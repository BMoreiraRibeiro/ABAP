{"config":{"lang":["pt"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Almanaque ABAP","text":"<p>Bem-vindo ao Almanaque ABAP \u2014 um guia pr\u00e1tico, organizado por curva de aprendizagem, com exemplos, padr\u00f5es e exerc\u00edcios.</p> <p>Se est\u00e1 a come\u00e7ar, siga a ordem sugerida abaixo; se j\u00e1 conhece os fundamentos, navegue diretamente pelos temas avan\u00e7ados.</p>"},{"location":"#percurso-de-aprendizagem","title":"\ud83d\udcda Percurso de Aprendizagem","text":""},{"location":"#fundamentos","title":"\ud83e\udde9 Fundamentos","text":"<p>Conceitos b\u00e1sicos, tipos de dados, tabelas internas e estrutura do programa.</p>"},{"location":"#sql","title":"\ud83d\udcbe SQL","text":"<p>SELECTs, joins, agrega\u00e7\u00f5es e otimiza\u00e7\u00f5es de consultas.</p>"},{"location":"#objetos-oo","title":"\ud83e\uddf1 Objetos (OO)","text":"<p>Classes, interfaces e padr\u00f5es de programa\u00e7\u00e3o orientada a objetos em ABAP.</p>"},{"location":"#alv-list-viewer","title":"\ud83d\udcca ALV (List Viewer)","text":"<p>Todos os tipos de ALV (cl\u00e1ssico/OO/tree) e exemplos pr\u00e1ticos de apresenta\u00e7\u00e3o de dados.</p>"},{"location":"#debugging","title":"\ud83d\udc1e Debugging","text":"<p>T\u00e9cnicas de debugging, breakpoints e an\u00e1lise de c\u00f3digo em runtime.</p>"},{"location":"#testes","title":"\ud83e\uddea Testes","text":"<p>ABAP Unit e boas pr\u00e1ticas de testes unit\u00e1rios.</p>"},{"location":"#performance","title":"\u26a1 Performance","text":"<p>Tuning, FOR ALL ENTRIES e otimiza\u00e7\u00f5es de performance.</p>"},{"location":"#integracoes","title":"\ud83d\udd17 Integra\u00e7\u00f5es","text":"<p>BAPIs, RFCs, jobs em background e integra\u00e7\u00e3o com sistemas externos.</p>"},{"location":"#jobs-background","title":"\u23f0 Jobs / Background","text":"<p>Agendamento e execu\u00e7\u00e3o de programas em background.</p>"},{"location":"#security","title":"\ud83d\udd12 Security","text":"<p>Authority checks e boas pr\u00e1ticas de seguran\u00e7a.</p>"},{"location":"#utilitarios","title":"\ud83e\uddf0 Utilit\u00e1rios","text":"<p>Snippets \u00fateis, manipula\u00e7\u00e3o de datas, JSON e fun\u00e7\u00f5es auxiliares.</p>"},{"location":"#cds-amdp","title":"\ud83d\udd37 CDS / AMDP","text":""},{"location":"#core-data-services-e-abap-managed-database-procedures","title":"Core Data Services e ABAP Managed Database Procedures.","text":""},{"location":"#por-onde-comecar","title":"\ud83d\ude80 Por onde come\u00e7ar?","text":"<ol> <li>Iniciante? Comece por Fundamentos \u2192 SQL \u2192 ALV</li> <li>J\u00e1 conhece ABAP b\u00e1sico? Explore Objetos (OO) \u2192 Performance \u2192 Integra\u00e7\u00f5es</li> <li>Desenvolvimento avan\u00e7ado? Veja CDS/AMDP \u2192 Testes \u2192 Security</li> </ol>"},{"location":"#como-usar-este-guia","title":"\ud83d\udca1 Como usar este guia","text":"<ul> <li>Use o menu lateral para navegar entre sec\u00e7\u00f5es</li> <li>Cada sec\u00e7\u00e3o tem um <code>index.md</code> introdut\u00f3rio e exemplos pr\u00e1ticos numerados</li> <li>Execute os exemplos no seu sistema SAP para aprender na pr\u00e1tica</li> <li>Os c\u00f3digos est\u00e3o prontos para copiar e adaptar</li> </ul> <p>Boa aprendizagem! \ud83c\udf93</p>"},{"location":"tags/","title":"\ud83d\udcda \u00cdndice de Tags","text":"<p>Esta p\u00e1gina lista todas as tags utilizadas na documenta\u00e7\u00e3o ABAP.</p>"},{"location":"tags/#tags-principais","title":"Tags Principais","text":"<ul> <li>#Fundamentos - Conceitos b\u00e1sicos de ABAP</li> <li>#SQL - Consultas e manipula\u00e7\u00e3o de dados</li> <li>#CDS - Core Data Services</li> <li>#ALV - ABAP List Viewer</li> <li>#Performance - Otimiza\u00e7\u00f5es e boas pr\u00e1ticas</li> <li>#OO - Programa\u00e7\u00e3o Orientada a Objetos</li> <li>#Modern-ABAP - Sintaxe moderna (7.40+)</li> </ul> <p>Nota: Esta p\u00e1gina ser\u00e1 gerada automaticamente quando o plugin de tags for configurado.</p>"},{"location":"alvs/","title":"Tipos de ALV em ABAP","text":"<p>Esta sec\u00e7\u00e3o aborda os diferentes tipos de ALV (ABAP List Viewer) dispon\u00edveis em ABAP para apresenta\u00e7\u00e3o de dados.</p>"},{"location":"alvs/#o-que-e-alv","title":"\ud83d\udcca O que \u00e9 ALV?","text":"<p>ALV (ABAP List Viewer) \u00e9 uma ferramenta SAP para exibir dados de forma estruturada com funcionalidades autom\u00e1ticas como: - Ordena\u00e7\u00e3o - Filtros - Exporta\u00e7\u00e3o (Excel, PDF) - Totaliza\u00e7\u00f5es - Layout personaliz\u00e1vel</p>"},{"location":"alvs/#tipos-de-alv","title":"\ud83c\udfaf Tipos de ALV","text":""},{"location":"alvs/#1-alv-classico-function-modules","title":"1. ALV Cl\u00e1ssico (Function Modules)","text":"<ul> <li><code>REUSE_ALV_GRID_DISPLAY</code></li> <li><code>REUSE_ALV_LIST_DISPLAY</code></li> <li><code>REUSE_ALV_HIERSEQ_LIST_DISPLAY</code></li> </ul>"},{"location":"alvs/#2-alv-orientado-a-objetos","title":"2. ALV Orientado a Objetos","text":"<ul> <li><code>CL_SALV_TABLE</code> (simples e completo)</li> <li><code>CL_GUI_ALV_GRID</code> (com container)</li> </ul>"},{"location":"alvs/#3-alv-tree","title":"3. ALV Tree","text":"<ul> <li>Apresenta\u00e7\u00e3o hier\u00e1rquica de dados</li> </ul>"},{"location":"alvs/#4-alv-popup","title":"4. ALV Popup","text":"<ul> <li>Janelas modais com dados</li> </ul>"},{"location":"alvs/#5-alv-em-fullscreen","title":"5. ALV em Fullscreen","text":"<ul> <li>Ocupa\u00e7\u00e3o total do ecr\u00e3</li> </ul> <p>\u00cdndice de Exemplos: 1. ALV Cl\u00e1ssico Grid 2. ALV Cl\u00e1ssico List 3. ALV OO com CL_SALV_TABLE 4. ALV OO com CL_GUI_ALV_GRID 5. ALV Tree Hier\u00e1rquico 6. ALV Popup 7. ALV com Edi\u00e7\u00e3o 8. ALV com Eventos 9. ALV com Bot\u00f5es Customizados 10. ALV com Layout e Variantes 11. ALV para Sele\u00e7\u00e3o de Valores</p>"},{"location":"alvs/#exemplos-rapidos-in-page","title":"\ud83e\udde9 Exemplos r\u00e1pidos (in-page)","text":"<p>Aqui est\u00e3o trechos de exemplo r\u00e1pidos para cada tipo de ALV. Mantive a estrutura com p\u00e1ginas separadas \u2014 clique em \"Ler mais\" para ver a explica\u00e7\u00e3o completa e exemplos maiores.</p>"},{"location":"alvs/#alv-classico-grid-trecho","title":"ALV Cl\u00e1ssico - Grid (trecho)","text":"<pre><code>REPORT z_alv_grid_classico.\n\nDATA: lt_sflight TYPE TABLE OF sflight,\n            lt_fieldcat TYPE slis_t_fieldcat_alv.\n\nSTART-OF-SELECTION.\n    SELECT * FROM sflight INTO TABLE lt_sflight UP TO 100 ROWS.\n    CALL FUNCTION 'REUSE_ALV_FIELDCATALOG_MERGE'\n        EXPORTING i_structure_name = 'SFLIGHT'\n        CHANGING  ct_fieldcat      = lt_fieldcat.\n    CALL FUNCTION 'REUSE_ALV_GRID_DISPLAY'\n        EXPORTING it_fieldcat = lt_fieldcat\n        TABLES   t_outtab    = lt_sflight.\n</code></pre> <p>Ler mais \u00bb</p>"},{"location":"alvs/#alv-classico-list-trecho","title":"ALV Cl\u00e1ssico - List (trecho)","text":"<pre><code>REPORT z_alv_list_classico.\nDATA: lt_scarr TYPE TABLE OF scarr, lt_fieldcat TYPE slis_t_fieldcat_alv.\nSTART-OF-SELECTION.\n    SELECT * FROM scarr INTO TABLE lt_scarr.\n    CALL FUNCTION 'REUSE_ALV_FIELDCATALOG_MERGE' EXPORTING i_structure_name = 'SCARR' CHANGING ct_fieldcat = lt_fieldcat.\n    CALL FUNCTION 'REUSE_ALV_LIST_DISPLAY' EXPORTING it_fieldcat = lt_fieldcat TABLES t_outtab = lt_scarr.\n</code></pre> <p>Ler mais \u00bb</p>"},{"location":"alvs/#alv-oo-cl_salv_table-trecho","title":"ALV OO - CL_SALV_TABLE (trecho)","text":"<pre><code>DATA: lt_sflight TYPE TABLE OF sflight, lo_alv TYPE REF TO cl_salv_table.\nSTART-OF-SELECTION.\n    SELECT * FROM sflight INTO TABLE lt_sflight UP TO 100 ROWS.\n    TRY.\n            cl_salv_table=&gt;factory( IMPORTING r_salv_table = lo_alv CHANGING t_table = lt_sflight ).\n            lo_alv-&gt;display( ).\n    CATCH cx_salv_msg INTO DATA(lx_error).\n            MESSAGE lx_error-&gt;get_text( ) TYPE 'E'.\n    ENDTRY.\n</code></pre> <p>Ler mais \u00bb</p>"},{"location":"alvs/#alv-oo-cl_gui_alv_grid-trecho","title":"ALV OO - CL_GUI_ALV_GRID (trecho)","text":"<pre><code>DATA: lo_container TYPE REF TO cl_gui_custom_container, lo_alv TYPE REF TO cl_gui_alv_grid, lt_sflight TYPE TABLE OF sflight.\nCREATE OBJECT lo_container EXPORTING container_name = 'CONTAINER'.\nCREATE OBJECT lo_alv EXPORTING i_parent = lo_container.\nCALL METHOD lo_alv-&gt;set_table_for_first_display CHANGING it_outtab = lt_sflight.\n</code></pre> <p>Ler mais \u00bb</p>"},{"location":"alvs/#alv-tree-exemplo-dinamico-trecho","title":"ALV Tree - Exemplo din\u00e2mico (trecho)","text":"<p>O exemplo din\u00e2mico <code>Z_DYNAMIC_SALV_TREE</code> constr\u00f3i recursivamente uma \u00e1rvore a partir de qualquer estrutura (campos simples, estruturas internas e tabelas internas). Veja o exemplo completo na p\u00e1gina.</p> <p>Ler mais \u00bb</p>"},{"location":"alvs/#alv-para-selecao-de-valores-trecho","title":"ALV para Sele\u00e7\u00e3o de Valores (trecho)","text":"<pre><code>\" Sele\u00e7\u00e3o m\u00faltipla com popup e checkbox\nCALL FUNCTION 'REUSE_ALV_POPUP_TO_SELECT'\n  EXPORTING\n    i_title              = 'Selecione Clientes'\n    i_selection          = 'X'\n    i_checkbox_fieldname = 'SEL'\n  IMPORTING\n    e_exit               = DATA(lv_exit)\n  TABLES\n    t_outtab             = lt_clientes\n    it_fieldcat          = lt_fieldcat.\n\nIF sy-subrc = 0 AND lv_exit IS INITIAL.\n  LOOP AT lt_clientes INTO DATA(ls_cliente) WHERE sel = 'X'.\n    \" Processar registos selecionados\n  ENDLOOP.\nENDIF.\n</code></pre> <p>Ler mais \u00bb</p> <p>Se quiser que algum destes trechos seja expandido (ex.: mostrar todo o exemplo do <code>Z_DYNAMIC_SALV_TREE</code> inline), digo e eu acrescento \u2014 por agora mantive trechos curtos na p\u00e1gina principal e deixei os exemplos completos nas p\u00e1ginas individuais.</p>"},{"location":"alvs/alv_botoes_custom/","title":"ALV com Bot\u00f5es Customizados","text":"<p>Adicionar bot\u00f5es pr\u00f3prios na toolbar do ALV.</p>"},{"location":"alvs/alv_botoes_custom/#com-cl_salv_table","title":"\ud83d\udd39 Com CL_SALV_TABLE","text":"<pre><code>DATA: lo_functions TYPE REF TO cl_salv_functions_list.\n\nlo_functions = lo_alv-&gt;get_functions( ).\nlo_functions-&gt;set_all( abap_true ).\n\n\" Adicionar bot\u00e3o customizado\nlo_functions-&gt;add_function(\n  name     = 'BTN_EXPORT'\n  icon     = '@49@'  \" \u00cdcone de exportar\n  text     = 'Exportar Sele\u00e7\u00e3o'\n  tooltip  = 'Exportar linhas selecionadas'\n  position = if_salv_c_function_position=&gt;right_of_salv_functions ).\n\n\" Capturar evento\nDATA: lo_events TYPE REF TO cl_salv_events_table.\nlo_events = lo_alv-&gt;get_event( ).\nSET HANDLER handle_user_command FOR lo_events.\n\nCLASS lcl_handler DEFINITION.\n  PUBLIC SECTION.\n    METHODS handle_user_command\n      FOR EVENT added_function OF cl_salv_events\n      IMPORTING e_salv_function.\nENDCLASS.\n\nCLASS lcl_handler IMPLEMENTATION.\n  METHOD handle_user_command.\n    CASE e_salv_function.\n      WHEN 'BTN_EXPORT'.\n        MESSAGE 'Bot\u00e3o Export clicado!' TYPE 'I'.\n    ENDCASE.\n  ENDMETHOD.\nENDCLASS.\n</code></pre>"},{"location":"alvs/alv_classico_grid/","title":"ALV Cl\u00e1ssico - Grid Display","text":"<p>O ALV Grid cl\u00e1ssico usa o function module <code>REUSE_ALV_GRID_DISPLAY</code>.</p>"},{"location":"alvs/alv_classico_grid/#exemplo-basico","title":"\ud83d\udd39 Exemplo B\u00e1sico","text":"<pre><code>REPORT z_alv_grid_classico.\n\nDATA: lt_sflight TYPE TABLE OF sflight,\n      lt_fieldcat TYPE slis_t_fieldcat_alv.\n\nSTART-OF-SELECTION.\n  \" Buscar dados\n  SELECT * FROM sflight INTO TABLE lt_sflight UP TO 100 ROWS.\n\n  \" Montar cat\u00e1logo de campos (autom\u00e1tico via estrutura)\n  CALL FUNCTION 'REUSE_ALV_FIELDCATALOG_MERGE'\n    EXPORTING\n      i_structure_name = 'SFLIGHT'\n    CHANGING\n      ct_fieldcat      = lt_fieldcat.\n\n  \" Exibir ALV\n  CALL FUNCTION 'REUSE_ALV_GRID_DISPLAY'\n    EXPORTING\n      it_fieldcat = lt_fieldcat\n    TABLES\n      t_outtab    = lt_sflight.\n</code></pre>"},{"location":"alvs/alv_classico_grid/#com-layout-customizado","title":"\ud83d\udd39 Com Layout Customizado","text":"<pre><code>DATA: ls_layout TYPE slis_layout_alv.\n\n\" Configurar layout\nls_layout-zebra = 'X'.              \" Linhas zebradas\nls_layout-colwidth_optimize = 'X'.  \" Otimizar largura das colunas\nls_layout-box_fieldname = 'SEL'.    \" Checkbox de sele\u00e7\u00e3o\n\nCALL FUNCTION 'REUSE_ALV_GRID_DISPLAY'\n  EXPORTING\n    is_layout   = ls_layout\n    it_fieldcat = lt_fieldcat\n  TABLES\n    t_outtab    = lt_sflight.\n</code></pre>"},{"location":"alvs/alv_classico_grid/#parametros-uteis","title":"\ud83d\udca1 Par\u00e2metros \u00dateis","text":"<ul> <li><code>i_callback_program</code> \u2192 Nome do programa para eventos</li> <li><code>i_callback_user_command</code> \u2192 Rotina para comandos do utilizador</li> <li><code>i_callback_pf_status_set</code> \u2192 GUI Status customizado</li> </ul>"},{"location":"alvs/alv_classico_list/","title":"ALV Cl\u00e1ssico - List Display","text":"<p>Apresenta\u00e7\u00e3o em formato lista (menos funcionalidades que Grid).</p>"},{"location":"alvs/alv_classico_list/#exemplo","title":"\ud83d\udd39 Exemplo","text":"<pre><code>REPORT z_alv_list_classico.\n\nDATA: lt_scarr TYPE TABLE OF scarr,\n      lt_fieldcat TYPE slis_t_fieldcat_alv.\n\nSTART-OF-SELECTION.\n  SELECT * FROM scarr INTO TABLE lt_scarr.\n\n  CALL FUNCTION 'REUSE_ALV_FIELDCATALOG_MERGE'\n    EXPORTING\n      i_structure_name = 'SCARR'\n    CHANGING\n      ct_fieldcat      = lt_fieldcat.\n\n  CALL FUNCTION 'REUSE_ALV_LIST_DISPLAY'\n    EXPORTING\n      it_fieldcat = lt_fieldcat\n    TABLES\n      t_outtab    = lt_scarr.\n</code></pre> <p>\ud83d\udca1 Menos usado que Grid, mas \u00fatil para reports simples.</p>"},{"location":"alvs/alv_editavel/","title":"ALV Edit\u00e1vel","text":"<p>Permitir edi\u00e7\u00e3o direta de dados no ALV.</p>"},{"location":"alvs/alv_editavel/#com-cl_gui_alv_grid","title":"\ud83d\udd39 Com CL_GUI_ALV_GRID","text":"<pre><code>DATA: lt_sflight TYPE TABLE OF sflight,\n      lo_alv     TYPE REF TO cl_gui_alv_grid,\n      lt_fieldcat TYPE lvc_t_fcat,\n      ls_layout  TYPE lvc_s_layo.\n\n\" ... criar container e dados ...\n\n\" Marcar campo como edit\u00e1vel no fieldcat\nLOOP AT lt_fieldcat ASSIGNING FIELD-SYMBOL(&lt;fs_fcat&gt;).\n  CASE &lt;fs_fcat&gt;-fieldname.\n    WHEN 'PRICE' OR 'CURRENCY'.\n      &lt;fs_fcat&gt;-edit = 'X'.  \" Permitir edi\u00e7\u00e3o\n  ENDCASE.\nENDLOOP.\n\n\" Layout para edi\u00e7\u00e3o\nls_layout-edit = 'X'.\n\nCALL METHOD lo_alv-&gt;set_table_for_first_display\n  EXPORTING\n    is_layout       = ls_layout\n  CHANGING\n    it_outtab       = lt_sflight\n    it_fieldcatalog = lt_fieldcat.\n</code></pre>"},{"location":"alvs/alv_editavel/#validar-dados-editados","title":"\ud83d\udd39 Validar Dados Editados","text":"<pre><code>\" Evento DATA_CHANGED\nSET HANDLER handle_data_changed FOR lo_alv.\n\nCLASS lcl_event_handler DEFINITION.\n  PUBLIC SECTION.\n    METHODS handle_data_changed\n      FOR EVENT data_changed OF cl_gui_alv_grid\n      IMPORTING er_data_changed.\nENDCLASS.\n\nCLASS lcl_event_handler IMPLEMENTATION.\n  METHOD handle_data_changed.\n    \" er_data_changed cont\u00e9m as altera\u00e7\u00f5es\n    LOOP AT er_data_changed-&gt;mt_good_cells INTO DATA(ls_cell).\n      \" Validar valor\n      IF ls_cell-value &lt; 0.\n        MESSAGE 'Pre\u00e7o n\u00e3o pode ser negativo' TYPE 'E'.\n      ENDIF.\n    ENDLOOP.\n  ENDMETHOD.\nENDCLASS.\n</code></pre>"},{"location":"alvs/alv_eventos/","title":"ALV com Eventos","text":"<p>Capturar a\u00e7\u00f5es do utilizador (clique duplo, bot\u00f5es, hotspots).</p>"},{"location":"alvs/alv_eventos/#evento-hotspot-click-cl_salv_table","title":"\ud83d\udd39 Evento Hotspot Click (CL_SALV_TABLE)","text":"<pre><code>DATA: lo_events TYPE REF TO cl_salv_events_table.\n\nlo_events = lo_alv-&gt;get_event( ).\nSET HANDLER handle_link_click FOR lo_events.\n\n\" ... na classe event handler ...\nCLASS lcl_handler DEFINITION.\n  PUBLIC SECTION.\n    METHODS handle_link_click\n      FOR EVENT link_click OF cl_salv_events_table\n      IMPORTING row column.\nENDCLASS.\n\nCLASS lcl_handler IMPLEMENTATION.\n  METHOD handle_link_click.\n    READ TABLE lt_sflight INDEX row INTO DATA(ls_flight).\n    MESSAGE |Clicaste em: { ls_flight-carrid }| TYPE 'I'.\n  ENDMETHOD.\nENDCLASS.\n</code></pre>"},{"location":"alvs/alv_eventos/#evento-user-command-classico","title":"\ud83d\udd39 Evento User Command (Cl\u00e1ssico)","text":"<pre><code>FORM user_command USING r_ucomm TYPE sy-ucomm\n                        rs_selfield TYPE slis_selfield.\n  CASE r_ucomm.\n    WHEN '&amp;IC1'.  \" Duplo clique\n      READ TABLE lt_sflight INDEX rs_selfield-tabindex INTO DATA(ls_line).\n      MESSAGE |Duplo clique: { ls_line-connid }| TYPE 'I'.\n  ENDCASE.\nENDFORM.\n</code></pre>"},{"location":"alvs/alv_layout_variantes/","title":"ALV com Layout e Variantes","text":"<p>Permitir que utilizadores guardem layouts personalizados.</p>"},{"location":"alvs/alv_layout_variantes/#com-cl_salv_table","title":"\ud83d\udd39 Com CL_SALV_TABLE","text":"<pre><code>DATA: lo_layout TYPE REF TO cl_salv_layout,\n      ls_key    TYPE salv_s_layout_key.\n\n\" Definir chave para guardar variantes\nls_key-report = sy-repid.\n\nlo_layout = lo_alv-&gt;get_layout( ).\nlo_layout-&gt;set_key( ls_key ).\nlo_layout-&gt;set_save_restriction( if_salv_c_layout=&gt;restrict_none ).  \" Permitir guardar\n\nlo_alv-&gt;display( ).\n</code></pre>"},{"location":"alvs/alv_layout_variantes/#layout-classico","title":"\ud83d\udd39 Layout Cl\u00e1ssico","text":"<pre><code>DATA: ls_variant TYPE disvariant.\n\nls_variant-report = sy-repid.\nls_variant-username = sy-uname.\n\nCALL FUNCTION 'REUSE_ALV_GRID_DISPLAY'\n  EXPORTING\n    i_save          = 'A'  \" Permitir guardar variantes\n    is_variant      = ls_variant\n    it_fieldcat     = lt_fieldcat\n  TABLES\n    t_outtab        = lt_data.\n</code></pre> <p>\ud83d\udca1 Variantes permitem que cada utilizador configure o seu pr\u00f3prio layout (ordem de colunas, filtros, etc.).</p>"},{"location":"alvs/alv_oo_gui_grid/","title":"ALV OO - CL_GUI_ALV_GRID","text":"<p>ALV com container para embedding em Dynpros ou integra\u00e7\u00e3o avan\u00e7ada.</p>"},{"location":"alvs/alv_oo_gui_grid/#exemplo-completo","title":"\ud83d\udd39 Exemplo Completo","text":"<pre><code>REPORT z_alv_gui_grid.\n\nDATA: lo_container TYPE REF TO cl_gui_custom_container,\n      lo_alv       TYPE REF TO cl_gui_alv_grid,\n      lt_sflight   TYPE TABLE OF sflight,\n      lt_fieldcat  TYPE lvc_t_fcat,\n      ls_layout    TYPE lvc_s_layo.\n\nSTART-OF-SELECTION.\n  SELECT * FROM sflight INTO TABLE lt_sflight UP TO 100 ROWS.\n\n  \" Montar fieldcat\n  CALL FUNCTION 'LVC_FIELDCATALOG_MERGE'\n    EXPORTING\n      i_structure_name = 'SFLIGHT'\n    CHANGING\n      ct_fieldcat      = lt_fieldcat.\n\n  \" Layout\n  ls_layout-zebra = 'X'.\n  ls_layout-cwidth_opt = 'X'.\n\n  \" Criar container (em Dynpro seria ligado a um controlo)\n  CREATE OBJECT lo_container\n    EXPORTING\n      container_name = 'CONTAINER'.\n\n  \" Criar ALV Grid\n  CREATE OBJECT lo_alv\n    EXPORTING\n      i_parent = lo_container.\n\n  \" Exibir dados\n  CALL METHOD lo_alv-&gt;set_table_for_first_display\n    EXPORTING\n      is_layout       = ls_layout\n    CHANGING\n      it_outtab       = lt_sflight\n      it_fieldcatalog = lt_fieldcat.\n\n  CALL SCREEN 100.\n</code></pre>"},{"location":"alvs/alv_oo_gui_grid/#screen-100-dynpro","title":"\ud83d\udd39 Screen 100 (Dynpro)","text":"<ul> <li>Criar screen 100 na SE51</li> <li>Adicionar Custom Container chamado <code>CONTAINER</code></li> <li>PBO: <pre><code>PROCESS BEFORE OUTPUT.\n  MODULE status_0100.\n</code></pre></li> </ul> <p>\ud83d\udca1 Usado quando precisas de controlo total sobre o ALV e integra\u00e7\u00e3o com Dynpros.</p>"},{"location":"alvs/alv_oo_salv_table/","title":"ALV OO - CL_SALV_TABLE","text":"<p>Abordagem moderna e simplificada para ALVs usando orienta\u00e7\u00e3o a objetos.</p>"},{"location":"alvs/alv_oo_salv_table/#exemplo-basico","title":"\ud83d\udd39 Exemplo B\u00e1sico","text":"<pre><code>REPORT z_alv_oo_salv.\n\nDATA: lt_sflight TYPE TABLE OF sflight,\n      lo_alv TYPE REF TO cl_salv_table.\n\nSTART-OF-SELECTION.\n  SELECT * FROM sflight INTO TABLE lt_sflight UP TO 100 ROWS.\n\n  TRY.\n      \" Factory method cria inst\u00e2ncia do ALV\n      cl_salv_table=&gt;factory(\n        IMPORTING r_salv_table = lo_alv\n        CHANGING  t_table      = lt_sflight ).\n\n      \" Exibir\n      lo_alv-&gt;display( ).\n\n    CATCH cx_salv_msg INTO DATA(lx_error).\n      MESSAGE lx_error-&gt;get_text( ) TYPE 'E'.\n  ENDTRY.\n</code></pre>"},{"location":"alvs/alv_oo_salv_table/#com-funcionalidades-ativadas","title":"\ud83d\udd39 Com Funcionalidades Ativadas","text":"<pre><code>DATA: lo_functions TYPE REF TO cl_salv_functions_list,\n      lo_columns   TYPE REF TO cl_salv_columns_table,\n      lo_display   TYPE REF TO cl_salv_display_settings.\n\n\" Ativar todas as fun\u00e7\u00f5es padr\u00e3o (Excel, layout, filtros, etc.)\nlo_functions = lo_alv-&gt;get_functions( ).\nlo_functions-&gt;set_all( abap_true ).\n\n\" Otimizar colunas\nlo_columns = lo_alv-&gt;get_columns( ).\nlo_columns-&gt;set_optimize( abap_true ).\n\n\" Configurar t\u00edtulo\nlo_display = lo_alv-&gt;get_display_settings( ).\nlo_display-&gt;set_list_header( 'Lista de Voos' ).\nlo_display-&gt;set_striped_pattern( abap_true ).  \" Zebrado\n\nlo_alv-&gt;display( ).\n</code></pre>"},{"location":"alvs/alv_oo_salv_table/#alterar-propriedades-de-colunas","title":"\ud83d\udd39 Alterar Propriedades de Colunas","text":"<pre><code>DATA: lo_column TYPE REF TO cl_salv_column_table.\n\nTRY.\n    \" Obter coluna espec\u00edfica\n    lo_column ?= lo_columns-&gt;get_column( 'PRICE' ).\n\n    \" Configurar\n    lo_column-&gt;set_short_text( 'Pre\u00e7o' ).\n    lo_column-&gt;set_medium_text( 'Pre\u00e7o do Voo' ).\n    lo_column-&gt;set_long_text( 'Pre\u00e7o Total do Voo' ).\n\n  CATCH cx_salv_not_found.\n    \" Coluna n\u00e3o encontrada\nENDTRY.\n</code></pre>"},{"location":"alvs/alv_oo_salv_table/#vantagens-do-cl_salv_table","title":"\ud83d\udca1 Vantagens do CL_SALV_TABLE","text":"<ul> <li>C\u00f3digo mais limpo e OO</li> <li>Funcionalidades autom\u00e1ticas (Export, Sort, Filter)</li> <li>Melhor manutenibilidade</li> </ul>"},{"location":"alvs/alv_popup/","title":"ALV Popup","text":"<p>Exibir ALV numa janela modal (popup).</p>"},{"location":"alvs/alv_popup/#exemplo-com-cl_salv_table","title":"\ud83d\udd39 Exemplo com CL_SALV_TABLE","text":"<pre><code>REPORT z_alv_popup.\n\nDATA: lt_scarr TYPE TABLE OF scarr,\n      lo_alv   TYPE REF TO cl_salv_table.\n\nSTART-OF-SELECTION.\n  SELECT * FROM scarr INTO TABLE lt_scarr.\n\n  TRY.\n      cl_salv_table=&gt;factory(\n        EXPORTING\n          list_display = abap_false   \" N\u00e3o fullscreen\n        IMPORTING\n          r_salv_table = lo_alv\n        CHANGING\n          t_table      = lt_scarr ).\n\n      \" Configurar como popup\n      lo_alv-&gt;set_screen_popup(\n        start_column = 10\n        end_column   = 100\n        start_line   = 5\n        end_line     = 20 ).\n\n      lo_alv-&gt;display( ).\n\n    CATCH cx_salv_msg.\n  ENDTRY.\n</code></pre>"},{"location":"alvs/alv_popup/#popup-com-reuse_alv_popup_to_select","title":"\ud83d\udd39 Popup com REUSE_ALV_POPUP_TO_SELECT","text":"<pre><code>DATA: lt_return TYPE TABLE OF scarr.\n\nCALL FUNCTION 'REUSE_ALV_POPUP_TO_SELECT'\n  EXPORTING\n    i_title               = 'Selecionar Companhia'\n    i_tabname             = 'SCARR'\n    i_structure_name      = 'SCARR'\n  IMPORTING\n    es_selfield           = DATA(ls_selected)\n  TABLES\n    t_outtab              = lt_scarr\n  EXCEPTIONS\n    program_error         = 1\n    OTHERS                = 2.\n\nIF sy-subrc = 0.\n  WRITE: / 'Selecionado:', ls_selected-value.\nENDIF.\n</code></pre>"},{"location":"alvs/alv_selecao_valores/","title":"ALV para Sele\u00e7\u00e3o de Valores","text":""},{"location":"alvs/alv_selecao_valores/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Este tipo de ALV permite ao utilizador selecionar um ou m\u00faltiplos registos de uma lista apresentada, retornando os valores selecionados para processamento posterior. \u00c9 ideal para:</p> <ul> <li>Sele\u00e7\u00e3o de valores em popup (como F4 customizado)</li> <li>Escolha m\u00faltipla de registos</li> <li>Filtrar e selecionar dados antes de processar</li> </ul>"},{"location":"alvs/alv_selecao_valores/#metodo-1-alv-popup-com-selecao-function-module","title":"\ud83c\udfaf M\u00e9todo 1: ALV Popup com Sele\u00e7\u00e3o (Function Module)","text":""},{"location":"alvs/alv_selecao_valores/#exemplo-basico-selecao-simples","title":"Exemplo B\u00e1sico - Sele\u00e7\u00e3o Simples","text":"<pre><code>REPORT z_alv_selecao_valores.\n\nTYPES: BEGIN OF ty_material,\n         matnr TYPE matnr,\n         maktx TYPE maktx,\n         mtart TYPE mtart,\n         meins TYPE meins,\n       END OF ty_material.\n\nDATA: lt_material TYPE TABLE OF ty_material,\n      ls_material TYPE ty_material,\n      lt_return   TYPE TABLE OF ddshretval,\n      ls_return   TYPE ddshretval.\n\nSTART-OF-SELECTION.\n\n  \" Buscar dados\n  SELECT mara~matnr, makt~maktx, mara~mtart, mara~meins\n    FROM mara\n    INNER JOIN makt ON mara~matnr = makt~matnr\n    INTO TABLE @lt_material\n    UP TO 100 ROWS\n    WHERE makt~spras = @sy-langu.\n\n  \" Exibir ALV com sele\u00e7\u00e3o\n  CALL FUNCTION 'F4IF_INT_TABLE_VALUE_REQUEST'\n    EXPORTING\n      retfield        = 'MATNR'           \" Campo a retornar\n      dynpprog        = sy-repid           \" Programa\n      dynpnr          = sy-dynnr           \" Tela\n      dynprofield     = 'P_MATNR'          \" Campo de tela\n      window_title    = 'Selecione um Material'\n      value_org       = 'S'                \" Estrutura\n    TABLES\n      value_tab       = lt_material        \" Tabela de valores\n      return_tab      = lt_return          \" Valores retornados\n    EXCEPTIONS\n      parameter_error = 1\n      no_values_found = 2\n      OTHERS          = 3.\n\n  IF sy-subrc = 0 AND lt_return IS NOT INITIAL.\n    READ TABLE lt_return INTO ls_return INDEX 1.\n    WRITE: / 'Material selecionado:', ls_return-fieldval.\n  ENDIF.\n</code></pre> <p>Caracter\u00edsticas: - \u2705 Popup autom\u00e1tico - \u2705 Busca integrada (F4) - \u2705 Retorna valor \u00fanico - \u26a0\ufe0f Limitado a um campo de retorno</p>"},{"location":"alvs/alv_selecao_valores/#metodo-2-alv-popup-com-checkbox-selecao-multipla","title":"\ud83c\udfaf M\u00e9todo 2: ALV Popup com Checkbox (Sele\u00e7\u00e3o M\u00faltipla)","text":""},{"location":"alvs/alv_selecao_valores/#exemplo-multipla-selecao","title":"Exemplo - M\u00faltipla Sele\u00e7\u00e3o","text":"<pre><code>REPORT z_alv_multi_selecao.\n\nTYPES: BEGIN OF ty_cliente,\n         sel   TYPE char1,              \" Checkbox\n         kunnr TYPE kunnr,\n         name1 TYPE name1,\n         ort01 TYPE ort01,\n         land1 TYPE land1,\n       END OF ty_cliente.\n\nDATA: lt_clientes TYPE TABLE OF ty_cliente,\n      ls_cliente  TYPE ty_cliente,\n      lt_fieldcat TYPE slis_t_fieldcat_alv,\n      ls_fieldcat TYPE slis_fieldcat_alv,\n      lt_selected TYPE TABLE OF ty_cliente.\n\nSTART-OF-SELECTION.\n\n  \" Buscar clientes\n  SELECT kunnr, name1, ort01, land1\n    FROM kna1\n    INTO CORRESPONDING FIELDS OF TABLE @lt_clientes\n    UP TO 50 ROWS.\n\n  \" Preparar Field Catalog\n  CLEAR ls_fieldcat.\n  ls_fieldcat-fieldname = 'SEL'.\n  ls_fieldcat-checkbox  = 'X'.\n  ls_fieldcat-edit      = 'X'.\n  ls_fieldcat-seltext_m = 'Sel'.\n  APPEND ls_fieldcat TO lt_fieldcat.\n\n  ls_fieldcat-fieldname = 'KUNNR'.\n  ls_fieldcat-seltext_m = 'Cliente'.\n  ls_fieldcat-checkbox  = space.\n  ls_fieldcat-edit      = space.\n  APPEND ls_fieldcat TO lt_fieldcat.\n\n  ls_fieldcat-fieldname = 'NAME1'.\n  ls_fieldcat-seltext_m = 'Nome'.\n  APPEND ls_fieldcat TO lt_fieldcat.\n\n  ls_fieldcat-fieldname = 'ORT01'.\n  ls_fieldcat-seltext_m = 'Cidade'.\n  APPEND ls_fieldcat TO lt_fieldcat.\n\n  ls_fieldcat-fieldname = 'LAND1'.\n  ls_fieldcat-seltext_m = 'Pa\u00eds'.\n  APPEND ls_fieldcat TO lt_fieldcat.\n\n  \" Exibir ALV popup com checkbox\n  CALL FUNCTION 'REUSE_ALV_POPUP_TO_SELECT'\n    EXPORTING\n      i_title               = 'Selecione Clientes'\n      i_selection           = 'X'           \" Permite sele\u00e7\u00e3o\n      i_screen_start_column = 10\n      i_screen_start_line   = 5\n      i_screen_end_column   = 120\n      i_screen_end_line     = 20\n      i_checkbox_fieldname  = 'SEL'         \" Campo checkbox\n    IMPORTING\n      e_exit                = DATA(lv_exit)\n    TABLES\n      t_outtab              = lt_clientes\n      it_fieldcat           = lt_fieldcat\n    EXCEPTIONS\n      program_error         = 1\n      OTHERS                = 2.\n\n  IF sy-subrc = 0 AND lv_exit IS INITIAL.\n    \" Processar selecionados\n    LOOP AT lt_clientes INTO ls_cliente WHERE sel = 'X'.\n      APPEND ls_cliente TO lt_selected.\n    ENDLOOP.\n\n    \" Mostrar resultado\n    WRITE: / 'Registos selecionados:', lines( lt_selected ).\n    LOOP AT lt_selected INTO ls_cliente.\n      WRITE: / ls_cliente-kunnr, ls_cliente-name1.\n    ENDLOOP.\n  ELSE.\n    WRITE: / 'Sele\u00e7\u00e3o cancelada'.\n  ENDIF.\n</code></pre> <p>Caracter\u00edsticas: - \u2705 Sele\u00e7\u00e3o m\u00faltipla com checkbox - \u2705 Popup configur\u00e1vel - \u2705 Retorna tabela completa - \u2705 Controlo sobre campos edit\u00e1veis</p>"},{"location":"alvs/alv_selecao_valores/#metodo-3-alv-oo-com-selecao-cl_salv_table-em-popup","title":"\ud83c\udfaf M\u00e9todo 3: ALV OO com Sele\u00e7\u00e3o (CL_SALV_TABLE em Popup)","text":""},{"location":"alvs/alv_selecao_valores/#exemplo-orientado-a-objetos","title":"Exemplo - Orientado a Objetos","text":"<pre><code>REPORT z_alv_oo_selecao.\n\nTYPES: BEGIN OF ty_fornecedor,\n         sel   TYPE char1,\n         lifnr TYPE lifnr,\n         name1 TYPE name1,\n         ort01 TYPE ort01,\n       END OF ty_fornecedor.\n\nDATA: lt_fornecedores TYPE TABLE OF ty_fornecedor,\n      lo_alv          TYPE REF TO cl_salv_table,\n      lo_selections   TYPE REF TO cl_salv_selections,\n      lo_columns      TYPE REF TO cl_salv_columns_table,\n      lo_column       TYPE REF TO cl_salv_column_table.\n\nSTART-OF-SELECTION.\n\n  \" Buscar fornecedores\n  SELECT lifnr, name1, ort01\n    FROM lfa1\n    INTO CORRESPONDING FIELDS OF TABLE @lt_fornecedores\n    UP TO 50 ROWS.\n\n  TRY.\n      \" Criar ALV\n      cl_salv_table=&gt;factory(\n        EXPORTING\n          list_display = abap_false    \" Fullscreen\n        IMPORTING\n          r_salv_table = lo_alv\n        CHANGING\n          t_table      = lt_fornecedores ).\n\n      \" Ativar sele\u00e7\u00e3o m\u00faltipla\n      lo_selections = lo_alv-&gt;get_selections( ).\n      lo_selections-&gt;set_selection_mode(\n        if_salv_c_selection_mode=&gt;row_column ).\n\n      \" Configurar colunas\n      lo_columns = lo_alv-&gt;get_columns( ).\n      lo_columns-&gt;set_optimize( abap_true ).\n\n      \" Esconder campo SEL\n      lo_column ?= lo_columns-&gt;get_column( 'SEL' ).\n      lo_column-&gt;set_visible( abap_false ).\n\n      \" Exibir ALV\n      lo_alv-&gt;display( ).\n\n      \" Obter linhas selecionadas\n      DATA(lt_rows) = lo_selections-&gt;get_selected_rows( ).\n\n      \" Processar sele\u00e7\u00e3o\n      IF lt_rows IS NOT INITIAL.\n        WRITE: / 'Fornecedores selecionados:'.\n        LOOP AT lt_rows INTO DATA(lv_row).\n          READ TABLE lt_fornecedores INDEX lv_row INTO DATA(ls_fornecedor).\n          IF sy-subrc = 0.\n            WRITE: / ls_fornecedor-lifnr, ls_fornecedor-name1.\n          ENDIF.\n        ENDLOOP.\n      ELSE.\n        WRITE: / 'Nenhum fornecedor selecionado'.\n      ENDIF.\n\n    CATCH cx_salv_msg INTO DATA(lx_error).\n      MESSAGE lx_error-&gt;get_text( ) TYPE 'E'.\n  ENDTRY.\n</code></pre> <p>Caracter\u00edsticas: - \u2705 Totalmente orientado a objetos - \u2705 Sele\u00e7\u00e3o nativa do SALV - \u2705 M\u00e9todos para obter linhas selecionadas - \u2705 Mais controlo sobre apar\u00eancia</p>"},{"location":"alvs/alv_selecao_valores/#metodo-4-alv-com-duplo-click-para-selecao","title":"\ud83c\udfaf M\u00e9todo 4: ALV com Duplo-Click para Sele\u00e7\u00e3o","text":""},{"location":"alvs/alv_selecao_valores/#exemplo-selecao-por-duplo-click","title":"Exemplo - Sele\u00e7\u00e3o por Duplo Click","text":"<pre><code>REPORT z_alv_doubleclick.\n\nTYPES: BEGIN OF ty_pedido,\n         vbeln TYPE vbeln_va,\n         erdat TYPE erdat,\n         netwr TYPE netwr,\n         waerk TYPE waerk,\n       END OF ty_pedido.\n\nDATA: lt_pedidos TYPE TABLE OF ty_pedido,\n      lo_alv     TYPE REF TO cl_salv_table,\n      lo_events  TYPE REF TO cl_salv_events_table.\n\nCLASS lcl_event_handler DEFINITION.\n  PUBLIC SECTION.\n    METHODS: on_double_click\n      FOR EVENT double_click OF cl_salv_events_table\n      IMPORTING row column.\nENDCLASS.\n\nCLASS lcl_event_handler IMPLEMENTATION.\n  METHOD on_double_click.\n    READ TABLE lt_pedidos INDEX row INTO DATA(ls_pedido).\n    IF sy-subrc = 0.\n      MESSAGE |Pedido selecionado: { ls_pedido-vbeln }| TYPE 'I'.\n      \" Aqui pode processar o valor selecionado\n    ENDIF.\n  ENDMETHOD.\nENDCLASS.\n\nSTART-OF-SELECTION.\n\n  \" Buscar pedidos\n  SELECT vbeln, erdat, netwr, waerk\n    FROM vbak\n    INTO CORRESPONDING FIELDS OF TABLE @lt_pedidos\n    UP TO 100 ROWS.\n\n  TRY.\n      \" Criar ALV\n      cl_salv_table=&gt;factory(\n        IMPORTING r_salv_table = lo_alv\n        CHANGING t_table = lt_pedidos ).\n\n      \" Registar eventos\n      lo_events = lo_alv-&gt;get_event( ).\n      DATA(lo_handler) = NEW lcl_event_handler( ).\n      SET HANDLER lo_handler-&gt;on_double_click FOR lo_events.\n\n      \" Configurar colunas\n      lo_alv-&gt;get_columns( )-&gt;set_optimize( abap_true ).\n\n      \" Exibir\n      lo_alv-&gt;display( ).\n\n    CATCH cx_salv_msg INTO DATA(lx_error).\n      MESSAGE lx_error-&gt;get_text( ) TYPE 'E'.\n  ENDTRY.\n</code></pre> <p>Caracter\u00edsticas: - \u2705 Sele\u00e7\u00e3o intuitiva (duplo-click) - \u2705 Eventos customiz\u00e1veis - \u2705 F\u00e1cil implementa\u00e7\u00e3o - \u2705 Ideal para sele\u00e7\u00e3o \u00fanica</p>"},{"location":"alvs/alv_selecao_valores/#comparacao-dos-metodos","title":"\ud83d\udcca Compara\u00e7\u00e3o dos M\u00e9todos","text":"M\u00e9todo Tipo M\u00faltipla Sele\u00e7\u00e3o Complexidade Uso Recomendado F4IF_INT_TABLE_VALUE_REQUEST Function \u274c N\u00e3o \u2b50 Baixa Sele\u00e7\u00e3o r\u00e1pida de valor \u00fanico REUSE_ALV_POPUP_TO_SELECT Function \u2705 Sim (checkbox) \u2b50\u2b50 M\u00e9dia Popup com m\u00faltipla sele\u00e7\u00e3o CL_SALV_TABLE com Sele\u00e7\u00f5es OO \u2705 Sim \u2b50\u2b50\u2b50 Alta Sele\u00e7\u00e3o avan\u00e7ada, fullscreen Duplo-Click Event OO \u274c N\u00e3o* \u2b50\u2b50 M\u00e9dia Sele\u00e7\u00e3o intuitiva \u00fanica <p>*Pode ser combinado com <code>CTRL+Click</code> para m\u00faltipla sele\u00e7\u00e3o</p>"},{"location":"alvs/alv_selecao_valores/#dicas-praticas","title":"\ud83d\udca1 Dicas Pr\u00e1ticas","text":""},{"location":"alvs/alv_selecao_valores/#boas-praticas","title":"\u2705 Boas Pr\u00e1ticas","text":"<ol> <li>Para sele\u00e7\u00e3o \u00fanica r\u00e1pida: Use <code>F4IF_INT_TABLE_VALUE_REQUEST</code></li> <li>Para m\u00faltipla sele\u00e7\u00e3o em popup: Use <code>REUSE_ALV_POPUP_TO_SELECT</code></li> <li>Para controlo avan\u00e7ado: Use <code>CL_SALV_TABLE</code> com eventos</li> <li>Validar sempre: Verifique se <code>sy-subrc = 0</code> ap\u00f3s chamadas</li> <li>User-friendly: Adicione t\u00edtulos descritivos \u00e0s janelas</li> </ol>"},{"location":"alvs/alv_selecao_valores/#armadilhas-comuns","title":"\u26a0\ufe0f Armadilhas Comuns","text":"<ol> <li>Esquecer o campo checkbox: Defina <code>i_checkbox_fieldname</code> corretamente</li> <li>N\u00e3o processar cancelamento: Sempre verificar <code>e_exit</code> em popups</li> <li>Performance: Limite registos com <code>UP TO n ROWS</code> em SELECTs</li> <li>Field Catalog incompleto: Certifique-se que todos os campos t\u00eam descri\u00e7\u00e3o</li> </ol>"},{"location":"alvs/alv_selecao_valores/#exemplos-relacionados","title":"\ud83d\udd17 Exemplos Relacionados","text":"<ul> <li>ALV Popup - Mais exemplos de popup</li> <li>ALV com Eventos - Trabalhar com eventos</li> <li>ALV Edit\u00e1vel - Combinar sele\u00e7\u00e3o com edi\u00e7\u00e3o</li> </ul>"},{"location":"alvs/alv_selecao_valores/#referencias-sap","title":"\ud83d\udcda Refer\u00eancias SAP","text":"<ul> <li>Transaction: SE37 \u2192 <code>F4IF_INT_TABLE_VALUE_REQUEST</code></li> <li>Transaction: SE37 \u2192 <code>REUSE_ALV_POPUP_TO_SELECT</code></li> <li>Transaction: SE24 \u2192 <code>CL_SALV_TABLE</code>, <code>CL_SALV_SELECTIONS</code></li> </ul> <p>Tags: <code>#ALV</code> <code>#Sele\u00e7\u00e3o</code> <code>#Popup</code> <code>#F4</code> <code>#Checkbox</code> <code>#Eventos</code></p>"},{"location":"alvs/alv_tree/","title":"ALV Tree - Hier\u00e1rquico","text":""},{"location":"alvs/alv_tree/#alv-tree-hierarquico_1","title":"ALV Tree - Hier\u00e1rquico","text":"<p>Apresenta\u00e7\u00e3o de dados em estrutura de \u00e1rvore (hierarquia pai-filho).</p>"},{"location":"alvs/alv_tree/#exemplo-com-cl_salv_tree","title":"\ud83d\udd39 Exemplo com CL_SALV_TREE","text":"<pre><code>REPORT z_alv_tree.\n\nDATA: lo_tree TYPE REF TO cl_salv_tree,\n      lt_data TYPE TABLE OF sflight.\n\nSTART-OF-SELECTION.\n  SELECT * FROM sflight INTO TABLE lt_data.\n\n  TRY.\n      cl_salv_tree=&gt;factory(\n        IMPORTING r_salv_tree = lo_tree\n        CHANGING  t_table     = lt_data ).\n\n      lo_tree-&gt;display( ).\n\n    CATCH cx_salv_error INTO DATA(lx_err).\n      MESSAGE lx_err-&gt;get_text( ) TYPE 'E'.\n  ENDTRY.\n</code></pre> <p>\ud83d\udca1 Ideal para estruturas como organogramas, BOMs ou \u00e1rvores de pastas.</p>"},{"location":"alvs/alv_tree/#exemplo-dinamico-z_dynamic_salv_tree","title":"\ud83d\udd39 Exemplo Din\u00e2mico: Z_DYNAMIC_SALV_TREE","text":"<p>Exemplo completo de um report ABAP que monta dinamicamente um SALV Tree a partir de qualquer estrutura, processando campos simples, estruturas internas e tabelas internas. \u00datil como refer\u00eancia para criar \u00e1rvores din\u00e2micas que refletem a estrutura de dados.</p> <pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_DYNAMIC_SALV_TREE\n*&amp;---------------------------------------------------------------------*\n*&amp; SALV Tree Din\u00e2mica - Processa qualquer estrutura automaticamente\n*&amp;---------------------------------------------------------------------*\nREPORT z_dynamic_salv_tree.\n\n*----------------------------------------------------------------------*\n* Estrutura para a Tree\n*----------------------------------------------------------------------*\nTYPES: BEGIN OF ty_tree_node,\n         field_name   TYPE string,\n         field_value  TYPE string,\n         field_type   TYPE string,\n       END OF ty_tree_node.\n\n*----------------------------------------------------------------------*\n* Declara\u00e7\u00f5es Globais\n*----------------------------------------------------------------------*\nDATA: gt_tree_data TYPE STANDARD TABLE OF ty_tree_node.\n\nDATA: go_tree      TYPE REF TO cl_salv_tree,\n      go_nodes     TYPE REF TO cl_salv_nodes,\n      go_node      TYPE REF TO cl_salv_node,\n      go_columns   TYPE REF TO cl_salv_columns_tree,\n      go_functions TYPE REF TO cl_salv_functions_tree.\n\n*----------------------------------------------------------------------*\n* START-OF-SELECTION\n*----------------------------------------------------------------------*\nSTART-OF-SELECTION.\n\n  \" Obter dados\n  DATA lv_os TYPE aufnr VALUE '200000000355'.\n  DATA(lo_so) = NEW zcl_wm_so( lv_os ).\n  DATA(ls_os) = zcl_wm_putorder_fill_body=&gt;get_put_order_data( lo_so ).\n\n  \" Criar SALV Tree\n  TRY.\n      CALL METHOD cl_salv_tree=&gt;factory\n        IMPORTING\n          r_salv_tree = go_tree\n        CHANGING\n          t_table     = gt_tree_data.\n    CATCH cx_salv_error INTO DATA(lx_error).\n      MESSAGE lx_error-&gt;get_text( ) TYPE 'I' DISPLAY LIKE 'E'.\n      RETURN.\n  ENDTRY.\n\n  \" Obter n\u00f3s\n  go_nodes = go_tree-&gt;get_nodes( ).\n\n  \" Construir \u00e1rvore recursivamente\n  PERFORM build_tree USING ls_os '' 0.\n\n  \" Configurar colunas\n  PERFORM configure_columns.\n\n  \" Ativar fun\u00e7\u00f5es\n  go_functions = go_tree-&gt;get_functions( ).\n  go_functions-&gt;set_all( abap_true ).\n\n  \" Colapsar todos os n\u00f3s\n  TRY.\n      go_nodes-&gt;collapse_all( ).\n    CATCH cx_salv_msg.\n  ENDTRY.\n\n  \" Exibir\n  go_tree-&gt;display( ).\n\n*----------------------------------------------------------------------*\n* FORM build_tree - Construir \u00e1rvore recursivamente\n*----------------------------------------------------------------------*\nFORM build_tree USING p_data       TYPE any\n                      p_parent_key TYPE salv_de_node_key\n                      p_level      TYPE i.\n\n  DATA: wa_node        TYPE ty_tree_node,\n        lv_current_key TYPE salv_de_node_key.\n\n  DATA(lo_type) = cl_abap_typedescr=&gt;describe_by_data( p_data ).\n\n  IF lo_type-&gt;kind &lt;&gt; cl_abap_typedescr=&gt;kind_struct.\n    RETURN.\n  ENDIF.\n\n  DATA(lt_comp) = CAST cl_abap_structdescr( lo_type )-&gt;components.\n\n  LOOP AT lt_comp ASSIGNING FIELD-SYMBOL(&lt;fs_comp&gt;).\n\n    \" Ignorar campos especiais\n    IF &lt;fs_comp&gt;-name = 'CONTROLLER' OR &lt;fs_comp&gt;-name = 'MANDT'.\n      CONTINUE.\n    ENDIF.\n\n    \" Obter valor do campo\n    FIELD-SYMBOLS: &lt;fs_value&gt; TYPE any.\n    ASSIGN COMPONENT &lt;fs_comp&gt;-name OF STRUCTURE p_data TO &lt;fs_value&gt;.\n\n    IF sy-subrc &lt;&gt; 0.\n      CONTINUE.\n    ENDIF.\n\n    CLEAR wa_node.\n    wa_node-field_name = &lt;fs_comp&gt;-name.\n\n    CASE &lt;fs_comp&gt;-type_kind.\n\n      \" ========== CAMPO SIMPLES ==========\n      WHEN cl_abap_typedescr=&gt;typekind_string OR\n           cl_abap_typedescr=&gt;typekind_char   OR\n           cl_abap_typedescr=&gt;typekind_num    OR\n           cl_abap_typedescr=&gt;typekind_int    OR\n           cl_abap_typedescr=&gt;typekind_int1   OR\n           cl_abap_typedescr=&gt;typekind_int2   OR\n           cl_abap_typedescr=&gt;typekind_packed OR\n           cl_abap_typedescr=&gt;typekind_date   OR\n           cl_abap_typedescr=&gt;typekind_time.\n\n        wa_node-field_value = &lt;fs_value&gt;.\n        wa_node-field_type = 'Campo'.\n\n        TRY.\n            go_node = go_nodes-&gt;add_node(\n              related_node = p_parent_key\n              relationship = cl_gui_column_tree=&gt;relat_last_child\n              data_row     = wa_node ).\n          CATCH cx_salv_msg.\n        ENDTRY.\n\n      \" ========== ESTRUTURA ==========\n      WHEN cl_abap_typedescr=&gt;typekind_struct1 OR\n           cl_abap_typedescr=&gt;typekind_struct2.\n\n        wa_node-field_value = '(Estrutura)'.\n        wa_node-field_type = 'Estrutura'.\n\n        TRY.\n            go_node = go_nodes-&gt;add_node(\n              related_node = p_parent_key\n              relationship = cl_gui_column_tree=&gt;relat_last_child\n              data_row     = wa_node ).\n            lv_current_key = go_node-&gt;get_key( ).\n          CATCH cx_salv_msg.\n            CONTINUE.\n        ENDTRY.\n\n        \" Chamada recursiva\n        DATA(lv_next_level) = p_level + 1.\n        PERFORM build_tree USING &lt;fs_value&gt; lv_current_key lv_next_level.\n\n      \" ========== TABELA ==========\n      WHEN cl_abap_typedescr=&gt;typekind_table.\n\n        FIELD-SYMBOLS: &lt;ft_table&gt; TYPE ANY TABLE.\n        ASSIGN &lt;fs_value&gt; TO &lt;ft_table&gt;.\n\n        DATA(lv_lines) = lines( &lt;ft_table&gt; ).\n        wa_node-field_value = |Tabela ({ lv_lines } linhas)|.\n        wa_node-field_type = 'Tabela'.\n\n        TRY.\n            go_node = go_nodes-&gt;add_node(\n              related_node = p_parent_key\n              relationship = cl_gui_column_tree=&gt;relat_last_child\n              data_row     = wa_node ).\n            lv_current_key = go_node-&gt;get_key( ).\n          CATCH cx_salv_msg.\n            CONTINUE.\n        ENDTRY.\n\n        \" Processar linhas\n        FIELD-SYMBOLS: &lt;fs_row&gt; TYPE any.\n        DATA: lv_row_counter TYPE i VALUE 0,\n              lv_row_key     TYPE salv_de_node_key.\n\n        LOOP AT &lt;ft_table&gt; ASSIGNING &lt;fs_row&gt;.\n          lv_row_counter = lv_row_counter + 1.\n\n          \" Criar n\u00f3 para a linha (sem adicionar como n\u00f3 vis\u00edvel)\n          \" Processar diretamente os campos da linha\n          DATA(lv_table_level) = p_level + 1.\n          PERFORM build_tree USING &lt;fs_row&gt; lv_current_key lv_table_level.\n        ENDLOOP.\n\n    ENDCASE.\n\n  ENDLOOP.\n\nENDFORM.\n\n*----------------------------------------------------------------------*\n* FORM configure_columns - Configurar colunas\n*----------------------------------------------------------------------*\nFORM configure_columns.\n\n  DATA: lo_column TYPE REF TO cl_salv_column_tree.\n\n  go_columns = go_tree-&gt;get_columns( ).\n  go_columns-&gt;set_optimize( abap_false ).\n\n  \" Definir largura da coluna de hierarquia (\u00edcones)\n  TRY.\n      go_tree-&gt;get_tree_settings( )-&gt;set_hierarchy_size( 8 ).\n    CATCH cx_salv_error.\n  ENDTRY.\n\n  \" Coluna FIELD_NAME\n  TRY.\n      lo_column ?= go_columns-&gt;get_column( 'FIELD_NAME' ).\n      lo_column-&gt;set_long_text( 'Campo' ).\n      lo_column-&gt;set_medium_text( 'Campo' ).\n      lo_column-&gt;set_short_text( 'Campo' ).\n      lo_column-&gt;set_output_length( 40 ).\n    CATCH cx_salv_not_found.\n  ENDTRY.\n\n  \" Coluna FIELD_VALUE\n  TRY.\n      lo_column ?= go_columns-&gt;get_column( 'FIELD_VALUE' ).\n      lo_column-&gt;set_long_text( 'Valor' ).\n      lo_column-&gt;set_medium_text( 'Valor' ).\n      lo_column-&gt;set_short_text( 'Valor' ).\n      lo_column-&gt;set_output_length( 80 ).\n    CATCH cx_salv_not_found.\n  ENDTRY.\n\n  \" Coluna FIELD_TYPE\n  TRY.\n      lo_column ?= go_columns-&gt;get_column( 'FIELD_TYPE' ).\n      lo_column-&gt;set_long_text( 'Tipo' ).\n      lo_column-&gt;set_medium_text( 'Tipo' ).\n      lo_column-&gt;set_short_text( 'Tipo' ).\n      lo_column-&gt;set_output_length( 12 ).\n    CATCH cx_salv_not_found.\n  ENDTRY.\n\nENDFORM.\n</code></pre>"},{"location":"cds/","title":"CDS Views (Core Data Services)","text":""},{"location":"cds/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>CDS Views s\u00e3o views sem\u00e2nticas definidas em linguagem DDL (Data Definition Language) que substituem as views cl\u00e1ssicas do SAP. Oferecem funcionalidades avan\u00e7adas como associations, annotations e otimiza\u00e7\u00e3o de performance.</p>"},{"location":"cds/#o-que-sao-cds-views","title":"\ud83c\udfaf O que s\u00e3o CDS Views?","text":"<p>CDS (Core Data Services) \u00e9 uma tecnologia SAP moderna que permite:</p> <ul> <li>\u2705 Criar views com sintaxe SQL moderna</li> <li>\u2705 Definir relacionamentos entre entidades (associations)</li> <li>\u2705 Adicionar metadados atrav\u00e9s de annotations</li> <li>\u2705 Otimizar performance com pushdown para base de dados</li> <li>\u2705 Integra\u00e7\u00e3o nativa com Fiori e OData</li> </ul>"},{"location":"cds/#conteudos","title":"\ud83d\udcda Conte\u00fados","text":"<p>Esta sec\u00e7\u00e3o est\u00e1 organizada nos seguintes t\u00f3picos:</p> <ol> <li>Introdu\u00e7\u00e3o - Conceitos b\u00e1sicos e primeira CDS View</li> <li>JOINs e Associa\u00e7\u00f5es - Como relacionar dados em CDS</li> <li>Anota\u00e7\u00f5es e Metadata - Configurar comportamento das views</li> <li>Fun\u00e7\u00f5es e Express\u00f5es - C\u00e1lculos e manipula\u00e7\u00e3o de dados</li> <li>Par\u00e2metros e Views Parametrizadas - CDS din\u00e2micas</li> </ol>"},{"location":"cds/#exemplo-rapido","title":"\ud83d\ude80 Exemplo R\u00e1pido","text":""},{"location":"cds/#cds-view-basica","title":"CDS View B\u00e1sica","text":"<pre><code>@AbapCatalog.sqlViewName: 'ZV_CLIENTES'\n@EndUserText.label: 'Clientes Ativos'\n@AccessControl.authorizationCheck: #CHECK\n\ndefine view Z_CDS_Clientes as\n  select from kna1\n{\n  key kunnr as Cliente,\n      name1 as Nome,\n      ort01 as Cidade,\n      land1 as Pais\n}\nwhere loevm = ''  -- N\u00e3o marcado para elimina\u00e7\u00e3o\n</code></pre>"},{"location":"cds/#consumir-em-abap","title":"Consumir em ABAP","text":"<pre><code>SELECT * FROM z_cds_clientes\n  INTO TABLE @DATA(lt_clientes)\n  UP TO 100 ROWS.\n\nLOOP AT lt_clientes INTO DATA(ls_cliente).\n  WRITE: / ls_cliente-cliente, ls_cliente-nome.\nENDLOOP.\n</code></pre>"},{"location":"cds/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ol> <li>Comece pela Introdu\u00e7\u00e3o para entender os conceitos b\u00e1sicos</li> <li>Instale o ABAP Development Tools (ADT) no Eclipse para criar CDS Views</li> <li>Pratique com os exemplos em cada sec\u00e7\u00e3o</li> </ol>"},{"location":"cds/#cds-vs-views-classicas","title":"\ud83d\udcca CDS vs. Views Cl\u00e1ssicas","text":"Caracter\u00edstica CDS View View Cl\u00e1ssica (SE11) Sintaxe DDL (SQL-like) ABAP Dictionary Associations \u2705 Sim \u274c N\u00e3o Annotations \u2705 Sim \u274c N\u00e3o Par\u00e2metros \u2705 Sim \u274c N\u00e3o Performance HANA \u2705 Otimizado \u26a0\ufe0f Limitado OData/Fiori \u2705 Nativo \u26a0\ufe0f Requer adapter <p>Tags: <code>#CDS</code> <code>#Views</code> <code>#DDL</code> <code>#HANA</code> <code>#Performance</code></p>"},{"location":"cds/1_introducao/","title":"CDS - Introdu\u00e7\u00e3o e Conceitos Fundamentais","text":""},{"location":"cds/1_introducao/#o-que-sao-core-data-services-cds","title":"O que s\u00e3o Core Data Services (CDS)?","text":"<p>Core Data Services (CDS) \u00e9 uma linguagem de defini\u00e7\u00e3o de dados sem\u00e2ntica que permite definir modelos de dados diretamente no dicion\u00e1rio ABAP. CDS representa uma evolu\u00e7\u00e3o significativa no desenvolvimento SAP, permitindo modelagem de dados mais pr\u00f3xima da camada de base de dados com melhor performance.</p>"},{"location":"cds/1_introducao/#principais-vantagens","title":"Principais Vantagens","text":"<ul> <li>Performance: Processamento push-down para HANA</li> <li>Reutiliza\u00e7\u00e3o: Views podem ser consumidas por outros objetos</li> <li>Anota\u00e7\u00f5es: Metadados sem\u00e2nticos integrados</li> <li>Modularidade: Composi\u00e7\u00e3o de views complexas</li> <li>Integra\u00e7\u00e3o: Suporte nativo para OData, Fiori, Analytics</li> </ul>"},{"location":"cds/1_introducao/#tipos-de-cds-views","title":"Tipos de CDS Views","text":""},{"location":"cds/1_introducao/#1-cds-view-entity-sintaxe-moderna","title":"1. CDS View Entity (Sintaxe Moderna)","text":"<pre><code>@AccessControl.authorizationCheck: #NOT_REQUIRED\n@EndUserText.label: 'Customer View'\ndefine view entity ZI_Customer\n  as select from kna1\n{\n  key kunnr as CustomerId,\n      name1 as CustomerName,\n      land1 as Country,\n      ort01 as City,\n      @Semantics.amount.currencyCode: 'Currency'\n      ktokd as AccountGroup\n}\n</code></pre>"},{"location":"cds/1_introducao/#2-cds-view-sintaxe-legada","title":"2. CDS View (Sintaxe Legada)","text":"<pre><code>@AbapCatalog.sqlViewName: 'ZVCUSTOMER'\n@AccessControl.authorizationCheck: #NOT_REQUIRED\n@EndUserText.label: 'Customer View'\ndefine view Z_Customer\n  as select from kna1\n{\n  key kunnr as CustomerId,\n      name1 as CustomerName,\n      land1 as Country,\n      ort01 as City\n}\n</code></pre> <p>Recomenda\u00e7\u00e3o</p> <p>Use View Entities para novos desenvolvimentos. \u00c9 a sintaxe moderna e recomendada pela SAP.</p>"},{"location":"cds/1_introducao/#estrutura-de-uma-cds-view","title":"Estrutura de uma CDS View","text":""},{"location":"cds/1_introducao/#componentes-essenciais","title":"Componentes Essenciais","text":"<pre><code>// 1. Anota\u00e7\u00f5es (Metadata)\n@AccessControl.authorizationCheck: #NOT_REQUIRED\n@EndUserText.label: 'Sales Order View'\n@Metadata.allowExtensions: true\n\n// 2. Defini\u00e7\u00e3o\ndefine view entity ZI_SalesOrder\n\n  // 3. Cl\u00e1usula AS SELECT\n  as select from vbak as SalesOrder\n\n  // 4. Associa\u00e7\u00f5es (Joins reutiliz\u00e1veis)\n  association [0..*] to ZI_SalesOrderItem as _Item\n    on $projection.SalesOrderId = _Item.SalesOrderId\n\n{\n  // 5. Lista de Campos\n  key SalesOrder.vbeln as SalesOrderId,\n      SalesOrder.erdat as CreationDate,\n      SalesOrder.ernam as CreatedBy,\n      SalesOrder.kunnr as CustomerId,\n\n      // 6. Exposi\u00e7\u00e3o de Associa\u00e7\u00f5es\n      _Item\n}\n</code></pre>"},{"location":"cds/1_introducao/#anotacoes-fundamentais","title":"Anota\u00e7\u00f5es Fundamentais","text":""},{"location":"cds/1_introducao/#anotacoes-tecnicas","title":"Anota\u00e7\u00f5es T\u00e9cnicas","text":"<pre><code>// Controle de autoriza\u00e7\u00e3o\n@AccessControl.authorizationCheck: #CHECK\n@AccessControl.authorizationCheck: #NOT_REQUIRED\n\n// Label para usu\u00e1rio final\n@EndUserText.label: 'Descri\u00e7\u00e3o da View'\n\n// Permitir extens\u00f5es via Metadata Extension\n@Metadata.allowExtensions: true\n\n// Ignorar valida\u00e7\u00f5es (apenas desenvolvimento)\n@AbapCatalog.compiler.compareFilter: true\n</code></pre>"},{"location":"cds/1_introducao/#anotacoes-semanticas","title":"Anota\u00e7\u00f5es Sem\u00e2nticas","text":"<pre><code>define view entity ZI_Product\n  as select from mara\n{\n  key matnr as ProductId,\n\n      // Quantidade\n      @Semantics.quantity.unitOfMeasure: 'BaseUnit'\n      ntgew as NetWeight,\n\n      // Unidade de medida\n      @Semantics.unitOfMeasure: true\n      meins as BaseUnit,\n\n      // Moeda\n      @Semantics.currencyCode: true\n      waers as Currency,\n\n      // Texto\n      @Semantics.text: true\n      maktx as ProductDescription\n}\n</code></pre>"},{"location":"cds/1_introducao/#criacao-de-cds-view-no-adt","title":"Cria\u00e7\u00e3o de CDS View no ADT","text":""},{"location":"cds/1_introducao/#passo-a-passo","title":"Passo a Passo","text":"<ol> <li>Criar objeto CDS</li> <li>Right-click no package \u2192 New \u2192 Other ABAP Repository Object</li> <li>Core Data Services \u2192 Data Definition</li> <li> <p>Nome: <code>ZI_CUSTOMER</code></p> </li> <li> <p>Template b\u00e1sico <pre><code>@AccessControl.authorizationCheck: #NOT_REQUIRED\n@EndUserText.label: 'Customer Data'\ndefine view entity ZI_Customer\n  as select from kna1\n{\n  key kunnr as CustomerId,\n      name1 as Name,\n      land1 as Country\n}\n</code></pre></p> </li> <li> <p>Ativar (Ctrl+F3)</p> </li> <li> <p>Testar (F8 - Data Preview)</p> </li> </ol>"},{"location":"cds/1_introducao/#nomenclatura-e-convencoes","title":"Nomenclatura e Conven\u00e7\u00f5es","text":""},{"location":"cds/1_introducao/#prefixos-recomendados","title":"Prefixos Recomendados","text":"Prefixo Tipo Descri\u00e7\u00e3o Exemplo <code>ZI_</code> Interface View View b\u00e1sica, representa entidade <code>ZI_Customer</code> <code>ZC_</code> Consumption View View para consumo (Fiori, OData) <code>ZC_Customer</code> <code>ZP_</code> Projection View Proje\u00e7\u00e3o de campos espec\u00edficos <code>ZP_CustomerBasic</code> <code>ZR_</code> Restricted View View com filtros <code>ZR_CustomerGermany</code>"},{"location":"cds/1_introducao/#nomenclatura-de-campos","title":"Nomenclatura de Campos","text":"<pre><code>define view entity ZI_SalesOrder\n  as select from vbak\n{\n  // Use nomes descritivos em CamelCase\n  key vbeln as SalesOrderId,        // \u2713 Bom\n      erdat as CreationDate,         // \u2713 Bom\n      kunnr as CustomerId,           // \u2713 Bom\n\n  // Evite abrevia\u00e7\u00f5es obscuras\n  // key vbeln as SO_ID,             // \u2717 Evitar\n  // erdat as CrDt,                  // \u2717 Evitar\n}\n</code></pre>"},{"location":"cds/1_introducao/#exemplo-completo-view-de-cliente-com-endereco","title":"Exemplo Completo: View de Cliente com Endere\u00e7o","text":"<pre><code>@AccessControl.authorizationCheck: #NOT_REQUIRED\n@EndUserText.label: 'Customer with Address'\ndefine view entity ZI_CustomerAddress\n  as select from kna1 as Customer\n\n  association [0..1] to ZI_Country as _Country\n    on $projection.Country = _Country.CountryCode\n{\n  key Customer.kunnr as CustomerId,\n\n      @EndUserText.label: 'Customer Name'\n      Customer.name1 as CustomerName,\n\n      @EndUserText.label: 'Street'\n      Customer.stras as Street,\n\n      @EndUserText.label: 'City'\n      Customer.ort01 as City,\n\n      @EndUserText.label: 'Postal Code'\n      Customer.pstlz as PostalCode,\n\n      @EndUserText.label: 'Country'\n      Customer.land1 as Country,\n\n      // Exposi\u00e7\u00e3o da associa\u00e7\u00e3o\n      _Country\n}\n</code></pre>"},{"location":"cds/1_introducao/#exercicios-praticos","title":"Exerc\u00edcios Pr\u00e1ticos","text":""},{"location":"cds/1_introducao/#exercicio-1-view-basica-de-produtos","title":"Exerc\u00edcio 1: View B\u00e1sica de Produtos","text":"<p>Crie uma CDS View que mostre produtos da tabela MARA: - N\u00famero do material (MATNR) - Descri\u00e7\u00e3o (MAKTX da MAKT) - Unidade base (MEINS) - Peso l\u00edquido (NTGEW)</p>"},{"location":"cds/1_introducao/#exercicio-2-view-com-anotacoes","title":"Exerc\u00edcio 2: View com Anota\u00e7\u00f5es","text":"<p>Adicione anota\u00e7\u00f5es sem\u00e2nticas apropriadas \u00e0 view do Exerc\u00edcio 1.</p>"},{"location":"cds/1_introducao/#exercicio-3-view-de-pedidos","title":"Exerc\u00edcio 3: View de Pedidos","text":"<p>Crie uma view da tabela VBAK mostrando: - N\u00famero do pedido - Data de cria\u00e7\u00e3o - Cliente - Tipo de documento</p> <p>Pr\u00f3ximos Passos</p> <p>Na pr\u00f3xima p\u00e1gina, aprenderemos sobre Associa\u00e7\u00f5es e Joins em CDS, incluindo como criar relacionamentos entre views e otimizar consultas.</p>"},{"location":"cds/2_joins/","title":"CDS - Associa\u00e7\u00f5es e Joins","text":""},{"location":"cds/2_joins/#diferenca-entre-associacoes-e-joins","title":"Diferen\u00e7a entre Associa\u00e7\u00f5es e Joins","text":""},{"location":"cds/2_joins/#joins-classicos","title":"Joins (Cl\u00e1ssicos)","text":"<ul> <li>Executados imediatamente</li> <li>Todos os dados s\u00e3o carregados</li> <li>Definidos na cl\u00e1usula <code>FROM</code></li> </ul>"},{"location":"cds/2_joins/#associacoes-on-demand","title":"Associa\u00e7\u00f5es (On-Demand)","text":"<ul> <li>Executados apenas quando necess\u00e1rio</li> <li>Dados carregados sob demanda</li> <li>Reutiliz\u00e1veis em outras views</li> <li>Recomendado para CDS moderno</li> </ul>"},{"location":"cds/2_joins/#associacoes-em-cds","title":"Associa\u00e7\u00f5es em CDS","text":""},{"location":"cds/2_joins/#sintaxe-basica","title":"Sintaxe B\u00e1sica","text":"<pre><code>@AccessControl.authorizationCheck: #NOT_REQUIRED\n@EndUserText.label: 'Sales Order with Customer'\ndefine view entity ZI_SalesOrder\n  as select from vbak as SalesOrder\n\n  // Defini\u00e7\u00e3o da associa\u00e7\u00e3o\n  association [0..1] to ZI_Customer as _Customer\n    on $projection.CustomerId = _Customer.CustomerId\n{\n  key SalesOrder.vbeln as SalesOrderId,\n      SalesOrder.erdat as CreationDate,\n      SalesOrder.kunnr as CustomerId,\n      SalesOrder.netwr as NetValue,\n\n      // Exposi\u00e7\u00e3o da associa\u00e7\u00e3o\n      _Customer\n}\n</code></pre>"},{"location":"cds/2_joins/#cardinalidades","title":"Cardinalidades","text":"<pre><code>// [min..max] ou [0..*]\n\nassociation [1]      to ZI_Customer    as _Customer    // Exatamente 1\nassociation [0..1]   to ZI_Address     as _Address     // Zero ou 1\nassociation [1..*]   to ZI_Item        as _Items       // Um ou mais\nassociation [0..*]   to ZI_Document    as _Documents   // Zero ou mais\n</code></pre>"},{"location":"cds/2_joins/#consumindo-associacoes","title":"Consumindo Associa\u00e7\u00f5es","text":""},{"location":"cds/2_joins/#em-consulta-abap","title":"Em Consulta ABAP","text":"<pre><code>SELECT FROM ZI_SalesOrder\n  FIELDS SalesOrderId,\n         CreationDate,\n         CustomerId,\n         \\_Customer-CustomerName,           \" Acesso via associa\u00e7\u00e3o\n         \\_Customer-Country,\n         \\_Customer-City\n  WHERE CreationDate &gt;= @sy-datum\n  INTO TABLE @DATA(lt_orders).\n\nLOOP AT lt_orders INTO DATA(ls_order).\n  WRITE: / ls_order-SalesOrderId,\n           ls_order-CustomerName,\n           ls_order-Country.\nENDLOOP.\n</code></pre>"},{"location":"cds/2_joins/#em-outra-cds-view","title":"Em Outra CDS View","text":"<pre><code>define view entity ZC_SalesOrderDisplay\n  as select from ZI_SalesOrder\n{\n  key SalesOrderId,\n      CreationDate,\n      CustomerId,\n      NetValue,\n\n      // Proje\u00e7\u00e3o de campos da associa\u00e7\u00e3o\n      _Customer.CustomerName,\n      _Customer.Country,\n      _Customer.City,\n\n      // Manter associa\u00e7\u00e3o para uso posterior\n      _Customer\n}\n</code></pre>"},{"location":"cds/2_joins/#path-expressions-navegacao-em-cadeia","title":"Path Expressions (Navega\u00e7\u00e3o em Cadeia)","text":""},{"location":"cds/2_joins/#multiplos-niveis-de-associacao","title":"M\u00faltiplos N\u00edveis de Associa\u00e7\u00e3o","text":"<pre><code>@AccessControl.authorizationCheck: #NOT_REQUIRED\n@EndUserText.label: 'Sales Order Item with Details'\ndefine view entity ZI_SalesOrderItem\n  as select from vbap as Item\n\n  association [1] to ZI_SalesOrder as _SalesOrder\n    on $projection.SalesOrderId = _SalesOrder.SalesOrderId\n{\n  key Item.vbeln as SalesOrderId,\n  key Item.posnr as ItemNumber,\n      Item.matnr as ProductId,\n      Item.kwmeng as Quantity,\n\n      // Navega\u00e7\u00e3o em cadeia: Item \u2192 Order \u2192 Customer\n      _SalesOrder._Customer.CustomerName as CustomerName,\n      _SalesOrder._Customer.Country as CustomerCountry,\n\n      // Exposi\u00e7\u00e3o das associa\u00e7\u00f5es\n      _SalesOrder\n}\n</code></pre>"},{"location":"cds/2_joins/#exemplo-completo-de-path-expression","title":"Exemplo Completo de Path Expression","text":"<pre><code>define view entity ZI_InvoiceItem\n  as select from bseg as InvoiceItem\n\n  association [1] to ZI_Invoice  as _Invoice\n    on $projection.DocumentNumber = _Invoice.DocumentNumber\n{\n  key InvoiceItem.belnr as DocumentNumber,\n  key InvoiceItem.buzei as LineItem,\n      InvoiceItem.wrbtr as Amount,\n\n      // Caminho: Item \u2192 Invoice \u2192 Customer \u2192 Country\n      _Invoice._Customer._Country.CountryName as CountryName,\n      _Invoice._Customer._Country.Region as Region,\n\n      _Invoice\n}\n</code></pre>"},{"location":"cds/2_joins/#joins-explicitos","title":"Joins Expl\u00edcitos","text":""},{"location":"cds/2_joins/#inner-join","title":"Inner Join","text":"<pre><code>define view entity ZI_CustomerOrders\n  as select from kna1 as Customer\n\n  inner join vbak as SalesOrder\n    on Customer.kunnr = SalesOrder.kunnr\n{\n  key Customer.kunnr       as CustomerId,\n      Customer.name1       as CustomerName,\n      SalesOrder.vbeln     as SalesOrderId,\n      SalesOrder.erdat     as OrderDate,\n      SalesOrder.netwr     as NetValue\n}\n</code></pre>"},{"location":"cds/2_joins/#left-outer-join","title":"Left Outer Join","text":"<pre><code>define view entity ZI_CustomerWithOrders\n  as select from kna1 as Customer\n\n  left outer join vbak as SalesOrder\n    on Customer.kunnr = SalesOrder.kunnr\n{\n  key Customer.kunnr       as CustomerId,\n      Customer.name1       as CustomerName,\n      SalesOrder.vbeln     as SalesOrderId,\n      SalesOrder.erdat     as OrderDate,\n      SalesOrder.netwr     as NetValue\n}\n</code></pre> <p>Performance</p> <p>Joins s\u00e3o executados imediatamente. Use associa\u00e7\u00f5es sempre que poss\u00edvel para melhor performance, especialmente com HANA.</p>"},{"location":"cds/2_joins/#comparacao-join-vs-associacao","title":"Compara\u00e7\u00e3o: Join vs Associa\u00e7\u00e3o","text":""},{"location":"cds/2_joins/#exemplo-com-join","title":"Exemplo com Join","text":"<pre><code>define view entity ZI_Order_WithJoin\n  as select from vbak as SalesOrder\n\n  inner join kna1 as Customer\n    on SalesOrder.kunnr = Customer.kunnr\n\n  inner join vbap as Item\n    on SalesOrder.vbeln = Item.vbeln\n{\n  key SalesOrder.vbeln as SalesOrderId,\n  key Item.posnr       as ItemNumber,\n      Customer.name1   as CustomerName,\n      Item.matnr       as ProductId\n}\n</code></pre>"},{"location":"cds/2_joins/#mesmo-exemplo-com-associacao-recomendado","title":"Mesmo Exemplo com Associa\u00e7\u00e3o (Recomendado)","text":"<pre><code>define view entity ZI_Order_WithAssoc\n  as select from vbak as SalesOrder\n\n  association [0..1] to ZI_Customer as _Customer\n    on $projection.CustomerId = _Customer.CustomerId\n\n  association [0..*] to ZI_Item as _Items\n    on $projection.SalesOrderId = _Items.SalesOrderId\n{\n  key SalesOrder.vbeln as SalesOrderId,\n      SalesOrder.kunnr as CustomerId,\n\n      _Customer,\n      _Items\n}\n\n// View de consumo que projeta os dados necess\u00e1rios\ndefine view entity ZC_OrderDisplay\n  as select from ZI_Order_WithAssoc\n{\n  key SalesOrderId,\n      CustomerId,\n      _Customer.CustomerName,\n      _Items.ItemNumber,\n      _Items.ProductId\n}\n</code></pre>"},{"location":"cds/2_joins/#associacoes-com-filtros","title":"Associa\u00e7\u00f5es com Filtros","text":""},{"location":"cds/2_joins/#filtro-na-associacao","title":"Filtro na Associa\u00e7\u00e3o","text":"<pre><code>define view entity ZI_SalesOrder\n  as select from vbak as SalesOrder\n\n  association [0..*] to vbap as _Items\n    on  $projection.SalesOrderId = _Items.vbeln\n    and _Items.abgru = ''                          // Apenas itens n\u00e3o rejeitados\n{\n  key SalesOrder.vbeln as SalesOrderId,\n      SalesOrder.kunnr as CustomerId,\n\n      _Items\n}\n</code></pre>"},{"location":"cds/2_joins/#associacao-com-parametros","title":"Associa\u00e7\u00e3o com Par\u00e2metros","text":"<pre><code>define view entity ZI_SalesOrderFiltered\n  as select from vbak as SalesOrder\n\n  association [0..*] to ZI_Item as _Items\n    on  $projection.SalesOrderId = _Items.SalesOrderId\n    and _Items.Quantity &gt; 0\n{\n  key SalesOrder.vbeln as SalesOrderId,\n      SalesOrder.kunnr as CustomerId,\n      SalesOrder.netwr as NetValue,\n\n      _Items\n}\n</code></pre>"},{"location":"cds/2_joins/#associacoes-para-textos","title":"Associa\u00e7\u00f5es para Textos","text":""},{"location":"cds/2_joins/#view-de-texto","title":"View de Texto","text":"<pre><code>@AccessControl.authorizationCheck: #NOT_REQUIRED\n@EndUserText.label: 'Product Text'\ndefine view entity ZI_ProductText\n  as select from makt\n{\n  key matnr as ProductId,\n  key spras as Language,\n      maktx as ProductDescription\n}\n</code></pre>"},{"location":"cds/2_joins/#view-principal-com-associacao-de-texto","title":"View Principal com Associa\u00e7\u00e3o de Texto","text":"<pre><code>@AccessControl.authorizationCheck: #NOT_REQUIRED\n@EndUserText.label: 'Product with Text'\ndefine view entity ZI_Product\n  as select from mara as Product\n\n  association [0..*] to ZI_ProductText as _Text\n    on $projection.ProductId = _Text.ProductId\n{\n  key Product.matnr as ProductId,\n      Product.meins as BaseUnit,\n      Product.ntgew as NetWeight,\n\n      // Texto na l\u00edngua de logon\n      _Text[1: Language = $session.system_language].ProductDescription,\n\n      _Text\n}\n</code></pre>"},{"location":"cds/2_joins/#exemplo-completo-hierarquia-de-views","title":"Exemplo Completo: Hierarquia de Views","text":""},{"location":"cds/2_joins/#1-view-de-interface-customer","title":"1. View de Interface (Customer)","text":"<pre><code>@AccessControl.authorizationCheck: #NOT_REQUIRED\n@EndUserText.label: 'Customer Interface'\ndefine view entity ZI_Customer\n  as select from kna1\n\n  association [0..1] to ZI_Country as _Country\n    on $projection.Country = _Country.CountryCode\n{\n  key kunnr as CustomerId,\n      name1 as CustomerName,\n      land1 as Country,\n      ort01 as City,\n\n      _Country\n}\n</code></pre>"},{"location":"cds/2_joins/#2-view-de-interface-sales-order","title":"2. View de Interface (Sales Order)","text":"<pre><code>@AccessControl.authorizationCheck: #NOT_REQUIRED\n@EndUserText.label: 'Sales Order Interface'\ndefine view entity ZI_SalesOrder\n  as select from vbak\n\n  association [0..1] to ZI_Customer as _Customer\n    on $projection.CustomerId = _Customer.CustomerId\n\n  association [0..*] to ZI_SalesOrderItem as _Items\n    on $projection.SalesOrderId = _Items.SalesOrderId\n{\n  key vbeln as SalesOrderId,\n      erdat as CreationDate,\n      kunnr as CustomerId,\n\n      @Semantics.amount.currencyCode: 'Currency'\n      netwr as NetValue,\n\n      waers as Currency,\n\n      _Customer,\n      _Items\n}\n</code></pre>"},{"location":"cds/2_joins/#3-view-de-consumo","title":"3. View de Consumo","text":"<pre><code>@AccessControl.authorizationCheck: #NOT_REQUIRED\n@EndUserText.label: 'Sales Order Consumption'\n@Metadata.allowExtensions: true\ndefine view entity ZC_SalesOrder\n  as select from ZI_SalesOrder\n{\n  key SalesOrderId,\n      CreationDate,\n      CustomerId,\n\n      _Customer.CustomerName,\n      _Customer.Country,\n      _Customer._Country.CountryName,\n\n      NetValue,\n      Currency,\n\n      _Customer,\n      _Items\n}\n</code></pre>"},{"location":"cds/2_joins/#exercicios-praticos","title":"Exerc\u00edcios Pr\u00e1ticos","text":""},{"location":"cds/2_joins/#exercicio-1-associacao-simples","title":"Exerc\u00edcio 1: Associa\u00e7\u00e3o Simples","text":"<p>Crie uma view ZI_Material com associa\u00e7\u00e3o para ZI_MaterialText.</p>"},{"location":"cds/2_joins/#exercicio-2-path-expression","title":"Exerc\u00edcio 2: Path Expression","text":"<p>Crie uma view que mostre itens de pedido com o nome do pa\u00eds do cliente usando path expression.</p>"},{"location":"cds/2_joins/#exercicio-3-comparacao","title":"Exerc\u00edcio 3: Compara\u00e7\u00e3o","text":"<p>Implemente a mesma l\u00f3gica usando: 1. Join expl\u00edcito 2. Associa\u00e7\u00e3o Compare a performance com Data Preview.</p> <p>Pr\u00f3ximos Passos</p> <p>Na pr\u00f3xima p\u00e1gina, exploraremos Anota\u00e7\u00f5es e Metadata Extensions para enriquecer as CDS Views com informa\u00e7\u00f5es sem\u00e2nticas.</p>"},{"location":"cds/3_anotacoes_metadata/","title":"CDS - Anota\u00e7\u00f5es e Metadata Extensions","text":""},{"location":"cds/3_anotacoes_metadata/#o-que-sao-anotacoes","title":"O que s\u00e3o Anota\u00e7\u00f5es?","text":"<p>Anota\u00e7\u00f5es s\u00e3o metadados que enriquecem as CDS Views com informa\u00e7\u00f5es sem\u00e2nticas, comportamentais e de apresenta\u00e7\u00e3o. S\u00e3o fundamentais para integra\u00e7\u00e3o com frameworks como SAP Fiori, OData e Analytics.</p>"},{"location":"cds/3_anotacoes_metadata/#sintaxe-basica","title":"Sintaxe B\u00e1sica","text":"<pre><code>@AnnotationName: value\n@AnnotationName.property: value\n@AnnotationName: { property1: value1, property2: value2 }\n</code></pre>"},{"location":"cds/3_anotacoes_metadata/#categorias-de-anotacoes","title":"Categorias de Anota\u00e7\u00f5es","text":""},{"location":"cds/3_anotacoes_metadata/#1-anotacoes-tecnicas","title":"1. Anota\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"cds/3_anotacoes_metadata/#access-control","title":"Access Control","text":"<pre><code>// Verificar autoriza\u00e7\u00e3o\n@AccessControl.authorizationCheck: #CHECK\n\n// N\u00e3o verificar (apenas desenvolvimento/demo)\n@AccessControl.authorizationCheck: #NOT_REQUIRED\n\n// Verificar apenas com privil\u00e9gio espec\u00edfico\n@AccessControl.authorizationCheck: #PRIVILEGED_ONLY\n</code></pre>"},{"location":"cds/3_anotacoes_metadata/#abap-catalog","title":"ABAP Catalog","text":"<pre><code>// Buffering (cache)\n@AbapCatalog.buffering.status: #ACTIVE\n@AbapCatalog.buffering.type: #GENERIC\n@AbapCatalog.buffering.numberOfKeyFields: 1\n\n// Compiler\n@AbapCatalog.compiler.compareFilter: true\n</code></pre>"},{"location":"cds/3_anotacoes_metadata/#2-anotacoes-de-apresentacao","title":"2. Anota\u00e7\u00f5es de Apresenta\u00e7\u00e3o","text":""},{"location":"cds/3_anotacoes_metadata/#end-user-text","title":"End User Text","text":"<pre><code>@EndUserText.label: 'Customer Master Data'\n@EndUserText.quickInfo: 'Complete customer information'\n\ndefine view entity ZI_Customer\n  as select from kna1\n{\n  key kunnr as CustomerId,\n\n      @EndUserText.label: 'Customer Name'\n      @EndUserText.quickInfo: 'Full name of the customer'\n      name1 as CustomerName\n}\n</code></pre>"},{"location":"cds/3_anotacoes_metadata/#ui-annotations","title":"UI Annotations","text":"<pre><code>@UI.headerInfo: {\n  typeName: 'Customer',\n  typeNamePlural: 'Customers',\n  title: { value: 'CustomerName' }\n}\n\ndefine view entity ZC_Customer\n  as select from ZI_Customer\n{\n  @UI.lineItem: [{ position: 10, importance: #HIGH }]\n  @UI.identification: [{ position: 10 }]\n  key CustomerId,\n\n  @UI.lineItem: [{ position: 20, importance: #HIGH }]\n  @UI.identification: [{ position: 20 }]\n  CustomerName,\n\n  @UI.lineItem: [{ position: 30 }]\n  Country\n}\n</code></pre>"},{"location":"cds/3_anotacoes_metadata/#3-anotacoes-semanticas","title":"3. Anota\u00e7\u00f5es Sem\u00e2nticas","text":""},{"location":"cds/3_anotacoes_metadata/#currency-e-amount","title":"Currency e Amount","text":"<pre><code>define view entity ZI_SalesOrder\n  as select from vbak\n{\n  key vbeln as SalesOrderId,\n\n      // Valor monet\u00e1rio\n      @Semantics.amount.currencyCode: 'Currency'\n      netwr as NetValue,\n\n      // C\u00f3digo de moeda\n      @Semantics.currencyCode: true\n      waers as Currency\n}\n</code></pre>"},{"location":"cds/3_anotacoes_metadata/#quantity-e-unit","title":"Quantity e Unit","text":"<pre><code>define view entity ZI_Product\n  as select from mara\n{\n  key matnr as ProductId,\n\n      // Quantidade\n      @Semantics.quantity.unitOfMeasure: 'BaseUnit'\n      ntgew as NetWeight,\n\n      // Unidade de medida\n      @Semantics.unitOfMeasure: true\n      meins as BaseUnit\n}\n</code></pre>"},{"location":"cds/3_anotacoes_metadata/#textos-e-datas","title":"Textos e Datas","text":"<pre><code>define view entity ZI_Customer\n  as select from kna1\n{\n  key kunnr as CustomerId,\n\n      // Texto descritivo\n      @Semantics.text: true\n      name1 as CustomerName,\n\n      // Nome comercial\n      @Semantics.name.fullName: true\n      name1 as FullName,\n\n      // Endere\u00e7o\n      @Semantics.address.street: true\n      stras as Street,\n\n      @Semantics.address.city: true\n      ort01 as City,\n\n      @Semantics.address.zipCode: true\n      pstlz as PostalCode\n}\n</code></pre>"},{"location":"cds/3_anotacoes_metadata/#4-anotacoes-de-analytics","title":"4. Anota\u00e7\u00f5es de Analytics","text":""},{"location":"cds/3_anotacoes_metadata/#analytics-annotations","title":"Analytics Annotations","text":"<pre><code>@Analytics.dataCategory: #CUBE\n@Analytics.dataExtraction.enabled: true\n\ndefine view entity ZI_SalesAnalytics\n  as select from vbak as SalesOrder\n\n  association [0..1] to ZI_Customer as _Customer\n    on $projection.CustomerId = _Customer.CustomerId\n{\n  // Dimens\u00f5es\n  @Analytics.dimension: true\n  key SalesOrder.vbeln as SalesOrderId,\n\n  @Analytics.dimension: true\n  SalesOrder.kunnr as CustomerId,\n\n  @Analytics.dimension: true\n  SalesOrder.erdat as CreationDate,\n\n  // Medidas\n  @Analytics.measure: true\n  @Aggregation.default: #SUM\n  @Semantics.amount.currencyCode: 'Currency'\n  SalesOrder.netwr as NetValue,\n\n  @Semantics.currencyCode: true\n  SalesOrder.waers as Currency,\n\n  _Customer\n}\n</code></pre>"},{"location":"cds/3_anotacoes_metadata/#metadata-extensions","title":"Metadata Extensions","text":"<p>Metadata Extensions permitem separar anota\u00e7\u00f5es de UI da defini\u00e7\u00e3o da view, promovendo reutiliza\u00e7\u00e3o e manutenibilidade.</p>"},{"location":"cds/3_anotacoes_metadata/#ativar-metadata-extension-na-view","title":"Ativar Metadata Extension na View","text":"<pre><code>@AccessControl.authorizationCheck: #NOT_REQUIRED\n@EndUserText.label: 'Customer Data'\n@Metadata.allowExtensions: true          // Habilitar extens\u00f5es\n\ndefine view entity ZI_Customer\n  as select from kna1\n{\n  key kunnr as CustomerId,\n      name1 as CustomerName,\n      land1 as Country,\n      ort01 as City\n}\n</code></pre>"},{"location":"cds/3_anotacoes_metadata/#criar-metadata-extension","title":"Criar Metadata Extension","text":"<pre><code>@Metadata.layer: #CUSTOMER\n\nannotate view ZI_Customer with\n{\n  // Anota\u00e7\u00f5es de Header\n  @UI.headerInfo: {\n    typeName: 'Customer',\n    typeNamePlural: 'Customers',\n    title: { value: 'CustomerName' },\n    description: { value: 'CustomerId' }\n  }\n  CustomerId;\n\n  // Anota\u00e7\u00f5es de Campos\n  @UI: {\n    lineItem: [{ position: 10, importance: #HIGH }],\n    identification: [{ position: 10 }],\n    selectionField: [{ position: 10 }]\n  }\n  @EndUserText.label: 'Customer Number'\n  CustomerId;\n\n  @UI: {\n    lineItem: [{ position: 20, importance: #HIGH }],\n    identification: [{ position: 20 }],\n    selectionField: [{ position: 20 }]\n  }\n  @EndUserText.label: 'Name'\n  CustomerName;\n\n  @UI: {\n    lineItem: [{ position: 30 }],\n    identification: [{ position: 30 }]\n  }\n  @EndUserText.label: 'Country'\n  Country;\n\n  @UI: {\n    lineItem: [{ position: 40 }],\n    identification: [{ position: 40 }]\n  }\n  @EndUserText.label: 'City'\n  City;\n}\n</code></pre>"},{"location":"cds/3_anotacoes_metadata/#layers-de-metadata","title":"Layers de Metadata","text":"<pre><code>// Diferentes camadas de extens\u00e3o\n@Metadata.layer: #CORE          // N\u00edvel mais baixo (SAP)\n@Metadata.layer: #LOCALIZATION  // Localiza\u00e7\u00e3o\n@Metadata.layer: #INDUSTRY      // Ind\u00fastria espec\u00edfica\n@Metadata.layer: #PARTNER       // Partner\n@Metadata.layer: #CUSTOMER      // Cliente (mais alta prioridade)\n</code></pre>"},{"location":"cds/3_anotacoes_metadata/#anotacoes-para-odata","title":"Anota\u00e7\u00f5es para OData","text":""},{"location":"cds/3_anotacoes_metadata/#anotacoes-odata-basicas","title":"Anota\u00e7\u00f5es OData B\u00e1sicas","text":"<pre><code>@OData.publish: true\n@OData.entitySet.name: 'Customers'\n@OData.entityType.name: 'Customer'\n\ndefine view entity ZC_Customer\n  as select from ZI_Customer\n{\n  @OData.property.name: 'CustomerID'\n  key CustomerId,\n\n  @OData.property.name: 'Name'\n  CustomerName,\n\n  @OData.property.name: 'CountryCode'\n  Country\n}\n</code></pre>"},{"location":"cds/3_anotacoes_metadata/#anotacoes-de-navegacao","title":"Anota\u00e7\u00f5es de Navega\u00e7\u00e3o","text":"<pre><code>define view entity ZC_SalesOrder\n  as select from ZI_SalesOrder\n{\n  key SalesOrderId,\n      CustomerId,\n\n      // Exposi\u00e7\u00e3o de associa\u00e7\u00e3o para OData\n      @OData.association.navigation: true\n      _Customer,\n\n      @OData.association.navigation: true\n      _Items\n}\n</code></pre>"},{"location":"cds/3_anotacoes_metadata/#exemplo-completo-view-com-anotacoes-completas","title":"Exemplo Completo: View com Anota\u00e7\u00f5es Completas","text":""},{"location":"cds/3_anotacoes_metadata/#view-base","title":"View Base","text":"<pre><code>@AccessControl.authorizationCheck: #NOT_REQUIRED\n@EndUserText.label: 'Sales Order'\n@Metadata.allowExtensions: true\n\ndefine view entity ZI_SalesOrder\n  as select from vbak as SalesOrder\n\n  association [0..1] to ZI_Customer as _Customer\n    on $projection.CustomerId = _Customer.CustomerId\n\n  association [0..*] to ZI_SalesOrderItem as _Items\n    on $projection.SalesOrderId = _Items.SalesOrderId\n{\n  key SalesOrder.vbeln as SalesOrderId,\n\n      SalesOrder.erdat as CreationDate,\n\n      SalesOrder.erzet as CreationTime,\n\n      SalesOrder.ernam as CreatedBy,\n\n      SalesOrder.kunnr as CustomerId,\n\n      @Semantics.amount.currencyCode: 'Currency'\n      SalesOrder.netwr as NetValue,\n\n      @Semantics.currencyCode: true\n      SalesOrder.waers as Currency,\n\n      SalesOrder.vkorg as SalesOrganization,\n\n      SalesOrder.vtweg as DistributionChannel,\n\n      SalesOrder.spart as Division,\n\n      // Associa\u00e7\u00f5es\n      _Customer,\n      _Items\n}\n</code></pre>"},{"location":"cds/3_anotacoes_metadata/#metadata-extension","title":"Metadata Extension","text":"<pre><code>@Metadata.layer: #CUSTOMER\n@UI: {\n  headerInfo: {\n    typeName: 'Sales Order',\n    typeNamePlural: 'Sales Orders',\n    title: { value: 'SalesOrderId' },\n    description: { value: 'CustomerName' }\n  },\n  presentationVariant: [{\n    sortOrder: [{ by: 'CreationDate', direction: #DESC }],\n    visualizations: [{type: #AS_LINEITEM}]\n  }]\n}\n\nannotate view ZI_SalesOrder with\n{\n  @UI.facet: [\n    {\n      id: 'GeneralInfo',\n      type: #COLLECTION,\n      label: 'General Information',\n      position: 10\n    },\n    {\n      id: 'BasicData',\n      parentId: 'GeneralInfo',\n      type: #FIELDGROUP_REFERENCE,\n      label: 'Basic Data',\n      targetQualifier: 'BasicData',\n      position: 10\n    },\n    {\n      id: 'Amounts',\n      parentId: 'GeneralInfo',\n      type: #FIELDGROUP_REFERENCE,\n      label: 'Amounts',\n      targetQualifier: 'Amounts',\n      position: 20\n    },\n    {\n      id: 'Items',\n      type: #LINEITEM_REFERENCE,\n      label: 'Items',\n      position: 20,\n      targetElement: '_Items'\n    }\n  ]\n  SalesOrderId;\n\n  @UI: {\n    lineItem: [{ position: 10, importance: #HIGH }],\n    identification: [{ position: 10 }],\n    selectionField: [{ position: 10 }]\n  }\n  @EndUserText.label: 'Sales Order'\n  SalesOrderId;\n\n  @UI: {\n    lineItem: [{ position: 20, importance: #HIGH }],\n    fieldGroup: [{ qualifier: 'BasicData', position: 10 }]\n  }\n  @EndUserText.label: 'Creation Date'\n  CreationDate;\n\n  @UI: {\n    fieldGroup: [{ qualifier: 'BasicData', position: 20 }]\n  }\n  @EndUserText.label: 'Creation Time'\n  CreationTime;\n\n  @UI: {\n    fieldGroup: [{ qualifier: 'BasicData', position: 30 }]\n  }\n  @EndUserText.label: 'Created By'\n  CreatedBy;\n\n  @UI: {\n    lineItem: [{ position: 30, importance: #HIGH }],\n    identification: [{ position: 20 }],\n    selectionField: [{ position: 20 }]\n  }\n  @EndUserText.label: 'Customer'\n  CustomerId;\n\n  @UI: {\n    lineItem: [{ position: 40, importance: #HIGH }],\n    fieldGroup: [{ qualifier: 'Amounts', position: 10 }]\n  }\n  @EndUserText.label: 'Net Value'\n  NetValue;\n\n  @UI: {\n    fieldGroup: [{ qualifier: 'Amounts', position: 20 }]\n  }\n  @EndUserText.label: 'Currency'\n  Currency;\n\n  @UI: {\n    fieldGroup: [{ qualifier: 'BasicData', position: 40 }]\n  }\n  @EndUserText.label: 'Sales Organization'\n  SalesOrganization;\n}\n</code></pre>"},{"location":"cds/3_anotacoes_metadata/#anotacoes-de-search","title":"Anota\u00e7\u00f5es de Search","text":""},{"location":"cds/3_anotacoes_metadata/#search-help","title":"Search Help","text":"<pre><code>@Search.defaultSearchElement: true\n@Search.fuzzinessThreshold: 0.8\n\ndefine view entity ZI_Customer\n  as select from kna1\n{\n  @Search.defaultSearchElement: true\n  @Search.ranking: #HIGH\n  key kunnr as CustomerId,\n\n  @Search.defaultSearchElement: true\n  @Search.ranking: #HIGH\n  name1 as CustomerName,\n\n  @Search.defaultSearchElement: true\n  @Search.ranking: #MEDIUM\n  ort01 as City\n}\n</code></pre>"},{"location":"cds/3_anotacoes_metadata/#anotacoes-de-validacao","title":"Anota\u00e7\u00f5es de Valida\u00e7\u00e3o","text":""},{"location":"cds/3_anotacoes_metadata/#value-help","title":"Value Help","text":"<pre><code>define view entity ZI_SalesOrder\n  as select from vbak\n{\n  key vbeln as SalesOrderId,\n\n  @Consumption.valueHelpDefinition: [{\n    entity: {\n      name: 'ZI_Customer',\n      element: 'CustomerId'\n    }\n  }]\n  kunnr as CustomerId,\n\n  @Consumption.valueHelpDefinition: [{\n    entity: {\n      name: 'ZI_Currency',\n      element: 'CurrencyCode'\n    }\n  }]\n  waers as Currency\n}\n</code></pre>"},{"location":"cds/3_anotacoes_metadata/#filtros-de-selecao","title":"Filtros de Sele\u00e7\u00e3o","text":"<pre><code>@Consumption.filter.mandatory: true\n@Consumption.filter.selectionType: #SINGLE\n@Consumption.filter.defaultValue: 'DE'\n\ndefine view entity ZI_Customer\n  as select from kna1\n{\n  key kunnr as CustomerId,\n      name1 as CustomerName,\n      land1 as Country\n}\n</code></pre>"},{"location":"cds/3_anotacoes_metadata/#exercicios-praticos","title":"Exerc\u00edcios Pr\u00e1ticos","text":""},{"location":"cds/3_anotacoes_metadata/#exercicio-1-anotacoes-basicas","title":"Exerc\u00edcio 1: Anota\u00e7\u00f5es B\u00e1sicas","text":"<p>Adicione anota\u00e7\u00f5es sem\u00e2nticas completas a uma view de produtos: - Quantidade com unidade - Peso com unidade - Textos descritivos</p>"},{"location":"cds/3_anotacoes_metadata/#exercicio-2-metadata-extension","title":"Exerc\u00edcio 2: Metadata Extension","text":"<p>Crie uma Metadata Extension para uma view de pedidos com: - Header Info - Facets (abas) - LineItem - FieldGroups</p>"},{"location":"cds/3_anotacoes_metadata/#exercicio-3-analytics","title":"Exerc\u00edcio 3: Analytics","text":"<p>Configure uma view para analytics com dimens\u00f5es e medidas.</p> <p>Pr\u00f3ximos Passos</p> <p>Na pr\u00f3xima p\u00e1gina, aprenderemos sobre Fun\u00e7\u00f5es e Express\u00f5es em CDS, incluindo c\u00e1lculos, agrega\u00e7\u00f5es e l\u00f3gica condicional.</p>"},{"location":"cds/4_funcoes/","title":"CDS - Fun\u00e7\u00f5es e Express\u00f5es","text":""},{"location":"cds/4_funcoes/#expressoes-aritmeticas","title":"Express\u00f5es Aritm\u00e9ticas","text":""},{"location":"cds/4_funcoes/#operacoes-basicas","title":"Opera\u00e7\u00f5es B\u00e1sicas","text":"<pre><code>define view entity ZI_ProductCalculations\n  as select from mara as Product\n{\n  key Product.matnr as ProductId,\n\n      // Adi\u00e7\u00e3o\n      Product.ntgew + Product.brgew as TotalWeight,\n\n      // Subtra\u00e7\u00e3o\n      Product.brgew - Product.ntgew as TareWeight,\n\n      // Multiplica\u00e7\u00e3o\n      Product.ntgew * 1000 as WeightInGrams,\n\n      // Divis\u00e3o\n      Product.ntgew / Product.volum as Density,\n\n      // Par\u00eanteses para prioridade\n      (Product.ntgew + Product.brgew) / 2 as AverageWeight\n}\n</code></pre>"},{"location":"cds/4_funcoes/#calculos-com-moedaquantidade","title":"C\u00e1lculos com Moeda/Quantidade","text":"<pre><code>define view entity ZI_SalesOrderCalculations\n  as select from vbak as SalesOrder\n{\n  key SalesOrder.vbeln as SalesOrderId,\n\n      @Semantics.amount.currencyCode: 'Currency'\n      SalesOrder.netwr as NetValue,\n\n      // C\u00e1lculo de desconto (10%)\n      @Semantics.amount.currencyCode: 'Currency'\n      SalesOrder.netwr * 0.10 as DiscountAmount,\n\n      // Valor com desconto\n      @Semantics.amount.currencyCode: 'Currency'\n      SalesOrder.netwr * 0.90 as NetAfterDiscount,\n\n      // IVA (23%)\n      @Semantics.amount.currencyCode: 'Currency'\n      SalesOrder.netwr * 0.23 as VATAmount,\n\n      // Total com IVA\n      @Semantics.amount.currencyCode: 'Currency'\n      SalesOrder.netwr * 1.23 as TotalWithVAT,\n\n      @Semantics.currencyCode: true\n      SalesOrder.waers as Currency\n}\n</code></pre>"},{"location":"cds/4_funcoes/#funcoes-de-texto","title":"Fun\u00e7\u00f5es de Texto","text":""},{"location":"cds/4_funcoes/#concatenacao","title":"Concatena\u00e7\u00e3o","text":"<pre><code>define view entity ZI_CustomerFullData\n  as select from kna1 as Customer\n{\n  key Customer.kunnr as CustomerId,\n\n      // Concatena\u00e7\u00e3o simples\n      concat(Customer.name1, Customer.name2) as FullName,\n\n      // Concatena\u00e7\u00e3o com separador\n      concat_with_space(Customer.name1, Customer.name2, 1) as FullNameWithSpace,\n\n      // Concatena\u00e7\u00e3o m\u00faltipla\n      concat(concat(Customer.stras, ', '), Customer.ort01) as FullAddress,\n\n      // Endere\u00e7o completo formatado\n      concat_with_space(\n        concat_with_space(Customer.stras, Customer.ort01, 1),\n        Customer.pstlz,\n        1\n      ) as CompleteAddress\n}\n</code></pre>"},{"location":"cds/4_funcoes/#manipulacao-de-strings","title":"Manipula\u00e7\u00e3o de Strings","text":"<pre><code>define view entity ZI_StringFunctions\n  as select from kna1 as Customer\n{\n  key Customer.kunnr as CustomerId,\n\n      // Mai\u00fasculas\n      upper(Customer.name1) as NameUpperCase,\n\n      // Min\u00fasculas\n      lower(Customer.name1) as NameLowerCase,\n\n      // Comprimento\n      length(Customer.name1) as NameLength,\n\n      // Substring (posi\u00e7\u00e3o, comprimento)\n      substring(Customer.name1, 1, 10) as NameFirst10Chars,\n\n      // Left (primeiros N caracteres)\n      left(Customer.name1, 5) as NameFirst5,\n\n      // Right (\u00faltimos N caracteres)\n      right(Customer.name1, 5) as NameLast5,\n\n      // Trim (remover espa\u00e7os)\n      ltrim(Customer.name1, ' ') as NameLeftTrim,\n      rtrim(Customer.name1, ' ') as NameRightTrim\n}\n</code></pre>"},{"location":"cds/4_funcoes/#replace-e-instr","title":"Replace e InStr","text":"<pre><code>define view entity ZI_StringReplace\n  as select from mara as Product\n{\n  key Product.matnr as ProductId,\n\n      // Substituir caracteres\n      replace(Product.matnr, '-', '_') as ProductIdUnderscore,\n\n      // Posi\u00e7\u00e3o de substring\n      instr(Product.maktx, 'PREMIUM') as PremiumPosition,\n\n      // Limpar caracteres especiais\n      replace(\n        replace(Product.maktx, '/', '-'),\n        '\\\\', '-'\n      ) as CleanDescription\n}\n</code></pre>"},{"location":"cds/4_funcoes/#funcoes-de-data-e-hora","title":"Fun\u00e7\u00f5es de Data e Hora","text":""},{"location":"cds/4_funcoes/#operacoes-com-datas","title":"Opera\u00e7\u00f5es com Datas","text":"<pre><code>define view entity ZI_DateFunctions\n  as select from vbak as SalesOrder\n{\n  key SalesOrder.vbeln as SalesOrderId,\n\n      // Data de cria\u00e7\u00e3o\n      SalesOrder.erdat as CreationDate,\n\n      // Adicionar dias\n      dats_add_days(SalesOrder.erdat, 30, 'INITIAL') as DueDatePlus30,\n\n      // Adicionar meses\n      dats_add_months(SalesOrder.erdat, 3, 'INITIAL') as DueDatePlus3Months,\n\n      // Diferen\u00e7a em dias\n      dats_days_between(SalesOrder.erdat, $session.system_date) as DaysSinceCreation,\n\n      // Ano, m\u00eas, dia\n      cast(substring(SalesOrder.erdat, 1, 4) as abap.numc(4)) as Year,\n      cast(substring(SalesOrder.erdat, 5, 2) as abap.numc(2)) as Month,\n      cast(substring(SalesOrder.erdat, 7, 2) as abap.numc(2)) as Day\n}\n</code></pre>"},{"location":"cds/4_funcoes/#timestamp","title":"Timestamp","text":"<pre><code>define view entity ZI_TimestampFunctions\n  as select from vbak as SalesOrder\n{\n  key SalesOrder.vbeln as SalesOrderId,\n\n      // Data e hora atuais\n      $session.system_date as CurrentDate,\n      cast($session.system_date as abap.dats) as CurrentDateCast,\n\n      // Timestamp\n      tstmp_current_utctimestamp() as CurrentTimestamp,\n\n      // Adicionar segundos ao timestamp\n      tstmp_add_seconds(\n        tstmp_current_utctimestamp(),\n        cast(3600 as abap.dec(15,0)),\n        'INITIAL'\n      ) as TimestampPlus1Hour\n}\n</code></pre>"},{"location":"cds/4_funcoes/#expressoes-case","title":"Express\u00f5es CASE","text":""},{"location":"cds/4_funcoes/#case-simples","title":"CASE Simples","text":"<pre><code>define view entity ZI_CustomerCategory\n  as select from kna1 as Customer\n{\n  key Customer.kunnr as CustomerId,\n      Customer.name1 as CustomerName,\n      Customer.land1 as Country,\n\n      // Categoriza\u00e7\u00e3o por pa\u00eds\n      case Customer.land1\n        when 'DE' then 'Germany'\n        when 'FR' then 'France'\n        when 'ES' then 'Spain'\n        when 'PT' then 'Portugal'\n        else 'Other'\n      end as CountryName,\n\n      // Regi\u00e3o\n      case Customer.land1\n        when 'DE' then 'Central Europe'\n        when 'FR' then 'Western Europe'\n        when 'ES' then 'Southern Europe'\n        when 'PT' then 'Southern Europe'\n        when 'IT' then 'Southern Europe'\n        else 'Other Region'\n      end as Region\n}\n</code></pre>"},{"location":"cds/4_funcoes/#case-com-condicoes","title":"CASE com Condi\u00e7\u00f5es","text":"<pre><code>define view entity ZI_SalesOrderStatus\n  as select from vbak as SalesOrder\n{\n  key SalesOrder.vbeln as SalesOrderId,\n      SalesOrder.erdat as CreationDate,\n\n      @Semantics.amount.currencyCode: 'Currency'\n      SalesOrder.netwr as NetValue,\n      SalesOrder.waers as Currency,\n\n      // Status baseado em valor\n      case\n        when SalesOrder.netwr &gt;= 100000 then 'VIP'\n        when SalesOrder.netwr &gt;= 50000 then 'High Value'\n        when SalesOrder.netwr &gt;= 10000 then 'Medium Value'\n        else 'Standard'\n      end as OrderCategory,\n\n      // Prioridade\n      case\n        when SalesOrder.netwr &gt;= 100000 then 1\n        when SalesOrder.netwr &gt;= 50000 then 2\n        when SalesOrder.netwr &gt;= 10000 then 3\n        else 4\n      end as Priority,\n\n      // Dias desde cria\u00e7\u00e3o\n      case\n        when dats_days_between(SalesOrder.erdat, $session.system_date) &gt; 365\n          then 'Old'\n        when dats_days_between(SalesOrder.erdat, $session.system_date) &gt; 180\n          then 'Medium'\n        when dats_days_between(SalesOrder.erdat, $session.system_date) &gt; 30\n          then 'Recent'\n        else 'New'\n      end as OrderAge\n}\n</code></pre>"},{"location":"cds/4_funcoes/#funcoes-de-conversao","title":"Fun\u00e7\u00f5es de Convers\u00e3o","text":""},{"location":"cds/4_funcoes/#cast-conversao-de-tipo","title":"CAST (Convers\u00e3o de Tipo)","text":"<pre><code>define view entity ZI_TypeConversions\n  as select from vbak as SalesOrder\n{\n  key SalesOrder.vbeln as SalesOrderId,\n\n      // String para n\u00famero\n      cast(SalesOrder.vbeln as abap.int4) as OrderNumber,\n\n      // N\u00famero para decimal\n      cast(SalesOrder.netwr as abap.dec(15,2)) as NetValueDecimal,\n\n      // String para data\n      cast(SalesOrder.erdat as abap.dats) as CreationDateFormatted,\n\n      // Convers\u00e3o de moeda (tipo)\n      cast(SalesOrder.netwr as abap.curr(15,2)) as NetValueCurrency\n}\n</code></pre>"},{"location":"cds/4_funcoes/#conversao-de-unidades","title":"Convers\u00e3o de Unidades","text":"<pre><code>define view entity ZI_UnitConversions\n  as select from mara as Product\n{\n  key Product.matnr as ProductId,\n\n      @Semantics.quantity.unitOfMeasure: 'BaseUnit'\n      Product.ntgew as NetWeight,\n\n      // Convers\u00e3o para gramas (assumindo KG)\n      @Semantics.quantity.unitOfMeasure: 'WeightUnitGrams'\n      Product.ntgew * 1000 as NetWeightGrams,\n\n      'G' as WeightUnitGrams,\n\n      @Semantics.unitOfMeasure: true\n      Product.meins as BaseUnit,\n\n      // Volume em litros para mililitros\n      @Semantics.quantity.unitOfMeasure: 'VolumeUnitML'\n      Product.volum * 1000 as VolumeML,\n\n      'ML' as VolumeUnitML\n}\n</code></pre>"},{"location":"cds/4_funcoes/#funcoes-de-agregacao","title":"Fun\u00e7\u00f5es de Agrega\u00e7\u00e3o","text":""},{"location":"cds/4_funcoes/#agregacoes-basicas","title":"Agrega\u00e7\u00f5es B\u00e1sicas","text":"<pre><code>define view entity ZI_CustomerOrderStats\n  as select from vbak as SalesOrder\n{\n  key SalesOrder.kunnr as CustomerId,\n\n      // Contagem\n      count(*) as TotalOrders,\n\n      // Soma\n      @Semantics.amount.currencyCode: 'Currency'\n      sum(SalesOrder.netwr) as TotalRevenue,\n\n      // M\u00e9dia\n      @Semantics.amount.currencyCode: 'Currency'\n      avg(SalesOrder.netwr as abap.dec(15,2)) as AverageOrderValue,\n\n      // M\u00ednimo\n      @Semantics.amount.currencyCode: 'Currency'\n      min(SalesOrder.netwr) as MinOrderValue,\n\n      // M\u00e1ximo\n      @Semantics.amount.currencyCode: 'Currency'\n      max(SalesOrder.netwr) as MaxOrderValue,\n\n      SalesOrder.waers as Currency\n}\ngroup by\n  SalesOrder.kunnr,\n  SalesOrder.waers\n</code></pre>"},{"location":"cds/4_funcoes/#agregacoes-com-having","title":"Agrega\u00e7\u00f5es com HAVING","text":"<pre><code>define view entity ZI_HighValueCustomers\n  as select from vbak as SalesOrder\n{\n  key SalesOrder.kunnr as CustomerId,\n\n      count(*) as OrderCount,\n\n      @Semantics.amount.currencyCode: 'Currency'\n      sum(SalesOrder.netwr) as TotalRevenue,\n\n      SalesOrder.waers as Currency\n}\ngroup by\n  SalesOrder.kunnr,\n  SalesOrder.waers\nhaving\n  sum(SalesOrder.netwr) &gt; 100000\n</code></pre>"},{"location":"cds/4_funcoes/#funcoes-matematicas","title":"Fun\u00e7\u00f5es Matem\u00e1ticas","text":""},{"location":"cds/4_funcoes/#funcoes-avancadas","title":"Fun\u00e7\u00f5es Avan\u00e7adas","text":"<pre><code>define view entity ZI_MathFunctions\n  as select from mara as Product\n{\n  key Product.matnr as ProductId,\n\n      // Valor absoluto\n      abs(Product.ntgew - Product.brgew) as WeightDifference,\n\n      // Arredondamento\n      round(Product.ntgew, 2) as NetWeightRounded,\n\n      // Teto (arredondar para cima)\n      ceil(Product.volum) as VolumeCeiling,\n\n      // Ch\u00e3o (arredondar para baixo)\n      floor(Product.volum) as VolumeFloor,\n\n      // Divis\u00e3o com resto\n      division(cast(Product.ntgew as abap.int4), 10, 2) as WeightDivided,\n\n      // M\u00f3dulo\n      mod(cast(Product.ntgew as abap.int4), 10) as WeightModulo\n}\n</code></pre>"},{"location":"cds/4_funcoes/#coalesce-e-nullif","title":"COALESCE e NULLIF","text":""},{"location":"cds/4_funcoes/#tratamento-de-valores-nulos","title":"Tratamento de Valores Nulos","text":"<pre><code>define view entity ZI_NullHandling\n  as select from kna1 as Customer\n{\n  key Customer.kunnr as CustomerId,\n\n      // Usar valor padr\u00e3o se nulo\n      coalesce(Customer.name2, Customer.name1) as DisplayName,\n\n      coalesce(Customer.telf1, 'No Phone') as PhoneNumber,\n\n      // Retornar null se valores s\u00e3o iguais\n      nullif(Customer.name1, Customer.name2) as Name1IfDifferent,\n\n      // Combina\u00e7\u00e3o\n      coalesce(\n        nullif(Customer.name2, ''),\n        Customer.name1,\n        'Unknown'\n      ) as BestName\n}\n</code></pre>"},{"location":"cds/4_funcoes/#exemplo-completo-dashboard-de-vendas","title":"Exemplo Completo: Dashboard de Vendas","text":"<pre><code>@AccessControl.authorizationCheck: #NOT_REQUIRED\n@EndUserText.label: 'Sales Dashboard'\ndefine view entity ZI_SalesDashboard\n  as select from vbak as SalesOrder\n\n  association [0..1] to ZI_Customer as _Customer\n    on $projection.CustomerId = _Customer.CustomerId\n{\n  key SalesOrder.vbeln as SalesOrderId,\n\n      SalesOrder.kunnr as CustomerId,\n\n      SalesOrder.erdat as CreationDate,\n\n      // Ano e M\u00eas\n      cast(substring(SalesOrder.erdat, 1, 4) as abap.numc(4)) as Year,\n      cast(substring(SalesOrder.erdat, 5, 2) as abap.numc(2)) as Month,\n\n      // Quarter\n      case cast(substring(SalesOrder.erdat, 5, 2) as abap.numc(2))\n        when 1 then 'Q1'\n        when 2 then 'Q1'\n        when 3 then 'Q1'\n        when 4 then 'Q2'\n        when 5 then 'Q2'\n        when 6 then 'Q2'\n        when 7 then 'Q3'\n        when 8 then 'Q3'\n        when 9 then 'Q3'\n        when 10 then 'Q4'\n        when 11 then 'Q4'\n        when 12 then 'Q4'\n        else 'Unknown'\n      end as Quarter,\n\n      // Valores\n      @Semantics.amount.currencyCode: 'Currency'\n      SalesOrder.netwr as NetValue,\n\n      @Semantics.amount.currencyCode: 'Currency'\n      SalesOrder.netwr * 0.23 as VATAmount,\n\n      @Semantics.amount.currencyCode: 'Currency'\n      SalesOrder.netwr * 1.23 as TotalValue,\n\n      SalesOrder.waers as Currency,\n\n      // Categorias\n      case\n        when SalesOrder.netwr &gt;= 100000 then 'VIP'\n        when SalesOrder.netwr &gt;= 50000 then 'Premium'\n        when SalesOrder.netwr &gt;= 10000 then 'Standard'\n        else 'Basic'\n      end as CustomerSegment,\n\n      // Dias desde cria\u00e7\u00e3o\n      dats_days_between(SalesOrder.erdat, $session.system_date) as DaysSinceCreation,\n\n      // Status\n      case\n        when dats_days_between(SalesOrder.erdat, $session.system_date) &lt;= 7\n          then 'New'\n        when dats_days_between(SalesOrder.erdat, $session.system_date) &lt;= 30\n          then 'Recent'\n        when dats_days_between(SalesOrder.erdat, $session.system_date) &lt;= 90\n          then 'Active'\n        else 'Old'\n      end as OrderStatus,\n\n      // Nome do cliente via associa\u00e7\u00e3o\n      _Customer.CustomerName,\n      _Customer.Country,\n\n      _Customer\n}\n</code></pre>"},{"location":"cds/4_funcoes/#exercicios-praticos","title":"Exerc\u00edcios Pr\u00e1ticos","text":""},{"location":"cds/4_funcoes/#exercicio-1-calculos-complexos","title":"Exerc\u00edcio 1: C\u00e1lculos Complexos","text":"<p>Crie uma view que calcule: - Margem de lucro (diferen\u00e7a entre pre\u00e7o de venda e custo) - Percentagem de desconto - Valor com IVA de 23%</p>"},{"location":"cds/4_funcoes/#exercicio-2-manipulacao-de-textos","title":"Exerc\u00edcio 2: Manipula\u00e7\u00e3o de Textos","text":"<p>Crie uma view que: - Concatene nome e sobrenome - Formate endere\u00e7o completo - Extraia c\u00f3digo postal dos primeiros 4 d\u00edgitos</p>"},{"location":"cds/4_funcoes/#exercicio-3-agregacoes","title":"Exerc\u00edcio 3: Agrega\u00e7\u00f5es","text":"<p>Crie uma view agregada com: - Total de vendas por cliente - M\u00e9dia de valor de pedido - N\u00famero de pedidos por m\u00eas</p> <p>Pr\u00f3ximos Passos</p> <p>Na pr\u00f3xima p\u00e1gina, exploraremos Par\u00e2metros, Filtros e Views Parametrizadas, incluindo como criar views din\u00e2micas e reutiliz\u00e1veis.</p>"},{"location":"cds/5_parametros_filtros_views_param/","title":"CDS - Par\u00e2metros, Filtros e Views Parametrizadas","text":""},{"location":"cds/5_parametros_filtros_views_param/#parametros-em-cds-views","title":"Par\u00e2metros em CDS Views","text":"<p>Par\u00e2metros permitem criar views din\u00e2micas que filtram ou calculam dados baseados em valores fornecidos em runtime.</p>"},{"location":"cds/5_parametros_filtros_views_param/#sintaxe-basica","title":"Sintaxe B\u00e1sica","text":"<pre><code>@AccessControl.authorizationCheck: #NOT_REQUIRED\n@EndUserText.label: 'Customer by Country'\ndefine view entity ZI_CustomerByCountry\n  with parameters\n    P_Country : land1\n  as select from kna1 as Customer\n{\n  key Customer.kunnr as CustomerId,\n      Customer.name1 as CustomerName,\n      Customer.land1 as Country,\n      Customer.ort01 as City\n}\nwhere\n  Customer.land1 = $parameters.P_Country\n</code></pre>"},{"location":"cds/5_parametros_filtros_views_param/#consumindo-view-com-parametros","title":"Consumindo View com Par\u00e2metros","text":"<pre><code>\" Consulta ABAP\nSELECT FROM ZI_CustomerByCountry( P_Country = 'DE' )\n  FIELDS CustomerId,\n         CustomerName,\n         City\n  INTO TABLE @DATA(lt_customers).\n\nLOOP AT lt_customers INTO DATA(ls_customer).\n  WRITE: / ls_customer-CustomerId,\n           ls_customer-CustomerName,\n           ls_customer-City.\nENDLOOP.\n</code></pre>"},{"location":"cds/5_parametros_filtros_views_param/#multiplos-parametros","title":"M\u00faltiplos Par\u00e2metros","text":""},{"location":"cds/5_parametros_filtros_views_param/#view-com-varios-parametros","title":"View com V\u00e1rios Par\u00e2metros","text":"<pre><code>@AccessControl.authorizationCheck: #NOT_REQUIRED\n@EndUserText.label: 'Sales Orders by Date Range'\ndefine view entity ZI_SalesOrderByDateRange\n  with parameters\n    P_DateFrom : abap.dats,\n    P_DateTo   : abap.dats,\n    P_Currency : waers\n  as select from vbak as SalesOrder\n{\n  key SalesOrder.vbeln as SalesOrderId,\n      SalesOrder.erdat as CreationDate,\n      SalesOrder.kunnr as CustomerId,\n\n      @Semantics.currencyCode: true\n  SalesOrder.waers as Currency,\n\n  // Associa\u00e7\u00e3o\n  _Customer\n}\nwhere\n      SalesOrder.erdat &gt;= $parameters.P_DateFrom\n  and SalesOrder.erdat &lt;= $parameters.P_DateTo\n  and SalesOrder.waers = $parameters.P_Currency\n  and _Customer.Country = $parameters.P_Country\n</code></pre>"},{"location":"cds/5_parametros_filtros_views_param/#consumo-do-dashboard","title":"Consumo do Dashboard","text":"<pre><code>\" ABAP Report\nREPORT z_sales_dashboard.\n\nPARAMETERS: p_from TYPE dats OBLIGATORY,\n            p_to   TYPE dats OBLIGATORY,\n            p_curr TYPE waers DEFAULT 'EUR',\n            p_land TYPE land1 DEFAULT 'PT'.\n\nSTART-OF-SELECTION.\n\n  SELECT FROM ZI_SalesDashboardParam(\n                P_DateFrom = @p_from,\n                P_DateTo   = @p_to,\n                P_Currency = @p_curr,\n                P_Country  = @p_land )\n    FIELDS Year,\n           Quarter,\n           CustomerSegment,\n           NetValue,\n           TotalValue\n    INTO TABLE @DATA(lt_dashboard).\n\n  \" Processar resultados\n  LOOP AT lt_dashboard INTO DATA(ls_line).\n    WRITE: / ls_line-Year,\n             ls_line-Quarter,\n             ls_line-CustomerSegment,\n             ls_line-NetValue,\n             ls_line-TotalValue.\n  ENDLOOP.\n</code></pre>"},{"location":"cds/5_parametros_filtros_views_param/#performance-com-parametros","title":"Performance com Par\u00e2metros","text":""},{"location":"cds/5_parametros_filtros_views_param/#push-down-com-parametros","title":"Push-Down com Par\u00e2metros","text":"<pre><code>@AccessControl.authorizationCheck: #NOT_REQUIRED\n@EndUserText.label: 'Optimized Parametrized View'\ndefine view entity ZI_OptimizedParamView\n  with parameters\n    P_SalesOrg : vbak.vkorg\n  as select from vbak as SalesOrder\n{\n  key SalesOrder.vbeln as SalesOrderId,\n      SalesOrder.erdat as CreationDate,\n      SalesOrder.netwr as NetValue\n}\nwhere\n  SalesOrder.vkorg = $parameters.P_SalesOrg  -- Filtro no banco de dados\n</code></pre> <p>Performance</p> <p>Par\u00e2metros aplicados no WHERE s\u00e3o processados no banco de dados (push-down), melhorando drasticamente a performance.</p>"},{"location":"cds/5_parametros_filtros_views_param/#exercicios-praticos","title":"Exerc\u00edcios Pr\u00e1ticos","text":""},{"location":"cds/5_parametros_filtros_views_param/#exercicio-1-view-parametrizada-basica","title":"Exerc\u00edcio 1: View Parametrizada B\u00e1sica","text":"<p>Crie uma view de materiais filtrada por: - Tipo de material (obrigat\u00f3rio) - Data de cria\u00e7\u00e3o (intervalo)</p>"},{"location":"cds/5_parametros_filtros_views_param/#exercicio-2-window-functions","title":"Exerc\u00edcio 2: Window Functions","text":"<p>Crie uma view que mostre: - Top 10 clientes por faturamento - Ranking por pa\u00eds - N\u00famero sequencial de pedidos por cliente</p>"},{"location":"cds/5_parametros_filtros_views_param/#exercicio-3-dashboard-completo","title":"Exerc\u00edcio 3: Dashboard Completo","text":"<p>Implemente um dashboard parametrizado com: - Filtros de data (obrigat\u00f3rios) - Filtro de pa\u00eds (opcional) - Agrega\u00e7\u00f5es por m\u00eas e trimestre - Categoriza\u00e7\u00e3o de clientes - Window functions para ranking</p>"},{"location":"cds/5_parametros_filtros_views_param/#exercicio-4-union-de-dados","title":"Exerc\u00edcio 4: Union de Dados","text":"<p>Combine dados de clientes (KNA1) e fornecedores (LFA1) em uma \u00fanica view com: - ID unificado - Tipo de parceiro - Endere\u00e7o completo</p>"},{"location":"cds/5_parametros_filtros_views_param/#resumo-do-modulo-cds","title":"Resumo do M\u00f3dulo CDS","text":""},{"location":"cds/5_parametros_filtros_views_param/#conceitos-fundamentais","title":"Conceitos Fundamentais","text":"<p>\u2705 CDS View Entities vs CDS Views \u2705 Anota\u00e7\u00f5es t\u00e9cnicas e sem\u00e2nticas \u2705 Nomenclatura e boas pr\u00e1ticas  </p>"},{"location":"cds/5_parametros_filtros_views_param/#associacoes-e-joins","title":"Associa\u00e7\u00f5es e Joins","text":"<p>\u2705 Diferen\u00e7a entre associa\u00e7\u00f5es e joins \u2705 Cardinalidades \u2705 Path expressions \u2705 Propaga\u00e7\u00e3o de associa\u00e7\u00f5es  </p>"},{"location":"cds/5_parametros_filtros_views_param/#anotacoes-e-metadata","title":"Anota\u00e7\u00f5es e Metadata","text":"<p>\u2705 Anota\u00e7\u00f5es UI \u2705 Anota\u00e7\u00f5es Analytics \u2705 Metadata Extensions \u2705 Separation of Concerns  </p>"},{"location":"cds/5_parametros_filtros_views_param/#funcoes-e-expressoes","title":"Fun\u00e7\u00f5es e Express\u00f5es","text":"<p>\u2705 Fun\u00e7\u00f5es de texto, data e matem\u00e1ticas \u2705 CASE expressions \u2705 Agrega\u00e7\u00f5es \u2705 Type casting  </p>"},{"location":"cds/5_parametros_filtros_views_param/#parametros-e-filtros","title":"Par\u00e2metros e Filtros","text":"<p>\u2705 Views parametrizadas \u2705 Session variables \u2705 Window functions \u2705 Subqueries e UNION  </p>"},{"location":"cds/5_parametros_filtros_views_param/#recursos-adicionais","title":"Recursos Adicionais","text":""},{"location":"cds/5_parametros_filtros_views_param/#documentacao-sap","title":"Documenta\u00e7\u00e3o SAP","text":"<ul> <li>CDS Development Guide</li> <li>CDS Annotations Reference</li> </ul>"},{"location":"cds/5_parametros_filtros_views_param/#best-practices","title":"Best Practices","text":"<ul> <li>Use View Entities para novos desenvolvimentos</li> <li>Prefira associa\u00e7\u00f5es sobre joins</li> <li>Implemente Metadata Extensions para UI</li> <li>Use par\u00e2metros para views reutiliz\u00e1veis</li> <li>Documente suas views com @EndUserText</li> </ul>"},{"location":"cds/5_parametros_filtros_views_param/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ol> <li>Praticar com exemplos reais</li> <li>Integrar com SAP Fiori</li> <li>Criar servi\u00e7os OData</li> <li>Implementar autoriza\u00e7\u00e3o (DCL)</li> <li>Otimizar performance com HANA</li> </ol> <p>Conclus\u00e3o</p> <p>Parab\u00e9ns! Voc\u00ea completou o tutorial completo de CDS. Continue praticando e explorando as capacidades avan\u00e7adas do Core Data Services.Semantics.amount.currencyCode: 'Currency'   SalesOrder.netwr as NetValue,</p> <p>SalesOrder.waers as Currency</p> <p>} where       SalesOrder.erdat &gt;= $parameters.P_DateFrom   and SalesOrder.erdat &lt;= $parameters.P_DateTo   and SalesOrder.waers = $parameters.P_Currency <pre><code>### Uso em ABAP\n\n```abap\nDATA: lv_date_from TYPE dats,\n      lv_date_to   TYPE dats.\n\nlv_date_from = sy-datum - 30.\nlv_date_to   = sy-datum.\n\nSELECT FROM ZI_SalesOrderByDateRange(\n              P_DateFrom = @lv_date_from,\n              P_DateTo   = @lv_date_to,\n              P_Currency = 'EUR' )\n  FIELDS SalesOrderId,\n         CreationDate,\n         NetValue,\n         Currency\n  INTO TABLE @DATA(lt_orders).\n</code></pre></p>"},{"location":"cds/5_parametros_filtros_views_param/#parametros-com-valores-padrao","title":"Par\u00e2metros com Valores Padr\u00e3o","text":""},{"location":"cds/5_parametros_filtros_views_param/#definindo-valores-default","title":"Definindo Valores Default","text":"<pre><code>@AccessControl.authorizationCheck: #NOT_REQUIRED\n@EndUserText.label: 'Products with Optional Filter'\ndefine view entity ZI_ProductsFiltered\n  with parameters\n    P_ProductType : mtart,\n    @Environment.systemField: #SYSTEM_DATE\n    P_ValidOn     : abap.dats\n  as select from mara as Product\n{\n  key Product.matnr as ProductId,\n      Product.mtart as ProductType,\n      Product.ersda as CreationDate,\n      Product.meins as BaseUnit\n}\nwhere\n  Product.mtart = $parameters.P_ProductType\n</code></pre>"},{"location":"cds/5_parametros_filtros_views_param/#system-fields-como-parametros","title":"System Fields como Par\u00e2metros","text":"<pre><code>@AccessControl.authorizationCheck: #NOT_REQUIRED\n@EndUserText.label: 'Current Language Texts'\ndefine view entity ZI_ProductText\n  with parameters\n    @Environment.systemField: #SYSTEM_LANGUAGE\n    P_Language : spras\n  as select from makt\n{\n  key matnr as ProductId,\n      spras as Language,\n      maktx as ProductDescription\n}\nwhere\n  spras = $parameters.P_Language\n</code></pre>"},{"location":"cds/5_parametros_filtros_views_param/#session-variables","title":"Session Variables","text":""},{"location":"cds/5_parametros_filtros_views_param/#variaveis-de-sistema-disponiveis","title":"Vari\u00e1veis de Sistema Dispon\u00edveis","text":"<pre><code>@AccessControl.authorizationCheck: #NOT_REQUIRED\n@EndUserText.label: 'Orders with Session Info'\ndefine view entity ZI_OrdersWithSessionInfo\n  as select from vbak as SalesOrder\n{\n  key SalesOrder.vbeln as SalesOrderId,\n      SalesOrder.erdat as CreationDate,\n      SalesOrder.kunnr as CustomerId,\n\n      // Data atual do sistema\n      $session.system_date as CurrentDate,\n\n      // L\u00edngua de logon\n      $session.system_language as SystemLanguage,\n\n      // Cliente (mandante)\n      $session.client as Client,\n\n      // Usu\u00e1rio\n      $session.user as CurrentUser,\n\n      // Dias desde cria\u00e7\u00e3o\n      dats_days_between(\n        SalesOrder.erdat,\n        $session.system_date\n      ) as DaysSinceCreation\n}\n</code></pre>"},{"location":"cds/5_parametros_filtros_views_param/#filtro-por-data-atual","title":"Filtro por Data Atual","text":"<pre><code>define view entity ZI_CurrentMonthOrders\n  as select from vbak as SalesOrder\n{\n  key SalesOrder.vbeln as SalesOrderId,\n      SalesOrder.erdat as CreationDate,\n      SalesOrder.netwr as NetValue\n}\nwhere\n      substring(SalesOrder.erdat, 1, 6) = \n      substring($session.system_date, 1, 6)\n</code></pre>"},{"location":"cds/5_parametros_filtros_views_param/#parametros-em-associacoes","title":"Par\u00e2metros em Associa\u00e7\u00f5es","text":""},{"location":"cds/5_parametros_filtros_views_param/#propagacao-de-parametros","title":"Propaga\u00e7\u00e3o de Par\u00e2metros","text":"<pre><code>@AccessControl.authorizationCheck: #NOT_REQUIRED\n@EndUserText.label: 'Sales Order with Items by Date'\ndefine view entity ZI_SalesOrderFiltered\n  with parameters\n    P_DateFrom : abap.dats\n  as select from vbak as SalesOrder\n\n  association [0..*] to ZI_SalesOrderItem as _Items\n    on $projection.SalesOrderId = _Items.SalesOrderId\n{\n  key SalesOrder.vbeln as SalesOrderId,\n      SalesOrder.erdat as CreationDate,\n      SalesOrder.kunnr as CustomerId,\n\n      _Items\n}\nwhere\n  SalesOrder.erdat &gt;= $parameters.P_DateFrom\n</code></pre>"},{"location":"cds/5_parametros_filtros_views_param/#view-consumidora-com-parametros","title":"View Consumidora com Par\u00e2metros","text":"<pre><code>define view entity ZC_SalesOrderWithDetails\n  with parameters\n    P_DateFrom : abap.dats,\n    P_Country  : land1\n  as select from ZI_SalesOrderFiltered(\n                   P_DateFrom: $parameters.P_DateFrom\n                 ) as SalesOrder\n\n  association [0..1] to ZI_CustomerByCountry as _Customer\n    on  $projection.CustomerId = _Customer.CustomerId\n    and _Customer.P_Country = $parameters.P_Country\n{\n  key SalesOrder.SalesOrderId,\n      SalesOrder.CreationDate,\n      SalesOrder.CustomerId,\n\n      _Customer.CustomerName,\n      _Customer.Country,\n\n      _Customer,\n      _Items\n}\n</code></pre>"},{"location":"cds/5_parametros_filtros_views_param/#union-e-union-all","title":"UNION e UNION ALL","text":""},{"location":"cds/5_parametros_filtros_views_param/#combinar-multiplas-fontes","title":"Combinar M\u00faltiplas Fontes","text":"<pre><code>@AccessControl.authorizationCheck: #NOT_REQUIRED\n@EndUserText.label: 'All Business Partners'\ndefine view entity ZI_AllBusinessPartners\n  as select from kna1 as Customer\n{\n  key kunnr as PartnerId,\n      name1 as PartnerName,\n      'Customer' as PartnerType,\n      land1 as Country\n}\n\nunion all\n\nselect from lfa1 as Vendor\n{\n  key lifnr as PartnerId,\n      name1 as PartnerName,\n      'Vendor' as PartnerType,\n      land1 as Country\n}\n</code></pre>"},{"location":"cds/5_parametros_filtros_views_param/#union-com-transformacao","title":"UNION com Transforma\u00e7\u00e3o","text":"<pre><code>define view entity ZI_CombinedAddresses\n  as select from kna1 as Customer\n{\n  kunnr as PartnerId,\n  concat('C-', kunnr) as PartnerCode,\n  name1 as Name,\n  stras as Street,\n  ort01 as City,\n  land1 as Country,\n  'Customer' as Type\n}\n\nunion\n\nselect from lfa1 as Vendor\n{\n  lifnr as PartnerId,\n  concat('V-', lifnr) as PartnerCode,\n  name1 as Name,\n  stras as Street,\n  ort01 as City,\n  land1 as Country,\n  'Vendor' as Type\n}\n</code></pre>"},{"location":"cds/5_parametros_filtros_views_param/#where-clause-avancada","title":"WHERE Clause Avan\u00e7ada","text":""},{"location":"cds/5_parametros_filtros_views_param/#multiplas-condicoes","title":"M\u00faltiplas Condi\u00e7\u00f5es","text":"<pre><code>define view entity ZI_ComplexFilter\n  as select from vbak as SalesOrder\n{\n  key SalesOrder.vbeln as SalesOrderId,\n      SalesOrder.erdat as CreationDate,\n      SalesOrder.kunnr as CustomerId,\n      SalesOrder.netwr as NetValue,\n      SalesOrder.waers as Currency\n}\nwhere\n      SalesOrder.erdat &gt;= '20240101'\n  and (\n        SalesOrder.netwr &gt;= 10000\n     or SalesOrder.kunnr in ( '0001000000', '0001000001' )\n      )\n  and SalesOrder.waers = 'EUR'\n</code></pre>"},{"location":"cds/5_parametros_filtros_views_param/#operadores-in-e-not-in","title":"Operadores IN e NOT IN","text":"<pre><code>define view entity ZI_EuropeanCustomers\n  as select from kna1 as Customer\n{\n  key Customer.kunnr as CustomerId,\n      Customer.name1 as CustomerName,\n      Customer.land1 as Country,\n      Customer.ort01 as City\n}\nwhere\n  Customer.land1 in ( 'DE', 'FR', 'ES', 'IT', 'PT', 'NL', 'BE' )\n  and Customer.loevm &lt;&gt; 'X'  -- N\u00e3o marcado para elimina\u00e7\u00e3o\n</code></pre>"},{"location":"cds/5_parametros_filtros_views_param/#operadores-like","title":"Operadores LIKE","text":"<pre><code>define view entity ZI_CustomerNameSearch\n  as select from kna1 as Customer\n{\n  key Customer.kunnr as CustomerId,\n      Customer.name1 as CustomerName,\n      Customer.ort01 as City\n}\nwhere\n      Customer.name1 like '%GMBH%'\n   or Customer.name1 like '%LTD%'\n   or Customer.name1 like '%SA%'\n</code></pre>"},{"location":"cds/5_parametros_filtros_views_param/#subqueries-exists-e-in","title":"Subqueries (EXISTS e IN)","text":""},{"location":"cds/5_parametros_filtros_views_param/#exists","title":"EXISTS","text":"<pre><code>@AccessControl.authorizationCheck: #NOT_REQUIRED\n@EndUserText.label: 'Customers with Orders'\ndefine view entity ZI_CustomersWithOrders\n  as select from kna1 as Customer\n{\n  key Customer.kunnr as CustomerId,\n      Customer.name1 as CustomerName,\n      Customer.land1 as Country,\n      Customer.ort01 as City\n}\nwhere exists (\n  select from vbak as SalesOrder\n  where SalesOrder.kunnr = Customer.kunnr\n    and SalesOrder.erdat &gt;= '20240101'\n)\n</code></pre>"},{"location":"cds/5_parametros_filtros_views_param/#not-exists","title":"NOT EXISTS","text":"<pre><code>define view entity ZI_CustomersWithoutOrders\n  as select from kna1 as Customer\n{\n  key Customer.kunnr as CustomerId,\n      Customer.name1 as CustomerName,\n      Customer.land1 as Country\n}\nwhere not exists (\n  select from vbak as SalesOrder\n  where SalesOrder.kunnr = Customer.kunnr\n)\n</code></pre>"},{"location":"cds/5_parametros_filtros_views_param/#in-com-subquery","title":"IN com Subquery","text":"<pre><code>define view entity ZI_HighValueCustomers\n  as select from kna1 as Customer\n{\n  key Customer.kunnr as CustomerId,\n      Customer.name1 as CustomerName,\n      Customer.land1 as Country\n}\nwhere Customer.kunnr in (\n  select SalesOrder.kunnr\n  from vbak as SalesOrder\n  where SalesOrder.netwr &gt;= 100000\n)\n</code></pre>"},{"location":"cds/5_parametros_filtros_views_param/#window-functions","title":"Window Functions","text":""},{"location":"cds/5_parametros_filtros_views_param/#rank-e-dense_rank","title":"RANK e DENSE_RANK","text":"<pre><code>@AccessControl.authorizationCheck: #NOT_REQUIRED\n@EndUserText.label: 'Customer Ranking by Revenue'\ndefine view entity ZI_CustomerRanking\n  as select from vbak as SalesOrder\n{\n  key SalesOrder.kunnr as CustomerId,\n\n      @Semantics.amount.currencyCode: 'Currency'\n      sum(SalesOrder.netwr) as TotalRevenue,\n\n      SalesOrder.waers as Currency,\n\n      // Ranking (valores iguais recebem mesma posi\u00e7\u00e3o, pr\u00f3ximo \u00e9 saltado)\n      rank( ) over(\n        partition by SalesOrder.waers\n        order by sum(SalesOrder.netwr) descending\n      ) as RevenueRank,\n\n      // Dense Rank (sem saltar posi\u00e7\u00f5es)\n      dense_rank( ) over(\n        partition by SalesOrder.waers\n        order by sum(SalesOrder.netwr) descending\n      ) as DenseRevenueRank\n}\ngroup by\n  SalesOrder.kunnr,\n  SalesOrder.waers\n</code></pre>"},{"location":"cds/5_parametros_filtros_views_param/#row_number","title":"ROW_NUMBER","text":"<pre><code>define view entity ZI_OrdersWithRowNumber\n  as select from vbak as SalesOrder\n{\n  key SalesOrder.vbeln as SalesOrderId,\n      SalesOrder.kunnr as CustomerId,\n      SalesOrder.erdat as CreationDate,\n      SalesOrder.netwr as NetValue,\n\n      // N\u00famero sequencial\n      row_number( ) over(\n        partition by SalesOrder.kunnr\n        order by SalesOrder.erdat descending\n      ) as OrderSequence\n}\n</code></pre>"},{"location":"cds/5_parametros_filtros_views_param/#filtrar-por-window-function","title":"Filtrar por Window Function","text":"<pre><code>define view entity ZI_LatestOrderPerCustomer\n  as select from ZI_OrdersWithRowNumber\n{\n  key SalesOrderId,\n      CustomerId,\n      CreationDate,\n      NetValue\n}\nwhere\n  OrderSequence = 1  -- Apenas o pedido mais recente\n</code></pre>"},{"location":"cds/5_parametros_filtros_views_param/#parametros-com-validacao","title":"Par\u00e2metros com Valida\u00e7\u00e3o","text":""},{"location":"cds/5_parametros_filtros_views_param/#view-com-filtro-obrigatorio","title":"View com Filtro Obrigat\u00f3rio","text":"<pre><code>@AccessControl.authorizationCheck: #NOT_REQUIRED\n@EndUserText.label: 'Sales Order - Mandatory Date'\ndefine view entity ZI_SalesOrderMandatory\n  with parameters\n    @Consumption.filter.mandatory: true\n    P_CreationDate : abap.dats\n  as select from vbak as SalesOrder\n{\n  key SalesOrder.vbeln as SalesOrderId,\n      SalesOrder.erdat as CreationDate,\n      SalesOrder.kunnr as CustomerId,\n      SalesOrder.netwr as NetValue\n}\nwhere\n  SalesOrder.erdat = $parameters.P_CreationDate\n</code></pre>"},{"location":"cds/5_parametros_filtros_views_param/#parametros-com-lista-de-valores","title":"Par\u00e2metros com Lista de Valores","text":"<pre><code>@AccessControl.authorizationCheck: #NOT_REQUIRED\n@EndUserText.label: 'Orders by Document Type'\ndefine view entity ZI_OrdersByDocType\n  with parameters\n    @Consumption.valueHelpDefinition: [{\n      entity: {\n        name: 'I_SalesDocumentType',\n        element: 'SalesDocumentType'\n      }\n    }]\n    P_DocType : vbak.auart\n  as select from vbak as SalesOrder\n{\n  key SalesOrder.vbeln as SalesOrderId,\n      SalesOrder.auart as DocumentType,\n      SalesOrder.erdat as CreationDate,\n      SalesOrder.netwr as NetValue\n}\nwhere\n  SalesOrder.auart = $parameters.P_DocType\n</code></pre>"},{"location":"cds/5_parametros_filtros_views_param/#exemplo-completo-dashboard-parametrizado","title":"Exemplo Completo: Dashboard Parametrizado","text":"<p>```abap @AccessControl.authorizationCheck: #NOT_REQUIRED @EndUserText.label: 'Sales Dashboard - Parametrized' @Analytics.dataCategory: #CUBE define view entity ZI_SalesDashboardParam   with parameters     @Consumption.filter.mandatory: true     @Consumption.filter.selectionType: #INTERVAL     P_DateFrom : abap.dats,</p> <pre><code>@Consumption.filter.mandatory: true\n@Consumption.filter.selectionType: #INTERVAL\nP_DateTo   : abap.dats,\n\n@Consumption.defaultValue: 'EUR'\n@Consumption.valueHelpDefinition: [{\n  entity: {\n    name: 'I_Currency',\n    element: 'Currency'\n  }\n}]\nP_Currency : waers,\n\n@Consumption.filter.selectionType: #SINGLE\n@Consumption.valueHelpDefinition: [{\n  entity: {\n    name: 'I_Country',\n    element: 'Country'\n  }\n}]\nP_Country  : land1\n</code></pre> <p>as select from vbak as SalesOrder</p> <p>association [0..1] to ZI_Customer as _Customer     on $projection.CustomerId = _Customer.CustomerId {   // Dimens\u00f5es   @Analytics.dimension: true   key SalesOrder.vbeln as SalesOrderId,</p> <p>@Analytics.dimension: true   SalesOrder.kunnr as CustomerId,</p> <p>@Analytics.dimension: true   SalesOrder.erdat as CreationDate,</p> <p>@Analytics.dimension: true   cast(substring(SalesOrder.erdat, 1, 6) as abap.char(6)) as YearMonth,</p> <p>@Analytics.dimension: true   cast(substring(SalesOrder.erdat, 1, 4) as abap.numc(4)) as Year,</p> <p>@Analytics.dimension: true   case cast(substring(SalesOrder.erdat, 5, 2) as abap.numc(2))     when 1 then 'Q1' when 2 then 'Q1' when 3 then 'Q1'     when 4 then 'Q2' when 5 then 'Q2' when 6 then 'Q2'     when 7 then 'Q3' when 8 then 'Q3' when 9 then 'Q3'     when 10 then 'Q4' when 11 then 'Q4' when 12 then 'Q4'     else 'Unknown'   end as Quarter,</p> <p>@Analytics.dimension: true   _Customer.Country,</p> <p>@Analytics.dimension: true   _Customer.City,</p> <p>@Analytics.dimension: true   case     when SalesOrder.netwr &gt;= 100000 then 'VIP'     when SalesOrder.netwr &gt;= 50000 then 'Premium'     when SalesOrder.netwr &gt;= 10000 then 'Standard'     else 'Basic'   end as CustomerSegment,</p> <p>// Medidas   @Analytics.measure: true   @Aggregation.default: #SUM   @Semantics.amount.currencyCode: 'Currency'   SalesOrder.netwr as NetValue,</p> <p>@Analytics.measure: true   @Aggregation.default: #SUM   @Semantics.amount.currencyCode: 'Currency'   SalesOrder.netwr * 0.23 as VATAmount,</p> <p>@Analytics.measure: true   @Aggregation.default: #SUM   @Semantics.amount.currencyCode: 'Currency'   SalesOrder.netwr * 1.23 as TotalValue,</p> <p>@</p>"},{"location":"cds_amdp/","title":"\ud83d\udd37 CDS e AMDP","text":"<p>Esta sec\u00e7\u00e3o apresenta Core Data Services (CDS) e ABAP Managed Database Procedures (AMDP) \u2014 tecnologias modernas para acesso e processamento de dados em SAP.</p>"},{"location":"cds_amdp/#o-que-vais-aprender","title":"\ud83d\udcd6 O que vais aprender","text":"<ul> <li>Core Data Services (CDS Views)</li> <li>Annotations e metadata</li> <li>Associations e relacionamentos</li> <li>CDS com par\u00e2metros</li> <li>AMDP (procedimentos em SQLScript)</li> <li>Performance com pushdown para HANA</li> <li>Consumir CDS em programas ABAP</li> <li>Diferen\u00e7as entre CDS e views cl\u00e1ssicas</li> </ul>"},{"location":"cds_amdp/#o-que-sao-cds-views","title":"\ud83c\udfaf O que s\u00e3o CDS Views?","text":"<p>CDS Views s\u00e3o views sem\u00e2nticas definidas em linguagem DDL (Data Definition Language) que:</p> <ul> <li>Substituem views cl\u00e1ssicas (SE11)</li> <li>Suportam annotations (metadados)</li> <li>Permitem associations (navega\u00e7\u00e3o entre entidades)</li> <li>Otimizam performance (pushdown para DB)</li> <li>Integram-se nativamente com Fiori/OData</li> </ul>"},{"location":"cds_amdp/#exemplo-de-cds-view","title":"\ud83d\udca1 Exemplo de CDS View","text":""},{"location":"cds_amdp/#cds-simples","title":"CDS Simples","text":"<pre><code>@AbapCatalog.sqlViewName: 'ZV_FLIGHTS'\n@EndUserText.label: 'Voos e Companhias'\n@AccessControl.authorizationCheck: #CHECK\n\ndefine view Z_CDS_Flights as\n  select from sflight\n  association [0..1] to scarr as _Carrier \n    on $projection.carrid = _Carrier.carrid\n{\n  key carrid,\n  key connid,\n  key fldate,\n      price,\n      currency,\n\n      // Expor associa\u00e7\u00e3o\n      _Carrier\n}\n</code></pre>"},{"location":"cds_amdp/#consumir-em-abap","title":"Consumir em ABAP","text":"<pre><code>SELECT * FROM z_cds_flights\n  INTO TABLE @DATA(lt_flights)\n  UP TO 10 ROWS.\n\nLOOP AT lt_flights INTO DATA(ls_flight).\n  WRITE: / ls_flight-carrid, \n         ls_flight-connid, \n         ls_flight-price.\nENDLOOP.\n</code></pre>"},{"location":"cds_amdp/#associations","title":"\ud83d\udd17 Associations","text":"<p>Definir relacionamentos entre entidades sem fazer JOINs expl\u00edcitos.</p> <pre><code>define view Z_CDS_Orders as\n  select from vbak\n  association [0..*] to vbap as _Items\n    on $projection.vbeln = _Items.vbeln\n  association [0..1] to kna1 as _Customer\n    on $projection.kunnr = _Customer.kunnr\n{\n  key vbeln,\n      kunnr,\n      vkorg,\n      vtweg,\n\n      // Expor associa\u00e7\u00f5es\n      _Items,\n      _Customer\n}\n</code></pre> <p>Usar em ABAP: <pre><code>SELECT * FROM z_cds_orders\n  INTO TABLE @DATA(lt_orders).\n\nLOOP AT lt_orders INTO DATA(ls_order).\n  \" Navegar pela associa\u00e7\u00e3o\n  SELECT * FROM @ls_order-_Items AS items\n    INTO TABLE @DATA(lt_items).\n\n  WRITE: / 'Ordem:', ls_order-vbeln, \n         'Itens:', lines( lt_items ).\nENDLOOP.\n</code></pre></p>"},{"location":"cds_amdp/#annotations-comuns","title":"\ud83c\udfa8 Annotations Comuns","text":"Annotation Descri\u00e7\u00e3o <code>@AbapCatalog.sqlViewName</code> Nome da view SQL gerada <code>@EndUserText.label</code> Descri\u00e7\u00e3o da view <code>@AccessControl.authorizationCheck</code> Controlo de acesso <code>@Analytics.dataCategory</code> Tipo de dados (dimens\u00e3o/facto) <code>@ObjectModel.usageType</code> Uso previsto <code>@VDM.viewType</code> Tipo de view no VDM"},{"location":"cds_amdp/#cds-com-parametros","title":"\ud83d\udd22 CDS com Par\u00e2metros","text":"<pre><code>@AbapCatalog.sqlViewName: 'ZV_FLIGHTS_PARAM'\n@EndUserText.label: 'Voos por Companhia'\n\ndefine view Z_CDS_Flights_Param\n  with parameters\n    p_carrid : s_carr_id\nas\n  select from sflight\n{\n  key carrid,\n  key connid,\n  key fldate,\n      price\n}\nwhere carrid = :p_carrid\n</code></pre> <p>Usar em ABAP: <pre><code>SELECT * FROM z_cds_flights_param( p_carrid = 'LH' )\n  INTO TABLE @DATA(lt_flights).\n</code></pre></p>"},{"location":"cds_amdp/#amdp-abap-managed-database-procedures","title":"\u26a1 AMDP (ABAP Managed Database Procedures)","text":"<p>Executar SQLScript nativo diretamente na base de dados (HANA).</p>"},{"location":"cds_amdp/#exemplo-amdp","title":"Exemplo AMDP","text":"<pre><code>CLASS zcl_amdp_example DEFINITION PUBLIC.\n  PUBLIC SECTION.\n    INTERFACES if_amdp_marker_hdb.\n\n    CLASS-METHODS get_top_flights\n      IMPORTING VALUE(iv_carrid) TYPE s_carr_id\n                VALUE(iv_limit)  TYPE i\n      EXPORTING VALUE(et_result) TYPE tt_sflight.\nENDCLASS.\n\nCLASS zcl_amdp_example IMPLEMENTATION.\n  METHOD get_top_flights BY DATABASE PROCEDURE \n    FOR HDB LANGUAGE SQLSCRIPT\n    OPTIONS READ-ONLY\n    USING sflight.\n\n    et_result = SELECT carrid, connid, fldate, price\n                FROM sflight\n                WHERE carrid = :iv_carrid\n                ORDER BY price DESC\n                LIMIT :iv_limit;\n  ENDMETHOD.\nENDCLASS.\n</code></pre> <p>Usar: <pre><code>DATA: lt_flights TYPE tt_sflight.\n\nzcl_amdp_example=&gt;get_top_flights(\n  EXPORTING\n    iv_carrid = 'LH'\n    iv_limit  = 10\n  IMPORTING\n    et_result = lt_flights ).\n</code></pre></p>"},{"location":"cds_amdp/#cds-vs-views-classicas","title":"\ud83d\udcca CDS vs. Views Cl\u00e1ssicas","text":"Caracter\u00edstica CDS View View Cl\u00e1ssica (SE11) Linguagem DDL (SQL-like) ABAP Dictionary Associations \u2705 Sim \u274c N\u00e3o Annotations \u2705 Sim \u274c N\u00e3o Par\u00e2metros \u2705 Sim \u274c N\u00e3o Performance HANA \u2705 Otimizado \u26a0\ufe0f Limitado OData/Fiori \u2705 Nativo \u26a0\ufe0f Requer adapter"},{"location":"cds_amdp/#boas-praticas","title":"\ud83d\ude80 Boas Pr\u00e1ticas","text":""},{"location":"cds_amdp/#fazer","title":"\u2705 Fazer","text":"<ol> <li>Naming convention: Z_CDS_ ou Z_I_ (interface) / Z_C_ (consumption)</li> <li>Usar associations em vez de JOINs repetidos</li> <li>Annotations completas para metadados</li> <li>Testar performance com SE16 / Data Preview</li> <li>Documentar prop\u00f3sito da view</li> </ol>"},{"location":"cds_amdp/#evitar","title":"\u274c Evitar","text":"<ol> <li>L\u00f3gica complexa em CDS (usar AMDP)</li> <li>Muitas camadas de views aninhadas</li> <li>SELECTs sem WHERE em CDS com dados grandes</li> <li>Esquecer <code>@AccessControl.authorizationCheck</code></li> </ol>"},{"location":"cds_amdp/#ferramentas-recomendadas","title":"\ud83d\udee0\ufe0f Ferramentas Recomendadas","text":"<ul> <li>Eclipse ADT (ABAP Development Tools): Criar e editar CDS Views</li> <li>Data Preview (F8): Testar CDS Views no Eclipse</li> <li>Transaction SE16: Ver dados da SQL view gerada</li> <li>Transaction SE11: Dicion\u00e1rio de dados (limitado para CDS)</li> </ul>"},{"location":"cds_amdp/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ol> <li>Consulte a sec\u00e7\u00e3o CDS Views para tutoriais detalhados</li> <li>Instale ABAP Development Tools (ADT) no Eclipse</li> <li>Crie uma CDS simples</li> <li>Experimente associations</li> <li>Teste AMDP se tiver HANA</li> <li>Explore SQL para otimizar queries</li> </ol> <p>Tags: <code>#CDS</code> <code>#AMDP</code> <code>#HANA</code> <code>#Performance</code> <code>#Modern-ABAP</code></p>"},{"location":"debug/","title":"\ud83d\udc1e Debug e An\u00e1lise","text":"<p>Ferramentas e t\u00e9cnicas para depurar programas ABAP, usar breakpoints e analisar o comportamento em tempo de execu\u00e7\u00e3o.</p>"},{"location":"debug/#o-que-vais-aprender","title":"\ud83d\udcd6 O que vais aprender","text":"<ul> <li>Ativar e usar o debugger cl\u00e1ssico e novo</li> <li>Tipos de breakpoints (est\u00e1ticos, din\u00e2micos, condicionais)</li> <li>An\u00e1lise de vari\u00e1veis e tabelas internas</li> <li>Watchpoints para detetar mudan\u00e7as em campos</li> <li>Call Stack e navega\u00e7\u00e3o entre chamadas</li> <li>Debugging de jobs em background</li> <li>An\u00e1lise de dumps (ST22)</li> <li>Runtime Analysis (SAT, SE30)</li> </ul>"},{"location":"debug/#ordem-de-aprendizagem","title":"\ud83c\udfaf Ordem de Aprendizagem","text":""},{"location":"debug/#1-breakpoints","title":"1\ufe0f\u20e3 Breakpoints","text":"<p>Tipos de breakpoints e como us\u00e1-los eficientemente.</p> <p>T\u00f3picos: - Breakpoint est\u00e1tico vs din\u00e2mico - Breakpoints condicionais - Breakpoints HTTP e de exce\u00e7\u00e3o - Gest\u00e3o de breakpoints</p>"},{"location":"debug/#2-watchpoints","title":"2\ufe0f\u20e3 Watchpoints","text":"<p>Monitorizar mudan\u00e7as em vari\u00e1veis durante a execu\u00e7\u00e3o.</p> <p>T\u00f3picos: - Criar watchpoints - Watchpoints com condi\u00e7\u00f5es - Watchpoints em estruturas e tabelas - Performance de watchpoints</p>"},{"location":"debug/#3-debugger-classico-vs-novo","title":"3\ufe0f\u20e3 Debugger Cl\u00e1ssico vs Novo","text":"<p>Compara\u00e7\u00e3o e uso dos dois debuggers dispon\u00edveis.</p> <p>T\u00f3picos: - Diferen\u00e7as entre debuggers - Atalhos de teclado - Quando usar cada um - Personaliza\u00e7\u00e3o do layout</p>"},{"location":"debug/#4-analise-de-dumps-st22","title":"4\ufe0f\u20e3 An\u00e1lise de Dumps (ST22)","text":"<p>Interpretar e resolver erros em runtime.</p> <p>T\u00f3picos: - Estrutura de um dump - Erros comuns e solu\u00e7\u00f5es - Call stack - An\u00e1lise de vari\u00e1veis no erro</p>"},{"location":"debug/#5-runtime-analysis-sat","title":"5\ufe0f\u20e3 Runtime Analysis (SAT)","text":"<p>Medir e otimizar performance de programas.</p> <p>T\u00f3picos: - Criar medi\u00e7\u00f5es - Interpretar resultados - Identificar gargalos - Comparar antes/depois</p>"},{"location":"debug/#6-debug-de-jobs-em-background","title":"6\ufe0f\u20e3 Debug de Jobs em Background","text":"<p>T\u00e9cnicas para debugar processos em background.</p> <p>T\u00f3picos: - M\u00e9todo JDBG - Breakpoints externos - SM37 e SM50 - Logs de aplica\u00e7\u00e3o</p>"},{"location":"debug/#ferramentas-principais","title":"\ud83d\udee0\ufe0f Ferramentas Principais","text":""},{"location":"debug/#debugger","title":"Debugger","text":"<ul> <li><code>/h</code> \u2192 Ativar debugger</li> <li><code>/hc</code> \u2192 Debugger cl\u00e1ssico</li> <li><code>/hs</code> \u2192 Novo debugger</li> <li><code>/hdel</code> \u2192 Apagar breakpoints</li> </ul>"},{"location":"debug/#atalhos-essenciais","title":"Atalhos Essenciais","text":"<ul> <li>F5 \u2192 Step into (entrar em m\u00e9todo)</li> <li>F6 \u2192 Step over (executar linha)</li> <li>F7 \u2192 Return (voltar ao chamador)</li> <li>F8 \u2192 Continue (at\u00e9 pr\u00f3ximo breakpoint)</li> <li>Shift+F12 \u2192 Criar watchpoint</li> </ul>"},{"location":"debug/#transactions","title":"Transactions","text":"<ul> <li>ST22 \u2192 An\u00e1lise de dumps</li> <li>SAT (SE30) \u2192 Runtime Analysis</li> <li>ST05 \u2192 SQL Trace</li> <li>SM37 \u2192 Background Jobs</li> <li>SM50 \u2192 Process Overview</li> </ul>"},{"location":"debug/#exemplo-rapido","title":"\ud83d\udca1 Exemplo R\u00e1pido","text":"<pre><code>REPORT z_debug_demo.\n\nDATA: lt_voos TYPE TABLE OF sflight,\n      lv_soma TYPE p DECIMALS 2.\n\nSTART-OF-SELECTION.\n\n  \" \u26d4 Breakpoint aqui (F7)\n  SELECT * FROM sflight INTO TABLE lt_voos UP TO 100 ROWS.\n\n  LOOP AT lt_voos INTO DATA(ls_voo).\n    \" \ud83d\udc41\ufe0f Watchpoint em lv_soma\n    lv_soma = lv_soma + ls_voo-price.\n\n    \" \u26d4 Breakpoint condicional: ls_voo-price &gt; 1000\n    IF ls_voo-price &gt; 1000.\n      WRITE: / |Voo caro: { ls_voo-carrid } { ls_voo-connid }|.\n    ENDIF.\n  ENDLOOP.\n\n  WRITE: / |Soma total: { lv_soma }|.\n</code></pre>"},{"location":"debug/#boas-praticas","title":"\ud83d\udea8 Boas Pr\u00e1ticas","text":""},{"location":"debug/#fazer","title":"\u2705 Fazer","text":"<ul> <li>Remover <code>BREAK-POINT</code> antes de transportar c\u00f3digo</li> <li>Usar breakpoints condicionais para LOOPs grandes</li> <li>Analisar ST22 para entender erros</li> <li>Medir com SAT antes de otimizar</li> <li>Usar JDBG para debug de jobs</li> </ul>"},{"location":"debug/#evitar","title":"\u274c Evitar","text":"<ul> <li>Deixar <code>BREAK-POINT</code> em c\u00f3digo produtivo</li> <li>Debugar sem ter hip\u00f3teses sobre o problema</li> <li>Ignorar o call stack</li> <li>Otimizar sem medir</li> <li>Debug em produ\u00e7\u00e3o sem autoriza\u00e7\u00e3o</li> </ul>"},{"location":"debug/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ol> <li>Comece por Breakpoints</li> <li>Aprenda Watchpoints para casos avan\u00e7ados</li> <li>Domine o Debugger para navegar eficientemente</li> <li>Use ST22 quando encontrar erros</li> <li>Otimize com SAT ap\u00f3s identificar problemas</li> <li>Explore Performance para t\u00e9cnicas de otimiza\u00e7\u00e3o</li> </ol> <p>Tags: <code>#Debug</code> <code>#Breakpoint</code> <code>#Watchpoint</code> <code>#ST22</code> <code>#SAT</code> <code>#Performance</code></p>"},{"location":"debug/1_breakpoints/","title":"Breakpoints em ABAP","text":"","tags":["ABAP","Debug","Breakpoints","Desenvolvimento"]},{"location":"debug/1_breakpoints/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Breakpoints s\u00e3o pontos de paragem que permitem pausar a execu\u00e7\u00e3o do programa para analisar o estado das vari\u00e1veis, l\u00f3gica e fluxo de execu\u00e7\u00e3o.</p>","tags":["ABAP","Debug","Breakpoints","Desenvolvimento"]},{"location":"debug/1_breakpoints/#tipos-de-breakpoints","title":"\ud83c\udfaf Tipos de Breakpoints","text":"","tags":["ABAP","Debug","Breakpoints","Desenvolvimento"]},{"location":"debug/1_breakpoints/#1-breakpoint-estatico-break-point","title":"1\ufe0f\u20e3 Breakpoint Est\u00e1tico (BREAK-POINT)","text":"<p>Inserido diretamente no c\u00f3digo fonte.</p> <pre><code>REPORT z_breakpoint_demo.\n\nDATA: lv_contador TYPE i,\n      lv_total TYPE i.\n\nSTART-OF-SELECTION.\n\n  DO 10 TIMES.\n    lv_contador = sy-index.\n\n    BREAK-POINT.  \" \u26d4 Execu\u00e7\u00e3o para aqui\n\n    lv_total = lv_total + lv_contador.\n  ENDLOOP.\n\n  WRITE: / |Total: { lv_total }|.\n</code></pre> <p>Caracter\u00edsticas: - \u2705 Permanente at\u00e9 ser removido do c\u00f3digo - \u2705 Funciona para todos os utilizadores - \u274c Deve ser removido antes de transportar - \u274c Ativado mesmo em produ\u00e7\u00e3o (perigoso!)</p> <p>Variante para Utilizador Espec\u00edfico: <pre><code>\" Apenas ativa para o seu utilizador\nBREAK sy-uname.\n\n\" Apenas para utilizador espec\u00edfico\nBREAK 'JSILVA'.\n</code></pre></p>","tags":["ABAP","Debug","Breakpoints","Desenvolvimento"]},{"location":"debug/1_breakpoints/#2-breakpoint-dinamico-session","title":"2\ufe0f\u20e3 Breakpoint Din\u00e2mico (Session)","text":"<p>Definido na GUI sem alterar c\u00f3digo.</p> <p>Como criar: 1. Abrir programa no editor (SE38/SE80) 2. Clicar na linha desejada 3. Pressionar F7 ou clicar no in\u00edcio da linha 4. Aparece um \u26d4 vermelho</p> <p>Caracter\u00edsticas: - \u2705 N\u00e3o altera c\u00f3digo - \u2705 Apenas para a sua sess\u00e3o - \u274c Perdido ao fechar sess\u00e3o - \u2705 Ideal para desenvolvimento</p> <p>Atalhos: - F7 - Criar/remover breakpoint - Shift+F7 - Desativar breakpoint temporariamente</p>","tags":["ABAP","Debug","Breakpoints","Desenvolvimento"]},{"location":"debug/1_breakpoints/#3-breakpoint-condicional","title":"3\ufe0f\u20e3 Breakpoint Condicional","text":"<p>Para apenas quando uma condi\u00e7\u00e3o \u00e9 verdadeira.</p> <p>Como criar: 1. Criar breakpoint din\u00e2mico (F7) 2. No debugger, clicar com bot\u00e3o direito no breakpoint 3. Selecionar \"Condition\" 4. Inserir condi\u00e7\u00e3o</p> <p>Exemplos de condi\u00e7\u00f5es:</p> <pre><code>\" Parar quando contador for maior que 100\nlv_contador &gt; 100\n\n\" Parar quando campo espec\u00edfico tiver valor\nls_cliente-nome = 'Jo\u00e3o Silva'\n\n\" Parar quando tabela tiver mais de 1000 linhas\nlines( lt_dados ) &gt; 1000\n\n\" Condi\u00e7\u00e3o complexa\nlv_valor &gt; 1000 AND ls_data-mes = '12'\n</code></pre> <p>Exemplo pr\u00e1tico:</p> <pre><code>SELECT * FROM sflight INTO TABLE @DATA(lt_voos).\n\nLOOP AT lt_voos INTO DATA(ls_voo).\n  \" Breakpoint aqui com condi\u00e7\u00e3o: ls_voo-price &gt; 1000\n\n  WRITE: / |{ ls_voo-carrid } { ls_voo-connid } - { ls_voo-price }|.\nENDLOOP.\n</code></pre>","tags":["ABAP","Debug","Breakpoints","Desenvolvimento"]},{"location":"debug/1_breakpoints/#4-breakpoint-em-statement","title":"4\ufe0f\u20e3 Breakpoint em Statement","text":"<p>Para quando um statement espec\u00edfico \u00e9 executado.</p> <p>Como criar: 1. Menu: Breakpoints \u2192 Create Statement Breakpoint 2. Inserir o statement (ex: <code>SELECT</code>, <code>CALL FUNCTION</code>)</p> <p>Exemplos:</p> <pre><code>\" Parar em todos os SELECTs\nBreakpoint em: SELECT\n\n\" Parar em chamadas de fun\u00e7\u00e3o espec\u00edfica\nBreakpoint em: CALL FUNCTION 'BAPI_CUSTOMER_GET'\n\n\" Parar em m\u00e9todos de classe\nBreakpoint em: CALL METHOD\n</code></pre>","tags":["ABAP","Debug","Breakpoints","Desenvolvimento"]},{"location":"debug/1_breakpoints/#5-breakpoint-http-debug-web","title":"5\ufe0f\u20e3 Breakpoint HTTP (Debug Web)","text":"<p>Para debugar aplica\u00e7\u00f5es web (BSP, WebDynpro, Fiori).</p> <p>Como ativar: 1. Executar <code>/h</code> no SAP GUI 2. Abrir aplica\u00e7\u00e3o web no browser 3. Execu\u00e7\u00e3o para no primeiro statement ABAP</p> <p>Ou usar o Debugger URL: <pre><code>?sap-client=100&amp;sap-user=USUARIO&amp;sap-password=SENHA&amp;SAP-DEBUGGER=X\n</code></pre></p>","tags":["ABAP","Debug","Breakpoints","Desenvolvimento"]},{"location":"debug/1_breakpoints/#6-breakpoint-em-excecao","title":"6\ufe0f\u20e3 Breakpoint em Exce\u00e7\u00e3o","text":"<p>Para quando uma exce\u00e7\u00e3o \u00e9 lan\u00e7ada.</p> <p>Como criar: 1. Menu Debugger: Settings \u2192 User-Specific Settings 2. Aba \"Exceptions\" 3. Selecionar classes de exce\u00e7\u00e3o</p> <p>Exemplo: <pre><code>TRY.\n    DATA(lv_result) = 10 / 0.  \" \u26d4 Para aqui em CX_SY_ZERODIVIDE\n  CATCH cx_sy_zerodivide.\n    WRITE: / 'Divis\u00e3o por zero!'.\nENDTRY.\n</code></pre></p>","tags":["ABAP","Debug","Breakpoints","Desenvolvimento"]},{"location":"debug/1_breakpoints/#7-breakpoint-em-system-field","title":"7\ufe0f\u20e3 Breakpoint em System Field","text":"<p>Para quando um system field muda.</p> <p>Exemplo: - Breakpoint quando <code>sy-subrc &lt;&gt; 0</code> - Breakpoint quando <code>sy-tabix = 50</code></p>","tags":["ABAP","Debug","Breakpoints","Desenvolvimento"]},{"location":"debug/1_breakpoints/#gestao-de-breakpoints","title":"\ud83d\udee0\ufe0f Gest\u00e3o de Breakpoints","text":"","tags":["ABAP","Debug","Breakpoints","Desenvolvimento"]},{"location":"debug/1_breakpoints/#ver-todos-os-breakpoints","title":"Ver Todos os Breakpoints","text":"<p>Transaction: <code>/h</code> \u2192 Settings \u2192 Display/Delete Breakpoints</p> <p>Ou menu: Utilities \u2192 Settings \u2192 ABAP Debugger \u2192 Breakpoints</p>","tags":["ABAP","Debug","Breakpoints","Desenvolvimento"]},{"location":"debug/1_breakpoints/#desativar-temporariamente","title":"Desativar Temporariamente","text":"<ul> <li>Clicar com bot\u00e3o direito \u2192 Deactivate</li> <li>\u00cdcone muda para \u2b55 (vazio)</li> </ul>","tags":["ABAP","Debug","Breakpoints","Desenvolvimento"]},{"location":"debug/1_breakpoints/#apagar-breakpoints","title":"Apagar Breakpoints","text":"<p>Apagar todos: <pre><code>\" No debugger\n/hdel\n</code></pre></p> <p>Apagar um espec\u00edfico: - F7 na linha do breakpoint</p>","tags":["ABAP","Debug","Breakpoints","Desenvolvimento"]},{"location":"debug/1_breakpoints/#exemplos-praticos","title":"\ud83d\udca1 Exemplos Pr\u00e1ticos","text":"","tags":["ABAP","Debug","Breakpoints","Desenvolvimento"]},{"location":"debug/1_breakpoints/#exemplo-1-debug-de-loop-com-condicao","title":"Exemplo 1: Debug de LOOP com Condi\u00e7\u00e3o","text":"<pre><code>REPORT z_debug_loop.\n\nDATA: lt_clientes TYPE TABLE OF kna1.\n\nSELECT * FROM kna1 INTO TABLE lt_clientes UP TO 1000 ROWS.\n\nLOOP AT lt_clientes INTO DATA(ls_cliente).\n  \" \u26d4 Breakpoint condicional aqui\n  \" Condi\u00e7\u00e3o: ls_cliente-land1 = 'PT'\n\n  IF ls_cliente-land1 = 'PT'.\n    WRITE: / ls_cliente-name1.\n  ENDIF.\nENDLOOP.\n</code></pre>","tags":["ABAP","Debug","Breakpoints","Desenvolvimento"]},{"location":"debug/1_breakpoints/#exemplo-2-debug-de-select-com-performance","title":"Exemplo 2: Debug de SELECT com Performance","text":"<pre><code>REPORT z_debug_select.\n\nDATA: lt_voos TYPE TABLE OF sflight.\n\n\" \u26d4 Breakpoint antes do SELECT\nSELECT * FROM sflight INTO TABLE lt_voos\n  WHERE carrid = 'LH'\n    AND connid = '0400'.\n\n\" \u26d4 Breakpoint depois do SELECT para ver resultado\nWRITE: / |Registos encontrados: { lines( lt_voos ) }|.\n</code></pre>","tags":["ABAP","Debug","Breakpoints","Desenvolvimento"]},{"location":"debug/1_breakpoints/#exemplo-3-debug-de-chamada-de-funcao","title":"Exemplo 3: Debug de Chamada de Fun\u00e7\u00e3o","text":"<pre><code>REPORT z_debug_function.\n\nDATA: lv_customer TYPE kna1-kunnr VALUE '0000001000'.\n\n\" \u26d4 Breakpoint antes da chamada\nCALL FUNCTION 'BAPI_CUSTOMER_GETDETAIL'\n  EXPORTING\n    customerno = lv_customer\n  EXCEPTIONS\n    OTHERS     = 1.\n\n\" \u26d4 Breakpoint depois para ver sy-subrc\nIF sy-subrc &lt;&gt; 0.\n  WRITE: / 'Erro ao buscar cliente'.\nENDIF.\n</code></pre>","tags":["ABAP","Debug","Breakpoints","Desenvolvimento"]},{"location":"debug/1_breakpoints/#exemplo-4-debug-com-variaveis-inline","title":"Exemplo 4: Debug com Vari\u00e1veis Inline","text":"<pre><code>REPORT z_debug_inline.\n\nSELECT * FROM sflight INTO TABLE @DATA(lt_voos) UP TO 10 ROWS.\n\n\" \u26d4 Breakpoint aqui - lt_voos j\u00e1 est\u00e1 populada\nDATA(lv_total) = REDUCE i( INIT sum = 0\n                            FOR wa IN lt_voos\n                            NEXT sum = sum + wa-seatsocc ).\n\nWRITE: / |Total de lugares ocupados: { lv_total }|.\n</code></pre>","tags":["ABAP","Debug","Breakpoints","Desenvolvimento"]},{"location":"debug/1_breakpoints/#boas-praticas","title":"\ud83c\udf93 Boas Pr\u00e1ticas","text":"","tags":["ABAP","Debug","Breakpoints","Desenvolvimento"]},{"location":"debug/1_breakpoints/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Usar breakpoints condicionais em LOOPs grandes\nLOOP AT lt_tabela INTO DATA(ls_linha).\n  \" Condi\u00e7\u00e3o: sy-tabix = 500\n  \" Evita parar 499 vezes!\nENDLOOP.\n\n\" 2. Usar BREAK sy-uname em desenvolvimento\nBREAK sy-uname.  \" S\u00f3 para voc\u00ea\n\n\" 3. Comentar breakpoints est\u00e1ticos\n\" BREAK-POINT.  \" TODO: Remover antes de transportar\n\n\" 4. Usar breakpoints de statement para an\u00e1lise\n\" Em vez de colocar 50 breakpoints, usar breakpoint em SELECT\n</code></pre>","tags":["ABAP","Debug","Breakpoints","Desenvolvimento"]},{"location":"debug/1_breakpoints/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. BREAK-POINT em produ\u00e7\u00e3o\nBREAK-POINT.  \" \u274c NUNCA em c\u00f3digo produtivo!\n\n\" 2. Breakpoints sem condi\u00e7\u00e3o em LOOPs grandes\nLOOP AT lt_tabela INTO DATA(ls_linha).  \" 1.000.000 de linhas\n  BREAK-POINT.  \" \u274c Vai parar 1 milh\u00e3o de vezes!\nENDLOOP.\n\n\" 3. Esquecer breakpoints din\u00e2micos ativos\n\" Verificar sempre: Utilities \u2192 Settings \u2192 Display Breakpoints\n\n\" 4. Usar breakpoint quando watchpoint seria melhor\n\" Se quer saber QUANDO um valor muda, use watchpoint!\n</code></pre>","tags":["ABAP","Debug","Breakpoints","Desenvolvimento"]},{"location":"debug/1_breakpoints/#troubleshooting","title":"\ud83d\udd0d Troubleshooting","text":"","tags":["ABAP","Debug","Breakpoints","Desenvolvimento"]},{"location":"debug/1_breakpoints/#breakpoint-nao-para","title":"Breakpoint N\u00e3o Para","text":"<p>Poss\u00edveis causas: 1. C\u00f3digo n\u00e3o \u00e9 executado (l\u00f3gica condicional) 2. Breakpoint desativado 3. Debugger desligado 4. C\u00f3digo em RFC/Background job (precisa configura\u00e7\u00e3o especial)</p> <p>Solu\u00e7\u00e3o: <pre><code>\" Adicionar WRITE antes do breakpoint para confirmar execu\u00e7\u00e3o\nWRITE: / 'Antes do breakpoint'.\nBREAK-POINT.\n</code></pre></p>","tags":["ABAP","Debug","Breakpoints","Desenvolvimento"]},{"location":"debug/1_breakpoints/#breakpoint-desaparece","title":"Breakpoint Desaparece","text":"<p>Causa: Breakpoints din\u00e2micos s\u00e3o perdidos ao: - Fechar sess\u00e3o - Recompilar programa - Mudar de utilizador</p> <p>Solu\u00e7\u00e3o: Usar breakpoints est\u00e1ticos tempor\u00e1rios ou anotar as linhas.</p>","tags":["ABAP","Debug","Breakpoints","Desenvolvimento"]},{"location":"debug/1_breakpoints/#performance-degradada","title":"Performance Degradada","text":"<p>Causa: Muitos breakpoints ativos</p> <p>Solu\u00e7\u00e3o: <pre><code>\" Limpar todos\n/hdel\n</code></pre></p>","tags":["ABAP","Debug","Breakpoints","Desenvolvimento"]},{"location":"debug/1_breakpoints/#atalhos-uteis","title":"\ud83d\udd17 Atalhos \u00dateis","text":"Atalho A\u00e7\u00e3o F7 Criar/Remover breakpoint Shift+F7 Desativar breakpoint /h Ativar debugger /hdel Apagar todos breakpoints Ctrl+Shift+F7 Ver todos breakpoints","tags":["ABAP","Debug","Breakpoints","Desenvolvimento"]},{"location":"debug/1_breakpoints/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>Watchpoints - Monitorizar mudan\u00e7as em vari\u00e1veis</li> <li>Debugger - Navegar no debugger</li> <li>ST22 - Analisar dumps</li> </ul> <p>Tags: <code>#Debug</code> <code>#Breakpoints</code> <code>#ABAP</code> <code>#Desenvolvimento</code> <code>#Troubleshooting</code></p>","tags":["ABAP","Debug","Breakpoints","Desenvolvimento"]},{"location":"debug/2_watchpoints/","title":"Watchpoints em ABAP","text":"","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Watchpoints monitorizam vari\u00e1veis e param a execu\u00e7\u00e3o quando o valor da vari\u00e1vel muda ou atinge uma condi\u00e7\u00e3o espec\u00edfica. S\u00e3o essenciais para rastrear mudan\u00e7as inesperadas em dados.</p>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#o-que-sao-watchpoints","title":"\ud83c\udfaf O que s\u00e3o Watchpoints?","text":"<p>Diferentemente dos breakpoints (que param em linhas de c\u00f3digo), watchpoints param quando: - Uma vari\u00e1vel muda de valor - Uma vari\u00e1vel atinge um valor espec\u00edfico - Um campo de estrutura/tabela \u00e9 modificado</p>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#como-criar-watchpoints","title":"\ud83d\udd39 Como Criar Watchpoints","text":"","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#metodo-1-durante-o-debug","title":"M\u00e9todo 1: Durante o Debug","text":"<ol> <li>Entrar em modo debug (/h ou F7)</li> <li>Selecionar vari\u00e1vel na aba \"Fields\"</li> <li>Clicar com bot\u00e3o direito \u2192 Create Watchpoint</li> <li>Ou usar atalho: Shift+F12</li> </ol>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#metodo-2-antes-do-debug","title":"M\u00e9todo 2: Antes do Debug","text":"<ol> <li>No editor, posicionar cursor na vari\u00e1vel</li> <li>Menu: Utilities \u2192 Breakpoints \u2192 Create Watchpoint</li> </ol>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#tipos-de-watchpoints","title":"\ud83d\udd39 Tipos de Watchpoints","text":"","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#1-watchpoint-simples-change","title":"1\ufe0f\u20e3 Watchpoint Simples (Change)","text":"<p>Para quando vari\u00e1vel muda de valor.</p> <pre><code>REPORT z_watchpoint_demo.\n\nDATA: lv_contador TYPE i VALUE 0.\n\nSTART-OF-SELECTION.\n\n  \" \ud83d\udc41\ufe0f Criar watchpoint em lv_contador\n\n  DO 10 TIMES.\n    lv_contador = lv_contador + 1.  \" \u26d4 Para aqui a cada mudan\u00e7a\n  ENDLOOP.\n\n  WRITE: / |Contador final: { lv_contador }|.\n</code></pre> <p>Quando usa: - Descobrir onde uma vari\u00e1vel \u00e9 modificada - Rastrear mudan\u00e7as inesperadas - Debug de loops complexos</p>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#2-watchpoint-com-condicao","title":"2\ufe0f\u20e3 Watchpoint com Condi\u00e7\u00e3o","text":"<p>Para apenas quando vari\u00e1vel atinge valor espec\u00edfico.</p> <pre><code>REPORT z_watchpoint_condicional.\n\nDATA: lv_preco TYPE p DECIMALS 2.\n\nSTART-OF-SELECTION.\n\n  SELECT price FROM sflight INTO lv_preco UP TO 100 ROWS.\n    \" \ud83d\udc41\ufe0f Watchpoint: lv_preco &gt; 1000\n    \" \u26d4 Para apenas quando pre\u00e7o &gt; 1000\n\n    WRITE: / lv_preco.\n  ENDSELECT.\n</code></pre> <p>Condi\u00e7\u00f5es poss\u00edveis: <pre><code>lv_valor &gt; 100          \" Maior que\nlv_status = 'E'         \" Igual a\nlv_contador &gt;= 50       \" Maior ou igual\nls_data-campo IS INITIAL \" Inicial\n</code></pre></p>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#3-watchpoint-em-estrutura","title":"3\ufe0f\u20e3 Watchpoint em Estrutura","text":"<p>Monitora campo espec\u00edfico de estrutura.</p> <pre><code>REPORT z_watchpoint_estrutura.\n\nDATA: BEGIN OF ls_cliente,\n        id    TYPE i,\n        nome  TYPE string,\n        ativo TYPE abap_bool,\n      END OF ls_cliente.\n\nSTART-OF-SELECTION.\n\n  ls_cliente-id = 1.\n  ls_cliente-nome = 'Jo\u00e3o'.\n\n  \" \ud83d\udc41\ufe0f Watchpoint em ls_cliente-ativo\n  ls_cliente-ativo = abap_true.  \" \u26d4 Para aqui\n\n  WRITE: / ls_cliente-nome.\n</code></pre>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#4-watchpoint-em-tabela-interna","title":"4\ufe0f\u20e3 Watchpoint em Tabela Interna","text":"<p>Monitora mudan\u00e7as em tabela interna.</p> <pre><code>REPORT z_watchpoint_tabela.\n\nDATA: lt_clientes TYPE TABLE OF kna1.\n\nSTART-OF-SELECTION.\n\n  \" \ud83d\udc41\ufe0f Watchpoint em lt_clientes\n  \" Condi\u00e7\u00e3o: lines( lt_clientes ) &gt; 100\n\n  SELECT * FROM kna1 INTO TABLE lt_clientes UP TO 1000 ROWS.\n  \" \u26d4 Para quando tabela tiver &gt; 100 linhas\n\n  WRITE: / |Total: { lines( lt_clientes ) }|.\n</code></pre>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#5-watchpoint-global","title":"5\ufe0f\u20e3 Watchpoint Global","text":"<p>Monitora vari\u00e1vel em qualquer programa da call stack.</p> <p>Como criar: 1. Debugger \u2192 Settings \u2192 Watchpoints 2. Selecionar \"Global Watchpoint\" 3. Inserir nome da vari\u00e1vel</p> <p>\u00datil para: - Rastrear vari\u00e1veis em chamadas de fun\u00e7\u00e3o - Debug de c\u00f3digo que n\u00e3o pode ser modificado - An\u00e1lise de framework SAP</p>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#exemplos-praticos","title":"\ud83d\udca1 Exemplos Pr\u00e1ticos","text":"","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#exemplo-1-rastrear-mudanca-inesperada","title":"Exemplo 1: Rastrear Mudan\u00e7a Inesperada","text":"<pre><code>REPORT z_debug_mudanca.\n\nDATA: lv_total TYPE p DECIMALS 2 VALUE '100.00'.\n\nSTART-OF-SELECTION.\n\n  \" \ud83d\udc41\ufe0f Watchpoint em lv_total\n  \" Objetivo: descobrir onde valor est\u00e1 sendo zerado\n\n  PERFORM calcular_desconto CHANGING lv_total.\n  PERFORM aplicar_taxa CHANGING lv_total.\n  PERFORM processar_pagamento CHANGING lv_total.\n\n  \" lv_total est\u00e1 0 mas deveria ter valor!\n  WRITE: / |Total: { lv_total }|.\n\nFORM calcular_desconto CHANGING cv_valor TYPE p.\n  cv_valor = cv_valor * '0.9'.\nENDFORM.\n\nFORM aplicar_taxa CHANGING cv_valor TYPE p.\n  cv_valor = cv_valor + 10.\nENDFORM.\n\nFORM processar_pagamento CHANGING cv_valor TYPE p.\n  cv_valor = 0.  \" \u26d4 Watchpoint para aqui!\nENDFORM.\n</code></pre>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#exemplo-2-debug-de-loop-com-acumulador","title":"Exemplo 2: Debug de Loop com Acumulador","text":"<pre><code>REPORT z_debug_acumulador.\n\nDATA: lt_valores TYPE TABLE OF i,\n      lv_soma TYPE i.\n\nSTART-OF-SELECTION.\n\n  lt_valores = VALUE #( ( 10 ) ( 20 ) ( 30 ) ( -100 ) ( 40 ) ).\n\n  \" \ud83d\udc41\ufe0f Watchpoint em lv_soma\n  \" Condi\u00e7\u00e3o: lv_soma &lt; 0\n\n  LOOP AT lt_valores INTO DATA(lv_valor).\n    lv_soma = lv_soma + lv_valor.  \" \u26d4 Para quando soma fica negativa\n  ENDLOOP.\n\n  WRITE: / |Soma: { lv_soma }|.\n</code></pre>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#exemplo-3-monitorar-system-field","title":"Exemplo 3: Monitorar System Field","text":"<pre><code>REPORT z_debug_sysubrc.\n\nDATA: lt_dados TYPE TABLE OF kna1.\n\nSTART-OF-SELECTION.\n\n  \" \ud83d\udc41\ufe0f Watchpoint em sy-subrc\n  \" Condi\u00e7\u00e3o: sy-subrc &lt;&gt; 0\n\n  SELECT * FROM kna1 INTO TABLE lt_dados WHERE kunnr = '9999999999'.\n  \" \u26d4 Para se SELECT falhar\n\n  IF sy-subrc = 0.\n    WRITE: / |Encontrados: { lines( lt_dados ) }|.\n  ELSE.\n    WRITE: / 'Nenhum dado encontrado'.\n  ENDIF.\n</code></pre>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#exemplo-4-debug-de-objeto-oo","title":"Exemplo 4: Debug de Objeto OO","text":"<pre><code>REPORT z_debug_objeto.\n\nCLASS lcl_conta DEFINITION.\n  PUBLIC SECTION.\n    METHODS: depositar IMPORTING iv_valor TYPE p DECIMALS 2.\n    DATA: mv_saldo TYPE p DECIMALS 2 READ-ONLY.\nENDCLASS.\n\nCLASS lcl_conta IMPLEMENTATION.\n  METHOD depositar.\n    mv_saldo = mv_saldo + iv_valor.\n  ENDMETHOD.\nENDCLASS.\n\nSTART-OF-SELECTION.\n\n  DATA(lo_conta) = NEW lcl_conta( ).\n\n  \" \ud83d\udc41\ufe0f Watchpoint em lo_conta-&gt;mv_saldo\n  \" Condi\u00e7\u00e3o: lo_conta-&gt;mv_saldo &gt; 1000\n\n  lo_conta-&gt;depositar( 100 ).\n  lo_conta-&gt;depositar( 200 ).\n  lo_conta-&gt;depositar( 800 ).  \" \u26d4 Para aqui (saldo = 1100)\n\n  WRITE: / |Saldo: { lo_conta-&gt;mv_saldo }|.\n</code></pre>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#gestao-de-watchpoints","title":"\ud83d\udee0\ufe0f Gest\u00e3o de Watchpoints","text":"","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#ver-watchpoints-ativos","title":"Ver Watchpoints Ativos","text":"<p>No Debugger: - Menu: Settings \u2192 Watchpoints - Ou: Aba \"Watchpoints\"</p>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#desativar-watchpoint","title":"Desativar Watchpoint","text":"<ul> <li>Clicar com bot\u00e3o direito \u2192 Deactivate</li> <li>Mant\u00e9m configura\u00e7\u00e3o mas n\u00e3o para execu\u00e7\u00e3o</li> </ul>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#apagar-watchpoint","title":"Apagar Watchpoint","text":"<ul> <li>Clicar com bot\u00e3o direito \u2192 Delete</li> <li>Ou: Shift+F12 na vari\u00e1vel novamente</li> </ul>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#apagar-todos-watchpoints","title":"Apagar Todos Watchpoints","text":"<p>No Debugger: <pre><code>Settings \u2192 Watchpoints \u2192 Delete All\n</code></pre></p>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#watchpoint-vs-breakpoint","title":"\ud83d\udd0d Watchpoint vs Breakpoint","text":"Aspecto Breakpoint Watchpoint Para em Linha de c\u00f3digo Mudan\u00e7a de vari\u00e1vel Usado para Verificar fluxo Rastrear dados Performance R\u00e1pido Mais lento Condi\u00e7\u00e3o Local no c\u00f3digo Valor da vari\u00e1vel Melhor para L\u00f3gica Estado de dados <p>Quando usar cada um:</p> <pre><code>\" \u2705 Use BREAKPOINT quando quer parar numa linha espec\u00edfica\nIF lv_valor &gt; 100.\n  BREAK-POINT.  \" Parar sempre que entrar no IF\n  PERFORM processar.\nENDIF.\n\n\" \u2705 Use WATCHPOINT quando quer saber QUANDO vari\u00e1vel muda\n\" \ud83d\udc41\ufe0f Watchpoint em lv_status\n\" Descobrir onde lv_status est\u00e1 sendo modificado\n</code></pre>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#performance-de-watchpoints","title":"\u26a1 Performance de Watchpoints","text":"","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#impacto","title":"Impacto","text":"<p>Watchpoints t\u00eam overhead significativo porque verificam a vari\u00e1vel ap\u00f3s cada statement.</p> <p>Exemplo de impacto: <pre><code>\" Sem watchpoint: 1 segundo\n\" Com watchpoint em lv_contador: 10 segundos\n\nDO 1000000 TIMES.\n  lv_contador = lv_contador + 1.\nENDLOOP.\n</code></pre></p>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#otimizacoes","title":"Otimiza\u00e7\u00f5es","text":"<pre><code>\" \u274c Evitar watchpoint em loops gigantes sem condi\u00e7\u00e3o\n\" \ud83d\udc41\ufe0f Watchpoint em lv_contador (sem condi\u00e7\u00e3o)\nDO 1000000 TIMES.\n  lv_contador = lv_contador + 1.  \" Para 1 milh\u00e3o de vezes!\nENDLOOP.\n\n\" \u2705 Usar com condi\u00e7\u00e3o\n\" \ud83d\udc41\ufe0f Watchpoint em lv_contador\n\" Condi\u00e7\u00e3o: lv_contador = 500000\nDO 1000000 TIMES.\n  lv_contador = lv_contador + 1.  \" Para apenas 1 vez\nENDLOOP.\n\n\" \u2705 Ou usar breakpoint condicional\nDO 1000000 TIMES.\n  lv_contador = lv_contador + 1.\n  \" Breakpoint aqui, condi\u00e7\u00e3o: sy-index = 500000\nENDLOOP.\n</code></pre>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#casos-de-uso-avancados","title":"\ud83d\udca1 Casos de Uso Avan\u00e7ados","text":"","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#1-rastrear-corrupcao-de-dados","title":"1. Rastrear Corrup\u00e7\u00e3o de Dados","text":"<pre><code>\" Problema: campo mv_id est\u00e1 sendo zerado inesperadamente\nCLASS lcl_produto DEFINITION.\n  PUBLIC SECTION.\n    DATA: mv_id TYPE i.\n    METHODS: processar.\nENDCLASS.\n\n\" \ud83d\udc41\ufe0f Watchpoint em lo_prod-&gt;mv_id\n\" Condi\u00e7\u00e3o: lo_prod-&gt;mv_id = 0\n\" Descobre exatamente onde o ID \u00e9 zerado\n</code></pre>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#2-debug-de-tabelas-grandes","title":"2. Debug de Tabelas Grandes","text":"<pre><code>DATA: lt_clientes TYPE TABLE OF kna1.\n\n\" \ud83d\udc41\ufe0f Watchpoint em sy-tabix\n\" Condi\u00e7\u00e3o: sy-tabix = 5000\n\" Para na linha 5000 do loop sem parar 4999 vezes antes\n\nSELECT * FROM kna1 INTO TABLE lt_clientes.\n\nLOOP AT lt_clientes INTO DATA(ls_cliente).\n  \" Processar\nENDLOOP.\n</code></pre>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#3-monitorar-excecoes","title":"3. Monitorar Exce\u00e7\u00f5es","text":"<pre><code>DATA: lv_erro TYPE string.\n\n\" \ud83d\udc41\ufe0f Watchpoint em lv_erro\n\" Condi\u00e7\u00e3o: lv_erro IS NOT INITIAL\n\nTRY.\n    \" C\u00f3digo complexo\n  CATCH cx_root INTO DATA(lo_ex).\n    lv_erro = lo_ex-&gt;get_text( ).  \" \u26d4 Para aqui\nENDTRY.\n</code></pre>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#boas-praticas","title":"\ud83c\udf93 Boas Pr\u00e1ticas","text":"","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Usar condi\u00e7\u00f5es para reduzir overhead\n\" \ud83d\udc41\ufe0f Watchpoint: lv_contador = 1000\n\" Em vez de parar a cada mudan\u00e7a\n\n\" 2. Watchpoint em campos espec\u00edficos, n\u00e3o estruturas inteiras\n\" \ud83d\udc41\ufe0f ls_data-status (espec\u00edfico)\n\" Em vez de ls_data (toda estrutura)\n\n\" 3. Remover watchpoints quando n\u00e3o necess\u00e1rios\n\" Performance!\n\n\" 4. Documentar o que est\u00e1 a investigar\n\" Comentar: \"Investigando porque mv_total fica negativo\"\n</code></pre>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Watchpoint sem condi\u00e7\u00e3o em loops grandes\nDO 1000000 TIMES.\n  lv_var = sy-index.  \" \u274c Para 1 milh\u00e3o de vezes!\nENDLOOP.\n\n\" 2. M\u00faltiplos watchpoints simult\u00e2neos\n\" \u274c Impacto de performance exponencial\n\n\" 3. Watchpoint em system fields muito usados\n\" \ud83d\udc41\ufe0f sy-subrc  \" \u274c Muda constantemente!\n\" \ud83d\udc41\ufe0f sy-tabix  \" \u274c Muda a cada itera\u00e7\u00e3o!\n\n\" 4. Esquecer watchpoints ativos\n\" Verificar sempre depois de debug\n</code></pre>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#troubleshooting","title":"\ud83d\udd27 Troubleshooting","text":"","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#watchpoint-nao-para","title":"Watchpoint N\u00e3o Para","text":"<p>Poss\u00edveis causas: 1. Vari\u00e1vel n\u00e3o est\u00e1 mudando 2. Condi\u00e7\u00e3o nunca \u00e9 verdadeira 3. Watchpoint desativado 4. Vari\u00e1vel \u00e9 local e saiu do escopo</p> <p>Solu\u00e7\u00e3o: <pre><code>\" Adicionar WRITE para confirmar mudan\u00e7a\nlv_valor = lv_valor + 10.\nWRITE: / |Valor mudou para: { lv_valor }|.\n</code></pre></p>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#performance-muito-lenta","title":"Performance Muito Lenta","text":"<p>Causa: Watchpoint em loop sem condi\u00e7\u00e3o</p> <p>Solu\u00e7\u00e3o: <pre><code>\" Adicionar condi\u00e7\u00e3o ao watchpoint\n\" Ou converter para breakpoint condicional\n</code></pre></p>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#watchpoint-em-objeto-nao-funciona","title":"Watchpoint em Objeto N\u00e3o Funciona","text":"<p>Causa: Refer\u00eancia do objeto mudou</p> <p>Solu\u00e7\u00e3o: <pre><code>\" Watchpoint na classe/atributo, n\u00e3o na refer\u00eancia\n\" \ud83d\udc41\ufe0f lo_obj-&gt;mv_campo \u2705\n\" Em vez de lo_obj \u274c\n</code></pre></p>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#atalhos-uteis","title":"\ud83d\udd17 Atalhos \u00dateis","text":"Atalho A\u00e7\u00e3o Shift+F12 Criar/Remover watchpoint Ctrl+Shift+F12 Ver todos watchpoints F8 Continuar at\u00e9 pr\u00f3ximo watchpoint","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/2_watchpoints/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>Debugger - Navegar eficientemente no debugger</li> <li>Breakpoints - Complementar com breakpoints</li> <li>ST22 - Analisar dumps quando watchpoint encontra problemas</li> </ul> <p>Tags: <code>#Debug</code> <code>#Watchpoints</code> <code>#Monitoriza\u00e7\u00e3o</code> <code>#ABAP</code> <code>#Troubleshooting</code></p>","tags":["ABAP","Debug","Watchpoints","Monitoriza\u00e7\u00e3o"]},{"location":"debug/3_debugger/","title":"Debugger Cl\u00e1ssico vs Novo","text":"","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>O SAP oferece dois debuggers: o Cl\u00e1ssico (antigo) e o Novo (moderno). Ambos t\u00eam vantagens e desvantagens dependendo da situa\u00e7\u00e3o.</p>","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#comparacao-rapida","title":"\ud83c\udfaf Compara\u00e7\u00e3o R\u00e1pida","text":"Aspecto Debugger Cl\u00e1ssico Novo Debugger Interface Janelas separadas Interface integrada com abas Performance Mais r\u00e1pido Mais lento Visualiza\u00e7\u00e3o Simples Rica e visual Objetos OO Limitado Excelente Tabelas B\u00e1sico Navega\u00e7\u00e3o avan\u00e7ada Atalho <code>/hc</code> <code>/hs</code> ou padr\u00e3o","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#debugger-classico","title":"\ud83d\udd39 Debugger Cl\u00e1ssico","text":"","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#ativar","title":"Ativar","text":"<pre><code>/hc  \" For\u00e7ar debugger cl\u00e1ssico\n</code></pre>","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#vantagens","title":"Vantagens","text":"<ul> <li>\u2705 Mais r\u00e1pido em sistemas lentos</li> <li>\u2705 Familiar para desenvolvedores antigos</li> <li>\u2705 Menos consumo de mem\u00f3ria</li> <li>\u2705 Melhor para debug r\u00e1pido</li> </ul>","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#desvantagens","title":"Desvantagens","text":"<ul> <li>\u274c Interface antiga</li> <li>\u274c Limitado para objetos</li> <li>\u274c Visualiza\u00e7\u00e3o de tabelas b\u00e1sica</li> </ul>","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#layout","title":"Layout","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  C\u00f3digo Fonte                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Fields (Vari\u00e1veis)                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Tables (Tabelas Internas)          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#atalhos-principais","title":"Atalhos Principais","text":"Atalho A\u00e7\u00e3o F5 Step into (entrar em m\u00e9todo/fun\u00e7\u00e3o) F6 Step over (executar linha) F7 Return (sair do m\u00e9todo atual) F8 Continue (at\u00e9 pr\u00f3ximo breakpoint) Ctrl+F Procurar campo Shift+F2 Definir vari\u00e1vel","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#novo-debugger","title":"\ud83d\udd39 Novo Debugger","text":"","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#ativar_1","title":"Ativar","text":"<pre><code>/hs  \" For\u00e7ar novo debugger\n</code></pre> <p>Ou configurar como padr\u00e3o: Utilities \u2192 Settings \u2192 ABAP Editor \u2192 Debugging \u2192 New Debugger</p>","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#vantagens_1","title":"Vantagens","text":"<ul> <li>\u2705 Interface moderna com abas</li> <li>\u2705 Excelente para objetos OO</li> <li>\u2705 Navega\u00e7\u00e3o avan\u00e7ada em tabelas</li> <li>\u2705 M\u00faltiplas views simult\u00e2neas</li> <li>\u2705 Melhor visualiza\u00e7\u00e3o de estruturas</li> </ul>","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#desvantagens_1","title":"Desvantagens","text":"<ul> <li>\u274c Mais lento em sistemas antigos</li> <li>\u274c Mais complexo para iniciantes</li> <li>\u274c Consome mais mem\u00f3ria</li> </ul>","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#layout-com-abas","title":"Layout com Abas","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Source Code | Variables | Breakpoints | ...  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                              \u2502\n\u2502  [Aba ativa com conte\u00fado]                   \u2502\n\u2502                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#abas-disponiveis","title":"Abas Dispon\u00edveis","text":"<ol> <li>Source Code - C\u00f3digo fonte</li> <li>Variables - Vari\u00e1veis locais e globais</li> <li>Breakpoints - Gest\u00e3o de breakpoints</li> <li>Watchpoints - Gest\u00e3o de watchpoints</li> <li>Call Stack - Pilha de chamadas</li> <li>Tables - Visualiza\u00e7\u00e3o de tabelas internas</li> <li>Objects - Navega\u00e7\u00e3o em objetos OO</li> <li>Settings - Configura\u00e7\u00f5es do debugger</li> </ol>","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#atalhos-comuns-ambos-debuggers","title":"\u26a1 Atalhos Comuns (Ambos Debuggers)","text":"","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#navegacao","title":"Navega\u00e7\u00e3o","text":"Atalho A\u00e7\u00e3o Descri\u00e7\u00e3o F5 Step Into Entra em m\u00e9todo/fun\u00e7\u00e3o F6 Step Over Executa linha sem entrar F7 Return Volta ao chamador F8 Continue At\u00e9 pr\u00f3ximo breakpoint Shift+F8 Continue to cursor At\u00e9 linha do cursor","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#breakpoints","title":"Breakpoints","text":"Atalho A\u00e7\u00e3o Shift+F7 Criar breakpoint Shift+F12 Criar watchpoint Ctrl+Shift+F7 Ver breakpoints","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#visualizacao","title":"Visualiza\u00e7\u00e3o","text":"Atalho A\u00e7\u00e3o Ctrl+F Procurar Shift+F2 Alterar valor de vari\u00e1vel Ctrl+F10 Ver tabela","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#casos-de-uso","title":"\ud83d\udca1 Casos de Uso","text":"","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#quando-usar-debugger-classico","title":"Quando Usar Debugger Cl\u00e1ssico","text":"<pre><code>\" \u2705 Debug r\u00e1pido de c\u00f3digo procedural\nREPORT z_simples.\n\nDATA: lv_total TYPE i.\n\nDO 10 TIMES.\n  lv_total = lv_total + sy-index.  \" Simples, n\u00e3o precisa features avan\u00e7adas\nENDLOOP.\n</code></pre>","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#quando-usar-novo-debugger","title":"Quando Usar Novo Debugger","text":"<pre><code>\" \u2705 Debug de c\u00f3digo OO complexo\nCLASS lcl_processador DEFINITION.\n  PUBLIC SECTION.\n    METHODS: processar IMPORTING io_dados TYPE REF TO lcl_dados.\nENDCLASS.\n\n\" Novo debugger \u00e9 melhor para navegar em objetos\nDATA(lo_proc) = NEW lcl_processador( ).\nDATA(lo_dados) = NEW lcl_dados( ).\nlo_proc-&gt;processar( lo_dados ).\n</code></pre>","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#funcionalidades-avancadas","title":"\ud83d\udd0d Funcionalidades Avan\u00e7adas","text":"","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#novo-debugger-navegacao-em-objetos","title":"Novo Debugger: Navega\u00e7\u00e3o em Objetos","text":"<pre><code>CLASS lcl_cliente DEFINITION.\n  PUBLIC SECTION.\n    DATA: mv_nome TYPE string,\n          mo_endereco TYPE REF TO lcl_endereco.\nENDCLASS.\n\n\" No novo debugger:\n\" - Expandir objeto\n\" - Ver atributos e refer\u00eancias\n\" - Navegar em objetos aninhados\nDATA(lo_cliente) = NEW lcl_cliente( ).\n</code></pre> <p>Visualiza\u00e7\u00e3o: <pre><code>\ud83d\udce6 lo_cliente (LCL_CLIENTE)\n  \u2514\u2500 \ud83d\udcc4 mv_nome: \"Jo\u00e3o Silva\"\n  \u2514\u2500 \ud83d\udce6 mo_endereco (LCL_ENDERECO)\n      \u2514\u2500 \ud83d\udcc4 mv_rua: \"Rua A\"\n      \u2514\u2500 \ud83d\udcc4 mv_cidade: \"Lisboa\"\n</code></pre></p>","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#novo-debugger-tabelas-internas","title":"Novo Debugger: Tabelas Internas","text":"<pre><code>DATA: lt_clientes TYPE TABLE OF kna1.\n\nSELECT * FROM kna1 INTO TABLE lt_clientes UP TO 1000 ROWS.\n\n\" No novo debugger:\n\" - Ver tabela em grid\n\" - Ordenar colunas\n\" - Filtrar dados\n\" - Exportar para Excel\n</code></pre>","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#personalizacao","title":"\ud83d\udee0\ufe0f Personaliza\u00e7\u00e3o","text":"","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#configurar-debugger-padrao","title":"Configurar Debugger Padr\u00e3o","text":"<p>Caminho: <pre><code>SAP GUI \u2192 Utilities \u2192 Settings \u2192 ABAP Editor \u2192 Debugging\n</code></pre></p> <p>Op\u00e7\u00f5es: - \u2611\ufe0f New ABAP Debugger - \u2610 Classic ABAP Debugger</p>","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#layout-do-novo-debugger","title":"Layout do Novo Debugger","text":"<p>Personalizar abas: 1. Clicar com bot\u00e3o direito na \u00e1rea de abas 2. Configure Layout 3. Arrastar/adicionar/remover abas</p> <p>Layouts predefinidos: - Standard - Desktop 1, 2, 3 - Analysis - Custom (criar o seu)</p>","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#comparacao-pratica","title":"\ud83c\udf93 Compara\u00e7\u00e3o Pr\u00e1tica","text":"","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#exemplo-debug-de-loop","title":"Exemplo: Debug de Loop","text":"<p>Debugger Cl\u00e1ssico: <pre><code>1. Ver c\u00f3digo\n2. Ver vari\u00e1veis numa janela separada\n3. Alternar entre janelas\n</code></pre></p> <p>Novo Debugger: <pre><code>1. C\u00f3digo e vari\u00e1veis lado a lado em abas\n2. Ver call stack simultaneamente\n3. Tudo numa interface integrada\n</code></pre></p>","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#exemplo-debug-de-objeto","title":"Exemplo: Debug de Objeto","text":"<p>Debugger Cl\u00e1ssico: <pre><code>lo_objeto-&gt;mv_atributo  \" Precisa digitar caminho completo\n</code></pre></p> <p>Novo Debugger: <pre><code>\ud83d\udce6 lo_objeto (expandir visualmente)\n  \u2514\u2500 \ud83d\udcc4 mv_atributo: valor\n  \u2514\u2500 \ud83d\udce6 mo_outro_objeto\n      \u2514\u2500 ...\n</code></pre></p>","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#dicas-e-truques","title":"\ud83d\udca1 Dicas e Truques","text":"","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#forcar-debugger-especifico","title":"For\u00e7ar Debugger Espec\u00edfico","text":"<pre><code>\" No c\u00f3digo (tempor\u00e1rio)\nBREAK-POINT.  \" Usa debugger padr\u00e3o\n\n\" Na transa\u00e7\u00e3o\n/hc  \" Cl\u00e1ssico\n/hs  \" Novo\n/h   \" Padr\u00e3o configurado\n</code></pre>","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#alternar-durante-debug","title":"Alternar Durante Debug","text":"<p>No debugger: <pre><code>Settings \u2192 Switch to Classic/New Debugger\n</code></pre></p>","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#desempenho-melhorado","title":"Desempenho Melhorado","text":"<p>Novo Debugger: - Desativar abas n\u00e3o usadas - Limitar visualiza\u00e7\u00e3o de tabelas - Configura\u00e7\u00e3o: Settings \u2192 Maximum Table Size (padr\u00e3o: 1000)</p> <p>Cl\u00e1ssico: - J\u00e1 otimizado por natureza - Melhor para sistemas lentos</p>","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#comandos-especiais","title":"\ud83d\udd17 Comandos Especiais","text":"","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#debugger-classico_1","title":"Debugger Cl\u00e1ssico","text":"<pre><code>/h    - Ativar debug\n/hdel - Apagar breakpoints\n/hx   - Desativar debug\n</code></pre>","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#novo-debugger_1","title":"Novo Debugger","text":"<pre><code>/hs   - For\u00e7ar novo debugger\n/hc   - For\u00e7ar cl\u00e1ssico\n/hx   - Sair do debug\n</code></pre>","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#boas-praticas","title":"\ud83c\udfaf Boas Pr\u00e1ticas","text":"","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Usar novo debugger para OO\nCLASS lcl_complexo DEFINITION.\n  \" ... c\u00f3digo OO complexo\nENDCLASS.\n\n\" 2. Usar cl\u00e1ssico para scripts r\u00e1pidos\nREPORT z_quick_fix.\n\" Debug r\u00e1pido\n\n\" 3. Personalizar layout\n\" Salvar layouts diferentes para diferentes tarefas\n\n\" 4. Aprender atalhos\n\" F5, F6, F7, F8 - essenciais!\n</code></pre>","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Debugger errado para a tarefa\n\" Cl\u00e1ssico para debug OO complexo \u274c\n\" Novo para sistema muito lento \u274c\n\n\" 2. N\u00e3o configurar layout\n\" Perder tempo procurando informa\u00e7\u00e3o\n\n\" 3. Ignorar call stack\n\" Fundamental para entender fluxo\n\n\" 4. N\u00e3o usar watchpoints\n\" Rastrear mudan\u00e7as manualmente\n</code></pre>","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/3_debugger/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>ST22 - Analisar dumps</li> <li>SAT - Runtime Analysis</li> <li>Breakpoints - Usar breakpoints eficientemente</li> </ul> <p>Tags: <code>#Debug</code> <code>#Debugger</code> <code>#Ferramentas</code> <code>#ABAP</code> <code>#Desenvolvimento</code></p>","tags":["ABAP","Debug","Debugger","Ferramentas"]},{"location":"debug/4_st22/","title":"An\u00e1lise de Dumps (ST22)","text":"","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>A transa\u00e7\u00e3o ST22 permite analisar dumps (short dumps) - erros em runtime que causam o t\u00e9rmino abrupto do programa. \u00c9 essencial para diagnosticar e corrigir problemas em produ\u00e7\u00e3o.</p>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#o-que-e-um-dump","title":"\ud83c\udfaf O que \u00e9 um Dump?","text":"<p>Um dump ocorre quando: - Divis\u00e3o por zero - Acesso a \u00edndice inv\u00e1lido de tabela - Convers\u00e3o de dados inv\u00e1lida - Timeout de programa - Falta de mem\u00f3ria - Autoriza\u00e7\u00e3o insuficiente</p> <p>Exemplo de c\u00f3digo que gera dump: <pre><code>DATA: lv_result TYPE i,\n      lv_divisor TYPE i VALUE 0.\n\nlv_result = 10 / lv_divisor.  \" \u274c DUMP: COMPUTE_INT_ZERODIVIDE\n</code></pre></p>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#aceder-a-st22","title":"\ud83d\udd39 Aceder \u00e0 ST22","text":"","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#transaction-code","title":"Transaction Code","text":"<pre><code>ST22\n</code></pre>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#o-que-ves","title":"O que v\u00eas","text":"<ul> <li>Lista de dumps recentes</li> <li>Filtros por data, utilizador, programa</li> <li>Detalhes completos de cada dump</li> </ul>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#estrutura-de-um-dump","title":"\ud83d\udd39 Estrutura de um Dump","text":"","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#1-cabecalho","title":"1. Cabe\u00e7alho","text":"<pre><code>Runtime Error: COMPUTE_INT_ZERODIVIDE\nDate/Time: 04.11.2025 10:30:15\nUser: JSILVA\nProgram: Z_MEU_PROGRAMA\n</code></pre>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#2-descricao-do-erro","title":"2. Descri\u00e7\u00e3o do Erro","text":"<p>Explica\u00e7\u00e3o em linguagem natural do que aconteceu.</p>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#3-source-code-extract","title":"3. Source Code Extract","text":"<p>C\u00f3digo onde o erro ocorreu: <pre><code>18  DATA lv_divisor TYPE i VALUE 0.\n19  \n20  lv_result = 10 / lv_divisor.  \" \u2190\u2190\u2190 Erro aqui\n21  \n22  WRITE: / lv_result.\n</code></pre></p>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#4-call-stack-pilha-de-chamadas","title":"4. Call Stack (Pilha de Chamadas)","text":"<pre><code>1. Z_MEU_PROGRAMA (Line 20)\n2. PERFORM calcular (Line 15)\n3. CLASS_METHOD processar (Line 45)\n</code></pre>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#5-conteudo-de-variaveis","title":"5. Conte\u00fado de Vari\u00e1veis","text":"<p>Valores das vari\u00e1veis no momento do erro: <pre><code>lv_result   = 0\nlv_divisor  = 0\nsy-subrc    = 0\nsy-tabix    = 1\n</code></pre></p>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#erros-comuns-e-solucoes","title":"\ud83d\udca1 Erros Comuns e Solu\u00e7\u00f5es","text":"","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#1-compute_int_zerodivide","title":"1. COMPUTE_INT_ZERODIVIDE","text":"<p>Causa: Divis\u00e3o por zero</p> <pre><code>\" \u274c Problema\nlv_result = lv_a / lv_b.  \" lv_b = 0\n\n\" \u2705 Solu\u00e7\u00e3o\nIF lv_b &lt;&gt; 0.\n  lv_result = lv_a / lv_b.\nELSE.\n  MESSAGE 'Divisor n\u00e3o pode ser zero' TYPE 'E'.\nENDIF.\n</code></pre>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#2-itab_line_not_found","title":"2. ITAB_LINE_NOT_FOUND","text":"<p>Causa: Acesso a linha inexistente de tabela</p> <pre><code>\" \u274c Problema\nDATA(ls_cliente) = lt_clientes[ 999 ].  \" \u00cdndice n\u00e3o existe\n\n\" \u2705 Solu\u00e7\u00e3o 1: READ TABLE com sy-subrc\nREAD TABLE lt_clientes INTO DATA(ls_cliente) INDEX 999.\nIF sy-subrc = 0.\n  \" Processar\nENDIF.\n\n\" \u2705 Solu\u00e7\u00e3o 2: Express\u00e3o com OPTIONAL\nDATA(ls_cliente) = VALUE #( lt_clientes[ 999 ] OPTIONAL ).\nIF ls_cliente IS NOT INITIAL.\n  \" Processar\nENDIF.\n</code></pre>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#3-convt_no_number","title":"3. CONVT_NO_NUMBER","text":"<p>Causa: Convers\u00e3o inv\u00e1lida de texto para n\u00famero</p> <pre><code>\" \u274c Problema\nDATA: lv_texto TYPE string VALUE 'ABC',\n      lv_numero TYPE i.\nlv_numero = lv_texto.  \" Erro!\n\n\" \u2705 Solu\u00e7\u00e3o\nTRY.\n    lv_numero = lv_texto.\n  CATCH cx_sy_conversion_no_number.\n    MESSAGE 'Valor n\u00e3o \u00e9 num\u00e9rico' TYPE 'E'.\nENDTRY.\n</code></pre>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#4-tsv_tnew_page_alloc_failed","title":"4. TSV_TNEW_PAGE_ALLOC_FAILED","text":"<p>Causa: Falta de mem\u00f3ria (tabela muito grande)</p> <pre><code>\" \u274c Problema\nSELECT * FROM ekko INTO TABLE lt_docs.  \" Milh\u00f5es de registos!\n\n\" \u2705 Solu\u00e7\u00e3o 1: Limitar quantidade\nSELECT * FROM ekko INTO TABLE lt_docs UP TO 10000 ROWS.\n\n\" \u2705 Solu\u00e7\u00e3o 2: Processar em pacotes\nSELECT * FROM ekko INTO TABLE @DATA(lt_pacote)\n  PACKAGE SIZE 1000.\n  \" Processar lt_pacote\nENDSELECT.\n</code></pre>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#5-move_cast_error","title":"5. MOVE_CAST_ERROR","text":"<p>Causa: Cast de objeto inv\u00e1lido</p> <pre><code>\" \u274c Problema\nDATA: lo_animal TYPE REF TO lcl_animal.\nlo_animal = NEW lcl_cao( ).\nDATA(lo_gato) = CAST lcl_gato( lo_animal ).  \" Erro! N\u00e3o \u00e9 gato\n\n\" \u2705 Solu\u00e7\u00e3o\nIF lo_animal IS INSTANCE OF lcl_gato.\n  DATA(lo_gato) = CAST lcl_gato( lo_animal ).\nELSE.\n  MESSAGE 'Objeto n\u00e3o \u00e9 do tipo esperado' TYPE 'E'.\nENDIF.\n</code></pre>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#6-time_out","title":"6. TIME_OUT","text":"<p>Causa: Programa excedeu tempo m\u00e1ximo</p> <pre><code>\" \u274c Problema\nDO 999999999 TIMES.\n  \" Loop infinito\nENDDO.\n\n\" \u2705 Solu\u00e7\u00e3o\nDATA lv_max TYPE i VALUE 1000.\nDO lv_max TIMES.\n  \" Processar\n  IF sy-index &gt;= lv_max.\n    EXIT.\n  ENDIF.\nENDDO.\n</code></pre>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#como-analisar-um-dump","title":"\ud83d\udd0d Como Analisar um Dump","text":"","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#passo-1-identificar-o-erro","title":"Passo 1: Identificar o Erro","text":"<p><pre><code>Runtime Error: ITAB_LINE_NOT_FOUND\n</code></pre> Pergunta: O que aconteceu?</p>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#passo-2-ver-codigo-fonte","title":"Passo 2: Ver C\u00f3digo Fonte","text":"<p><pre><code>20  DATA(ls_linha) = lt_tabela[ 100 ].  \" \u2190\u2190\u2190 Aqui\n</code></pre> Pergunta: Onde aconteceu?</p>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#passo-3-analisar-call-stack","title":"Passo 3: Analisar Call Stack","text":"<p><pre><code>1. Z_PROGRAMA (Line 20)\n2. FORM processar_dados (Line 15)\n3. Main Program (Line 5)\n</code></pre> Pergunta: Como cheg\u00e1mos aqui?</p>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#passo-4-verificar-variaveis","title":"Passo 4: Verificar Vari\u00e1veis","text":"<p><pre><code>lt_tabela: 50 linhas\nsy-index: 100\n</code></pre> Pergunta: Qual era o estado?</p>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#passo-5-entender-causa-raiz","title":"Passo 5: Entender Causa Raiz","text":"<p>Conclus\u00e3o: Tentei aceder \u00e0 linha 100, mas tabela s\u00f3 tem 50 linhas.</p>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#passo-6-corrigir","title":"Passo 6: Corrigir","text":"<pre><code>\" \u2705 Solu\u00e7\u00e3o\nIF lines( lt_tabela ) &gt;= 100.\n  DATA(ls_linha) = lt_tabela[ 100 ].\nELSE.\n  MESSAGE 'Tabela n\u00e3o tem linhas suficientes' TYPE 'E'.\nENDIF.\n</code></pre>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#funcionalidades-da-st22","title":"\ud83d\udee0\ufe0f Funcionalidades da ST22","text":"","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#filtros","title":"Filtros","text":"<pre><code>- Por data\n- Por utilizador\n- Por programa\n- Por tipo de erro\n- Por servidor\n</code></pre>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#acoes","title":"A\u00e7\u00f5es","text":"<ul> <li>Analisar: Ver detalhes completos</li> <li>Repetir: Tentar reproduzir (apenas em desenvolvimento)</li> <li>Arquivar: Marcar como resolvido</li> <li>Exportar: Guardar detalhes</li> </ul>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#estatisticas-de-dumps","title":"\ud83d\udcca Estat\u00edsticas de Dumps","text":"<p>ST22 \u2192 Analysis \u2192 Statistics</p> <p>Ver: - Dumps mais frequentes - Programas com mais problemas - Utilizadores afetados - Tend\u00eancias ao longo do tempo</p>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#exemplo-completo-de-analise","title":"\ud83d\udca1 Exemplo Completo de An\u00e1lise","text":"","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#dump-recebido","title":"Dump Recebido","text":"<pre><code>Runtime Error: ITAB_LINE_NOT_FOUND\nProgram: Z_RELATORIO_VENDAS\nUser: VENDEDOR01\nDate: 04.11.2025 14:30:00\n</code></pre>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#codigo-com-erro","title":"C\u00f3digo com Erro","text":"<pre><code>45  LOOP AT lt_vendas INTO DATA(ls_venda).\n46    DATA(ls_cliente) = lt_clientes[ kunnr = ls_venda-kunnr ].\n47    WRITE: / ls_cliente-name1, ls_venda-netwr.\n48  ENDLOOP.\n</code></pre>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#call-stack","title":"Call Stack","text":"<pre><code>Z_RELATORIO_VENDAS (Line 46)\n</code></pre>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#variaveis","title":"Vari\u00e1veis","text":"<pre><code>lt_vendas: 100 linhas\nlt_clientes: 80 linhas\nls_venda-kunnr: '0000099999'\n</code></pre>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#analise","title":"An\u00e1lise","text":"<ol> <li>Problema: Cliente '0000099999' n\u00e3o existe em lt_clientes</li> <li>Causa: Dados inconsistentes (venda sem cliente)</li> <li>Solu\u00e7\u00e3o: Usar READ TABLE com verifica\u00e7\u00e3o</li> </ol>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#correcao","title":"Corre\u00e7\u00e3o","text":"<pre><code>LOOP AT lt_vendas INTO DATA(ls_venda).\n  READ TABLE lt_clientes INTO DATA(ls_cliente)\n    WITH KEY kunnr = ls_venda-kunnr.\n\n  IF sy-subrc = 0.\n    WRITE: / ls_cliente-name1, ls_venda-netwr.\n  ELSE.\n    WRITE: / 'Cliente n\u00e3o encontrado:', ls_venda-kunnr.\n  ENDIF.\nENDLOOP.\n</code></pre>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#boas-praticas","title":"\ud83c\udf93 Boas Pr\u00e1ticas","text":"","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Sempre verificar sy-subrc\nREAD TABLE lt_tab INTO ls_linha INDEX 1.\nIF sy-subrc = 0.\n  \" OK\nENDIF.\n\n\" 2. Usar TRY-CATCH para convers\u00f5es\nTRY.\n    lv_numero = lv_texto.\n  CATCH cx_sy_conversion_error.\n    \" Tratar erro\nENDTRY.\n\n\" 3. Validar antes de aceder\nIF lines( lt_tab ) &gt; 0.\n  DATA(ls_first) = lt_tab[ 1 ].\nENDIF.\n\n\" 4. Limitar SELECTs\nSELECT * FROM tabela INTO TABLE lt_data UP TO 10000 ROWS.\n</code></pre>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Acesso direto sem valida\u00e7\u00e3o\nDATA(ls_linha) = lt_tab[ 1 ].  \" \u274c Pode n\u00e3o existir\n\n\" 2. Ignorar possibilidade de erro\nlv_numero = lv_texto.  \" \u274c Pode n\u00e3o ser n\u00famero\n\n\" 3. SELECTs sem limite\nSELECT * FROM tabela.  \" \u274c Pode trazer milh\u00f5es\n\n\" 4. N\u00e3o documentar erros conhecidos\n\" Se conhece o problema, documente!\n</code></pre>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#transactions-relacionadas","title":"\ud83d\udd17 Transactions Relacionadas","text":"<ul> <li>ST22 - An\u00e1lise de dumps</li> <li>SM21 - System log (eventos do sistema)</li> <li>ST11 - Developer traces</li> <li>SM50 - Process overview</li> <li>SAT - Runtime analysis</li> </ul>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/4_st22/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>SAT - Analisar performance</li> <li>Debugger - Prevenir dumps com debug</li> <li>Watchpoints - Rastrear mudan\u00e7as</li> </ul> <p>Tags: <code>#Debug</code> <code>#ST22</code> <code>#Dumps</code> <code>#Erros</code> <code>#Troubleshooting</code> <code>#ABAP</code></p>","tags":["ABAP","Debug","ST22","Dumps","Erros"]},{"location":"debug/5_sat/","title":"Runtime Analysis (SAT / SE30)","text":"","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>SAT (ou SE30 em sistemas antigos) \u00e9 a ferramenta de an\u00e1lise de performance em runtime. Permite medir o tempo de execu\u00e7\u00e3o de programas e identificar gargalos de performance.</p>","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#para-que-serve","title":"\ud83c\udfaf Para que Serve","text":"<ul> <li>Medir tempo de execu\u00e7\u00e3o do programa</li> <li>Identificar c\u00f3digo lento</li> <li>Analisar queries SQL</li> <li>Ver tempo gasto por m\u00e9todo/fun\u00e7\u00e3o</li> <li>Encontrar gargalos de performance</li> <li>Comparar antes/depois de otimiza\u00e7\u00f5es</li> </ul>","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#iniciar-analise","title":"\ud83d\udd39 Iniciar An\u00e1lise","text":"","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#transaction-code","title":"Transaction Code","text":"<pre><code>SAT   (sistemas novos)\nSE30  (sistemas antigos)\n</code></pre>","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#passos-basicos","title":"Passos B\u00e1sicos","text":"<ol> <li>SAT \u2192 Nova medi\u00e7\u00e3o</li> <li>Inserir nome do programa</li> <li>Pressionar Execute</li> <li>Programa executa e \u00e9 medido</li> <li>Ver resultados da an\u00e1lise</li> </ol>","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#tipos-de-medicao","title":"\ud83d\udd39 Tipos de Medi\u00e7\u00e3o","text":"","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#1-medicao-de-programa","title":"1\ufe0f\u20e3 Medi\u00e7\u00e3o de Programa","text":"<pre><code>REPORT z_programa_teste.\n\nSTART-OF-SELECTION.\n  \" Todo este c\u00f3digo ser\u00e1 medido\n  SELECT * FROM sflight INTO TABLE @DATA(lt_voos).\n\n  LOOP AT lt_voos INTO DATA(ls_voo).\n    \" Processar\n  ENDLOOP.\n</code></pre> <p>Como: 1. SAT \u2192 Program: <code>Z_PROGRAMA_TESTE</code> 2. Execute 3. Ver resultados</p>","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#2-medicao-de-transaction","title":"2\ufe0f\u20e3 Medi\u00e7\u00e3o de Transaction","text":"<p>Exemplo: Medir SE16</p> <ol> <li>SAT \u2192 Transaction: <code>SE16</code></li> <li>Execute</li> <li>Executar a\u00e7\u00f5es na SE16</li> <li>Voltar ao SAT para ver resultados</li> </ol>","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#3-medicao-manual-codigo","title":"3\ufe0f\u20e3 Medi\u00e7\u00e3o Manual (C\u00f3digo)","text":"<pre><code>REPORT z_manual_measure.\n\nDATA: lv_start TYPE timestampl,\n      lv_end TYPE timestampl,\n      lv_diff TYPE p DECIMALS 6.\n\n\" Iniciar medi\u00e7\u00e3o\nGET TIME STAMP FIELD lv_start.\n\n\" C\u00f3digo a medir\nSELECT * FROM sflight INTO TABLE @DATA(lt_voos) UP TO 10000 ROWS.\n\nLOOP AT lt_voos INTO DATA(ls_voo).\n  \" Processar\nENDLOOP.\n\n\" Fim da medi\u00e7\u00e3o\nGET TIME STAMP FIELD lv_end.\n\n\" Calcular diferen\u00e7a\nlv_diff = lv_end - lv_start.\n\nWRITE: / |Tempo decorrido: { lv_diff } segundos|.\n</code></pre>","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#interpretar-resultados","title":"\ud83d\udcca Interpretar Resultados","text":"","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#visao-geral_1","title":"Vis\u00e3o Geral","text":"<pre><code>Total Runtime: 2.5 segundos\nDatabase Time: 2.0 segundos (80%)\nABAP Time: 0.5 segundos (20%)\n</code></pre> <p>Interpreta\u00e7\u00e3o: - Se Database &gt; 70%: Otimizar SQL - Se ABAP &gt; 70%: Otimizar c\u00f3digo ABAP</p>","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#hit-list-lista-de-campeoes","title":"Hit List (Lista de Campe\u00f5es)","text":"<p>Mostra os m\u00e9todos/fun\u00e7\u00f5es mais lentos:</p> <pre><code>1. SELECT FROM SFLIGHT         - 1.8s (72%)\n2. LOOP AT lt_voos             - 0.3s (12%)\n3. APPEND TO lt_result         - 0.2s (8%)\n4. PERFORM calcular_total      - 0.2s (8%)\n</code></pre> <p>A\u00e7\u00e3o: Focar em otimizar os primeiros da lista!</p>","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#call-hierarchy","title":"Call Hierarchy","text":"<p>Mostra a \u00e1rvore de chamadas:</p> <pre><code>Z_PROGRAMA\n\u251c\u2500 SELECT FROM SFLIGHT (1.8s)\n\u251c\u2500 PERFORM processar_dados (0.5s)\n\u2502  \u251c\u2500 LOOP AT lt_voos (0.3s)\n\u2502  \u2514\u2500 APPEND (0.2s)\n\u2514\u2500 WRITE (0.2s)\n</code></pre>","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#exemplos-de-otimizacao","title":"\ud83d\udca1 Exemplos de Otimiza\u00e7\u00e3o","text":"","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#exemplo-1-select-lento","title":"Exemplo 1: SELECT Lento","text":"<p>Antes (Lento): <pre><code>\" \u274c 5 segundos\nSELECT * FROM sflight.\n  \" Processar linha a linha\nENDSELECT.\n</code></pre></p> <p>An\u00e1lise SAT: <pre><code>SELECT FROM SFLIGHT: 5.0s (100%)\n</code></pre></p> <p>Depois (R\u00e1pido): <pre><code>\" \u2705 0.5 segundos\nSELECT * FROM sflight INTO TABLE @DATA(lt_voos).\n\nLOOP AT lt_voos INTO DATA(ls_voo).\n  \" Processar\nENDLOOP.\n</code></pre></p> <p>Nova An\u00e1lise: <pre><code>SELECT FROM SFLIGHT: 0.5s (90%)\nLOOP: 0.05s (10%)\n</code></pre></p> <p>Melhoria: 10x mais r\u00e1pido!</p>","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#exemplo-2-for-all-entries-ineficiente","title":"Exemplo 2: FOR ALL ENTRIES Ineficiente","text":"<p>Antes: <pre><code>\" \u274c Lento se lt_docs estiver vazia\nSELECT * FROM ekpo\n  INTO TABLE @DATA(lt_items)\n  FOR ALL ENTRIES IN @lt_docs\n  WHERE ebeln = @lt_docs-ebeln.\n</code></pre></p> <p>An\u00e1lise: 3 segundos (tempo desperdi\u00e7ado)</p> <p>Depois: <pre><code>\" \u2705 Verificar antes\nIF lt_docs IS NOT INITIAL.\n  SELECT * FROM ekpo\n    INTO TABLE @DATA(lt_items)\n    FOR ALL ENTRIES IN @lt_docs\n    WHERE ebeln = @lt_docs-ebeln.\nENDIF.\n</code></pre></p> <p>Melhoria: Evita SELECT desnecess\u00e1rio</p>","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#exemplo-3-loop-lento","title":"Exemplo 3: LOOP Lento","text":"<p>Antes: <pre><code>\" \u274c Lento: O(n\u00b2)\nLOOP AT lt_vendas INTO DATA(ls_venda).\n  LOOP AT lt_clientes INTO DATA(ls_cliente).\n    IF ls_cliente-kunnr = ls_venda-kunnr.\n      \" Processar\n      EXIT.\n    ENDIF.\n  ENDLOOP.\nENDLOOP.\n</code></pre></p> <p>An\u00e1lise: 10 segundos para 1000 vendas</p> <p>Depois: <pre><code>\" \u2705 R\u00e1pido: O(n)\nLOOP AT lt_vendas INTO DATA(ls_venda).\n  READ TABLE lt_clientes INTO DATA(ls_cliente)\n    WITH KEY kunnr = ls_venda-kunnr\n    BINARY SEARCH.\n\n  IF sy-subrc = 0.\n    \" Processar\n  ENDIF.\nENDLOOP.\n</code></pre></p> <p>Melhoria: 10s \u2192 0.5s (20x mais r\u00e1pido!)</p>","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#funcionalidades-avancadas","title":"\ud83d\udee0\ufe0f Funcionalidades Avan\u00e7adas","text":"","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#1-comparar-medicoes","title":"1. Comparar Medi\u00e7\u00f5es","text":"<p>Cen\u00e1rio: Antes e depois de otimiza\u00e7\u00e3o</p> <ol> <li>SAT \u2192 Criar medi\u00e7\u00e3o \"ANTES\"</li> <li>Executar programa</li> <li>Otimizar c\u00f3digo</li> <li>SAT \u2192 Criar medi\u00e7\u00e3o \"DEPOIS\"</li> <li>Comparar resultados</li> </ol> <p>Resultado: <pre><code>ANTES:  10.0s\nDEPOIS:  1.0s\nMELHORIA: 10x\n</code></pre></p>","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#2-sql-trace","title":"2. SQL Trace","text":"<p>Ativar SQL Trace junto com SAT:</p> <ol> <li>SAT \u2192 Settings \u2192 SQL Trace: ON</li> <li>Executar medi\u00e7\u00e3o</li> <li>Ver queries SQL executadas</li> </ol> <p>Resultado: <pre><code>SELECT * FROM SFLIGHT - Executed 1 time - 2.0s\n  - Records fetched: 1000\n  - Identical selects: 0\n</code></pre></p>","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#3-memory-analysis","title":"3. Memory Analysis","text":"<p>Ver consumo de mem\u00f3ria:</p> <ol> <li>SAT \u2192 Settings \u2192 Memory Analysis: ON</li> <li>Executar</li> <li>Ver picos de mem\u00f3ria</li> </ol>","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#metricas-importantes","title":"\ud83d\udcc8 M\u00e9tricas Importantes","text":"","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#database-time","title":"Database Time","text":"<p>Alto (&gt;70%): - Otimizar SELECTs - Adicionar \u00edndices - Usar JOIN em vez de FOR ALL ENTRIES - Limitar quantidade de dados</p> <p>Baixo (&lt;30%): - Bom! C\u00f3digo ABAP est\u00e1 eficiente</p>","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#abap-processing-time","title":"ABAP Processing Time","text":"<p>Alto (&gt;70%): - Otimizar LOOPs - Usar tabelas HASHED/SORTED - Evitar loops aninhados - Usar express\u00f5es modernas</p>","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#number-of-database-accesses","title":"Number of Database Accesses","text":"<p>Alto (&gt;100): - Consolidar SELECTs - Usar JOIN - Buffer tables quando poss\u00edvel</p>","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#exemplo-completo","title":"\ud83d\udca1 Exemplo Completo","text":"","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#programa-lento","title":"Programa Lento","text":"<pre><code>REPORT z_lento.\n\nDATA: lt_vendas TYPE TABLE OF vbak,\n      lt_items TYPE TABLE OF vbap,\n      lt_clientes TYPE TABLE OF kna1.\n\nSTART-OF-SELECTION.\n\n  \" \u274c Problema 1: SELECT sem limite\n  SELECT * FROM vbak INTO TABLE lt_vendas.\n\n  \" \u274c Problema 2: SELECT dentro de LOOP\n  LOOP AT lt_vendas INTO DATA(ls_venda).\n    SELECT * FROM vbap INTO TABLE lt_items\n      WHERE vbeln = ls_venda-vbeln.\n\n    \" \u274c Problema 3: LOOP aninhado sem otimiza\u00e7\u00e3o\n    LOOP AT lt_items INTO DATA(ls_item).\n      SELECT SINGLE * FROM kna1 INTO DATA(ls_cliente)\n        WHERE kunnr = ls_venda-kunnr.\n\n      WRITE: / ls_cliente-name1, ls_item-matnr.\n    ENDLOOP.\n  ENDLOOP.\n</code></pre> <p>An\u00e1lise SAT: <pre><code>Total: 45 segundos\nDatabase: 40s (89%)\n  - SELECT FROM VBAK: 5s\n  - SELECT FROM VBAP: 20s (1000 vezes!)\n  - SELECT FROM KNA1: 15s (5000 vezes!)\n</code></pre></p>","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#programa-otimizado","title":"Programa Otimizado","text":"<pre><code>REPORT z_rapido.\n\nDATA: lt_vendas TYPE TABLE OF vbak,\n      lt_items TYPE TABLE OF vbap,\n      lt_clientes TYPE HASHED TABLE OF kna1\n                   WITH UNIQUE KEY kunnr.\n\nSTART-OF-SELECTION.\n\n  \" \u2705 Melhoria 1: Limitar quantidade\n  SELECT * FROM vbak INTO TABLE lt_vendas\n    UP TO 1000 ROWS.\n\n  \" \u2705 Melhoria 2: SELECT \u00fanico com FOR ALL ENTRIES\n  IF lt_vendas IS NOT INITIAL.\n    SELECT * FROM vbap INTO TABLE lt_items\n      FOR ALL ENTRIES IN lt_vendas\n      WHERE vbeln = lt_vendas-vbeln.\n\n    \" \u2705 Melhoria 3: Buscar clientes de uma vez\n    SELECT * FROM kna1 INTO TABLE lt_clientes\n      FOR ALL ENTRIES IN lt_vendas\n      WHERE kunnr = lt_vendas-kunnr.\n  ENDIF.\n\n  \" \u2705 Melhoria 4: Ordenar para BINARY SEARCH\n  SORT lt_items BY vbeln.\n\n  \" \u2705 Melhoria 5: Usar tabela HASHED\n  LOOP AT lt_vendas INTO DATA(ls_venda).\n    LOOP AT lt_items INTO DATA(ls_item)\n      WHERE vbeln = ls_venda-vbeln.\n\n      \" \u2705 Melhoria 6: READ TABLE em HASHED\n      READ TABLE lt_clientes INTO DATA(ls_cliente)\n        WITH TABLE KEY kunnr = ls_venda-kunnr.\n\n      IF sy-subrc = 0.\n        WRITE: / ls_cliente-name1, ls_item-matnr.\n      ENDIF.\n    ENDLOOP.\n  ENDLOOP.\n</code></pre> <p>Nova An\u00e1lise: <pre><code>Total: 2 segundos\nDatabase: 1.5s (75%)\n  - SELECT FROM VBAK: 0.5s\n  - SELECT FROM VBAP: 0.5s (1 vez!)\n  - SELECT FROM KNA1: 0.5s (1 vez!)\nABAP: 0.5s (25%)\n</code></pre></p> <p>Resultado: 45s \u2192 2s = 22.5x mais r\u00e1pido!</p>","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#boas-praticas","title":"\ud83c\udf93 Boas Pr\u00e1ticas","text":"","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Medir antes de otimizar\n\" N\u00e3o otimize \u00e0s cegas!\n\n\" 2. Focar nos 20% que causam 80% do problema\n\" Hit List no SAT mostra isto\n\n\" 3. Comparar antes/depois\nDATA lv_antes TYPE p DECIMALS 6.\nDATA lv_depois TYPE p DECIMALS 6.\n\n\" 4. Documentar melhorias\n\" Comentar: \"Otimizado de 10s para 1s\"\n</code></pre>","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Otimizar sem medir\n\" \"Acho que este c\u00f3digo est\u00e1 lento\" \u274c\n\n\" 2. Micro-otimiza\u00e7\u00f5es prematuras\nlv_x = lv_y + 1.  \" \u2705 Leg\u00edvel\nlv_x += 1.        \" \u2705 Tamb\u00e9m OK\n\" Diferen\u00e7a \u00e9 insignificante!\n\n\" 3. Ignorar resultados\n\" SAT diz: \"SELECT lento\" mas n\u00e3o corrige \u274c\n\n\" 4. N\u00e3o testar ap\u00f3s otimiza\u00e7\u00e3o\n\" Otimizou mas quebrou funcionalidade \u274c\n</code></pre>","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#transactions-relacionadas","title":"\ud83d\udd17 Transactions Relacionadas","text":"<ul> <li>SAT / SE30 - Runtime Analysis</li> <li>ST05 - SQL Trace (detalhado)</li> <li>ST12 - Performance Trace (completo)</li> <li>ST22 - Dumps (ap\u00f3s otimiza\u00e7\u00e3o falhar)</li> </ul>","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/5_sat/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>Performance - T\u00e9cnicas de otimiza\u00e7\u00e3o</li> <li>SQL Otimiza\u00e7\u00f5es - Otimizar queries</li> <li>FOR ALL ENTRIES - Usar corretamente</li> </ul> <p>Tags: <code>#Performance</code> <code>#SAT</code> <code>#RuntimeAnalysis</code> <code>#Otimiza\u00e7\u00e3o</code> <code>#ABAP</code></p>","tags":["ABAP","Performance","SAT","Runtime Analysis","Otimiza\u00e7\u00e3o"]},{"location":"debug/6_debug_jobs/","title":"Debug de Jobs em Background","text":"","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Debugar jobs em background requer t\u00e9cnicas especiais, pois n\u00e3o t\u00eam interface visual e executam em processos separados.</p>","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#desafios","title":"\ud83c\udfaf Desafios","text":"<ul> <li>\u274c N\u00e3o h\u00e1 interface gr\u00e1fica</li> <li>\u274c Executam em processo separado</li> <li>\u274c Podem executar em servidor diferente</li> <li>\u274c Podem executar fora do hor\u00e1rio de trabalho</li> <li>\u2705 Mas \u00e9 poss\u00edvel debugar!</li> </ul>","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#metodo-1-jdbg-recomendado","title":"\ud83d\udd39 M\u00e9todo 1: JDBG (Recomendado)","text":"","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#comando-magico","title":"Comando M\u00e1gico","text":"<p>Adicionar <code>JDBG</code> na variante ou nos par\u00e2metros:</p> <ol> <li>SM37 \u2192 Selecionar job</li> <li>Job \u2192 Change</li> <li>Start \u2192 Immediate</li> <li>No campo ABAP Program:    <pre><code>JDBG\n</code></pre></li> <li>Salvar e liberar job</li> </ol>","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#quando-executar","title":"Quando Executar","text":"<p>O job espera pelo debugger quando inicia.</p> <p>Passos: 1. Libertar job 2. SM37 \u2192 Refresh at\u00e9 status \"Active\" 3. SM50 \u2192 Selecionar processo do job 4. Program/Mode \u2192 Debugging 5. Debugger abre!</p>","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#metodo-2-breakpoint-de-utilizador","title":"\ud83d\udd39 M\u00e9todo 2: Breakpoint de Utilizador","text":"","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#configurar-breakpoint","title":"Configurar Breakpoint","text":"<ol> <li>Abrir programa no SE38/SE80</li> <li>Colocar breakpoint (F7) na linha desejada</li> <li>Breakpoint deve ser externo (n\u00e3o session)</li> </ol>","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#ativar-debug-para-jobs","title":"Ativar Debug para Jobs","text":"<pre><code>Menu: Utilities \u2192 Settings \u2192 ABAP Editor \u2192 Debugging\n\u2611 Debugging with External Breakpoints\n</code></pre>","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#executar-job","title":"Executar Job","text":"<ol> <li>Libertar job normalmente</li> <li>Quando job atingir breakpoint, aparece notifica\u00e7\u00e3o</li> <li>Aceitar e debugger abre</li> </ol> <p>Nota: Funciona apenas se job executar no mesmo servidor!</p>","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#metodo-3-sm37-direct-debug","title":"\ud83d\udd39 M\u00e9todo 3: SM37 Direct Debug","text":"","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#para-jobs-agendados","title":"Para Jobs Agendados","text":"<ol> <li>SM37 \u2192 Encontrar job</li> <li>Antes de libertar, marcar checkbox:    <pre><code>\u2611 Start with debugging\n</code></pre></li> <li>Libertar job</li> <li>Job para na primeira linha execut\u00e1vel</li> </ol>","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#exemplo-pratico","title":"\ud83d\udca1 Exemplo Pr\u00e1tico","text":"","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#programa-de-background","title":"Programa de Background","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_JOB_EXEMPLO\n*&amp;---------------------------------------------------------------------*\nREPORT z_job_exemplo.\n\nPARAMETERS: p_days TYPE i DEFAULT 30.\n\nDATA: lt_voos TYPE TABLE OF sflight,\n      lv_count TYPE i.\n\nSTART-OF-SELECTION.\n\n  \" \ud83d\udd0d Breakpoint aqui para debug\n  SELECT * FROM sflight INTO TABLE lt_voos\n    WHERE fldate &gt;= @( sy-datum - p_days ).\n\n  lv_count = lines( lt_voos ).\n\n  \" \ud83d\udd0d Breakpoint aqui tamb\u00e9m\n  IF lv_count &gt; 0.\n    WRITE: / |Encontrados { lv_count } voos|.\n  ELSE.\n    WRITE: / 'Nenhum voo encontrado'.\n  ENDIF.\n</code></pre>","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#agendar-com-debug","title":"Agendar com Debug","text":"<p>SM36: 1. Nome do job: <code>Z_DEBUG_VOOS</code> 2. Programa: <code>Z_JOB_EXEMPLO</code> 3. Variante: (criar com p_days = 30) 4. Especificar campo adicional: <code>JDBG</code> 5. Start condition: Immediate 6. Salvar</p> <p>Debugar: 1. SM37 \u2192 Procurar <code>Z_DEBUG_VOOS</code> 2. Status: Scheduled \u2192 Released 3. Aguardar status: Active 4. SM50 \u2192 Encontrar processo 5. Program/Mode \u2192 Debugging</p>","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#troubleshooting","title":"\ud83d\udee0\ufe0f Troubleshooting","text":"","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#job-nao-para-no-breakpoint","title":"Job N\u00e3o Para no Breakpoint","text":"<p>Causa 1: Servidor diferente - \u2705 Solu\u00e7\u00e3o: Usar JDBG</p> <p>Causa 2: Breakpoint n\u00e3o \u00e9 externo - \u2705 Solu\u00e7\u00e3o: Settings \u2192 External Breakpoints</p> <p>Causa 3: Job j\u00e1 executou - \u2705 Solu\u00e7\u00e3o: Reagendar</p>","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#nao-consigo-aceitar-debug","title":"N\u00e3o Consigo Aceitar Debug","text":"<p>Causa: Pop-up perdido ou fechado</p> <p>Solu\u00e7\u00e3o: <pre><code>SM50 \u2192 Selecionar processo \u2192 Debugging (for\u00e7ar)\n</code></pre></p>","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#job-fica-preso","title":"Job Fica Preso","text":"<p>Causa: Debug ativo mas n\u00e3o acedido</p> <p>Solu\u00e7\u00e3o: <pre><code>SM50 \u2192 Processo \u2192 Cancel with Core (\u00faltimo recurso)\n</code></pre></p>","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#debug-de-job-periodico","title":"\ud83d\udd39 Debug de Job Peri\u00f3dico","text":"","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#cenario","title":"Cen\u00e1rio","text":"<p>Job executa de hora em hora, precisa debugar a pr\u00f3xima execu\u00e7\u00e3o.</p> <p>Passos: 1. SM37 \u2192 Encontrar job peri\u00f3dico 2. Copiar job: Job \u2192 Copy 3. Modificar c\u00f3pia:    - Start: Immediate    - Adicionar: JDBG 4. Libertar c\u00f3pia 5. Debugar c\u00f3pia (n\u00e3o afeta original)</p>","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#boas-praticas","title":"\ud83d\udca1 Boas Pr\u00e1ticas","text":"","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Log detalhado em jobs\nWRITE: / |{ sy-datum } { sy-uzeit }: Iniciando processamento|.\nWRITE: / |Par\u00e2metros: p_days = { p_days }|.\n\n\" 2. Usar Application Log (BAL)\nDATA: lo_log TYPE REF TO cl_application_log.\nlo_log-&gt;add_message( 'Processando...' ).\n\n\" 3. Verificar vari\u00e1veis de ambiente\nIF sy-batch = 'X'.\n  \" Executando em background\n  WRITE: / 'Modo batch ativo'.\nENDIF.\n\n\" 4. Tratamento de erros robusto\nTRY.\n    \" Processar\n  CATCH cx_root INTO DATA(lo_ex).\n    WRITE: / lo_ex-&gt;get_text( ).\nENDTRY.\n</code></pre>","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. BREAK-POINT em jobs de produ\u00e7\u00e3o\nBREAK-POINT.  \" \u274c Job fica preso!\n\n\" 2. Debug em hor\u00e1rio de produ\u00e7\u00e3o\n\" Pode afetar outros utilizadores\n\n\" 3. Job sem log\n\" Imposs\u00edvel saber o que aconteceu\n\n\" 4. Timeout longo em debug\n\" Job pode ser cancelado pelo sistema\n</code></pre>","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#monitorizacao-de-jobs","title":"\ud83d\udcca Monitoriza\u00e7\u00e3o de Jobs","text":"","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#sm37-job-overview","title":"SM37 - Job Overview","text":"<pre><code>- Status:\n  \u25cf Scheduled: Agendado\n  \u25cf Released: Libertado\n  \u25cf Active: Executando\n  \u25cf Finished: Conclu\u00eddo\n  \u25cf Cancelled: Cancelado\n</code></pre>","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#ver-spoollog","title":"Ver Spool/Log","text":"<ol> <li>SM37 \u2192 Selecionar job</li> <li>Spool list \u2192 Ver output</li> <li>Job log \u2192 Ver mensagens sistema</li> </ol>","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#sm50-process-overview","title":"SM50 - Process Overview","text":"<p>Ver processos ativos em tempo real: <pre><code>- Processo do job\n- Tempo de execu\u00e7\u00e3o\n- Utilizador\n- Status\n</code></pre></p>","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#exemplo-log-de-aplicacao","title":"\ud83d\udd39 Exemplo: Log de Aplica\u00e7\u00e3o","text":"<pre><code>REPORT z_job_com_log.\n\nDATA: lo_log TYPE REF TO cl_log.\n\nSTART-OF-SELECTION.\n\n  \" Criar log\n  TRY.\n      cl_log=&gt;create(\n        EXPORTING\n          object = 'ZJOB'\n          subobject = 'PROC'\n        RECEIVING\n          log = lo_log\n      ).\n    CATCH cx_log.\n      RETURN.\n  ENDTRY.\n\n  \" Adicionar mensagens\n  lo_log-&gt;add_msg( 'Iniciando processamento...' ).\n\n  TRY.\n      SELECT * FROM sflight INTO TABLE @DATA(lt_voos) UP TO 100 ROWS.\n\n      lo_log-&gt;add_msg( |Processados { lines( lt_voos ) } registos| ).\n\n    CATCH cx_sy_sql_error INTO DATA(lo_sql_ex).\n      lo_log-&gt;add_msg(\n        msgty = 'E'\n        msgtext = lo_sql_ex-&gt;get_text( )\n      ).\n  ENDTRY.\n\n  \" Salvar log\n  lo_log-&gt;save( ).\n\n  \" Ver log: SLG1\n  WRITE: / 'Log salvo em SLG1 - Object: ZJOB'.\n</code></pre>","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#transactions-uteis","title":"\ud83d\udd17 Transactions \u00dateis","text":"<ul> <li>SM36 - Agendar jobs</li> <li>SM37 - Monitorizar jobs</li> <li>SM50 - Process overview (debug ativo)</li> <li>SLG1 - Application log viewer</li> <li>SE38 - Executar programa (teste antes)</li> </ul>","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"debug/6_debug_jobs/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>Breakpoints - Usar breakpoints eficientemente</li> <li>ST22 - Analisar dumps de jobs</li> <li>SAT - Medir performance de jobs</li> </ul> <p>Tags: <code>#Debug</code> <code>#BackgroundJobs</code> <code>#SM37</code> <code>#JDBG</code> <code>#ABAP</code></p>","tags":["ABAP","Debug","Background Jobs","SM37"]},{"location":"exemplos/","title":"Exemplos Pr\u00e1ticos ABAP","text":"<p>Esta se\u00e7\u00e3o apresenta programas completos e funcionais que integram m\u00faltiplos conceitos ABAP. Cada exemplo \u00e9 auto-contido, documentado e pronto para uso, demonstrando boas pr\u00e1ticas de desenvolvimento.</p>","tags":["Exemplos","Reports","Programas","ALV","Integra\u00e7\u00e3o","Completo"]},{"location":"exemplos/#exemplo-1-report-de-consulta-com-alv-grid","title":"Exemplo 1: Report de Consulta com ALV Grid","text":"<p>Report interativo que busca pedidos de venda com filtros din\u00e2micos e exibe em ALV Grid com funcionalidades avan\u00e7adas.</p> <pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_SALES_ORDER_REPORT\n*&amp;---------------------------------------------------------------------*\n*&amp; Descri\u00e7\u00e3o: Report de consulta de pedidos de venda com ALV\n*&amp; Funcionalidades:\n*&amp;   - Filtros de sele\u00e7\u00e3o (data, cliente, material)\n*&amp;   - ALV Grid interativo com duplo clique\n*&amp;   - Exporta\u00e7\u00e3o para Excel\n*&amp;   - Navega\u00e7\u00e3o para VA03 (exibir pedido)\n*&amp;   - C\u00e1lculo de totais\n*&amp;---------------------------------------------------------------------*\nREPORT z_sales_order_report.\n\n*----------------------------------------------------------------------*\n* Type Definitions\n*----------------------------------------------------------------------*\nTYPES: BEGIN OF ty_output,\n         vbeln     TYPE vbak-vbeln,      \" Pedido\n         erdat     TYPE vbak-erdat,      \" Data cria\u00e7\u00e3o\n         kunnr     TYPE vbak-kunnr,      \" Cliente\n         name1     TYPE kna1-name1,      \" Nome cliente\n         posnr     TYPE vbap-posnr,      \" Item\n         matnr     TYPE vbap-matnr,      \" Material\n         maktx     TYPE makt-maktx,      \" Descri\u00e7\u00e3o material\n         kwmeng    TYPE vbap-kwmeng,     \" Quantidade\n         netwr     TYPE vbap-netwr,      \" Valor l\u00edquido\n         waerk     TYPE vbap-waerk,      \" Moeda\n         icon      TYPE icon_d,          \" \u00cdcone de status\n         cellcolor TYPE lvc_t_scol,      \" Cores de c\u00e9lula\n       END OF ty_output.\n\nTYPES: tt_output TYPE STANDARD TABLE OF ty_output WITH DEFAULT KEY.\n\n*----------------------------------------------------------------------*\n* Data Declarations\n*----------------------------------------------------------------------*\nDATA: gt_output  TYPE tt_output,\n      gt_fcat    TYPE lvc_t_fcat,\n      gs_layout  TYPE lvc_s_layo,\n      go_alv     TYPE REF TO cl_salv_table.\n\n*----------------------------------------------------------------------*\n* Selection Screen\n*----------------------------------------------------------------------*\nSELECTION-SCREEN BEGIN OF BLOCK b1 WITH FRAME TITLE TEXT-001.\n  \" Per\u00edodo\n  SELECT-OPTIONS: s_erdat FOR vbak-erdat DEFAULT sy-datum TO sy-datum.\n\n  \" Cliente\n  SELECT-OPTIONS: s_kunnr FOR vbak-kunnr.\n\n  \" Material\n  SELECT-OPTIONS: s_matnr FOR vbap-matnr.\n\n  \" Par\u00e2metros adicionais\n  PARAMETERS: p_max TYPE i DEFAULT 500 OBLIGATORY.  \" M\u00e1ximo de registros\nSELECTION-SCREEN END OF BLOCK b1.\n\n*----------------------------------------------------------------------*\n* Initialization\n*----------------------------------------------------------------------*\nINITIALIZATION.\n  \" Textos da tela de sele\u00e7\u00e3o\n  TEXT-001 = 'Filtros de Sele\u00e7\u00e3o'.\n\n*----------------------------------------------------------------------*\n* At Selection Screen\n*----------------------------------------------------------------------*\nAT SELECTION-SCREEN.\n  \" Valida\u00e7\u00f5es\n  IF p_max &lt;= 0.\n    MESSAGE 'M\u00e1ximo de registros deve ser maior que zero' TYPE 'E'.\n  ENDIF.\n\n  IF p_max &gt; 10000.\n    MESSAGE 'M\u00e1ximo de registros n\u00e3o pode exceder 10.000' TYPE 'W'.\n  ENDIF.\n\n*----------------------------------------------------------------------*\n* Start of Selection\n*----------------------------------------------------------------------*\nSTART-OF-SELECTION.\n  PERFORM fetch_data.\n  PERFORM enrich_data.\n  PERFORM calculate_totals.\n\nEND-OF-SELECTION.\n  PERFORM display_alv.\n\n*----------------------------------------------------------------------*\n* Form FETCH_DATA\n*----------------------------------------------------------------------*\nFORM fetch_data.\n  DATA: lt_vbak TYPE TABLE OF vbak,\n        lt_vbap TYPE TABLE OF vbap.\n\n  \" Buscar cabe\u00e7alhos de pedidos\n  SELECT * FROM vbak\n    WHERE erdat IN @s_erdat\n      AND kunnr IN @s_kunnr\n    INTO TABLE @lt_vbak\n    UP TO @p_max ROWS.\n\n  IF lt_vbak IS INITIAL.\n    MESSAGE 'Nenhum pedido encontrado com os crit\u00e9rios informados' TYPE 'S'.\n    LEAVE LIST-PROCESSING.\n  ENDIF.\n\n  \" Buscar itens dos pedidos\n  SELECT * FROM vbap\n    FOR ALL ENTRIES IN @lt_vbak\n    WHERE vbeln = @lt_vbak-vbeln\n      AND matnr IN @s_matnr\n    INTO TABLE @lt_vbap.\n\n  IF lt_vbap IS INITIAL.\n    MESSAGE 'Nenhum item encontrado com os materiais informados' TYPE 'S'.\n    LEAVE LIST-PROCESSING.\n  ENDIF.\n\n  \" Combinar dados de cabe\u00e7alho e item\n  LOOP AT lt_vbap INTO DATA(ls_vbap).\n    READ TABLE lt_vbak INTO DATA(ls_vbak)\n      WITH KEY vbeln = ls_vbap-vbeln.\n\n    CHECK sy-subrc = 0.\n\n    APPEND VALUE #(\n      vbeln  = ls_vbap-vbeln\n      erdat  = ls_vbak-erdat\n      kunnr  = ls_vbak-kunnr\n      posnr  = ls_vbap-posnr\n      matnr  = ls_vbap-matnr\n      kwmeng = ls_vbap-kwmeng\n      netwr  = ls_vbap-netwr\n      waerk  = ls_vbap-waerk\n    ) TO gt_output.\n  ENDLOOP.\n\n  \" Mensagem de progresso\n  MESSAGE |{ lines( gt_output ) } itens carregados| TYPE 'S'.\nENDFORM.\n\n*----------------------------------------------------------------------*\n* Form ENRICH_DATA\n*----------------------------------------------------------------------*\nFORM enrich_data.\n  DATA: lt_kna1 TYPE TABLE OF kna1,\n        lt_makt TYPE TABLE OF makt.\n\n  CHECK gt_output IS NOT INITIAL.\n\n  \" Buscar nomes de clientes\n  SELECT kunnr, name1 FROM kna1\n    FOR ALL ENTRIES IN @gt_output\n    WHERE kunnr = @gt_output-kunnr\n    INTO TABLE @lt_kna1.\n\n  \" Buscar descri\u00e7\u00f5es de materiais\n  SELECT matnr, maktx FROM makt\n    FOR ALL ENTRIES IN @gt_output\n    WHERE matnr = @gt_output-matnr\n      AND spras = @sy-langu\n    INTO TABLE @lt_makt.\n\n  \" Criar tabelas HASHED para lookup r\u00e1pido\n  DATA(lt_kna1_hash) = VALUE ty_t_kna1_hash(\n    FOR ls_kna1 IN lt_kna1 ( ls_kna1 )\n  ).\n\n  DATA(lt_makt_hash) = VALUE ty_t_makt_hash(\n    FOR ls_makt IN lt_makt ( ls_makt )\n  ).\n\n  \" Enriquecer dados principais\n  LOOP AT gt_output ASSIGNING FIELD-SYMBOL(&lt;fs_output&gt;).\n    \" Nome do cliente\n    READ TABLE lt_kna1_hash INTO DATA(ls_kna1)\n      WITH TABLE KEY kunnr = &lt;fs_output&gt;-kunnr.\n    IF sy-subrc = 0.\n      &lt;fs_output&gt;-name1 = ls_kna1-name1.\n    ENDIF.\n\n    \" Descri\u00e7\u00e3o do material\n    READ TABLE lt_makt_hash INTO DATA(ls_makt)\n      WITH TABLE KEY matnr = &lt;fs_output&gt;-matnr.\n    IF sy-subrc = 0.\n      &lt;fs_output&gt;-maktx = ls_makt-maktx.\n    ENDIF.\n\n    \" Adicionar \u00edcone baseado no valor\n    IF &lt;fs_output&gt;-netwr &gt;= 10000.\n      &lt;fs_output&gt;-icon = icon_led_green.      \" Alto valor\n    ELSEIF &lt;fs_output&gt;-netwr &gt;= 5000.\n      &lt;fs_output&gt;-icon = icon_led_yellow.     \" M\u00e9dio valor\n    ELSE.\n      &lt;fs_output&gt;-icon = icon_led_red.        \" Baixo valor\n    ENDIF.\n\n    \" Colorir linha se valor muito alto\n    IF &lt;fs_output&gt;-netwr &gt;= 50000.\n      &lt;fs_output&gt;-cellcolor = VALUE #(\n        ( fname = 'NETWR'\n          color-col = 5   \" Verde\n          color-int = 0\n          color-inv = 0 )\n      ).\n    ENDIF.\n  ENDLOOP.\nENDFORM.\n\n*----------------------------------------------------------------------*\n* Form CALCULATE_TOTALS\n*----------------------------------------------------------------------*\nFORM calculate_totals.\n  DATA: lv_total_value TYPE p DECIMALS 2,\n        lv_total_qty   TYPE p DECIMALS 2,\n        lv_orders      TYPE i.\n\n  \" Calcular totais\n  LOOP AT gt_output INTO DATA(ls_output).\n    lv_total_value = lv_total_value + ls_output-netwr.\n    lv_total_qty   = lv_total_qty + ls_output-kwmeng.\n  ENDLOOP.\n\n  \" Contar pedidos \u00fanicos\n  DATA(lt_unique_orders) = gt_output.\n  SORT lt_unique_orders BY vbeln.\n  DELETE ADJACENT DUPLICATES FROM lt_unique_orders COMPARING vbeln.\n  lv_orders = lines( lt_unique_orders ).\n\n  \" Exibir resumo\n  WRITE: / 'RESUMO DA SELE\u00c7\u00c3O',\n         / '-' FILLING sy-linsz,\n         / 'Total de Pedidos:', lv_orders,\n         / 'Total de Itens:', lines( gt_output ),\n         / 'Valor Total:', lv_total_value CURRENCY 'BRL',\n         / 'Quantidade Total:', lv_total_qty,\n         / '-' FILLING sy-linsz.\n  SKIP.\nENDFORM.\n\n*----------------------------------------------------------------------*\n* Form DISPLAY_ALV\n*----------------------------------------------------------------------*\nFORM display_alv.\n  TRY.\n      \" Criar inst\u00e2ncia ALV\n      cl_salv_table=&gt;factory(\n        IMPORTING\n          r_salv_table = go_alv\n        CHANGING\n          t_table      = gt_output\n      ).\n\n      \" Configurar fun\u00e7\u00f5es\n      DATA(lo_functions) = go_alv-&gt;get_functions( ).\n      lo_functions-&gt;set_all( abap_true ).\n\n      \" Configurar colunas\n      DATA(lo_columns) = go_alv-&gt;get_columns( ).\n      lo_columns-&gt;set_optimize( abap_true ).\n\n      \" Configurar \u00edcones\n      TRY.\n          DATA(lo_column) = lo_columns-&gt;get_column( 'ICON' ).\n          lo_column-&gt;set_icon( abap_true ).\n          lo_column-&gt;set_long_text( 'Status' ).\n          lo_column-&gt;set_medium_text( 'Status' ).\n          lo_column-&gt;set_short_text( 'St.' ).\n        CATCH cx_salv_not_found.\n      ENDTRY.\n\n      \" Configurar cores\n      TRY.\n          lo_column = lo_columns-&gt;get_column( 'CELLCOLOR' ).\n          lo_column-&gt;set_technical( abap_true ).\n        CATCH cx_salv_not_found.\n      ENDTRY.\n\n      \" Configurar layout\n      DATA(lo_display) = go_alv-&gt;get_display_settings( ).\n      lo_display-&gt;set_striped_pattern( abap_true ).\n      lo_display-&gt;set_list_header( 'Relat\u00f3rio de Pedidos de Venda' ).\n\n      \" Configurar sele\u00e7\u00e3o\n      DATA(lo_selections) = go_alv-&gt;get_selections( ).\n      lo_selections-&gt;set_selection_mode( if_salv_c_selection_mode=&gt;row_column ).\n\n      \" Evento de duplo clique\n      DATA(lo_events) = go_alv-&gt;get_event( ).\n      SET HANDLER on_double_click FOR lo_events.\n\n      \" Exibir ALV\n      go_alv-&gt;display( ).\n\n    CATCH cx_salv_msg INTO DATA(lx_salv).\n      MESSAGE lx_salv-&gt;get_text( ) TYPE 'E'.\n  ENDTRY.\nENDFORM.\n\n*----------------------------------------------------------------------*\n* Event Handler: Double Click\n*----------------------------------------------------------------------*\nCLASS lcl_event_handler DEFINITION.\n  PUBLIC SECTION.\n    CLASS-METHODS:\n      on_double_click FOR EVENT double_click OF cl_salv_events_table\n        IMPORTING row column.\nENDCLASS.\n\nCLASS lcl_event_handler IMPLEMENTATION.\n  METHOD on_double_click.\n    READ TABLE gt_output INTO DATA(ls_output) INDEX row.\n    CHECK sy-subrc = 0.\n\n    \" Se clicar na coluna de pedido, navegar para VA03\n    IF column = 'VBELN'.\n      SET PARAMETER ID 'AUN' FIELD ls_output-vbeln.\n      CALL TRANSACTION 'VA03' AND SKIP FIRST SCREEN.\n    ENDIF.\n\n    \" Se clicar na coluna de material, navegar para MM03\n    IF column = 'MATNR'.\n      SET PARAMETER ID 'MAT' FIELD ls_output-matnr.\n      CALL TRANSACTION 'MM03' AND SKIP FIRST SCREEN.\n    ENDIF.\n  ENDMETHOD.\nENDCLASS.\n\n*----------------------------------------------------------------------*\n* Type Definitions for Hashed Tables\n*----------------------------------------------------------------------*\nTYPES: BEGIN OF ty_kna1_hash,\n         kunnr TYPE kunnr,\n         name1 TYPE name1,\n       END OF ty_kna1_hash,\n       ty_t_kna1_hash TYPE HASHED TABLE OF ty_kna1_hash\n         WITH UNIQUE KEY kunnr.\n\nTYPES: BEGIN OF ty_makt_hash,\n         matnr TYPE matnr,\n         maktx TYPE maktx,\n       END OF ty_makt_hash,\n       ty_t_makt_hash TYPE HASHED TABLE OF ty_makt_hash\n         WITH UNIQUE KEY matnr.\n</code></pre> <p>Conceitos Aplicados</p> <ul> <li>SQL Otimizado: FOR ALL ENTRIES, HASHED tables para lookup</li> <li>ALV SALV: Grid moderno com eventos</li> <li>Selection Screen: Filtros din\u00e2micos com valida\u00e7\u00e3o</li> <li>Performance: Minimiza\u00e7\u00e3o de acessos ao banco</li> <li>UX: \u00cdcones, cores, duplo clique para navega\u00e7\u00e3o</li> <li>C\u00e1lculos: Agrega\u00e7\u00f5es e estat\u00edsticas</li> </ul>","tags":["Exemplos","Reports","Programas","ALV","Integra\u00e7\u00e3o","Completo"]},{"location":"exemplos/#exemplo-2-job-automatico-de-processamento-em-massa","title":"Exemplo 2: Job Autom\u00e1tico de Processamento em Massa","text":"<p>Programa execut\u00e1vel em background que processa faturas pendentes automaticamente.</p> <pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_INVOICE_BATCH_PROCESSOR\n*&amp;---------------------------------------------------------------------*\n*&amp; Descri\u00e7\u00e3o: Processamento em massa de faturas pendentes\n*&amp; Funcionalidades:\n*&amp;   - Identificar faturas a processar\n*&amp;   - Validar dados antes do processamento\n*&amp;   - Processar em pacotes (commit work parcial)\n*&amp;   - Log de auditoria completo (Application Log - BAL)\n*&amp;   - Envio de email com resultado\n*&amp;   - Tratamento de erros robusto\n*&amp;---------------------------------------------------------------------*\nREPORT z_invoice_batch_processor.\n\n*----------------------------------------------------------------------*\n* Constants\n*----------------------------------------------------------------------*\nCONSTANTS: gc_package_size TYPE i VALUE 100,\n           gc_log_object   TYPE balobj_d VALUE 'ZFIN',\n           gc_log_subobj   TYPE balsubobj VALUE 'INVOICE_PROC'.\n\n*----------------------------------------------------------------------*\n* Types\n*----------------------------------------------------------------------*\nTYPES: BEGIN OF ty_invoice,\n         invoice_id   TYPE vbeln_vf,\n         customer_id  TYPE kunnr,\n         amount       TYPE wrbtr,\n         currency     TYPE waers,\n         status       TYPE char1,\n         error_msg    TYPE string,\n       END OF ty_invoice,\n       tt_invoices TYPE STANDARD TABLE OF ty_invoice WITH DEFAULT KEY.\n\n*----------------------------------------------------------------------*\n* Data\n*----------------------------------------------------------------------*\nDATA: gt_invoices     TYPE tt_invoices,\n      gv_log_handle   TYPE balloghndl,\n      gv_success_count TYPE i,\n      gv_error_count   TYPE i.\n\n*----------------------------------------------------------------------*\n* Selection Screen\n*----------------------------------------------------------------------*\nSELECTION-SCREEN BEGIN OF BLOCK b1 WITH FRAME TITLE TEXT-001.\n  PARAMETERS: p_bukrs TYPE bukrs DEFAULT '1000' OBLIGATORY,\n              p_datum TYPE datum DEFAULT sy-datum OBLIGATORY.\n\n  PARAMETERS: p_test  AS CHECKBOX DEFAULT 'X',  \" Modo teste\n              p_email TYPE ad_smtpadr.           \" Email para notifica\u00e7\u00e3o\nSELECTION-SCREEN END OF BLOCK b1.\n\n*----------------------------------------------------------------------*\n* Initialization\n*----------------------------------------------------------------------*\nINITIALIZATION.\n  TEXT-001 = 'Par\u00e2metros de Processamento'.\n\n*----------------------------------------------------------------------*\n* Start of Selection\n*----------------------------------------------------------------------*\nSTART-OF-SELECTION.\n  PERFORM initialize_log.\n  PERFORM select_invoices.\n  PERFORM validate_invoices.\n  PERFORM process_invoices.\n  PERFORM finalize_log.\n  PERFORM send_notification.\n\n*----------------------------------------------------------------------*\n* Form INITIALIZE_LOG\n*----------------------------------------------------------------------*\nFORM initialize_log.\n  DATA: ls_log TYPE bal_s_log.\n\n  \" Criar log de aplica\u00e7\u00e3o\n  ls_log-object    = gc_log_object.\n  ls_log-subobject = gc_log_subobj.\n  ls_log-extnumber = |{ sy-datum }{ sy-uzeit }|.\n  ls_log-aldate    = sy-datum.\n  ls_log-altime    = sy-uzeit.\n  ls_log-aluser    = sy-uname.\n  ls_log-alprog    = sy-repid.\n\n  CALL FUNCTION 'BAL_LOG_CREATE'\n    EXPORTING\n      i_s_log      = ls_log\n    IMPORTING\n      e_log_handle = gv_log_handle\n    EXCEPTIONS\n      OTHERS       = 1.\n\n  IF sy-subrc &lt;&gt; 0.\n    MESSAGE 'Erro ao criar log de aplica\u00e7\u00e3o' TYPE 'E'.\n  ENDIF.\n\n  \" Log de in\u00edcio\n  PERFORM add_log_message\n    EXPORTING\n      iv_msgty = 'I'\n      iv_text  = |Processamento iniciado - Empresa: { p_bukrs } - Data: { p_datum }|.\n\n  IF p_test = abap_true.\n    PERFORM add_log_message\n      EXPORTING\n        iv_msgty = 'W'\n        iv_text  = 'MODO TESTE - Nenhuma altera\u00e7\u00e3o ser\u00e1 gravada no banco'.\n  ENDIF.\nENDFORM.\n\n*----------------------------------------------------------------------*\n* Form SELECT_INVOICES\n*----------------------------------------------------------------------*\nFORM select_invoices.\n  \" Buscar faturas pendentes\n  \" (Exemplo simulado - adaptar para tabelas reais)\n  SELECT vbeln AS invoice_id,\n         kunag AS customer_id,\n         netwr AS amount,\n         waerk AS currency\n    FROM vbrk\n    WHERE fkart = 'F2'\n      AND bukrs = @p_bukrs\n      AND fkdat = @p_datum\n      AND rfbsk = 'A'  \" Status: Aguardando processamento\n    INTO CORRESPONDING FIELDS OF TABLE @gt_invoices\n    UP TO 1000 ROWS.\n\n  IF gt_invoices IS INITIAL.\n    PERFORM add_log_message\n      EXPORTING\n        iv_msgty = 'I'\n        iv_text  = 'Nenhuma fatura pendente encontrada'.\n    LEAVE PROGRAM.\n  ENDIF.\n\n  PERFORM add_log_message\n    EXPORTING\n      iv_msgty = 'S'\n      iv_text  = |{ lines( gt_invoices ) } faturas encontradas para processamento|.\nENDFORM.\n\n*----------------------------------------------------------------------*\n* Form VALIDATE_INVOICES\n*----------------------------------------------------------------------*\nFORM validate_invoices.\n  DATA: lv_invalid_count TYPE i.\n\n  LOOP AT gt_invoices ASSIGNING FIELD-SYMBOL(&lt;fs_invoice&gt;).\n    \" Validar montante\n    IF &lt;fs_invoice&gt;-amount &lt;= 0.\n      &lt;fs_invoice&gt;-status = 'E'.\n      &lt;fs_invoice&gt;-error_msg = 'Valor inv\u00e1lido (zero ou negativo)'.\n      lv_invalid_count = lv_invalid_count + 1.\n      CONTINUE.\n    ENDIF.\n\n    \" Validar cliente\n    SELECT SINGLE kunnr FROM kna1\n      WHERE kunnr = @&lt;fs_invoice&gt;-customer_id\n      INTO @DATA(lv_kunnr).\n\n    IF sy-subrc &lt;&gt; 0.\n      &lt;fs_invoice&gt;-status = 'E'.\n      &lt;fs_invoice&gt;-error_msg = 'Cliente n\u00e3o encontrado'.\n      lv_invalid_count = lv_invalid_count + 1.\n      CONTINUE.\n    ENDIF.\n\n    \" Valida\u00e7\u00e3o bem-sucedida\n    &lt;fs_invoice&gt;-status = 'V'.  \" Validado\n  ENDLOOP.\n\n  IF lv_invalid_count &gt; 0.\n    PERFORM add_log_message\n      EXPORTING\n        iv_msgty = 'W'\n        iv_text  = |{ lv_invalid_count } faturas com erros de valida\u00e7\u00e3o|.\n  ELSE.\n    PERFORM add_log_message\n      EXPORTING\n        iv_msgty = 'S'\n        iv_text  = 'Todas as faturas validadas com sucesso'.\n  ENDIF.\nENDFORM.\n\n*----------------------------------------------------------------------*\n* Form PROCESS_INVOICES\n*----------------------------------------------------------------------*\nFORM process_invoices.\n  DATA: lv_package_count TYPE i,\n        lt_package       TYPE tt_invoices.\n\n  LOOP AT gt_invoices INTO DATA(ls_invoice)\n    WHERE status = 'V'.  \" Apenas validadas\n\n    \" Adicionar ao pacote\n    APPEND ls_invoice TO lt_package.\n\n    \" Processar quando atingir tamanho do pacote\n    IF lines( lt_package ) &gt;= gc_package_size.\n      PERFORM process_package CHANGING lt_package.\n      lv_package_count = lv_package_count + 1.\n      CLEAR lt_package.\n    ENDIF.\n  ENDLOOP.\n\n  \" Processar pacote restante\n  IF lt_package IS NOT INITIAL.\n    PERFORM process_package CHANGING lt_package.\n    lv_package_count = lv_package_count + 1.\n  ENDIF.\n\n  PERFORM add_log_message\n    EXPORTING\n      iv_msgty = 'I'\n      iv_text  = |{ lv_package_count } pacotes processados|.\nENDFORM.\n\n*----------------------------------------------------------------------*\n* Form PROCESS_PACKAGE\n*----------------------------------------------------------------------*\nFORM process_package CHANGING ct_package TYPE tt_invoices.\n  LOOP AT ct_package ASSIGNING FIELD-SYMBOL(&lt;fs_invoice&gt;).\n    TRY.\n        \" L\u00f3gica de processamento da fatura\n        \" (Exemplo: chamar BAPI, atualizar tabelas, etc.)\n        PERFORM process_single_invoice CHANGING &lt;fs_invoice&gt;.\n\n        \" Sucesso\n        &lt;fs_invoice&gt;-status = 'S'.\n        gv_success_count = gv_success_count + 1.\n\n        PERFORM add_log_message\n          EXPORTING\n            iv_msgty = 'S'\n            iv_text  = |Fatura { &lt;fs_invoice&gt;-invoice_id } processada com sucesso|.\n\n      CATCH cx_root INTO DATA(lx_error).\n        \" Erro\n        &lt;fs_invoice&gt;-status = 'E'.\n        &lt;fs_invoice&gt;-error_msg = lx_error-&gt;get_text( ).\n        gv_error_count = gv_error_count + 1.\n\n        PERFORM add_log_message\n          EXPORTING\n            iv_msgty = 'E'\n            iv_text  = |Erro ao processar fatura { &lt;fs_invoice&gt;-invoice_id }: |\n                    &amp;&amp; |{ lx_error-&gt;get_text( ) }|.\n    ENDTRY.\n  ENDLOOP.\n\n  \" Commit parcial (se n\u00e3o estiver em modo teste)\n  IF p_test = abap_false.\n    COMMIT WORK AND WAIT.\n  ELSE.\n    ROLLBACK WORK.\n  ENDIF.\nENDFORM.\n\n*----------------------------------------------------------------------*\n* Form PROCESS_SINGLE_INVOICE\n*----------------------------------------------------------------------*\nFORM process_single_invoice CHANGING cs_invoice TYPE ty_invoice.\n  \" Simular processamento\n  \" Em produ\u00e7\u00e3o, chamar BAPI ou fun\u00e7\u00e3o de processamento real\n\n  \" Exemplo: BAPI_ACC_INVOICE_RECEIPT_POST\n  DATA: lt_return TYPE bapiret2_t.\n\n  \" Simular sucesso (adaptar para l\u00f3gica real)\n  IF cs_invoice-amount &gt; 100000.\n    \" Simular erro para valores muito altos\n    RAISE EXCEPTION TYPE cx_sy_arithmetic_overflow\n      EXPORTING\n        textid = VALUE #( msgid = 'ZMSG' msgno = '001'\n                          msgv1 = 'Valor excede limite permitido' ).\n  ENDIF.\n\n  \" Processamento bem-sucedido\n  \" (Aqui viria a l\u00f3gica real de processamento)\nENDFORM.\n\n*----------------------------------------------------------------------*\n* Form ADD_LOG_MESSAGE\n*----------------------------------------------------------------------*\nFORM add_log_message\n  EXPORTING\n    iv_msgty TYPE symsgty\n    iv_text  TYPE string.\n\n  DATA: ls_msg TYPE bal_s_msg.\n\n  ls_msg-msgty = iv_msgty.\n  ls_msg-msgid = 'ZMSG'.\n  ls_msg-msgno = '001'.\n  ls_msg-msgv1 = iv_text+0(50).\n  ls_msg-msgv2 = iv_text+50(50).\n  ls_msg-msgv3 = iv_text+100(50).\n  ls_msg-msgv4 = iv_text+150(50).\n\n  CALL FUNCTION 'BAL_LOG_MSG_ADD'\n    EXPORTING\n      i_log_handle = gv_log_handle\n      i_s_msg      = ls_msg\n    EXCEPTIONS\n      OTHERS       = 1.\nENDFORM.\n\n*----------------------------------------------------------------------*\n* Form FINALIZE_LOG\n*----------------------------------------------------------------------*\nFORM finalize_log.\n  \" Resumo final\n  DATA: lv_total TYPE i.\n\n  lv_total = gv_success_count + gv_error_count.\n\n  PERFORM add_log_message\n    EXPORTING\n      iv_msgty = 'I'\n      iv_text  = '--- RESUMO DO PROCESSAMENTO ---'.\n\n  PERFORM add_log_message\n    EXPORTING\n      iv_msgty = 'I'\n      iv_text  = |Total processado: { lv_total }|.\n\n  PERFORM add_log_message\n    EXPORTING\n      iv_msgty = 'S'\n      iv_text  = |Sucesso: { gv_success_count }|.\n\n  IF gv_error_count &gt; 0.\n    PERFORM add_log_message\n      EXPORTING\n        iv_msgty = 'E'\n        iv_text  = |Erros: { gv_error_count }|.\n  ENDIF.\n\n  \" Salvar log no banco\n  CALL FUNCTION 'BAL_DB_SAVE'\n    EXPORTING\n      i_save_all   = 'X'\n      i_log_handle = gv_log_handle\n    EXCEPTIONS\n      OTHERS       = 1.\n\n  COMMIT WORK.\n\n  \" Exibir log (se executado em foreground)\n  IF sy-batch = abap_false.\n    CALL FUNCTION 'BAL_DSP_LOG_DISPLAY'\n      EXPORTING\n        i_log_handle = gv_log_handle\n      EXCEPTIONS\n        OTHERS       = 1.\n  ENDIF.\nENDFORM.\n\n*----------------------------------------------------------------------*\n* Form SEND_NOTIFICATION\n*----------------------------------------------------------------------*\nFORM send_notification.\n  CHECK p_email IS NOT INITIAL.\n\n  DATA: lo_send_request TYPE REF TO cl_bcs,\n        lo_document     TYPE REF TO cl_document_bcs,\n        lo_recipient    TYPE REF TO if_recipient_bcs,\n        lt_body         TYPE bcsy_text.\n\n  TRY.\n      \" Criar email\n      lo_send_request = cl_bcs=&gt;create_persistent( ).\n\n      \" Corpo do email\n      APPEND |Processamento de Faturas - { sy-datum } { sy-uzeit }| TO lt_body.\n      APPEND '' TO lt_body.\n      APPEND |Empresa: { p_bukrs }| TO lt_body.\n      APPEND |Data: { p_datum }| TO lt_body.\n      APPEND '' TO lt_body.\n      APPEND '--- RESUMO ---' TO lt_body.\n      APPEND |Total processado: { gv_success_count + gv_error_count }| TO lt_body.\n      APPEND |Sucesso: { gv_success_count }| TO lt_body.\n      APPEND |Erros: { gv_error_count }| TO lt_body.\n\n      IF p_test = abap_true.\n        APPEND '' TO lt_body.\n        APPEND 'ATEN\u00c7\u00c3O: Executado em MODO TESTE' TO lt_body.\n      ENDIF.\n\n      \" Criar documento\n      lo_document = cl_document_bcs=&gt;create_document(\n        i_type    = 'RAW'\n        i_text    = lt_body\n        i_subject = |Resultado do Processamento de Faturas - { sy-datum }|\n      ).\n\n      lo_send_request-&gt;set_document( lo_document ).\n\n      \" Destinat\u00e1rio\n      lo_recipient = cl_cam_address_bcs=&gt;create_internet_address( p_email ).\n      lo_send_request-&gt;add_recipient( lo_recipient ).\n\n      \" Remetente\n      DATA(lo_sender) = cl_sapuser_bcs=&gt;create( sy-uname ).\n      lo_send_request-&gt;set_sender( lo_sender ).\n\n      \" Enviar\n      lo_send_request-&gt;set_send_immediately( abap_true ).\n      DATA(lv_sent) = lo_send_request-&gt;send( ).\n\n      IF lv_sent = abap_true.\n        COMMIT WORK.\n        MESSAGE 'Email de notifica\u00e7\u00e3o enviado' TYPE 'S'.\n      ENDIF.\n\n    CATCH cx_bcs INTO DATA(lx_bcs).\n      MESSAGE |Erro ao enviar email: { lx_bcs-&gt;get_text( ) }| TYPE 'W'.\n  ENDTRY.\nENDFORM.\n</code></pre> <p>Conceitos Aplicados</p> <ul> <li>Background Processing: Preparado para execu\u00e7\u00e3o via SM36/SM37</li> <li>Package Processing: Commits parciais para grandes volumes</li> <li>Application Log (BAL): Rastreabilidade completa</li> <li>Error Handling: TRY/CATCH robusto</li> <li>Valida\u00e7\u00f5es: Antes do processamento</li> <li>Email Notification: Resultados autom\u00e1ticos</li> <li>Test Mode: Simular sem gravar dados</li> </ul>","tags":["Exemplos","Reports","Programas","ALV","Integra\u00e7\u00e3o","Completo"]},{"location":"exemplos/#exemplo-3-integracao-rfc-completa","title":"Exemplo 3: Integra\u00e7\u00e3o RFC Completa","text":"<p>Classe que encapsula integra\u00e7\u00e3o RFC com sistema externo de forma robusta e reutiliz\u00e1vel.</p> <pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Class ZCL_RFC_CUSTOMER_INTEGRATION\n*&amp;---------------------------------------------------------------------*\n*&amp; Descri\u00e7\u00e3o: Classe para integra\u00e7\u00e3o de clientes via RFC\n*&amp; Funcionalidades:\n*&amp;   - Envio de clientes para sistema externo\n*&amp;   - Recep\u00e7\u00e3o de clientes de sistema externo\n*&amp;   - Retry autom\u00e1tico em caso de erro\n*&amp;   - Logging estruturado\n*&amp;   - Tratamento de exce\u00e7\u00f5es RFC\n*&amp;---------------------------------------------------------------------*\nCLASS zcl_rfc_customer_integration DEFINITION\n  PUBLIC\n  FINAL\n  CREATE PUBLIC.\n\n  PUBLIC SECTION.\n    \" Types\n    TYPES: BEGIN OF ty_customer,\n             kunnr TYPE kunnr,\n             name1 TYPE name1,\n             ort01 TYPE ort01,\n             land1 TYPE land1,\n             email TYPE ad_smtpadr,\n           END OF ty_customer,\n           tt_customers TYPE STANDARD TABLE OF ty_customer WITH DEFAULT KEY.\n\n    TYPES: BEGIN OF ty_result,\n             kunnr   TYPE kunnr,\n             success TYPE abap_bool,\n             message TYPE string,\n           END OF ty_result,\n           tt_results TYPE STANDARD TABLE OF ty_result WITH DEFAULT KEY.\n\n    \" Methods\n    METHODS constructor\n      IMPORTING iv_destination TYPE rfcdest DEFAULT 'ZEXT_SYSTEM'.\n\n    METHODS send_customers\n      IMPORTING it_customers      TYPE tt_customers\n      RETURNING VALUE(rt_results) TYPE tt_results\n      RAISING   cx_rfc_exception.\n\n    METHODS get_customers\n      IMPORTING iv_country         TYPE land1\n      RETURNING VALUE(rt_customers) TYPE tt_customers\n      RAISING   cx_rfc_exception.\n\n  PRIVATE SECTION.\n    DATA: mv_destination TYPE rfcdest,\n          mv_retry_count TYPE i VALUE 3,\n          mo_logger      TYPE REF TO zcl_logger.\n\n    METHODS check_connection\n      RAISING cx_rfc_exception.\n\n    METHODS log_message\n      IMPORTING iv_type    TYPE symsgty\n                iv_message TYPE string.\nENDCLASS.\n\nCLASS zcl_rfc_customer_integration IMPLEMENTATION.\n  METHOD constructor.\n    mv_destination = iv_destination.\n\n    \" Inicializar logger\n    mo_logger = NEW zcl_logger( ).\n\n    \" Verificar conex\u00e3o\n    TRY.\n        check_connection( ).\n        log_message(\n          iv_type = 'S'\n          iv_message = |Conex\u00e3o RFC estabelecida: { mv_destination }|\n        ).\n      CATCH cx_rfc_exception INTO DATA(lx_rfc).\n        log_message(\n          iv_type = 'E'\n          iv_message = |Falha na conex\u00e3o RFC: { lx_rfc-&gt;get_text( ) }|\n        ).\n        RAISE EXCEPTION lx_rfc.\n    ENDTRY.\n  ENDMETHOD.\n\n  METHOD check_connection.\n    \" Testar conex\u00e3o RFC\n    CALL FUNCTION 'RFC_PING'\n      DESTINATION mv_destination\n      EXCEPTIONS\n        communication_failure = 1  MESSAGE DATA(lv_msg)\n        system_failure        = 2  MESSAGE lv_msg\n        OTHERS                = 3.\n\n    IF sy-subrc &lt;&gt; 0.\n      RAISE EXCEPTION TYPE cx_rfc_exception\n        EXPORTING\n          textid = VALUE #(\n            msgid = sy-msgid\n            msgno = sy-msgno\n            msgv1 = lv_msg\n          ).\n    ENDIF.\n  ENDMETHOD.\n\n  METHOD send_customers.\n    DATA: lt_failed TYPE tt_customers,\n          lv_retry  TYPE i.\n\n    \" Processar cada cliente\n    LOOP AT it_customers INTO DATA(ls_customer).\n      DATA(ls_result) = VALUE ty_result( kunnr = ls_customer-kunnr ).\n\n      \" Retry logic\n      DO mv_retry_count TIMES.\n        lv_retry = sy-index.\n\n        TRY.\n            \" Chamar FM RFC no destino externo\n            \" (Adaptar nome da fun\u00e7\u00e3o para a real)\n            CALL FUNCTION 'Z_REMOTE_CREATE_CUSTOMER'\n              DESTINATION mv_destination\n              EXPORTING\n                iv_kunnr = ls_customer-kunnr\n                iv_name1 = ls_customer-name1\n                iv_ort01 = ls_customer-ort01\n                iv_land1 = ls_customer-land1\n                iv_email = ls_customer-email\n              IMPORTING\n                ev_success = DATA(lv_success)\n                ev_message = DATA(lv_message)\n              EXCEPTIONS\n                communication_failure = 1  MESSAGE DATA(lv_comm_msg)\n                system_failure        = 2  MESSAGE lv_comm_msg\n                customer_exists       = 3\n                invalid_data          = 4\n                OTHERS                = 5.\n\n            CASE sy-subrc.\n              WHEN 0.\n                \" Sucesso\n                ls_result-success = abap_true.\n                ls_result-message = lv_message.\n\n                log_message(\n                  iv_type = 'S'\n                  iv_message = |Cliente { ls_customer-kunnr } enviado com sucesso|\n                ).\n\n                EXIT.  \" Sair do loop de retry\n\n              WHEN 1 OR 2.\n                \" Erro de comunica\u00e7\u00e3o - tentar novamente\n                IF lv_retry &lt; mv_retry_count.\n                  log_message(\n                    iv_type = 'W'\n                    iv_message = |Tentativa { lv_retry }: Erro de comunica\u00e7\u00e3o - { lv_comm_msg }|\n                  ).\n\n                  WAIT UP TO 2 SECONDS.  \" Aguardar antes de retry\n                  CONTINUE.\n                ELSE.\n                  \" M\u00e1ximo de tentativas excedido\n                  ls_result-success = abap_false.\n                  ls_result-message = |Falha de comunica\u00e7\u00e3o ap\u00f3s { mv_retry_count } tentativas|.\n\n                  log_message(\n                    iv_type = 'E'\n                    iv_message = |Cliente { ls_customer-kunnr }: { ls_result-message }|\n                  ).\n\n                  EXIT.\n                ENDIF.\n\n              WHEN 3.\n                \" Cliente j\u00e1 existe\n                ls_result-success = abap_false.\n                ls_result-message = 'Cliente j\u00e1 existe no sistema destino'.\n\n                log_message(\n                  iv_type = 'W'\n                  iv_message = |Cliente { ls_customer-kunnr } j\u00e1 existe|\n                ).\n\n                EXIT.\n\n              WHEN 4.\n                \" Dados inv\u00e1lidos\n                ls_result-success = abap_false.\n                ls_result-message = 'Dados inv\u00e1lidos'.\n\n                log_message(\n                  iv_type = 'E'\n                  iv_message = |Cliente { ls_customer-kunnr }: Dados inv\u00e1lidos|\n                ).\n\n                EXIT.\n\n              WHEN OTHERS.\n                \" Erro gen\u00e9rico\n                ls_result-success = abap_false.\n                ls_result-message = 'Erro desconhecido'.\n\n                log_message(\n                  iv_type = 'E'\n                  iv_message = |Cliente { ls_customer-kunnr }: Erro desconhecido|\n                ).\n\n                EXIT.\n            ENDCASE.\n\n          CATCH cx_rfc_exception INTO DATA(lx_rfc).\n            \" Exce\u00e7\u00e3o RFC\n            ls_result-success = abap_false.\n            ls_result-message = lx_rfc-&gt;get_text( ).\n\n            log_message(\n              iv_type = 'E'\n              iv_message = |Cliente { ls_customer-kunnr }: { lx_rfc-&gt;get_text( ) }|\n            ).\n\n            EXIT.\n        ENDTRY.\n      ENDDO.\n\n      APPEND ls_result TO rt_results.\n    ENDLOOP.\n\n    \" Log final\n    DATA(lv_success_count) = REDUCE i( INIT sum = 0\n                                        FOR ls_res IN rt_results\n                                        WHERE ( success = abap_true )\n                                        NEXT sum = sum + 1 ).\n\n    log_message(\n      iv_type = 'I'\n      iv_message = |Processamento conclu\u00eddo: { lv_success_count }/{ lines( it_customers ) } sucessos|\n    ).\n  ENDMETHOD.\n\n  METHOD get_customers.\n    \" Buscar clientes do sistema externo\n    TRY.\n        CALL FUNCTION 'Z_REMOTE_GET_CUSTOMERS'\n          DESTINATION mv_destination\n          EXPORTING\n            iv_country   = iv_country\n          IMPORTING\n            et_customers = rt_customers\n          EXCEPTIONS\n            communication_failure = 1  MESSAGE DATA(lv_msg)\n            system_failure        = 2  MESSAGE lv_msg\n            no_data_found         = 3\n            OTHERS                = 4.\n\n        CASE sy-subrc.\n          WHEN 0.\n            log_message(\n              iv_type = 'S'\n              iv_message = |{ lines( rt_customers ) } clientes recebidos do sistema externo|\n            ).\n\n          WHEN 1 OR 2.\n            RAISE EXCEPTION TYPE cx_rfc_exception\n              EXPORTING\n                textid = VALUE #( msgid = 'ZMSG' msgno = '001' msgv1 = lv_msg ).\n\n          WHEN 3.\n            log_message(\n              iv_type = 'I'\n              iv_message = |Nenhum cliente encontrado para pa\u00eds { iv_country }|\n            ).\n\n          WHEN OTHERS.\n            RAISE EXCEPTION TYPE cx_rfc_exception\n              EXPORTING\n                textid = VALUE #( msgid = 'ZMSG' msgno = '999' msgv1 = 'Erro desconhecido' ).\n        ENDCASE.\n\n      CATCH cx_rfc_exception INTO DATA(lx_rfc).\n        log_message(\n          iv_type = 'E'\n          iv_message = |Erro ao buscar clientes: { lx_rfc-&gt;get_text( ) }|\n        ).\n        RAISE EXCEPTION lx_rfc.\n    ENDTRY.\n  ENDMETHOD.\n\n  METHOD log_message.\n    \" Logar via classe de logger (ou usar BAL diretamente)\n    mo_logger-&gt;add_message(\n      iv_type    = iv_type\n      iv_message = iv_message\n    ).\n\n    \" Tamb\u00e9m escrever em syslog para debug\n    IF iv_type = 'E'.\n      MESSAGE iv_message TYPE 'E'.\n    ENDIF.\n  ENDMETHOD.\nENDCLASS.\n\n*----------------------------------------------------------------------*\n* Programa de Teste\n*----------------------------------------------------------------------*\nREPORT z_test_rfc_integration.\n\nSTART-OF-SELECTION.\n  TRY.\n      \" Instanciar classe\n      DATA(lo_rfc) = NEW zcl_rfc_customer_integration( 'ZEXT_SYSTEM' ).\n\n      \" Preparar dados de teste\n      DATA(lt_customers) = VALUE zcl_rfc_customer_integration=&gt;tt_customers(\n        ( kunnr = '0000100001' name1 = 'Cliente Teste 1'\n          ort01 = 'S\u00e3o Paulo' land1 = 'BR' email = 'teste1@example.com' )\n        ( kunnr = '0000100002' name1 = 'Cliente Teste 2'\n          ort01 = 'Rio de Janeiro' land1 = 'BR' email = 'teste2@example.com' )\n      ).\n\n      \" Enviar clientes\n      DATA(lt_results) = lo_rfc-&gt;send_customers( lt_customers ).\n\n      \" Exibir resultados\n      LOOP AT lt_results INTO DATA(ls_result).\n        IF ls_result-success = abap_true.\n          WRITE: / icon_green_light AS ICON, ls_result-kunnr, ls_result-message.\n        ELSE.\n          WRITE: / icon_red_light AS ICON, ls_result-kunnr, ls_result-message.\n        ENDIF.\n      ENDLOOP.\n\n      SKIP.\n\n      \" Buscar clientes do sistema externo\n      DATA(lt_remote_customers) = lo_rfc-&gt;get_customers( 'BR' ).\n\n      WRITE: / 'Clientes recebidos:'.\n      LOOP AT lt_remote_customers INTO DATA(ls_customer).\n        WRITE: / ls_customer-kunnr, ls_customer-name1, ls_customer-ort01.\n      ENDLOOP.\n\n    CATCH cx_rfc_exception INTO DATA(lx_rfc).\n      WRITE: / 'Erro RFC:', lx_rfc-&gt;get_text( ).\n  ENDTRY.\n</code></pre> <p>Conceitos Aplicados</p> <ul> <li>RFC: Chamadas ass\u00edncronas e s\u00edncronas</li> <li>Retry Logic: Tentativas autom\u00e1ticas em falhas</li> <li>Exception Handling: Tratamento robusto de erros RFC</li> <li>OOP: Encapsulamento da l\u00f3gica de integra\u00e7\u00e3o</li> <li>Logging: Rastreabilidade de todas as opera\u00e7\u00f5es</li> <li>Testability: F\u00e1cil de testar e mockar</li> </ul>","tags":["Exemplos","Reports","Programas","ALV","Integra\u00e7\u00e3o","Completo"]},{"location":"exemplos/#exemplo-4-aplicacao-oo-completa-com-testes","title":"Exemplo 4: Aplica\u00e7\u00e3o OO Completa com Testes","text":"<p>Sistema de gerenciamento de pedidos usando princ\u00edpios SOLID e com testes unit\u00e1rios.</p> <pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Sistema de Gerenciamento de Pedidos - Arquitetura Limpa\n*&amp;---------------------------------------------------------------------*\n\n*----------------------------------------------------------------------*\n* Interface: Repository Pattern\n*----------------------------------------------------------------------*\nINTERFACE lif_order_repository.\n  TYPES: tt_orders TYPE STANDARD TABLE OF zvbak WITH DEFAULT KEY.\n\n  METHODS get_by_id\n    IMPORTING iv_order_id      TYPE vbeln_va\n    RETURNING VALUE(rs_order)  TYPE zvbak\n    RAISING   cx_order_not_found.\n\n  METHODS get_all\n    IMPORTING iv_customer_id    TYPE kunnr OPTIONAL\n              iv_date_from      TYPE datum OPTIONAL\n              iv_date_to        TYPE datum OPTIONAL\n    RETURNING VALUE(rt_orders)  TYPE tt_orders.\n\n  METHODS save\n    IMPORTING is_order TYPE zvbak\n    RAISING   cx_order_save_failed.\n\n  METHODS delete\n    IMPORTING iv_order_id TYPE vbeln_va\n    RAISING   cx_order_not_found.\nENDINTERFACE.\n\n*----------------------------------------------------------------------*\n* Interface: Validator\n*----------------------------------------------------------------------*\nINTERFACE lif_order_validator.\n  METHODS validate\n    IMPORTING is_order           TYPE zvbak\n    RETURNING VALUE(rt_messages) TYPE bapiret2_t.\nENDINTERFACE.\n\n*----------------------------------------------------------------------*\n* Interface: Notification Service\n*----------------------------------------------------------------------*\nINTERFACE lif_notification_service.\n  METHODS send_order_confirmation\n    IMPORTING iv_order_id TYPE vbeln_va\n              iv_email    TYPE ad_smtpadr\n    RAISING   cx_notification_failed.\nENDINTERFACE.\n\n*----------------------------------------------------------------------*\n* Domain Entity: Order\n*----------------------------------------------------------------------*\nCLASS lcl_order DEFINITION FINAL.\n  PUBLIC SECTION.\n    TYPES: BEGIN OF ty_item,\n             posnr  TYPE posnr_va,\n             matnr  TYPE matnr,\n             kwmeng TYPE kwmeng,\n             netpr  TYPE netpr,\n           END OF ty_item,\n           tt_items TYPE STANDARD TABLE OF ty_item WITH DEFAULT KEY.\n\n    METHODS constructor\n      IMPORTING iv_order_id   TYPE vbeln_va\n                iv_customer_id TYPE kunnr\n                iv_order_date TYPE datum DEFAULT sy-datum.\n\n    METHODS add_item\n      IMPORTING is_item TYPE ty_item\n      RAISING   cx_invalid_item.\n\n    METHODS remove_item\n      IMPORTING iv_position TYPE posnr_va.\n\n    METHODS get_total_value\n      RETURNING VALUE(rv_total) TYPE wrbtr.\n\n    METHODS get_order_id\n      RETURNING VALUE(rv_order_id) TYPE vbeln_va.\n\n    METHODS get_customer_id\n      RETURNING VALUE(rv_customer_id) TYPE kunnr.\n\n    METHODS get_items\n      RETURNING VALUE(rt_items) TYPE tt_items.\n\n    METHODS to_database_structure\n      RETURNING VALUE(rs_order) TYPE zvbak.\n\n  PRIVATE SECTION.\n    DATA: mv_order_id    TYPE vbeln_va,\n          mv_customer_id TYPE kunnr,\n          mv_order_date  TYPE datum,\n          mt_items       TYPE tt_items.\nENDCLASS.\n\nCLASS lcl_order IMPLEMENTATION.\n  METHOD constructor.\n    mv_order_id = iv_order_id.\n    mv_customer_id = iv_customer_id.\n    mv_order_date = iv_order_date.\n  ENDMETHOD.\n\n  METHOD add_item.\n    \" Validar item\n    IF is_item-matnr IS INITIAL OR is_item-kwmeng &lt;= 0.\n      RAISE EXCEPTION TYPE cx_invalid_item.\n    ENDIF.\n\n    \" Verificar se item j\u00e1 existe\n    READ TABLE mt_items WITH KEY posnr = is_item-posnr TRANSPORTING NO FIELDS.\n    IF sy-subrc = 0.\n      RAISE EXCEPTION TYPE cx_invalid_item\n        EXPORTING textid = VALUE #( msgid = 'ZMSG' msgno = '002'\n                                     msgv1 = 'Item j\u00e1 existe' ).\n    ENDIF.\n\n    APPEND is_item TO mt_items.\n  ENDMETHOD.\n\n  METHOD remove_item.\n    DELETE mt_items WHERE posnr = iv_position.\n  ENDMETHOD.\n\n  METHOD get_total_value.\n    rv_total = REDUCE wrbtr(\n      INIT sum = 0\n      FOR ls_item IN mt_items\n      NEXT sum = sum + ( ls_item-kwmeng * ls_item-netpr )\n    ).\n  ENDMETHOD.\n\n  METHOD get_order_id.\n    rv_order_id = mv_order_id.\n  ENDMETHOD.\n\n  METHOD get_customer_id.\n    rv_customer_id = mv_customer_id.\n  ENDMETHOD.\n\n  METHOD get_items.\n    rt_items = mt_items.\n  ENDMETHOD.\n\n  METHOD to_database_structure.\n    rs_order-vbeln = mv_order_id.\n    rs_order-kunnr = mv_customer_id.\n    rs_order-erdat = mv_order_date.\n    rs_order-netwr = get_total_value( ).\n  ENDMETHOD.\nENDCLASS.\n\n*----------------------------------------------------------------------*\n* Service: Order Service (Business Logic)\n*----------------------------------------------------------------------*\nCLASS lcl_order_service DEFINITION FINAL.\n  PUBLIC SECTION.\n    METHODS constructor\n      IMPORTING io_repository  TYPE REF TO lif_order_repository\n                io_validator   TYPE REF TO lif_order_validator\n                io_notification TYPE REF TO lif_notification_service.\n\n    METHODS create_order\n      IMPORTING io_order         TYPE REF TO lcl_order\n                iv_send_notification TYPE abap_bool DEFAULT abap_true\n      RAISING   cx_order_save_failed\n                cx_validation_failed\n                cx_notification_failed.\n\n    METHODS get_order\n      IMPORTING iv_order_id     TYPE vbeln_va\n      RETURNING VALUE(ro_order) TYPE REF TO lcl_order\n      RAISING   cx_order_not_found.\n\n    METHODS calculate_order_statistics\n      IMPORTING iv_customer_id     TYPE kunnr\n      RETURNING VALUE(rs_stats)    TYPE ty_statistics.\n\n  PRIVATE SECTION.\n    DATA: mo_repository  TYPE REF TO lif_order_repository,\n          mo_validator   TYPE REF TO lif_order_validator,\n          mo_notification TYPE REF TO lif_notification_service.\n\n    TYPES: BEGIN OF ty_statistics,\n             total_orders TYPE i,\n             total_value  TYPE wrbtr,\n             avg_value    TYPE wrbtr,\n           END OF ty_statistics.\nENDCLASS.\n\nCLASS lcl_order_service IMPLEMENTATION.\n  METHOD constructor.\n    mo_repository = io_repository.\n    mo_validator = io_validator.\n    mo_notification = io_notification.\n  ENDMETHOD.\n\n  METHOD create_order.\n    \" 1. Validar pedido\n    DATA(lt_messages) = mo_validator-&gt;validate( io_order-&gt;to_database_structure( ) ).\n\n    IF line_exists( lt_messages[ type = 'E' ] ).\n      RAISE EXCEPTION TYPE cx_validation_failed\n        EXPORTING messages = lt_messages.\n    ENDIF.\n\n    \" 2. Salvar no banco\n    TRY.\n        mo_repository-&gt;save( io_order-&gt;to_database_structure( ) ).\n      CATCH cx_order_save_failed INTO DATA(lx_save).\n        RAISE EXCEPTION lx_save.\n    ENDTRY.\n\n    \" 3. Enviar notifica\u00e7\u00e3o (se solicitado)\n    IF iv_send_notification = abap_true.\n      \" Buscar email do cliente\n      SELECT SINGLE smtp_addr FROM adr6\n        INTO @DATA(lv_email)\n        WHERE addrnumber = ( SELECT addrnumber FROM kna1\n                             WHERE kunnr = @io_order-&gt;get_customer_id( ) ).\n\n      IF sy-subrc = 0 AND lv_email IS NOT INITIAL.\n        TRY.\n            mo_notification-&gt;send_order_confirmation(\n              iv_order_id = io_order-&gt;get_order_id( )\n              iv_email    = lv_email\n            ).\n          CATCH cx_notification_failed.\n            \" Log error but don't fail order creation\n        ENDTRY.\n      ENDIF.\n    ENDIF.\n  ENDMETHOD.\n\n  METHOD get_order.\n    \" Buscar do repository\n    DATA(ls_order_data) = mo_repository-&gt;get_by_id( iv_order_id ).\n\n    \" Reconstruir objeto de dom\u00ednio\n    ro_order = NEW lcl_order(\n      iv_order_id    = ls_order_data-vbeln\n      iv_customer_id = ls_order_data-kunnr\n      iv_order_date  = ls_order_data-erdat\n    ).\n\n    \" Buscar itens (simplificado)\n    \" ... adicionar itens ao pedido ...\n  ENDMETHOD.\n\n  METHOD calculate_order_statistics.\n    DATA(lt_orders) = mo_repository-&gt;get_all( iv_customer_id = iv_customer_id ).\n\n    rs_stats-total_orders = lines( lt_orders ).\n    rs_stats-total_value = REDUCE wrbtr(\n      INIT sum = 0\n      FOR ls_order IN lt_orders\n      NEXT sum = sum + ls_order-netwr\n    ).\n\n    IF rs_stats-total_orders &gt; 0.\n      rs_stats-avg_value = rs_stats-total_value / rs_stats-total_orders.\n    ENDIF.\n  ENDMETHOD.\nENDCLASS.\n\n*----------------------------------------------------------------------*\n* Unit Tests\n*----------------------------------------------------------------------*\nCLASS ltc_order_tests DEFINITION FINAL FOR TESTING\n  DURATION SHORT\n  RISK LEVEL HARMLESS.\n\n  PRIVATE SECTION.\n    DATA: mo_order TYPE REF TO lcl_order.\n\n    METHODS: setup,\n             test_create_order FOR TESTING,\n             test_add_item FOR TESTING,\n             test_calculate_total FOR TESTING,\n             test_add_invalid_item FOR TESTING.\nENDCLASS.\n\nCLASS ltc_order_tests IMPLEMENTATION.\n  METHOD setup.\n    mo_order = NEW lcl_order(\n      iv_order_id    = '0000000001'\n      iv_customer_id = '0000100000'\n      iv_order_date  = '20250115'\n    ).\n  ENDMETHOD.\n\n  METHOD test_create_order.\n    \" Assert\n    cl_abap_unit_assert=&gt;assert_equals(\n      act = mo_order-&gt;get_order_id( )\n      exp = '0000000001'\n      msg = 'Order ID incorreto'\n    ).\n\n    cl_abap_unit_assert=&gt;assert_equals(\n      act = mo_order-&gt;get_customer_id( )\n      exp = '0000100000'\n      msg = 'Customer ID incorreto'\n    ).\n  ENDMETHOD.\n\n  METHOD test_add_item.\n    \" Arrange\n    DATA(ls_item) = VALUE lcl_order=&gt;ty_item(\n      posnr  = '000010'\n      matnr  = 'MAT001'\n      kwmeng = 5\n      netpr  = '100.00'\n    ).\n\n    \" Act\n    TRY.\n        mo_order-&gt;add_item( ls_item ).\n      CATCH cx_invalid_item.\n        cl_abap_unit_assert=&gt;fail( 'N\u00e3o deveria lan\u00e7ar exce\u00e7\u00e3o' ).\n    ENDTRY.\n\n    \" Assert\n    DATA(lt_items) = mo_order-&gt;get_items( ).\n    cl_abap_unit_assert=&gt;assert_equals(\n      act = lines( lt_items )\n      exp = 1\n      msg = 'Deveria ter 1 item'\n    ).\n  ENDMETHOD.\n\n  METHOD test_calculate_total.\n    \" Arrange\n    mo_order-&gt;add_item( VALUE #( posnr = '000010' matnr = 'MAT001'\n                                  kwmeng = 5 netpr = '100.00' ) ).\n    mo_order-&gt;add_item( VALUE #( posnr = '000020' matnr = 'MAT002'\n                                  kwmeng = 3 netpr = '50.00' ) ).\n\n    \" Act\n    DATA(lv_total) = mo_order-&gt;get_total_value( ).\n\n    \" Assert\n    cl_abap_unit_assert=&gt;assert_equals(\n      act = lv_total\n      exp = '650.00'   \" (5 * 100) + (3 * 50) = 650\n      msg = 'Total calculado incorretamente'\n    ).\n  ENDMETHOD.\n\n  METHOD test_add_invalid_item.\n    \" Arrange\n    DATA(ls_invalid_item) = VALUE lcl_order=&gt;ty_item(\n      posnr  = '000010'\n      matnr  = ''          \" Material vazio - inv\u00e1lido\n      kwmeng = 5\n      netpr  = '100.00'\n    ).\n\n    \" Act &amp; Assert\n    TRY.\n        mo_order-&gt;add_item( ls_invalid_item ).\n        cl_abap_unit_assert=&gt;fail( 'Deveria lan\u00e7ar cx_invalid_item' ).\n      CATCH cx_invalid_item.\n        \" Sucesso - exce\u00e7\u00e3o esperada\n    ENDTRY.\n  ENDMETHOD.\nENDCLASS.\n</code></pre> <p>Conceitos Aplicados</p> <ul> <li>SOLID Principles: Single Responsibility, Dependency Inversion</li> <li>Design Patterns: Repository, Service Layer, Domain Entity</li> <li>Clean Architecture: Separa\u00e7\u00e3o de camadas</li> <li>ABAP Unit: Testes automatizados completos</li> <li>Dependency Injection: Via constructor</li> <li>Interface Segregation: Contratos bem definidos</li> <li>Exception Handling: Exce\u00e7\u00f5es customizadas</li> </ul>","tags":["Exemplos","Reports","Programas","ALV","Integra\u00e7\u00e3o","Completo"]},{"location":"exemplos/#resumo-dos-conceitos-integrados","title":"Resumo dos Conceitos Integrados","text":"<p>O que Aprendemos</p> <p>Estes exemplos demonstram a integra\u00e7\u00e3o de:</p> <p>Exemplo 1 - ALV Report: - SQL otimizado (FOR ALL ENTRIES, HASHED tables) - ALV SALV com eventos - Tratamento de cores e \u00edcones - Navega\u00e7\u00e3o entre transa\u00e7\u00f5es - C\u00e1lculos e agrega\u00e7\u00f5es</p> <p>Exemplo 2 - Batch Job: - Background processing - Package processing (commits parciais) - Application Log (BAL) - Valida\u00e7\u00f5es e error handling - Email notifications - Test mode vs production mode</p> <p>Exemplo 3 - RFC Integration: - Chamadas RFC robustas - Retry logic autom\u00e1tico - Exception handling espec\u00edfico - Logging estruturado - Encapsulamento OO - Testabilidade</p> <p>Exemplo 4 - Clean Architecture: - SOLID principles - Design patterns (Repository, Service Layer) - Domain-driven design - Dependency injection - Unit testing completo - Separation of concerns</p> <p>Boas Pr\u00e1ticas Demonstradas</p> <ul> <li>Separa\u00e7\u00e3o de responsabilidades: Cada classe/form tem prop\u00f3sito \u00fanico</li> <li>Coment\u00e1rios \u00fateis: Headers explicativos, n\u00e3o c\u00f3digo \u00f3bvio</li> <li>Tratamento de erros: TRY/CATCH, exce\u00e7\u00f5es customizadas</li> <li>Performance: FOR ALL ENTRIES, HASHED tables, package processing</li> <li>Manutenibilidade: C\u00f3digo modular e reutiliz\u00e1vel</li> <li>Testabilidade: Depend\u00eancias injetadas, interfaces</li> <li>Auditoria: Logging completo de opera\u00e7\u00f5es</li> <li>User Experience: Feedback visual, navega\u00e7\u00e3o intuitiva</li> </ul> <p>Tags: #Exemplos #ALV #Background-Jobs #RFC #Integration #Clean-Architecture #SOLID #Unit-Tests #Best-Practices</p>","tags":["Exemplos","Reports","Programas","ALV","Integra\u00e7\u00e3o","Completo"]},{"location":"fundamentos/","title":"\ud83e\udde9 Fundamentos ABAP","text":"<p>Esta sec\u00e7\u00e3o introduz os conceitos fundamentais da linguagem ABAP \u2014 a base essencial de todo o desenvolvimento SAP.</p>","tags":["ABAP","Fundamentos","Iniciante"]},{"location":"fundamentos/#o-que-vais-aprender","title":"\ud83d\udcd6 O que vais aprender","text":"<ul> <li>Tipos de dados primitivos e complexos</li> <li>Declara\u00e7\u00e3o e uso de vari\u00e1veis e constantes</li> <li>Trabalhar com tabelas internas (arrays ABAP)</li> <li>Estruturas e tipos customizados</li> <li>Condi\u00e7\u00f5es e operadores l\u00f3gicos</li> <li>Loops e itera\u00e7\u00f5es</li> <li>Express\u00f5es modernas ABAP (7.40+)</li> <li>Orienta\u00e7\u00e3o a objetos b\u00e1sica</li> </ul>","tags":["ABAP","Fundamentos","Iniciante"]},{"location":"fundamentos/#ordem-de-aprendizagem","title":"\ud83c\udfaf Ordem de Aprendizagem","text":"","tags":["ABAP","Fundamentos","Iniciante"]},{"location":"fundamentos/#1-variaveis-e-tipos-de-dados","title":"1\ufe0f\u20e3 Vari\u00e1veis e Tipos de Dados","text":"<p>Tipos elementares (<code>i</code>, <code>p</code>, <code>c</code>, <code>string</code>, <code>d</code>, <code>t</code>), declara\u00e7\u00e3o de vari\u00e1veis e constantes.</p>","tags":["ABAP","Fundamentos","Iniciante"]},{"location":"fundamentos/#2-estruturas","title":"2\ufe0f\u20e3 Estruturas","text":"<p>Agrupar campos relacionados numa \u00fanica entidade com <code>TYPES BEGIN OF</code> e <code>STRUCTURES</code>.</p>","tags":["ABAP","Fundamentos","Iniciante"]},{"location":"fundamentos/#3-condicoes-e-logica","title":"3\ufe0f\u20e3 Condi\u00e7\u00f5es e L\u00f3gica","text":"<p><code>IF</code>, <code>CASE</code>, operadores l\u00f3gicos e compara\u00e7\u00f5es.</p>","tags":["ABAP","Fundamentos","Iniciante"]},{"location":"fundamentos/#4-loops","title":"4\ufe0f\u20e3 Loops","text":"<p><code>LOOP AT</code>, <code>DO</code>, <code>WHILE</code> e como iterar sobre dados.</p>","tags":["ABAP","Fundamentos","Iniciante"]},{"location":"fundamentos/#5-expressoes","title":"5\ufe0f\u20e3 Express\u00f5es","text":"<p>Express\u00f5es modernas ABAP: <code>VALUE</code>, <code>CORRESPONDING</code>, <code>FILTER</code>, operador <code>|...|</code>.</p>","tags":["ABAP","Fundamentos","Iniciante"]},{"location":"fundamentos/#6-tabelas-internas","title":"6\ufe0f\u20e3 Tabelas Internas","text":"<p>Como criar, manipular e iterar sobre cole\u00e7\u00f5es de dados em mem\u00f3ria.</p>","tags":["ABAP","Fundamentos","Iniciante"]},{"location":"fundamentos/#7-orientacao-a-objetos-basica","title":"7\ufe0f\u20e3 Orienta\u00e7\u00e3o a Objetos B\u00e1sica","text":"<p>Classes, objetos, m\u00e9todos, atributos e encapsulamento.</p>","tags":["ABAP","Fundamentos","Iniciante"]},{"location":"fundamentos/#exemplo-rapido","title":"\ud83d\udca1 Exemplo R\u00e1pido","text":"<pre><code>REPORT z_fundamentos_demo.\n\n\" 1. Declarar vari\u00e1veis\nDATA: lv_nome  TYPE string VALUE 'Bruno',\n      lv_idade TYPE i VALUE 25.\n\n\" 2. Estrutura\nTYPES: BEGIN OF ty_pessoa,\n         nome  TYPE string,\n         idade TYPE i,\n       END OF ty_pessoa.\n\n\" 3. Tabela interna\nDATA lt_pessoas TYPE TABLE OF ty_pessoa.\n\n\" 4. Adicionar dados (express\u00e3o moderna)\nlt_pessoas = VALUE #(\n  ( nome = 'Bruno' idade = 25 )\n  ( nome = 'Ana'   idade = 30 )\n  ( nome = 'Jo\u00e3o'  idade = 28 )\n).\n\n\" 5. Iterar com inline declaration\nLOOP AT lt_pessoas INTO DATA(ls_pessoa).\n  WRITE: / |{ ls_pessoa-nome } tem { ls_pessoa-idade } anos|.\nENDLOOP.\n\n\" 6. Condi\u00e7\u00e3o\nIF lv_idade &gt;= 18.\n  WRITE: / '\u00c9 maior de idade'.\nENDIF.\n</code></pre>","tags":["ABAP","Fundamentos","Iniciante"]},{"location":"fundamentos/#proximos-passos","title":"\ud83d\ude80 Pr\u00f3ximos Passos","text":"<ol> <li>Comece por Vari\u00e1veis e Tipos de Dados</li> <li>Siga a ordem num\u00e9rica acima (1\u21927)</li> <li>Execute os exemplos no seu sistema SAP</li> <li>Depois avance para SQL ABAP</li> </ol>","tags":["ABAP","Fundamentos","Iniciante"]},{"location":"fundamentos/1_variaveis_tipo_dados/","title":"Vari\u00e1veis e Tipos de Dados","text":""},{"location":"fundamentos/1_variaveis_tipo_dados/#declaracao-de-variaveis","title":"Declara\u00e7\u00e3o de Vari\u00e1veis","text":""},{"location":"fundamentos/1_variaveis_tipo_dados/#sintaxe-moderna-inline","title":"Sintaxe Moderna (Inline)","text":"<pre><code>\" Declara\u00e7\u00e3o inline com DATA()\nDATA(lv_nome) = 'Jo\u00e3o Silva'.\nDATA(lv_idade) = 25.\nDATA(lv_salario) = CONV decfloat34( '2500.50' ).\n\n\" Declara\u00e7\u00e3o inline em loops\nLOOP AT lt_clientes INTO DATA(ls_cliente).\n  WRITE: / ls_cliente-nome.\nENDLOOP.\n\n\" Declara\u00e7\u00e3o inline em SELECT\nSELECT SINGLE * FROM scarr INTO @DATA(ls_carrier) WHERE carrid = 'LH'.\n</code></pre>"},{"location":"fundamentos/1_variaveis_tipo_dados/#declaracao-tradicional","title":"Declara\u00e7\u00e3o Tradicional","text":"<pre><code>DATA: lv_nome    TYPE string,\n      lv_idade   TYPE i,\n      lv_salario TYPE p DECIMALS 2.\n\nlv_nome = 'Maria Santos'.\nlv_idade = 30.\nlv_salario = '3000.00'.\n</code></pre>"},{"location":"fundamentos/1_variaveis_tipo_dados/#tipos-de-dados-elementares","title":"Tipos de Dados Elementares","text":""},{"location":"fundamentos/1_variaveis_tipo_dados/#numericos","title":"Num\u00e9ricos","text":"<pre><code>\" Inteiros\nDATA(lv_int) = 100.                    \" TYPE i (4 bytes)\nDATA(lv_int8) = CONV int8( 1000000 ).  \" TYPE int8 (8 bytes)\n\n\" Decimais\nDATA(lv_packed) = CONV p( '123.45' ).  \" Packed number\nDATA lv_preco TYPE p DECIMALS 2 VALUE '99.99'.\n\n\" Float\nDATA(lv_float) = CONV f( '3.14159' ).\nDATA(lv_decfloat) = CONV decfloat34( '3.141592653589793' ).\n</code></pre>"},{"location":"fundamentos/1_variaveis_tipo_dados/#texto","title":"Texto","text":"<pre><code>\" String (comprimento din\u00e2mico)\nDATA(lv_texto) = 'Isto \u00e9 uma string'.\nDATA(lv_concatenado) = |Cliente: { lv_nome }, Idade: { lv_idade }|.\n\n\" Caracteres (comprimento fixo)\nDATA lv_code TYPE c LENGTH 10 VALUE 'ABC123'.\nDATA lv_char TYPE char20 VALUE 'Texto fixo'.\n\n\" Texto longo\nDATA lv_texto_longo TYPE string.\nlv_texto_longo = 'Lorem ipsum dolor sit amet, ' &amp;&amp;\n                 'consectetur adipiscing elit.'.\n</code></pre>"},{"location":"fundamentos/1_variaveis_tipo_dados/#data-e-hora","title":"Data e Hora","text":"<pre><code>\" Data atual\nDATA(lv_data) = sy-datum.              \" YYYYMMDD\nDATA(lv_hora) = sy-uzeit.              \" HHMMSS\nDATA(lv_timestamp) = CONV timestamp( utclong_current( ) ).\n\n\" Tipos espec\u00edficos\nDATA lv_datum TYPE d VALUE '20250101'. \" Data\nDATA lv_uzeit TYPE t VALUE '143000'.   \" Hora\n</code></pre>"},{"location":"fundamentos/1_variaveis_tipo_dados/#outros-tipos","title":"Outros Tipos","text":"<pre><code>\" Hexadecimal\nDATA lv_hex TYPE x LENGTH 4.\nlv_hex = '0F1E2D3C'.\n\n\" Booleano (ABAP usa ABAP_BOOL ou CHAR1)\nDATA(lv_ativo) = abap_true.            \" 'X'\nDATA(lv_inativo) = abap_false.         \" ' '\n\nIF lv_ativo = abap_true.\n  \" L\u00f3gica quando ativo\nENDIF.\n</code></pre>"},{"location":"fundamentos/1_variaveis_tipo_dados/#conversoes-de-tipo","title":"Convers\u00f5es de Tipo","text":""},{"location":"fundamentos/1_variaveis_tipo_dados/#conv-e-cast","title":"CONV e CAST","text":"<pre><code>\" CONV - Convers\u00e3o de tipo elementar\nDATA(lv_string_num) = '12345'.\nDATA(lv_numero) = CONV i( lv_string_num ).\n\nDATA(lv_preco_string) = CONV string( lv_preco ).\n\n\" CAST - Convers\u00e3o de objetos\nDATA(lo_obj) = CAST cl_abap_typedescr( \n  cl_abap_typedescr=&gt;describe_by_data( lv_nome ) \n).\n</code></pre>"},{"location":"fundamentos/1_variaveis_tipo_dados/#conversoes-implicitas","title":"Convers\u00f5es Impl\u00edcitas","text":"<pre><code>DATA lv_char10 TYPE c LENGTH 10.\nDATA lv_string TYPE string.\n\nlv_char10 = 'TESTE'.\nlv_string = lv_char10.  \" Convers\u00e3o autom\u00e1tica\n\n\" Aten\u00e7\u00e3o: pode haver perda de informa\u00e7\u00e3o\nDATA lv_num TYPE i VALUE 123456789.\nDATA lv_char TYPE c LENGTH 5.\nlv_char = lv_num.  \" Trunca para '12345'\n</code></pre>"},{"location":"fundamentos/1_variaveis_tipo_dados/#constantes","title":"Constantes","text":"<pre><code>\" Constantes da classe\nCLASS lcl_calculator DEFINITION.\n  PUBLIC SECTION.\n    CONSTANTS:\n      gc_pi    TYPE p DECIMALS 14 VALUE '3.14159265358979',\n      gc_taxa  TYPE p DECIMALS 2 VALUE '1.23',\n      gc_max   TYPE i VALUE 1000.\n\n    CONSTANTS gc_separador TYPE c LENGTH 1 VALUE '-'.\nENDCLASS.\n\n\" Uso de constantes\nDATA(lv_area) = gc_pi * lv_raio * lv_raio.\n</code></pre>"},{"location":"fundamentos/1_variaveis_tipo_dados/#tipos-locais","title":"Tipos Locais","text":"<pre><code>TYPES: BEGIN OF ty_cliente,\n         id      TYPE i,\n         nome    TYPE string,\n         email   TYPE string,\n         ativo   TYPE abap_bool,\n         criado  TYPE timestamp,\n       END OF ty_cliente.\n\nDATA ls_cliente TYPE ty_cliente.\nls_cliente = VALUE #( \n  id     = 1\n  nome   = 'Ana Costa'\n  email  = 'ana@example.com'\n  ativo  = abap_true\n  criado = utclong_current( )\n).\n\n\" Tipos de tabela\nTYPES ty_t_clientes TYPE STANDARD TABLE OF ty_cliente WITH DEFAULT KEY.\nDATA lt_clientes TYPE ty_t_clientes.\n</code></pre>"},{"location":"fundamentos/1_variaveis_tipo_dados/#value-e-inicializacao","title":"VALUE e Inicializa\u00e7\u00e3o","text":"<pre><code>\" VALUE com estruturas\nDATA(ls_produto) = VALUE ty_produto(\n  id        = 100\n  nome      = 'Laptop'\n  preco     = '999.99'\n  stock     = 50\n  categoria = 'Inform\u00e1tica'\n).\n\n\" CLEAR vs. VALUE #()\nCLEAR ls_produto.                    \" Limpa valores\nls_produto = VALUE #( ).             \" Sintaxe moderna\n\n\" Inicializa\u00e7\u00e3o de tabelas\nDATA(lt_numeros) = VALUE ty_t_numeros( ( 1 ) ( 2 ) ( 3 ) ( 4 ) ( 5 ) ).\n</code></pre>"},{"location":"fundamentos/1_variaveis_tipo_dados/#ambito-de-variaveis","title":"\u00c2mbito de Vari\u00e1veis","text":"<pre><code>CLASS lcl_exemplo DEFINITION.\n  PUBLIC SECTION.\n    DATA mv_publico TYPE string.           \" Acess\u00edvel externamente\n\n  PROTECTED SECTION.\n    DATA mv_protegido TYPE string.         \" Acess\u00edvel em subclasses\n\n  PRIVATE SECTION.\n    DATA mv_privado TYPE string.           \" Apenas nesta classe\n\n    METHODS processar.\nENDCLASS.\n\nCLASS lcl_exemplo IMPLEMENTATION.\n  METHOD processar.\n    \" Vari\u00e1veis locais do m\u00e9todo\n    DATA(lv_temp) = 'Tempor\u00e1rio'.\n\n    \" Acesso a atributos\n    mv_privado = 'Valor privado'.\n    me-&gt;mv_publico = 'Valor p\u00fablico'.  \" me-&gt; \u00e9 opcional\n  ENDMETHOD.\nENDCLASS.\n</code></pre>"},{"location":"fundamentos/1_variaveis_tipo_dados/#dicas-de-boas-praticas","title":"Dicas de Boas Pr\u00e1ticas","text":"<p>Nomenclatura</p> <ul> <li>Use prefixos claros: <code>lv_</code> para vari\u00e1veis locais, <code>gv_</code> para globais</li> <li><code>ls_</code> para estruturas, <code>lt_</code> para tabelas internas</li> <li><code>lo_</code> para objetos, <code>lr_</code> para refer\u00eancias</li> <li><code>gc_</code> para constantes globais, <code>lc_</code> para constantes locais</li> </ul> <p>Performance</p> <ul> <li>Evite convers\u00f5es desnecess\u00e1rias em loops</li> <li>Use tipos adequados (n\u00e3o declare <code>TYPE p DECIMALS 10</code> se s\u00f3 precisa de 2)</li> <li>Prefira <code>STRING</code> para textos din\u00e2micos, <code>C</code> para fixos</li> </ul> <p>Sintaxe Moderna</p> <pre><code>\" \u274c Evitar\nDATA lv_resultado TYPE string.\nlv_resultado = 'Valor: ' &amp;&amp; lv_valor.\n\n\" \u2705 Preferir\nDATA(lv_resultado) = |Valor: { lv_valor }|.\n</code></pre> <p>Declara\u00e7\u00e3o Inline</p> <ul> <li>Use <code>DATA()</code> sempre que o tipo seja \u00f3bvio pelo contexto</li> <li>Torna o c\u00f3digo mais conciso e leg\u00edvel</li> <li>Dispon\u00edvel desde ABAP 7.40</li> </ul> <p>Tags: #Fundamentos #Vari\u00e1veis #Modern-ABAP</p>"},{"location":"fundamentos/2_estruturas/","title":"Estruturas","text":""},{"location":"fundamentos/2_estruturas/#declaracao-de-estruturas","title":"Declara\u00e7\u00e3o de Estruturas","text":""},{"location":"fundamentos/2_estruturas/#estruturas-locais","title":"Estruturas Locais","text":"<pre><code>TYPES: BEGIN OF ty_endereco,\n         rua      TYPE string,\n         numero   TYPE string,\n         cidade   TYPE string,\n         codigo   TYPE string,\n         pais     TYPE land1,\n       END OF ty_endereco.\n\nTYPES: BEGIN OF ty_pessoa,\n         id       TYPE i,\n         nome     TYPE string,\n         idade    TYPE i,\n         endereco TYPE ty_endereco,\n         salario  TYPE p DECIMALS 2,\n       END OF ty_pessoa.\n\nDATA ls_pessoa TYPE ty_pessoa.\n</code></pre>"},{"location":"fundamentos/2_estruturas/#estruturas-baseadas-em-ddic","title":"Estruturas Baseadas em DDIC","text":"<pre><code>\" Usar estrutura do dicion\u00e1rio\nDATA ls_scarr TYPE scarr.\nDATA ls_mara  TYPE mara.\n\n\" Declara\u00e7\u00e3o inline com SELECT\nSELECT SINGLE * FROM kna1 INTO @DATA(ls_cliente) WHERE kunnr = '0000100000'.\n</code></pre>"},{"location":"fundamentos/2_estruturas/#inicializacao-de-estruturas","title":"Inicializa\u00e7\u00e3o de Estruturas","text":""},{"location":"fundamentos/2_estruturas/#value-constructor","title":"VALUE Constructor","text":"<pre><code>\" Sintaxe moderna - preenchimento completo\nDATA(ls_produto) = VALUE ty_produto(\n  id          = 1001\n  descricao   = 'Port\u00e1til Dell'\n  preco       = '899.99'\n  quantidade  = 15\n  data_registo = sy-datum\n).\n\n\" Preenchimento parcial\nDATA(ls_config) = VALUE ty_config(\n  ativo = abap_true\n  \" outros campos ficam com valor inicial\n).\n\n\" Com BASE - manter valores existentes\nls_produto = VALUE #( BASE ls_produto\n  preco      = '799.99'  \" Atualiza apenas o pre\u00e7o\n  quantidade = 20        \" e a quantidade\n).\n</code></pre>"},{"location":"fundamentos/2_estruturas/#corresponding","title":"CORRESPONDING","text":"<pre><code>\" Copiar campos com mesmo nome\nTYPES: BEGIN OF ty_origem,\n         campo1 TYPE string,\n         campo2 TYPE i,\n         campo3 TYPE string,\n       END OF ty_origem.\n\nTYPES: BEGIN OF ty_destino,\n         campo1 TYPE string,\n         campo2 TYPE i,\n         campo4 TYPE string,\n       END OF ty_destino.\n\nDATA(ls_origem) = VALUE ty_origem(\n  campo1 = 'A'\n  campo2 = 10\n  campo3 = 'X'\n).\n\n\" Copia campo1 e campo2\nDATA(ls_destino) = CORRESPONDING #( ls_origem ).\n\n\" Com mapeamento adicional\nls_destino = CORRESPONDING #( BASE ( ls_destino ) ls_origem MAPPING campo4 = campo3 ).\n</code></pre>"},{"location":"fundamentos/2_estruturas/#acesso-a-campos","title":"Acesso a Campos","text":""},{"location":"fundamentos/2_estruturas/#acesso-direto","title":"Acesso Direto","text":"<pre><code>\" Leitura\nDATA(lv_nome) = ls_pessoa-nome.\nDATA(lv_rua) = ls_pessoa-endereco-rua.\n\n\" Escrita\nls_pessoa-idade = 30.\nls_pessoa-endereco-cidade = 'Lisboa'.\n\n\" Com field-symbols\nFIELD-SYMBOLS &lt;lv_campo&gt; TYPE any.\nASSIGN ls_pessoa-nome TO &lt;lv_campo&gt;.\n&lt;lv_campo&gt; = 'Jo\u00e3o Silva'.\n</code></pre>"},{"location":"fundamentos/2_estruturas/#acesso-dinamico","title":"Acesso Din\u00e2mico","text":"<pre><code>DATA lv_nome_campo TYPE string VALUE 'NOME'.\n\n\" Atribui\u00e7\u00e3o din\u00e2mica\nASSIGN COMPONENT lv_nome_campo OF STRUCTURE ls_pessoa TO FIELD-SYMBOL(&lt;lv_valor&gt;).\nIF sy-subrc = 0.\n  &lt;lv_valor&gt; = 'Maria Santos'.\nENDIF.\n\n\" Leitura din\u00e2mica\nDATA lv_conteudo TYPE string.\nASSIGN COMPONENT 'IDADE' OF STRUCTURE ls_pessoa TO &lt;lv_valor&gt;.\nIF sy-subrc = 0.\n  lv_conteudo = &lt;lv_valor&gt;.\nENDIF.\n</code></pre>"},{"location":"fundamentos/2_estruturas/#estruturas-aninhadas","title":"Estruturas Aninhadas","text":""},{"location":"fundamentos/2_estruturas/#definicao","title":"Defini\u00e7\u00e3o","text":"<pre><code>TYPES: BEGIN OF ty_contacto,\n         telefone TYPE string,\n         email    TYPE string,\n       END OF ty_contacto.\n\nTYPES: BEGIN OF ty_funcionario,\n         numero    TYPE i,\n         nome      TYPE string,\n         contacto  TYPE ty_contacto,\n         morada    TYPE ty_endereco,\n       END OF ty_funcionario.\n</code></pre>"},{"location":"fundamentos/2_estruturas/#manipulacao","title":"Manipula\u00e7\u00e3o","text":"<pre><code>DATA(ls_funcionario) = VALUE ty_funcionario(\n  numero = 12345\n  nome   = 'Ana Costa'\n  contacto = VALUE #(\n    telefone = '+351 910000000'\n    email    = 'ana.costa@empresa.pt'\n  )\n  morada = VALUE #(\n    rua    = 'Rua das Flores'\n    numero = '123'\n    cidade = 'Porto'\n    codigo = '4000-001'\n  )\n).\n\n\" Acesso em profundidade\nWRITE: / ls_funcionario-contacto-email.\nWRITE: / ls_funcionario-morada-cidade.\n</code></pre>"},{"location":"fundamentos/2_estruturas/#operacoes-com-estruturas","title":"Opera\u00e7\u00f5es com Estruturas","text":""},{"location":"fundamentos/2_estruturas/#comparacao","title":"Compara\u00e7\u00e3o","text":"<pre><code>DATA ls_pessoa1 TYPE ty_pessoa.\nDATA ls_pessoa2 TYPE ty_pessoa.\n\nls_pessoa1 = VALUE #( id = 1 nome = 'Jo\u00e3o' idade = 25 ).\nls_pessoa2 = VALUE #( id = 1 nome = 'Jo\u00e3o' idade = 25 ).\n\n\" Compara\u00e7\u00e3o completa\nIF ls_pessoa1 = ls_pessoa2.\n  WRITE: / 'Estruturas iguais'.\nENDIF.\n\n\" Compara\u00e7\u00e3o de campos espec\u00edficos\nIF ls_pessoa1-nome = ls_pessoa2-nome.\n  WRITE: / 'Nomes iguais'.\nENDIF.\n</code></pre>"},{"location":"fundamentos/2_estruturas/#limpeza","title":"Limpeza","text":"<pre><code>\" Limpar toda a estrutura\nCLEAR ls_pessoa.\n\n\" Sintaxe moderna\nls_pessoa = VALUE #( ).\n\n\" Limpar campos espec\u00edficos (manter outros)\nls_pessoa = VALUE #( BASE ls_pessoa\n  salario = 0\n  idade   = 0\n).\n</code></pre>"},{"location":"fundamentos/2_estruturas/#move-corresponding","title":"Move-Corresponding","text":"<pre><code>\" Move campos com mesmo nome\nDATA ls_origem TYPE ty_pessoa.\nDATA ls_destino TYPE ty_funcionario.\n\nls_origem = VALUE #( nome = 'Pedro' ).\n\nMOVE-CORRESPONDING ls_origem TO ls_destino.\n\" ou sintaxe moderna:\nls_destino = CORRESPONDING #( ls_origem ).\n</code></pre>"},{"location":"fundamentos/2_estruturas/#estruturas-include","title":"Estruturas Include","text":"<pre><code>TYPES: BEGIN OF ty_auditoria,\n         criado_por TYPE syuname,\n         criado_em  TYPE timestamp,\n         alterado_por TYPE syuname,\n         alterado_em  TYPE timestamp,\n       END OF ty_auditoria.\n\nTYPES: BEGIN OF ty_documento.\n         INCLUDE TYPE ty_auditoria.\nTYPES:   numero TYPE string,\n         descricao TYPE string,\n       END OF ty_documento.\n\n\" ty_documento cont\u00e9m todos os campos de ty_auditoria + os pr\u00f3prios\n</code></pre>"},{"location":"fundamentos/2_estruturas/#component-operator","title":"Component Operator","text":"<pre><code>\" Acesso moderno a componentes\nDATA(lv_email) = ls_funcionario-contacto-email.\n\n\" Verificar exist\u00eancia de componente\nIF ls_funcionario CS 'NOME'.  \" CS = Contains String (campo existe)\n  WRITE: / 'Campo NOME existe'.\nENDIF.\n\n\" N\u00famero de componentes\nDESCRIBE FIELD ls_funcionario COMPONENTS DATA(lv_num_campos).\n</code></pre>"},{"location":"fundamentos/2_estruturas/#trabalhar-com-includes-de-tabelas-ddic","title":"Trabalhar com Includes de Tabelas DDIC","text":"<pre><code>\" Estrutura que usa includes do dicion\u00e1rio\nDATA ls_vbak TYPE vbak.  \" Cont\u00e9m includes como VBAP_INCL\n\n\" Acesso normal aos campos inclu\u00eddos\nWRITE: / ls_vbak-vbeln.  \" Campo da pr\u00f3pria estrutura\nWRITE: / ls_vbak-erdat.  \" Campo de um include\n</code></pre>"},{"location":"fundamentos/2_estruturas/#estruturas-deep-vs-flat","title":"Estruturas Deep vs. Flat","text":""},{"location":"fundamentos/2_estruturas/#estrutura-flat-sem-tabelas-internas-ou-referencias","title":"Estrutura Flat (sem tabelas internas ou refer\u00eancias)","text":"<pre><code>TYPES: BEGIN OF ty_flat,\n         campo1 TYPE c LENGTH 10,\n         campo2 TYPE i,\n         campo3 TYPE p DECIMALS 2,\n       END OF ty_flat.\n\n\" Pode ser usada com: EXPORT/IMPORT, MOVE, opera\u00e7\u00f5es bin\u00e1rias\n</code></pre>"},{"location":"fundamentos/2_estruturas/#estrutura-deep-com-tabelas-internas-ou-strings","title":"Estrutura Deep (com tabelas internas ou strings)","text":"<pre><code>TYPES: BEGIN OF ty_deep,\n         id     TYPE i,\n         nome   TYPE string,           \" STRING = deep\n         itens  TYPE ty_t_itens,       \" Tabela interna = deep\n       END OF ty_deep.\n\n\" Requer tratamento especial em certas opera\u00e7\u00f5es\n</code></pre>"},{"location":"fundamentos/2_estruturas/#dicas-de-boas-praticas","title":"Dicas de Boas Pr\u00e1ticas","text":"<p>Nomenclatura de Tipos</p> <ul> <li>Use <code>ty_</code> para tipos de estrutura: <code>ty_cliente</code>, <code>ty_pedido</code></li> <li>Use <code>ty_t_</code> para tipos de tabela: <code>ty_t_clientes</code>, <code>ty_t_pedidos</code></li> <li>Seja descritivo: <code>ty_pessoa</code> melhor que <code>ty_p</code></li> </ul> <p>Performance</p> <ul> <li>Evite estruturas demasiado grandes (muitos campos desnecess\u00e1rios)</li> <li>Em loops, aceda diretamente aos campos necess\u00e1rios</li> <li>Use <code>CORRESPONDING</code> com cuidado em loops (pode ser lento)</li> </ul> <p>VALUE vs. Atribui\u00e7\u00e3o Individual</p> <pre><code>\" \u274c Menos leg\u00edvel\nDATA ls_cliente TYPE ty_cliente.\nls_cliente-id = 1.\nls_cliente-nome = 'Jo\u00e3o'.\nls_cliente-ativo = abap_true.\n\n\" \u2705 Mais limpo\nDATA(ls_cliente) = VALUE ty_cliente(\n  id    = 1\n  nome  = 'Jo\u00e3o'\n  ativo = abap_true\n).\n</code></pre> <p>Estruturas vs. Classes</p> <ul> <li>Estruturas: dados apenas (sem comportamento)</li> <li>Classes: dados + m\u00e9todos (comportamento)</li> <li>Use estruturas para DTOs (Data Transfer Objects)</li> <li>Use classes quando precisar de encapsulamento e l\u00f3gica</li> </ul> <p>Tags: #Fundamentos #Estruturas #Modern-ABAP</p>"},{"location":"fundamentos/3_condicoes_logica/","title":"Condi\u00e7\u00f5es e L\u00f3gica","text":""},{"location":"fundamentos/3_condicoes_logica/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Este cap\u00edtulo aborda as estruturas condicionais e l\u00f3gicas em ABAP, essenciais para controlar o fluxo de execu\u00e7\u00e3o do programa com base em condi\u00e7\u00f5es.</p>"},{"location":"fundamentos/3_condicoes_logica/#operadores-logicos","title":"\ud83c\udfaf Operadores L\u00f3gicos","text":""},{"location":"fundamentos/3_condicoes_logica/#operadores-de-comparacao","title":"Operadores de Compara\u00e7\u00e3o","text":"<pre><code>\" Operadores relacionais\n=   \" Igual a\n&lt;&gt;  \" Diferente de (tamb\u00e9m NE)\n&lt;   \" Menor que (tamb\u00e9m LT)\n&gt;   \" Maior que (tamb\u00e9m GT)\n&lt;=  \" Menor ou igual (tamb\u00e9m LE)\n&gt;=  \" Maior ou igual (tamb\u00e9m GE)\n\n\" Exemplos\nIF idade &gt;= 18.\n  WRITE: / 'Maior de idade'.\nENDIF.\n\nIF status &lt;&gt; 'CANCELADO'.\n  WRITE: / 'Pedido ativo'.\nENDIF.\n</code></pre>"},{"location":"fundamentos/3_condicoes_logica/#operadores-booleanos","title":"Operadores Booleanos","text":"<pre><code>AND  \" E l\u00f3gico (ambas condi\u00e7\u00f5es verdadeiras)\nOR   \" OU l\u00f3gico (pelo menos uma verdadeira)\nNOT  \" Nega\u00e7\u00e3o\n\n\" Exemplos\nIF idade &gt;= 18 AND tem_carta = abap_true.\n  WRITE: / 'Pode conduzir'.\nENDIF.\n\nIF categoria = 'VIP' OR valor_compra &gt; 1000.\n  WRITE: / 'Cliente premium'.\nENDIF.\n\nIF NOT bloqueado = abap_true.\n  WRITE: / 'Cliente ativo'.\nENDIF.\n</code></pre>"},{"location":"fundamentos/3_condicoes_logica/#operadores-de-string","title":"Operadores de String","text":"<pre><code>CO  \" Contains Only (cont\u00e9m apenas)\nCN  \" Contains Not (n\u00e3o cont\u00e9m)\nCA  \" Contains Any (cont\u00e9m algum)\nNA  \" Not Any (n\u00e3o cont\u00e9m nenhum)\nCS  \" Contains String (cont\u00e9m texto)\nNS  \" Not String (n\u00e3o cont\u00e9m texto)\nCP  \" Contains Pattern (padr\u00e3o com *)\nNP  \" Not Pattern\n\n\" Exemplos\nDATA lv_texto TYPE string VALUE 'ABAP2025'.\n\nIF lv_texto CO '0123456789'.\n  \" Cont\u00e9m apenas n\u00fameros\nENDIF.\n\nIF lv_texto CA '0123456789'.\n  \" Cont\u00e9m pelo menos um n\u00famero\n  WRITE: / 'Tem n\u00fameros'.\nENDIF.\n\nIF lv_texto CS 'ABAP'.\n  \" Cont\u00e9m a substring 'ABAP'\n  WRITE: / '\u00c9 sobre ABAP'.\nENDIF.\n\nIF lv_texto CP 'A*P'.\n  \" Padr\u00e3o: come\u00e7a com A e termina com P\n  WRITE: / 'Match de padr\u00e3o'.\nENDIF.\n</code></pre>"},{"location":"fundamentos/3_condicoes_logica/#if-elseif-else","title":"\ud83d\udd00 IF - ELSEIF - ELSE","text":""},{"location":"fundamentos/3_condicoes_logica/#sintaxe-basica","title":"Sintaxe B\u00e1sica","text":"<pre><code>\" IF simples\nIF condicao.\n  \" c\u00f3digo se verdadeiro\nENDIF.\n\n\" IF-ELSE\nIF nota &gt;= 10.\n  WRITE: / 'Aprovado'.\nELSE.\n  WRITE: / 'Reprovado'.\nENDIF.\n\n\" IF-ELSEIF-ELSE\nIF nota &gt;= 16.\n  WRITE: / 'Excelente'.\nELSEIF nota &gt;= 14.\n  WRITE: / 'Muito Bom'.\nELSEIF nota &gt;= 10.\n  WRITE: / 'Aprovado'.\nELSE.\n  WRITE: / 'Reprovado'.\nENDIF.\n</code></pre>"},{"location":"fundamentos/3_condicoes_logica/#condicoes-multiplas","title":"Condi\u00e7\u00f5es M\u00faltiplas","text":"<pre><code>DATA: lv_idade    TYPE i VALUE 25,\n      lv_salario  TYPE p DECIMALS 2 VALUE '2500.00',\n      lv_categoria TYPE char1 VALUE 'A'.\n\n\" M\u00faltiplas condi\u00e7\u00f5es com AND\nIF lv_idade &gt; 18 AND lv_salario &gt; 2000 AND lv_categoria = 'A'.\n  WRITE: / 'Cliente Premium'.\nENDIF.\n\n\" M\u00faltiplas condi\u00e7\u00f5es com OR\nIF lv_categoria = 'A' OR lv_categoria = 'B' OR lv_salario &gt; 5000.\n  WRITE: / 'Desconto especial'.\nENDIF.\n\n\" Combina\u00e7\u00e3o de AND e OR (usar par\u00eanteses)\nIF ( lv_idade &gt; 60 OR lv_categoria = 'VIP' ) AND lv_salario &gt; 1000.\n  WRITE: / 'Benef\u00edcio concedido'.\nENDIF.\n</code></pre>"},{"location":"fundamentos/3_condicoes_logica/#if-inline-expressao-ternaria","title":"IF Inline (Express\u00e3o Tern\u00e1ria)","text":"<pre><code>\" Sintaxe moderna - express\u00e3o condicional\nDATA(lv_descricao) = COND string( \n  WHEN idade &gt;= 18 THEN 'Adulto'\n  ELSE 'Menor'\n).\n\n\" Com m\u00faltiplas condi\u00e7\u00f5es\nDATA(lv_categoria) = COND char1(\n  WHEN nota &gt;= 16 THEN 'A'\n  WHEN nota &gt;= 14 THEN 'B'\n  WHEN nota &gt;= 10 THEN 'C'\n  ELSE 'F'\n).\n\n\" Usar em atribui\u00e7\u00f5es\nDATA(lv_preco_final) = COND p DECIMALS 2(\n  WHEN cliente_vip = abap_true THEN preco * '0.8'  \" 20% desconto\n  WHEN valor_compra &gt; 1000     THEN preco * '0.9'  \" 10% desconto\n  ELSE preco\n).\n</code></pre>"},{"location":"fundamentos/3_condicoes_logica/#case-when","title":"\ud83d\udd04 CASE - WHEN","text":""},{"location":"fundamentos/3_condicoes_logica/#sintaxe-basica_1","title":"Sintaxe B\u00e1sica","text":"<pre><code>\" CASE simples\nCASE mes.\n  WHEN 1.\n    WRITE: / 'Janeiro'.\n  WHEN 2.\n    WRITE: / 'Fevereiro'.\n  WHEN 3.\n    WRITE: / 'Mar\u00e7o'.\n  WHEN OTHERS.\n    WRITE: / 'Outro m\u00eas'.\nENDCASE.\n\n\" CASE com m\u00faltiplos valores\nCASE dia_semana.\n  WHEN 1 OR 7.\n    WRITE: / 'Fim de semana'.\n  WHEN 2 OR 3 OR 4 OR 5 OR 6.\n    WRITE: / 'Dia \u00fatil'.\nENDCASE.\n</code></pre>"},{"location":"fundamentos/3_condicoes_logica/#case-com-ranges","title":"CASE com Ranges","text":"<pre><code>DATA lv_nota TYPE i VALUE 15.\n\nCASE lv_nota.\n  WHEN 0 TO 9.\n    WRITE: / 'Reprovado'.\n  WHEN 10 TO 13.\n    WRITE: / 'Suficiente'.\n  WHEN 14 TO 15.\n    WRITE: / 'Bom'.\n  WHEN 16 TO 17.\n    WRITE: / 'Muito Bom'.\n  WHEN 18 TO 20.\n    WRITE: / 'Excelente'.\n  WHEN OTHERS.\n    WRITE: / 'Nota inv\u00e1lida'.\nENDCASE.\n</code></pre>"},{"location":"fundamentos/3_condicoes_logica/#case-inline-switch","title":"CASE Inline (SWITCH)","text":"<pre><code>\" Sintaxe moderna - express\u00e3o SWITCH\nDATA(lv_trimestre) = SWITCH i(\n  mes\n  WHEN 1 OR 2 OR 3     THEN 1\n  WHEN 4 OR 5 OR 6     THEN 2\n  WHEN 7 OR 8 OR 9     THEN 3\n  WHEN 10 OR 11 OR 12  THEN 4\n).\n\n\" Com strings\nDATA(lv_saudacao) = SWITCH string(\n  hora\n  WHEN 0 TO 5    THEN 'Boa madrugada'\n  WHEN 6 TO 11   THEN 'Bom dia'\n  WHEN 12 TO 17  THEN 'Boa tarde'\n  WHEN 18 TO 23  THEN 'Boa noite'\n).\n\n\" Em c\u00e1lculos\nDATA(lv_taxa) = SWITCH p DECIMALS 2(\n  tipo_cliente\n  WHEN 'VIP'    THEN '0.05'\n  WHEN 'PREMIUM' THEN '0.10'\n  WHEN 'NORMAL'  THEN '0.15'\n  ELSE '0.20'\n).\n</code></pre>"},{"location":"fundamentos/3_condicoes_logica/#check-e-assert","title":"\u2705 CHECK e ASSERT","text":""},{"location":"fundamentos/3_condicoes_logica/#check-sair-se-condicao-falsa","title":"CHECK - Sair se Condi\u00e7\u00e3o Falsa","text":"<pre><code>\" Em procedimentos\nMETHOD processar_pedido.\n  \" Sai do m\u00e9todo se pedido cancelado\n  CHECK status &lt;&gt; 'CANCELADO'.\n\n  \" Continua processamento...\nENDMETHOD.\n\n\" Em loops\nLOOP AT lt_clientes INTO DATA(ls_cliente).\n  \" Pula registos inativos\n  CHECK ls_cliente-ativo = abap_true.\n\n  \" Processa apenas clientes ativos\n  WRITE: / ls_cliente-nome.\nENDLOOP.\n\n\" Sintaxe cl\u00e1ssica\nDATA lv_numero TYPE i VALUE 5.\nCHECK lv_numero &gt; 0.\nWRITE: / 'N\u00famero positivo'.  \" S\u00f3 executa se CHECK passar\n</code></pre>"},{"location":"fundamentos/3_condicoes_logica/#assert-validacao-em-desenvolvimento","title":"ASSERT - Valida\u00e7\u00e3o em Desenvolvimento","text":"<pre><code>\" ASSERT para debugging (n\u00e3o usar em produ\u00e7\u00e3o)\nDATA lv_divisor TYPE i VALUE 0.\n\n\" Lan\u00e7a exce\u00e7\u00e3o se condi\u00e7\u00e3o for falsa\nASSERT lv_divisor &lt;&gt; 0.  \" Para execu\u00e7\u00e3o se divisor for zero\n\nDATA(lv_resultado) = 10 / lv_divisor.\n\n\" Melhor usar IF em produ\u00e7\u00e3o\nIF lv_divisor = 0.\n  MESSAGE 'Divis\u00e3o por zero' TYPE 'E'.\nELSE.\n  lv_resultado = 10 / lv_divisor.\nENDIF.\n</code></pre>"},{"location":"fundamentos/3_condicoes_logica/#verificacoes-uteis","title":"\ud83d\udd0d Verifica\u00e7\u00f5es \u00dateis","text":""},{"location":"fundamentos/3_condicoes_logica/#verificar-valores-iniciais","title":"Verificar Valores Iniciais","text":"<pre><code>\" IS INITIAL - verifica se est\u00e1 vazio/inicial\nIF lv_nome IS INITIAL.\n  WRITE: / 'Nome n\u00e3o preenchido'.\nENDIF.\n\nIF lv_tabela IS NOT INITIAL.\n  WRITE: / 'Tabela tem dados'.\nENDIF.\n\n\" Valores iniciais por tipo:\n\" - N\u00fameros: 0\n\" - Strings: ''\n\" - Tabelas: vazia\n\" - Estruturas: todos campos iniciais\n</code></pre>"},{"location":"fundamentos/3_condicoes_logica/#verificar-existencia-em-tabela","title":"Verificar Exist\u00eancia em Tabela","text":"<pre><code>\" LINE_EXISTS - moderna\nIF line_exists( lt_clientes[ id = 100 ] ).\n  WRITE: / 'Cliente existe'.\nENDIF.\n\n\" Alternativa cl\u00e1ssica\nREAD TABLE lt_clientes WITH KEY id = 100 TRANSPORTING NO FIELDS.\nIF sy-subrc = 0.\n  WRITE: / 'Cliente existe'.\nENDIF.\n</code></pre>"},{"location":"fundamentos/3_condicoes_logica/#verificar-intervalo-between","title":"Verificar Intervalo (BETWEEN)","text":"<pre><code>DATA lv_preco TYPE p DECIMALS 2 VALUE '50.00'.\n\nIF lv_preco BETWEEN '10.00' AND '100.00'.\n  WRITE: / 'Pre\u00e7o dentro do intervalo'.\nENDIF.\n\n\" Equivalente a:\nIF lv_preco &gt;= '10.00' AND lv_preco &lt;= '100.00'.\n  WRITE: / 'Pre\u00e7o dentro do intervalo'.\nENDIF.\n</code></pre>"},{"location":"fundamentos/3_condicoes_logica/#verificar-tipo-de-dados","title":"Verificar Tipo de Dados","text":"<pre><code>DATA lv_valor TYPE string VALUE '123'.\n\n\" Verificar se \u00e9 num\u00e9rico\nIF lv_valor CO '0123456789'.\n  DATA(lv_numero) = CONV i( lv_valor ).\n  WRITE: / 'Valor convertido:', lv_numero.\nENDIF.\n</code></pre>"},{"location":"fundamentos/3_condicoes_logica/#boas-praticas","title":"\ud83c\udfa8 Boas Pr\u00e1ticas","text":""},{"location":"fundamentos/3_condicoes_logica/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Usar express\u00f5es modernas quando apropriado\nDATA(lv_status) = COND string(\n  WHEN nota &gt;= 10 THEN 'Aprovado'\n  ELSE 'Reprovado'\n).\n\n\" 2. Extrair condi\u00e7\u00f5es complexas para vari\u00e1veis\nDATA(lv_cliente_premium) = xsdbool( \n  categoria = 'VIP' OR valor_compra &gt; 1000 \n).\n\nIF lv_cliente_premium = abap_true.\n  \" c\u00f3digo...\nENDIF.\n\n\" 3. Usar CASE em vez de m\u00faltiplos IF-ELSEIF\nCASE status.\n  WHEN 'A'.\n    processar_ativo( ).\n  WHEN 'P'.\n    processar_pendente( ).\n  WHEN 'C'.\n    processar_cancelado( ).\nENDCASE.\n</code></pre>"},{"location":"fundamentos/3_condicoes_logica/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. IFs aninhados excessivos\nIF condicao1 = abap_true.\n  IF condicao2 = abap_true.\n    IF condicao3 = abap_true.\n      IF condicao4 = abap_true.\n        \" Muito profundo! \u274c\n      ENDIF.\n    ENDIF.\n  ENDIF.\nENDIF.\n\n\" Melhor: usar AND ou extrair para m\u00e9todo\nIF condicao1 = abap_true AND \n   condicao2 = abap_true AND\n   condicao3 = abap_true AND\n   condicao4 = abap_true.\n  \" Mais leg\u00edvel \u2705\nENDIF.\n\n\" 2. Comparar com abap_true/abap_false desnecessariamente\nIF ativo = abap_true.  \" \u274c Redundante\nIF ativo.              \" \u2705 Suficiente\n\n\" 3. ELSE vazio\nIF condicao.\n  \" faz algo\nELSE.\n  \" nada  \u274c\nENDIF.\n\n\" Melhor:\nIF NOT condicao.  \" \u2705\n  \" faz algo\nENDIF.\n</code></pre>"},{"location":"fundamentos/3_condicoes_logica/#exemplos-praticos","title":"\ud83d\udca1 Exemplos Pr\u00e1ticos","text":""},{"location":"fundamentos/3_condicoes_logica/#validacao-de-dados","title":"Valida\u00e7\u00e3o de Dados","text":"<pre><code>METHOD validar_cliente.\n  \" Valida\u00e7\u00f5es com mensagens claras\n  IF nome IS INITIAL.\n    MESSAGE 'Nome obrigat\u00f3rio' TYPE 'E'.\n    RETURN.\n  ENDIF.\n\n  IF idade &lt; 18.\n    MESSAGE 'Cliente deve ser maior de idade' TYPE 'E'.\n    RETURN.\n  ENDIF.\n\n  IF email NS '@'.\n    MESSAGE 'Email inv\u00e1lido' TYPE 'E'.\n    RETURN.\n  ENDIF.\n\n  \" Todas valida\u00e7\u00f5es passaram\n  MESSAGE 'Cliente v\u00e1lido' TYPE 'S'.\nENDMETHOD.\n</code></pre>"},{"location":"fundamentos/3_condicoes_logica/#calculo-de-desconto","title":"C\u00e1lculo de Desconto","text":"<pre><code>METHOD calcular_desconto.\n  DATA(lv_desconto) = SWITCH p DECIMALS 2(\n    tipo_cliente\n    WHEN 'VIP'      THEN valor * '0.20'  \" 20%\n    WHEN 'PREMIUM'  THEN valor * '0.15'  \" 15%\n    WHEN 'REGULAR'  THEN valor * '0.10'  \" 10%\n    ELSE valor * '0.05'                   \" 5%\n  ).\n\n  \" Desconto adicional por volume\n  IF quantidade &gt; 100.\n    lv_desconto = lv_desconto + ( valor * '0.05' ).\n  ENDIF.\n\n  RETURN lv_desconto.\nENDMETHOD.\n</code></pre>"},{"location":"fundamentos/3_condicoes_logica/#classificacao-de-pedido","title":"Classifica\u00e7\u00e3o de Pedido","text":"<pre><code>METHOD classificar_pedido.\n  DATA lv_prioridade TYPE char1.\n\n  CASE abap_true.\n    WHEN urgente = abap_true AND valor &gt; 10000.\n      lv_prioridade = 'A'.  \" Urgente e alto valor\n\n    WHEN urgente = abap_true.\n      lv_prioridade = 'B'.  \" Apenas urgente\n\n    WHEN valor &gt; 10000.\n      lv_prioridade = 'C'.  \" Apenas alto valor\n\n    WHEN OTHERS.\n      lv_prioridade = 'D'.  \" Normal\n  ENDCASE.\n\n  RETURN lv_prioridade.\nENDMETHOD.\n</code></pre>"},{"location":"fundamentos/3_condicoes_logica/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<p>Agora que domina condi\u00e7\u00f5es e l\u00f3gica, continue para:</p> <ol> <li>Loops - Estruturas de repeti\u00e7\u00e3o</li> <li>Express\u00f5es - Express\u00f5es modernas ABAP</li> <li>Tabelas Internas - Trabalhar com cole\u00e7\u00f5es de dados</li> </ol> <p>Tags: <code>#Fundamentos</code> <code>#Condi\u00e7\u00f5es</code> <code>#IF</code> <code>#CASE</code> <code>#L\u00f3gica</code> <code>#Modern-ABAP</code></p>"},{"location":"fundamentos/4_loops/","title":"Loops","text":""},{"location":"fundamentos/4_loops/#loop-at-tabelas-internas","title":"LOOP AT (Tabelas Internas)","text":""},{"location":"fundamentos/4_loops/#sintaxe-moderna-com-declaracao-inline","title":"Sintaxe Moderna com Declara\u00e7\u00e3o Inline","text":"<pre><code>\" Declara\u00e7\u00e3o inline do work area\nLOOP AT lt_clientes INTO DATA(ls_cliente).\n  WRITE: / ls_cliente-nome, ls_cliente-cidade.\nENDLOOP.\n\n\" Com field-symbol (mais eficiente, n\u00e3o copia dados)\nLOOP AT lt_produtos ASSIGNING FIELD-SYMBOL(&lt;ls_produto&gt;).\n  &lt;ls_produto&gt;-preco = &lt;ls_produto&gt;-preco * '1.1'.  \" Aumenta 10%\nENDLOOP.\n\n\" Com refer\u00eancia (para estruturas grandes)\nLOOP AT lt_documentos REFERENCE INTO DATA(lr_doc).\n  WRITE: / lr_doc-&gt;numero, lr_doc-&gt;descricao.\nENDLOOP.\n</code></pre>"},{"location":"fundamentos/4_loops/#sintaxe-tradicional","title":"Sintaxe Tradicional","text":"<pre><code>DATA ls_cliente TYPE ty_cliente.\n\nLOOP AT lt_clientes INTO ls_cliente.\n  WRITE: / ls_cliente-nome.\nENDLOOP.\n\n\" Com field-symbol declarado\nFIELD-SYMBOLS &lt;ls_produto&gt; TYPE ty_produto.\n\nLOOP AT lt_produtos ASSIGNING &lt;ls_produto&gt;.\n  &lt;ls_produto&gt;-stock = &lt;ls_produto&gt;-stock - 1.\nENDLOOP.\n</code></pre>"},{"location":"fundamentos/4_loops/#loop-com-condicoes-where","title":"Loop com Condi\u00e7\u00f5es WHERE","text":"<pre><code>\" Filtrar durante o loop\nLOOP AT lt_clientes INTO DATA(ls_cliente)\n  WHERE pais = 'PT' AND ativo = abap_true.\n\n  WRITE: / ls_cliente-nome.\nENDLOOP.\n\n\" M\u00faltiplas condi\u00e7\u00f5es\nLOOP AT lt_produtos ASSIGNING FIELD-SYMBOL(&lt;ls_prod&gt;)\n  WHERE categoria = 'ELETRO' \n    AND preco &gt; 100\n    AND stock &gt; 0.\n\n  \" Processar produtos\nENDLOOP.\n\n\" Com OR\nLOOP AT lt_pedidos INTO DATA(ls_pedido)\n  WHERE status = 'A' OR status = 'P'.\n\n  WRITE: / ls_pedido-numero.\nENDLOOP.\n</code></pre>"},{"location":"fundamentos/4_loops/#loop-com-fromto","title":"Loop com FROM/TO","text":"<pre><code>\" Processar linhas espec\u00edficas\nLOOP AT lt_dados INTO DATA(ls_dado) FROM 10 TO 20.\n  WRITE: / ls_dado-campo.\nENDLOOP.\n\n\" Apenas primeiros N registos\nLOOP AT lt_clientes INTO DATA(ls_cliente) TO 100.\n  \" Processa apenas primeiros 100\nENDLOOP.\n</code></pre>"},{"location":"fundamentos/4_loops/#controlo-de-fluxo-no-loop","title":"Controlo de Fluxo no Loop","text":""},{"location":"fundamentos/4_loops/#continue-e-exit","title":"CONTINUE e EXIT","text":"<pre><code>LOOP AT lt_produtos INTO DATA(ls_produto).\n\n  \" Saltar este registo\n  IF ls_produto-tipo = 'OBSOLETO'.\n    CONTINUE.  \" Vai para pr\u00f3xima itera\u00e7\u00e3o\n  ENDIF.\n\n  \" Parar loop completamente\n  IF ls_produto-categoria = 'DESCONTINUADO'.\n    EXIT.  \" Sai do loop\n  ENDIF.\n\n  \" Processar produto\n  WRITE: / ls_produto-descricao.\n\nENDLOOP.\n</code></pre>"},{"location":"fundamentos/4_loops/#check","title":"CHECK","text":"<pre><code>\" CHECK: continua apenas se condi\u00e7\u00e3o verdadeira\nLOOP AT lt_clientes INTO DATA(ls_cliente).\n\n  CHECK ls_cliente-ativo = abap_true.  \" Salta se n\u00e3o ativo\n  CHECK ls_cliente-pais = 'PT'.        \" Salta se n\u00e3o PT\n\n  \" S\u00f3 chega aqui se ambas condi\u00e7\u00f5es verdadeiras\n  WRITE: / ls_cliente-nome.\n\nENDLOOP.\n</code></pre>"},{"location":"fundamentos/4_loops/#informacao-do-loop-sy-tabix-sy-subrc","title":"Informa\u00e7\u00e3o do Loop (sy-tabix, sy-subrc)","text":"<pre><code>LOOP AT lt_produtos INTO DATA(ls_produto).\n\n  \" sy-tabix = \u00edndice atual (1-based)\n  WRITE: / |Linha { sy-tabix }: { ls_produto-nome }|.\n\n  \" Processar apenas linhas pares\n  IF sy-tabix MOD 2 = 0.\n    \" L\u00f3gica para pares\n  ENDIF.\n\nENDLOOP.\n\n\" sy-subrc ap\u00f3s loop\nIF sy-subrc = 0.\n  WRITE: / 'Loop processou pelo menos 1 registo'.\nELSE.\n  WRITE: / 'Tabela vazia ou nenhum registo correspondeu'.\nENDIF.\n</code></pre>"},{"location":"fundamentos/4_loops/#do-loop-com-contador","title":"DO (Loop com Contador)","text":"<pre><code>\" Loop N vezes\nDO 10 TIMES.\n  WRITE: / |Itera\u00e7\u00e3o { sy-index }|.\nENDDO.\n\n\" Loop infinito (com EXIT)\nDATA lv_contador TYPE i.\n\nDO.\n  lv_contador = lv_contador + 1.\n\n  IF lv_contador &gt; 100.\n    EXIT.\n  ENDIF.\n\n  \" Processar\nENDDO.\n\n\" Com vari\u00e1vel inline\nDO DATA(lv_max) TIMES.\n  lv_max = 5.\n  WRITE: / sy-index.\nENDDO.\n</code></pre>"},{"location":"fundamentos/4_loops/#while-loop-com-condicao","title":"WHILE (Loop com Condi\u00e7\u00e3o)","text":"<pre><code>DATA lv_soma TYPE i VALUE 0.\nDATA lv_num TYPE i VALUE 1.\n\nWHILE lv_soma &lt; 100.\n  lv_soma = lv_soma + lv_num.\n  lv_num = lv_num + 1.\nENDWHILE.\n\nWRITE: / |Soma final: { lv_soma }|.\n\n\" Com m\u00faltiplas condi\u00e7\u00f5es\nWHILE lv_contador &lt; 1000 AND lv_erro = abap_false.\n  \" Processar\n  lv_contador = lv_contador + 1.\nENDWHILE.\n</code></pre>"},{"location":"fundamentos/4_loops/#loops-aninhados","title":"Loops Aninhados","text":"<pre><code>\" Loop dentro de loop\nLOOP AT lt_clientes INTO DATA(ls_cliente).\n\n  WRITE: / |Cliente: { ls_cliente-nome }|.\n\n  LOOP AT lt_pedidos INTO DATA(ls_pedido)\n    WHERE cliente_id = ls_cliente-id.\n\n    WRITE: /10 |Pedido: { ls_pedido-numero }|.\n\n  ENDLOOP.\n\nENDLOOP.\n\n\" Com controlo de fluxo\nLOOP AT lt_categorias INTO DATA(ls_cat).\n\n  DATA(lv_encontrado) = abap_false.\n\n  LOOP AT lt_produtos INTO DATA(ls_prod)\n    WHERE categoria = ls_cat-id.\n\n    lv_encontrado = abap_true.\n    EXIT.  \" Apenas verifica se existe\n\n  ENDLOOP.\n\n  IF lv_encontrado = abap_true.\n    WRITE: / |Categoria { ls_cat-nome } tem produtos|.\n  ENDIF.\n\nENDLOOP.\n</code></pre>"},{"location":"fundamentos/4_loops/#loop-em-grupos-group-by","title":"Loop em Grupos (GROUP BY)","text":"<pre><code>\" Agrupar e processar\nLOOP AT lt_vendas INTO DATA(ls_venda)\n  GROUP BY ( pais = ls_venda-pais \n             ano  = ls_venda-ano )\n  ASSIGNING FIELD-SYMBOL(&lt;group&gt;).\n\n  WRITE: / |Pa\u00eds: { &lt;group&gt;-pais }, Ano: { &lt;group&gt;-ano }|.\n\n  DATA lv_total TYPE p DECIMALS 2.\n  CLEAR lv_total.\n\n  \" Loop nos membros do grupo\n  LOOP AT GROUP &lt;group&gt; INTO DATA(ls_venda_grupo).\n    lv_total = lv_total + ls_venda_grupo-valor.\n  ENDLOOP.\n\n  WRITE: / |Total: { lv_total }|.\n\nENDLOOP.\n</code></pre>"},{"location":"fundamentos/4_loops/#loop-com-indice-personalizado","title":"Loop com \u00cdndice Personalizado","text":"<pre><code>DATA lv_contador TYPE i.\n\nLOOP AT lt_dados INTO DATA(ls_dado).\n\n  lv_contador = lv_contador + 1.\n\n  WRITE: / |Registo { lv_contador } de { lines( lt_dados ) }: { ls_dado-valor }|.\n\n  \" Processar \u00faltimo registo de forma diferente\n  IF lv_contador = lines( lt_dados ).\n    WRITE: / 'Este \u00e9 o \u00faltimo registo'.\n  ENDIF.\n\nENDLOOP.\n</code></pre>"},{"location":"fundamentos/4_loops/#parallel-cursor-multiplas-tabelas","title":"Parallel Cursor (M\u00faltiplas Tabelas)","text":"<pre><code>DATA lv_idx TYPE i VALUE 1.\n\nLOOP AT lt_cabecalho INTO DATA(ls_cab).\n\n  \" Ler tabela de itens na posi\u00e7\u00e3o correspondente\n  READ TABLE lt_itens INDEX lv_idx INTO DATA(ls_item).\n  IF sy-subrc = 0.\n    WRITE: / |{ ls_cab-numero } - { ls_item-descricao }|.\n  ENDIF.\n\n  lv_idx = lv_idx + 1.\n\nENDLOOP.\n</code></pre>"},{"location":"fundamentos/4_loops/#reduce-reducaoagregacao","title":"REDUCE (Redu\u00e7\u00e3o/Agrega\u00e7\u00e3o)","text":"<pre><code>\" Somar valores\nDATA(lv_total) = REDUCE decfloat34( \n  INIT sum = 0\n  FOR ls_produto IN lt_produtos\n  NEXT sum = sum + ls_produto-preco \n).\n\n\" Concatenar strings\nDATA(lv_nomes) = REDUCE string(\n  INIT texto = ''\n  FOR ls_cliente IN lt_clientes\n  NEXT texto = texto &amp;&amp; ls_cliente-nome &amp;&amp; ', '\n).\n\n\" Contar registos com condi\u00e7\u00e3o\nDATA(lv_ativos) = REDUCE i(\n  INIT count = 0\n  FOR ls_cliente IN lt_clientes\n  WHERE ( ativo = abap_true )\n  NEXT count = count + 1\n).\n</code></pre>"},{"location":"fundamentos/4_loops/#for-iteracao-em-expressoes","title":"FOR (Itera\u00e7\u00e3o em Express\u00f5es)","text":"<pre><code>\" Construir tabela com FOR\nDATA(lt_quadrados) = VALUE ty_t_numeros(\n  FOR i = 1 THEN i + 1 WHILE i &lt;= 10\n  ( i * i )\n).\n\n\" Transformar tabela\nDATA(lt_nomes) = VALUE string_table(\n  FOR ls_cliente IN lt_clientes\n  ( ls_cliente-nome )\n).\n\n\" Com condi\u00e7\u00e3o WHERE\nDATA(lt_ativos) = VALUE ty_t_clientes(\n  FOR ls_cliente IN lt_clientes\n  WHERE ( ativo = abap_true )\n  ( ls_cliente )\n).\n\n\" Transforma\u00e7\u00e3o complexa\nDATA(lt_resumo) = VALUE ty_t_resumo(\n  FOR ls_venda IN lt_vendas\n  ( id     = ls_venda-id\n    total  = ls_venda-quantidade * ls_venda-preco_unit\n    status = COND #( WHEN ls_venda-pago = abap_true \n                     THEN 'Pago' \n                     ELSE 'Pendente' )\n  )\n).\n</code></pre>"},{"location":"fundamentos/4_loops/#dicas-de-boas-praticas","title":"Dicas de Boas Pr\u00e1ticas","text":"<p>Performance</p> <ul> <li>Use <code>ASSIGNING FIELD-SYMBOL</code> para modificar registos (evita c\u00f3pia)</li> <li>Use <code>INTO DATA()</code> para apenas leitura</li> <li>Use <code>REFERENCE INTO</code> para estruturas muito grandes</li> <li>Aplique WHERE sempre que poss\u00edvel (filtra antes do loop)</li> </ul> <p>Armadilhas Comuns</p> <pre><code>\" \u274c Modificar tabela durante loop (pode causar problemas)\nLOOP AT lt_dados INTO DATA(ls_dado).\n  APPEND ls_dado TO lt_dados.  \" PERIGO!\nENDLOOP.\n\n\" \u2705 Usar tabela auxiliar\nDATA lt_novos LIKE lt_dados.\nLOOP AT lt_dados INTO DATA(ls_dado).\n  APPEND ls_dado TO lt_novos.\nENDLOOP.\nAPPEND LINES OF lt_novos TO lt_dados.\n\n\" \u274c Esquecer de limpar work area\nDATA ls_cliente TYPE ty_cliente.\nLOOP AT lt_clientes INTO ls_cliente.\n  \" ls_cliente mant\u00e9m valor da itera\u00e7\u00e3o anterior!\nENDLOOP.\n\n\" \u2705 Usar declara\u00e7\u00e3o inline\nLOOP AT lt_clientes INTO DATA(ls_cliente).\n  \" ls_cliente \u00e9 sempre limpo\nENDLOOP.\n</code></pre> <p>Loop Moderno vs. Tradicional</p> <pre><code>\" \u274c Forma antiga\nDATA ls_produto TYPE ty_produto.\nLOOP AT lt_produtos INTO ls_produto.\n  ls_produto-preco = ls_produto-preco * '1.1'.\n  MODIFY lt_produtos FROM ls_produto.\nENDLOOP.\n\n\" \u2705 Forma moderna\nLOOP AT lt_produtos ASSIGNING FIELD-SYMBOL(&lt;ls_produto&gt;).\n  &lt;ls_produto&gt;-preco = &lt;ls_produto&gt;-preco * '1.1'.\nENDLOOP.\n</code></pre> <p>Escolher o Loop Correto</p> <ul> <li>LOOP AT: Tabelas internas</li> <li>DO: N\u00famero fixo de itera\u00e7\u00f5es</li> <li>WHILE: Condi\u00e7\u00e3o din\u00e2mica</li> <li>FOR: Express\u00f5es de transforma\u00e7\u00e3o</li> <li>REDUCE: Agrega\u00e7\u00f5es e c\u00e1lculos</li> </ul> <p>Tags: #Fundamentos #Loops #Modern-ABAP #Performance</p>"},{"location":"fundamentos/5_expressoes/","title":"Express\u00f5es","text":""},{"location":"fundamentos/5_expressoes/#string-templates","title":"String Templates","text":""},{"location":"fundamentos/5_expressoes/#sintaxe-basica","title":"Sintaxe B\u00e1sica","text":"<pre><code>DATA(lv_nome) = 'Jo\u00e3o Silva'.\nDATA(lv_idade) = 30.\n\n\" Template simples\nDATA(lv_msg) = |Ol\u00e1, { lv_nome }!|.\n\n\" M\u00faltiplas vari\u00e1veis\nDATA(lv_info) = |Nome: { lv_nome }, Idade: { lv_idade } anos|.\n\n\" Com express\u00f5es\nDATA(lv_calc) = |O dobro da idade \u00e9 { lv_idade * 2 }|.\n</code></pre>"},{"location":"fundamentos/5_expressoes/#formatacao-em-templates","title":"Formata\u00e7\u00e3o em Templates","text":"<pre><code>DATA(lv_valor) = '1234.567'.\nDATA(lv_data) = sy-datum.\n\n\" N\u00fameros com formata\u00e7\u00e3o\nDATA(lv_fmt1) = |Valor: { lv_valor NUMBER = USER }|.  \" Formato utilizador\nDATA(lv_fmt2) = |Pre\u00e7o: { lv_valor CURRENCY = 'EUR' }|.\n\n\" Datas\nDATA(lv_data_fmt) = |Data: { lv_data DATE = USER }|.\nDATA(lv_data_iso) = |Data ISO: { lv_data DATE = ISO }|.\n\n\" Alinhamento (ALIGN LEFT/CENTER/RIGHT)\nDATA(lv_align) = |{ 'Texto' WIDTH = 20 ALIGN = RIGHT }|.\nDATA(lv_pad) = |{ lv_idade WIDTH = 5 ALIGN = RIGHT PAD = '0' }|.  \" 00030\n\n\" Mai\u00fasculas/Min\u00fasculas\nDATA(lv_upper) = |{ lv_nome CASE = UPPER }|.  \" JO\u00c3O SILVA\nDATA(lv_lower) = |{ lv_nome CASE = LOWER }|.  \" jo\u00e3o silva\n</code></pre>"},{"location":"fundamentos/5_expressoes/#templates-complexos","title":"Templates Complexos","text":"<pre><code>\" Com condi\u00e7\u00f5es inline\nDATA(lv_status) = |Cliente { COND #( WHEN lv_ativo = abap_true \n                                      THEN 'ativo' \n                                      ELSE 'inativo' ) }|.\n\n\" Aninhado\nDATA(lv_relatorio) = |Resumo: { |Total: { lv_total }| }|.\n\n\" Com chamada de m\u00e9todo\nDATA(lv_result) = |Resultado: { lo_objeto-&gt;get_valor( ) }|.\n\n\" Multilinha (com \\n ou caracteres especiais)\nDATA(lv_email) = |Ol\u00e1 { lv_nome },{ cl_abap_char_utilities=&gt;newline }|\n              &amp;&amp; |{ cl_abap_char_utilities=&gt;newline }|\n              &amp;&amp; |Obrigado pela sua encomenda.|.\n</code></pre>"},{"location":"fundamentos/5_expressoes/#operadores-aritmeticos","title":"Operadores Aritm\u00e9ticos","text":""},{"location":"fundamentos/5_expressoes/#operacoes-basicas","title":"Opera\u00e7\u00f5es B\u00e1sicas","text":"<pre><code>DATA(lv_a) = 10.\nDATA(lv_b) = 3.\n\n\" Adi\u00e7\u00e3o, subtra\u00e7\u00e3o, multiplica\u00e7\u00e3o, divis\u00e3o\nDATA(lv_soma) = lv_a + lv_b.      \" 13\nDATA(lv_sub) = lv_a - lv_b.       \" 7\nDATA(lv_mult) = lv_a * lv_b.      \" 30\nDATA(lv_div) = lv_a / lv_b.       \" 3 (divis\u00e3o inteira)\n\n\" Divis\u00e3o com decimais\nDATA(lv_div_dec) = CONV decfloat34( lv_a ) / lv_b.  \" 3.333...\n\n\" M\u00f3dulo (resto da divis\u00e3o)\nDATA(lv_resto) = lv_a MOD lv_b.   \" 1\n\n\" Pot\u00eancia\nDATA(lv_pot) = lv_a ** 2.         \" 100\n\n\" Opera\u00e7\u00f5es combinadas\nDATA(lv_result) = ( lv_a + lv_b ) * 2 - 5.\n</code></pre>"},{"location":"fundamentos/5_expressoes/#operacoes-com-atribuicao","title":"Opera\u00e7\u00f5es com Atribui\u00e7\u00e3o","text":"<pre><code>DATA lv_contador TYPE i VALUE 10.\n\n\" Incremento e decremento\nlv_contador = lv_contador + 1.\nlv_contador = lv_contador - 1.\n\n\" Multiplica\u00e7\u00e3o/divis\u00e3o com atribui\u00e7\u00e3o\nlv_contador = lv_contador * 2.\nlv_contador = lv_contador / 2.\n\n\" ADD, SUBTRACT, MULTIPLY, DIVIDE (forma tradicional)\nADD 5 TO lv_contador.\nSUBTRACT 3 FROM lv_contador.\nMULTIPLY lv_contador BY 2.\nDIVIDE lv_contador BY 4.\n</code></pre>"},{"location":"fundamentos/5_expressoes/#operacoes-com-strings","title":"Opera\u00e7\u00f5es com Strings","text":""},{"location":"fundamentos/5_expressoes/#concatenacao","title":"Concatena\u00e7\u00e3o","text":"<pre><code>DATA(lv_primeiro) = 'Jo\u00e3o'.\nDATA(lv_ultimo) = 'Silva'.\n\n\" Operador &amp;&amp; (mant\u00e9m espa\u00e7os)\nDATA(lv_nome1) = lv_primeiro &amp;&amp; ' ' &amp;&amp; lv_ultimo.\n\n\" CONCATENATE (remove espa\u00e7os trailing por defeito)\nDATA lv_nome2 TYPE string.\nCONCATENATE lv_primeiro lv_ultimo INTO lv_nome2 SEPARATED BY space.\n\n\" String template (recomendado)\nDATA(lv_nome3) = |{ lv_primeiro } { lv_ultimo }|.\n</code></pre>"},{"location":"fundamentos/5_expressoes/#manipulacao-de-strings","title":"Manipula\u00e7\u00e3o de Strings","text":"<pre><code>DATA(lv_texto) = '  ABAP Programming  '.\n\n\" Comprimento\nDATA(lv_len) = strlen( lv_texto ).\n\n\" Remover espa\u00e7os\nDATA(lv_trim) = condense( lv_texto ).  \" Remove espa\u00e7os extra\nlv_texto = shift_left( val = lv_texto ).   \" Remove espa\u00e7os \u00e0 esquerda\nlv_texto = shift_right( val = lv_texto ).  \" Remove espa\u00e7os \u00e0 direita\n\n\" Substituir\nDATA(lv_novo) = replace( val = lv_texto sub = 'ABAP' with = 'SAP' ).\n\n\" Substring\nDATA(lv_sub) = substring( val = lv_texto off = 2 len = 4 ).\n\n\" Mai\u00fasculas/Min\u00fasculas\nDATA(lv_upper) = to_upper( lv_texto ).\nDATA(lv_lower) = to_lower( lv_texto ).\n\n\" Dividir string\nSPLIT lv_texto AT space INTO DATA(lv_part1) DATA(lv_part2).\n\n\" Encontrar\nDATA(lv_pos) = find( val = lv_texto sub = 'Programming' ).\nIF lv_pos &gt;= 0.\n  WRITE: / |Encontrado na posi\u00e7\u00e3o { lv_pos }|.\nENDIF.\n</code></pre>"},{"location":"fundamentos/5_expressoes/#match-e-expressoes-regulares","title":"Match e Express\u00f5es Regulares","text":"<pre><code>DATA(lv_email) = 'utilizador@example.com'.\n\n\" Verificar padr\u00e3o\nIF matches( val = lv_email regex = '^\\w+@\\w+\\.\\w+$' ).\n  WRITE: / 'Email v\u00e1lido'.\nENDIF.\n\n\" Extrair com regex\nDATA(lv_dominio) = replace( val = lv_email regex = '^.*@' with = '' ).\n\n\" Contar ocorr\u00eancias\nDATA(lv_count) = count( val = 'teste teste teste' sub = 'teste' ).\n</code></pre>"},{"location":"fundamentos/5_expressoes/#operacoes-com-tabelas-internas","title":"Opera\u00e7\u00f5es com Tabelas Internas","text":""},{"location":"fundamentos/5_expressoes/#leitura-de-linhas","title":"Leitura de Linhas","text":"<pre><code>\" Acesso direto por \u00edndice []\nDATA(ls_primeiro) = lt_clientes[ 1 ].  \" Primeira linha\n\n\" Com DEFAULT (evita dump se n\u00e3o existir)\nDATA(ls_cliente) = VALUE #( lt_clientes[ id = 100 ] DEFAULT ls_default ).\n\n\" Acesso a campo espec\u00edfico\nDATA(lv_nome) = lt_clientes[ 1 ]-nome.\n\n\" Opcional com ?\nTRY.\n    DATA(ls_opt) = lt_clientes[ id = 999 ].\n  CATCH cx_sy_itab_line_not_found.\n    \" Linha n\u00e3o encontrada\nENDTRY.\n</code></pre>"},{"location":"fundamentos/5_expressoes/#funcoes-de-tabela","title":"Fun\u00e7\u00f5es de Tabela","text":"<pre><code>\" N\u00famero de linhas\nDATA(lv_count) = lines( lt_clientes ).\n\n\" Existe linha?\nIF line_exists( lt_clientes[ id = 100 ] ).\n  WRITE: / 'Cliente existe'.\nENDIF.\n\n\" \u00cdndice da linha\nDATA(lv_idx) = line_index( lt_clientes[ nome = 'Jo\u00e3o' ] ).\n</code></pre>"},{"location":"fundamentos/5_expressoes/#filter","title":"FILTER","text":"<pre><code>\" Filtrar tabela\nDATA(lt_ativos) = FILTER #( lt_clientes WHERE ativo = abap_true ).\n\n\" Com m\u00faltiplas condi\u00e7\u00f5es\nDATA(lt_filtrado) = FILTER #( lt_produtos \n  WHERE categoria = 'ELETRO' \n    AND preco &gt; 100 \n    AND stock &gt; 0 \n).\n\n\" EXCEPT - excluir registos\nDATA(lt_inativos) = FILTER #( lt_clientes EXCEPT WHERE ativo = abap_true ).\n</code></pre>"},{"location":"fundamentos/5_expressoes/#value-constructor","title":"VALUE Constructor","text":""},{"location":"fundamentos/5_expressoes/#criar-estruturas","title":"Criar Estruturas","text":"<pre><code>\" Estrutura simples\nDATA(ls_pessoa) = VALUE ty_pessoa(\n  id    = 1\n  nome  = 'Ana'\n  idade = 25\n).\n\n\" Com BASE (manter valores existentes)\nls_pessoa = VALUE #( BASE ls_pessoa\n  idade = 26\n).\n\n\" Estrutura aninhada\nDATA(ls_pedido) = VALUE ty_pedido(\n  numero = '001'\n  cliente = VALUE #(\n    id   = 100\n    nome = 'Cliente XYZ'\n  )\n  itens = VALUE #(\n    ( produto = 'A' qtd = 5 )\n    ( produto = 'B' qtd = 3 )\n  )\n).\n</code></pre>"},{"location":"fundamentos/5_expressoes/#criar-tabelas","title":"Criar Tabelas","text":"<pre><code>\" Tabela com valores diretos\nDATA(lt_numeros) = VALUE ty_t_int( ( 1 ) ( 2 ) ( 3 ) ( 4 ) ( 5 ) ).\n\n\" Tabela de estruturas\nDATA(lt_clientes) = VALUE ty_t_clientes(\n  ( id = 1 nome = 'Jo\u00e3o'  ativo = abap_true )\n  ( id = 2 nome = 'Maria' ativo = abap_true )\n  ( id = 3 nome = 'Pedro' ativo = abap_false )\n).\n\n\" Com BASE (adicionar a existente)\nlt_clientes = VALUE #( BASE lt_clientes\n  ( id = 4 nome = 'Ana' ativo = abap_true )\n).\n\n\" Com LINES OF (juntar tabelas)\nDATA(lt_todos) = VALUE ty_t_clientes(\n  ( id = 1 nome = 'A' )\n  LINES OF lt_clientes\n  ( id = 999 nome = 'Z' )\n).\n</code></pre>"},{"location":"fundamentos/5_expressoes/#corresponding","title":"CORRESPONDING","text":""},{"location":"fundamentos/5_expressoes/#entre-estruturas","title":"Entre Estruturas","text":"<pre><code>\" Copiar campos com mesmo nome\nDATA(ls_destino) = CORRESPONDING ty_destino( ls_origem ).\n\n\" Com BASE\nls_destino = CORRESPONDING #( BASE ls_destino ls_origem ).\n\n\" Com MAPPING (mapear campos diferentes)\nls_destino = CORRESPONDING #( ls_origem \n  MAPPING campo_dest = campo_orig\n          nome_novo  = nome_antigo\n).\n\n\" EXCEPT (excluir campos)\nls_destino = CORRESPONDING #( ls_origem EXCEPT campo1 campo2 ).\n</code></pre>"},{"location":"fundamentos/5_expressoes/#entre-tabelas","title":"Entre Tabelas","text":"<pre><code>\" Converter tabela completa\nDATA(lt_destino) = CORRESPONDING ty_t_destino( lt_origem ).\n\n\" Manter registos + adicionar\nlt_destino = CORRESPONDING #( BASE lt_destino lt_origem ).\n\n\" Com transforma\u00e7\u00e3o inline\nDATA(lt_resumo) = CORRESPONDING ty_t_resumo( lt_vendas\n  MAPPING id_resumo = id_venda\n          valor_total = valor\n).\n</code></pre>"},{"location":"fundamentos/5_expressoes/#conv-conversao-de-tipos","title":"CONV (Convers\u00e3o de Tipos)","text":"<pre><code>\" Converter tipos b\u00e1sicos\nDATA(lv_string) = '12345'.\nDATA(lv_int) = CONV i( lv_string ).\n\nDATA(lv_decimal) = CONV decfloat34( '3.14159' ).\nDATA(lv_packed) = CONV p( lv_decimal ).\n\n\" Em express\u00f5es\nDATA(lv_resultado) = CONV decfloat34( lv_valor1 ) / CONV decfloat34( lv_valor2 ).\n\n\" Com data/hora\nDATA(lv_timestamp) = CONV timestamp( utclong_current( ) ).\n</code></pre>"},{"location":"fundamentos/5_expressoes/#cast-conversao-de-objetos","title":"CAST (Convers\u00e3o de Objetos)","text":"<pre><code>\" Cast de refer\u00eancias\nDATA lo_generic TYPE REF TO object.\nDATA(lo_specific) = CAST cl_my_class( lo_generic ).\n\n\" Cast seguro com TRY\nTRY.\n    DATA(lo_cliente) = CAST cl_cliente( lo_objeto ).\n    lo_cliente-&gt;processar( ).\n  CATCH cx_sy_move_cast_error.\n    \" Cast falhou\nENDTRY.\n\n\" Verificar tipo antes\nIF lo_objeto IS INSTANCE OF cl_cliente.\n  DATA(lo_cli) = CAST cl_cliente( lo_objeto ).\nENDIF.\n</code></pre>"},{"location":"fundamentos/5_expressoes/#ref-criar-referencia","title":"REF (Criar Refer\u00eancia)","text":"<pre><code>\" Criar refer\u00eancia a vari\u00e1vel\nDATA lv_valor TYPE i VALUE 100.\nDATA(lr_valor) = REF #( lv_valor ).\n\n\" Modificar via refer\u00eancia\nlr_valor-&gt;* = 200.  \" lv_valor agora \u00e9 200\n\n\" Refer\u00eancia a estrutura\nDATA ls_cliente TYPE ty_cliente.\nDATA(lr_cliente) = REF #( ls_cliente ).\nlr_cliente-&gt;nome = 'Jo\u00e3o'.\n\n\" Criar nova inst\u00e2ncia\nDATA(lr_nova) = NEW ty_cliente( ).\n</code></pre>"},{"location":"fundamentos/5_expressoes/#dicas-de-boas-praticas","title":"Dicas de Boas Pr\u00e1ticas","text":"<p>String Templates</p> <ul> <li>Use sempre string templates em vez de CONCATENATE</li> <li>Mais leg\u00edvel e menos propenso a erros</li> <li>Performance equivalente ou melhor</li> </ul> <p>Cuidado com Convers\u00f5es</p> <pre><code>\" \u274c Pode perder precis\u00e3o\nDATA(lv_result) = 10 / 3.  \" Resultado: 3 (inteiro)\n\n\" \u2705 Converter para decimal primeiro\nDATA(lv_result) = CONV decfloat34( 10 ) / 3.  \" 3.333...\n\n\" \u274c Acesso direto pode causar dump\nDATA(ls_cliente) = lt_clientes[ 999 ].\n\n\" \u2705 Com tratamento de erro\nTRY.\n    DATA(ls_cliente) = lt_clientes[ 999 ].\n  CATCH cx_sy_itab_line_not_found.\nENDTRY.\n</code></pre> <p>Express\u00f5es Modernas</p> <pre><code>\" \u274c Forma antiga\nDATA lv_resultado TYPE string.\nIF lv_idade &gt;= 18.\n  lv_resultado = 'Adulto'.\nELSE.\n  lv_resultado = 'Menor'.\nENDIF.\nCONCATENATE 'Status:' lv_resultado INTO lv_resultado SEPARATED BY space.\n\n\" \u2705 Forma moderna\nDATA(lv_resultado) = |Status: { COND #( WHEN lv_idade &gt;= 18 \n                                         THEN 'Adulto' \n                                         ELSE 'Menor' ) }|.\n</code></pre> <p>Performance de Express\u00f5es</p> <ul> <li>VALUE, CORRESPONDING, FILTER s\u00e3o otimizados pelo compilador</li> <li>String templates s\u00e3o t\u00e3o r\u00e1pidos quanto CONCATENATE</li> <li>Use inline declarations para reduzir c\u00f3digo</li> <li>REDUCE \u00e9 eficiente para agrega\u00e7\u00f5es</li> </ul> <p>Tags: #Fundamentos #Express\u00f5es #Modern-ABAP #Performance</p>"},{"location":"fundamentos/6_tabelas_internas/","title":"Tabelas Internas","text":""},{"location":"fundamentos/6_tabelas_internas/#tipos-de-tabelas","title":"Tipos de Tabelas","text":""},{"location":"fundamentos/6_tabelas_internas/#standard-table-mais-comum","title":"STANDARD TABLE (mais comum)","text":"<pre><code>\" Declara\u00e7\u00e3o de tipo\nTYPES ty_t_clientes TYPE STANDARD TABLE OF ty_cliente WITH DEFAULT KEY.\n\n\" Declara\u00e7\u00e3o inline\nDATA lt_produtos TYPE STANDARD TABLE OF ty_produto WITH EMPTY KEY.\n\n\" Com chave espec\u00edfica\nDATA lt_pedidos TYPE STANDARD TABLE OF ty_pedido\n  WITH NON-UNIQUE KEY numero.\n\n\" M\u00faltiplas chaves\nDATA lt_vendas TYPE STANDARD TABLE OF ty_venda\n  WITH NON-UNIQUE KEY pais ano mes\n  WITH UNIQUE SORTED KEY by_id COMPONENTS id.\n</code></pre>"},{"location":"fundamentos/6_tabelas_internas/#sorted-table","title":"SORTED TABLE","text":"<pre><code>\" Sempre ordenada pela chave\nDATA lt_clientes TYPE SORTED TABLE OF ty_cliente\n  WITH UNIQUE KEY id.\n\n\" Chave n\u00e3o \u00fanica\nDATA lt_produtos TYPE SORTED TABLE OF ty_produto\n  WITH NON-UNIQUE KEY categoria preco.\n\n\" Acesso bin\u00e1rio autom\u00e1tico (mais r\u00e1pido)\n</code></pre>"},{"location":"fundamentos/6_tabelas_internas/#hashed-table","title":"HASHED TABLE","text":"<pre><code>\" Acesso hash (muito r\u00e1pido para leitura)\nDATA lt_cache TYPE HASHED TABLE OF ty_cache\n  WITH UNIQUE KEY id.\n\n\" Ideal para lookups frequentes\nDATA lt_config TYPE HASHED TABLE OF ty_config\n  WITH UNIQUE KEY chave.\n\n\" N\u00e3o permite \u00edndice num\u00e9rico\n\" N\u00e3o pode ser ordenada\n</code></pre>"},{"location":"fundamentos/6_tabelas_internas/#inicializacao-e-preenchimento","title":"Inicializa\u00e7\u00e3o e Preenchimento","text":""},{"location":"fundamentos/6_tabelas_internas/#value-constructor","title":"VALUE Constructor","text":"<pre><code>\" Tabela vazia\nDATA(lt_empty) = VALUE ty_t_produtos( ).\n\n\" Com valores iniciais\nDATA(lt_numeros) = VALUE ty_t_int( ( 1 ) ( 2 ) ( 3 ) ( 4 ) ( 5 ) ).\n\n\" Tabela de estruturas\nDATA(lt_clientes) = VALUE ty_t_clientes(\n  ( id = 1 nome = 'Jo\u00e3o Silva'   cidade = 'Lisboa' )\n  ( id = 2 nome = 'Maria Santos' cidade = 'Porto' )\n  ( id = 3 nome = 'Pedro Costa'  cidade = 'Braga' )\n).\n\n\" Com FOR (loop inline)\nDATA(lt_quadrados) = VALUE ty_t_int(\n  FOR i = 1 THEN i + 1 WHILE i &lt;= 10\n  ( i * i )\n).\n</code></pre>"},{"location":"fundamentos/6_tabelas_internas/#append","title":"APPEND","text":"<pre><code>\" Adicionar estrutura\nDATA ls_cliente TYPE ty_cliente.\nls_cliente = VALUE #( id = 1 nome = 'Ana' ).\nAPPEND ls_cliente TO lt_clientes.\n\n\" Inline\nAPPEND VALUE #( id = 2 nome = 'Bruno' ) TO lt_clientes.\n\n\" M\u00faltiplas linhas\nAPPEND LINES OF lt_novos TO lt_clientes.\n\n\" Com FROM/TO\nAPPEND LINES OF lt_origem FROM 5 TO 10 TO lt_destino.\n</code></pre>"},{"location":"fundamentos/6_tabelas_internas/#insert","title":"INSERT","text":"<pre><code>\" Inserir em posi\u00e7\u00e3o espec\u00edfica\nDATA(ls_novo) = VALUE ty_cliente( id = 99 nome = 'Novo Cliente' ).\nINSERT ls_novo INTO lt_clientes INDEX 1.\n\n\" Inserir inline\nINSERT VALUE #( id = 100 nome = 'Outro' ) INTO lt_clientes INDEX 3.\n\n\" Inserir tabela em posi\u00e7\u00e3o\nINSERT LINES OF lt_novos INTO lt_clientes INDEX 5.\n\n\" Em sorted/hashed table (insere na posi\u00e7\u00e3o correcta)\nINSERT ls_cliente INTO TABLE lt_clientes_sorted.\n</code></pre>"},{"location":"fundamentos/6_tabelas_internas/#leitura-de-dados","title":"Leitura de Dados","text":""},{"location":"fundamentos/6_tabelas_internas/#read-table","title":"READ TABLE","text":"<pre><code>\" Por \u00edndice\nREAD TABLE lt_clientes INDEX 1 INTO DATA(ls_cliente).\nIF sy-subrc = 0.\n  WRITE: / ls_cliente-nome.\nENDIF.\n\n\" Por chave\nREAD TABLE lt_clientes INTO ls_cliente WITH KEY id = 100.\n\n\" Com ASSIGNING (mais eficiente)\nREAD TABLE lt_produtos ASSIGNING FIELD-SYMBOL(&lt;ls_prod&gt;) WITH KEY id = 200.\nIF sy-subrc = 0.\n  &lt;ls_prod&gt;-preco = &lt;ls_prod&gt;-preco * '1.1'.\nENDIF.\n\n\" Com REFERENCE\nREAD TABLE lt_clientes REFERENCE INTO DATA(lr_cliente) WITH KEY id = 50.\n\n\" Busca bin\u00e1ria (em sorted table)\nREAD TABLE lt_clientes_sorted INTO ls_cliente \n  WITH KEY id = 100 BINARY SEARCH.\n</code></pre>"},{"location":"fundamentos/6_tabelas_internas/#acesso-direto-por","title":"Acesso Direto por []","text":"<pre><code>\" Por \u00edndice (pode causar dump se n\u00e3o existir)\nDATA(ls_primeiro) = lt_clientes[ 1 ].\n\n\" Por chave\nDATA(ls_cliente) = lt_clientes[ id = 100 ].\n\n\" Com KEY secund\u00e1ria\nDATA(ls_venda) = lt_vendas[ KEY by_date data = lv_data ].\n\n\" Acesso a campo espec\u00edfico\nDATA(lv_nome) = lt_clientes[ 1 ]-nome.\n\n\" Com DEFAULT (evita dump)\nDATA(ls_safe) = VALUE #( lt_clientes[ id = 999 ] \n                          DEFAULT VALUE #( id = 0 nome = 'N\u00e3o encontrado' ) ).\n\n\" OPTIONAL - retorna refer\u00eancia ou null\nTRY.\n    DATA(ls_opt) = lt_clientes[ id = 999 ].\n  CATCH cx_sy_itab_line_not_found.\n    \" Tratar aus\u00eancia\nENDTRY.\n</code></pre>"},{"location":"fundamentos/6_tabelas_internas/#modificacao-de-dados","title":"Modifica\u00e7\u00e3o de Dados","text":""},{"location":"fundamentos/6_tabelas_internas/#modify","title":"MODIFY","text":"<pre><code>\" Modificar linha espec\u00edfica\nDATA(ls_update) = VALUE ty_cliente( id = 1 nome = 'Nome Atualizado' ).\nMODIFY TABLE lt_clientes FROM ls_update.\n\n\" Modificar por \u00edndice\nMODIFY lt_clientes INDEX 1 FROM ls_update.\n\n\" Modificar dentro de loop\nLOOP AT lt_produtos ASSIGNING FIELD-SYMBOL(&lt;ls_prod&gt;).\n  &lt;ls_prod&gt;-preco = &lt;ls_prod&gt;-preco * '1.1'.\nENDLOOP.\n\n\" MODIFY dentro de loop (menos eficiente)\nLOOP AT lt_clientes INTO DATA(ls_cli).\n  ls_cli-ultima_atualizacao = sy-datum.\n  MODIFY lt_clientes FROM ls_cli.\nENDLOOP.\n\n\" Inline com TRANSPORTING\nMODIFY lt_produtos FROM VALUE #( id = 100 stock = 50 )\n  TRANSPORTING stock WHERE id = 100.\n</code></pre>"},{"location":"fundamentos/6_tabelas_internas/#delete","title":"DELETE","text":"<pre><code>\" Deletar por \u00edndice\nDELETE lt_clientes INDEX 1.\n\n\" Deletar por chave\nDELETE TABLE lt_clientes WITH TABLE KEY id = 100.\n\n\" Deletar com WHERE\nDELETE lt_produtos WHERE stock = 0.\n\n\" Deletar dentro de loop\nLOOP AT lt_clientes INTO DATA(ls_cli).\n  IF ls_cli-ativo = abap_false.\n    DELETE lt_clientes.  \" Deleta linha atual\n  ENDIF.\nENDLOOP.\n\n\" Deletar linhas adjacentes\nDELETE lt_clientes FROM 5 TO 10.\n\n\" Limpar tabela completa\nCLEAR lt_clientes.\n\" ou\nlt_clientes = VALUE #( ).\n\" ou\nREFRESH lt_clientes.\n</code></pre>"},{"location":"fundamentos/6_tabelas_internas/#ordenacao","title":"Ordena\u00e7\u00e3o","text":""},{"location":"fundamentos/6_tabelas_internas/#sort","title":"SORT","text":"<pre><code>\" Ordena\u00e7\u00e3o simples (ascendente)\nSORT lt_clientes BY nome.\n\n\" Descendente\nSORT lt_clientes BY nome DESCENDING.\n\n\" M\u00faltiplos campos\nSORT lt_vendas BY pais ASCENDING ano DESCENDING mes ASCENDING.\n\n\" Caso insensitivo\nSORT lt_produtos BY descricao AS TEXT.\n\n\" Est\u00e1vel (mant\u00e9m ordem original para iguais)\nSORT lt_dados BY campo STABLE.\n</code></pre>"},{"location":"fundamentos/6_tabelas_internas/#filtros-e-transformacoes","title":"Filtros e Transforma\u00e7\u00f5es","text":""},{"location":"fundamentos/6_tabelas_internas/#filter","title":"FILTER","text":"<pre><code>\" Filtrar com WHERE\nDATA(lt_ativos) = FILTER #( lt_clientes WHERE ativo = abap_true ).\n\n\" M\u00faltiplas condi\u00e7\u00f5es\nDATA(lt_premium) = FILTER #( lt_clientes \n  WHERE tipo = 'VIP' \n    AND saldo &gt; 10000 \n    AND ativo = abap_true \n).\n\n\" EXCEPT - inverter filtro\nDATA(lt_inativos) = FILTER #( lt_clientes EXCEPT WHERE ativo = abap_true ).\n\n\" Com chave secund\u00e1ria\nDATA(lt_filtrado) = FILTER #( lt_vendas \n  USING KEY by_pais \n  WHERE pais = 'PT' \n).\n</code></pre>"},{"location":"fundamentos/6_tabelas_internas/#reduce-agregacoes","title":"REDUCE (Agrega\u00e7\u00f5es)","text":"<pre><code>\" Somar valores\nDATA(lv_total) = REDUCE decfloat34(\n  INIT sum = 0\n  FOR ls_venda IN lt_vendas\n  NEXT sum = sum + ls_venda-valor\n).\n\n\" Contar com condi\u00e7\u00e3o\nDATA(lv_count_ativos) = REDUCE i(\n  INIT cnt = 0\n  FOR ls_cliente IN lt_clientes\n  WHERE ( ativo = abap_true )\n  NEXT cnt = cnt + 1\n).\n\n\" Encontrar m\u00e1ximo\nDATA(lv_max_preco) = REDUCE decfloat34(\n  INIT max = 0\n  FOR ls_produto IN lt_produtos\n  NEXT max = COND #( WHEN ls_produto-preco &gt; max \n                     THEN ls_produto-preco \n                     ELSE max )\n).\n\n\" Concatenar strings\nDATA(lv_nomes) = REDUCE string(\n  INIT texto = ''\n  FOR ls_cliente IN lt_clientes\n  NEXT texto = texto &amp;&amp; ls_cliente-nome &amp;&amp; ', '\n).\n</code></pre>"},{"location":"fundamentos/6_tabelas_internas/#corresponding","title":"CORRESPONDING","text":"<pre><code>\" Converter entre tabelas de tipos diferentes\nDATA(lt_destino) = CORRESPONDING ty_t_destino( lt_origem ).\n\n\" Com BASE (manter existentes)\nlt_destino = CORRESPONDING #( BASE lt_destino lt_origem ).\n\n\" Com MAPPING\nDATA(lt_resumo) = CORRESPONDING ty_t_resumo( lt_vendas\n  MAPPING id_resumo = id_venda\n          total = valor\n).\n\n\" EXCEPT campos\nDATA(lt_parcial) = CORRESPONDING ty_t_parcial( lt_completo\n  EXCEPT campo1 campo2\n).\n</code></pre>"},{"location":"fundamentos/6_tabelas_internas/#operacoes-com-conjuntos","title":"Opera\u00e7\u00f5es com Conjuntos","text":""},{"location":"fundamentos/6_tabelas_internas/#comparacao-de-tabelas","title":"Compara\u00e7\u00e3o de Tabelas","text":"<pre><code>\" Verificar se iguais\nIF lt_tabela1 = lt_tabela2.\n  WRITE: / 'Tabelas id\u00eanticas'.\nENDIF.\n\n\" Verificar se vazia\nIF lt_clientes IS INITIAL.\n  WRITE: / 'Sem clientes'.\nENDIF.\n\nIF lt_clientes IS NOT INITIAL.\n  \" Processar\nENDIF.\n</code></pre>"},{"location":"fundamentos/6_tabelas_internas/#funcoes-de-tabela","title":"Fun\u00e7\u00f5es de Tabela","text":"<pre><code>\" N\u00famero de linhas\nDATA(lv_count) = lines( lt_clientes ).\n\n\" Verificar exist\u00eancia\nIF line_exists( lt_clientes[ id = 100 ] ).\n  WRITE: / 'Cliente existe'.\nENDIF.\n\n\" Obter \u00edndice\nDATA(lv_index) = line_index( lt_clientes[ nome = 'Jo\u00e3o' ] ).\nIF lv_index &gt; 0.\n  WRITE: / |Encontrado no \u00edndice { lv_index }|.\nENDIF.\n</code></pre>"},{"location":"fundamentos/6_tabelas_internas/#group-by-agrupamento","title":"GROUP BY (Agrupamento)","text":"<pre><code>\" Agrupar e processar\nLOOP AT lt_vendas INTO DATA(ls_venda)\n  GROUP BY ( pais = ls_venda-pais \n             ano  = ls_venda-ano )\n  ASSIGNING FIELD-SYMBOL(&lt;group&gt;).\n\n  WRITE: / |Pa\u00eds: { &lt;group&gt;-pais }, Ano: { &lt;group&gt;-ano }|.\n\n  \" Processar membros do grupo\n  DATA(lv_total) = REDUCE decfloat34(\n    INIT sum = 0\n    FOR ls_item IN GROUP &lt;group&gt;\n    NEXT sum = sum + ls_item-valor\n  ).\n\n  WRITE: / |Total: { lv_total }|.\n\nENDLOOP.\n\n\" Criar tabela agrupada\nDATA(lt_agrupado) = VALUE ty_t_resumo(\n  FOR GROUPS &lt;group&gt; OF ls_venda IN lt_vendas\n  GROUP BY ( pais = ls_venda-pais )\n  ( pais  = &lt;group&gt;-pais\n    total = REDUCE decfloat34(\n              INIT sum = 0\n              FOR ls IN GROUP &lt;group&gt;\n              NEXT sum = sum + ls-valor\n            )\n    count = REDUCE i(\n              INIT cnt = 0\n              FOR ls IN GROUP &lt;group&gt;\n              NEXT cnt = cnt + 1\n            )\n  )\n).\n</code></pre>"},{"location":"fundamentos/6_tabelas_internas/#tabelas-aninhadas","title":"Tabelas Aninhadas","text":"<pre><code>TYPES: BEGIN OF ty_cabecalho,\n         numero TYPE string,\n         data   TYPE datum,\n         itens  TYPE ty_t_itens,\n       END OF ty_cabecalho.\n\nDATA(lt_pedidos) = VALUE ty_t_cabecalho(\n  ( numero = 'P001'\n    data   = sy-datum\n    itens  = VALUE #(\n      ( produto = 'A' qtd = 5 preco = '10.00' )\n      ( produto = 'B' qtd = 3 preco = '20.00' )\n    )\n  )\n  ( numero = 'P002'\n    data   = sy-datum\n    itens  = VALUE #(\n      ( produto = 'C' qtd = 10 preco = '5.00' )\n    )\n  )\n).\n\n\" Processar tabelas aninhadas\nLOOP AT lt_pedidos INTO DATA(ls_pedido).\n  WRITE: / |Pedido: { ls_pedido-numero }|.\n\n  LOOP AT ls_pedido-itens INTO DATA(ls_item).\n    WRITE: /5 |Produto: { ls_item-produto }, Qtd: { ls_item-qtd }|.\n  ENDLOOP.\nENDLOOP.\n</code></pre>"},{"location":"fundamentos/6_tabelas_internas/#dicas-de-boas-praticas","title":"Dicas de Boas Pr\u00e1ticas","text":"<p>Escolha do Tipo de Tabela</p> <ul> <li>STANDARD: Uso geral, permite duplicados, acesso por \u00edndice</li> <li>SORTED: Quando precisa de ordem, busca bin\u00e1ria autom\u00e1tica</li> <li>HASHED: Lookups muito frequentes, grandes volumes</li> </ul> <p>Performance</p> <pre><code>\" \u274c Evitar - leitura linear em loop\nLOOP AT lt_pedidos INTO DATA(ls_ped).\n  READ TABLE lt_clientes INTO DATA(ls_cli) \n    WITH KEY id = ls_ped-cliente_id.\nENDLOOP.\n\n\" \u2705 Preferir - usar HASHED ou SORTED\nDATA lt_clientes TYPE HASHED TABLE OF ty_cliente\n  WITH UNIQUE KEY id.\n\n\" \u2705 Ou criar \u00edndice secund\u00e1rio\nDATA lt_clientes TYPE STANDARD TABLE OF ty_cliente\n  WITH NON-UNIQUE KEY id\n  WITH UNIQUE HASHED KEY by_id COMPONENTS id.\n</code></pre> <p>Sintaxe Moderna</p> <pre><code>\" \u274c Forma antiga\nDATA lt_resultado TYPE ty_t_clientes.\nDATA ls_cliente TYPE ty_cliente.\n\nLOOP AT lt_clientes INTO ls_cliente WHERE ativo = abap_true.\n  APPEND ls_cliente TO lt_resultado.\nENDLOOP.\n\n\" \u2705 Forma moderna\nDATA(lt_resultado) = FILTER #( lt_clientes WHERE ativo = abap_true ).\n</code></pre> <p>Declara\u00e7\u00e3o de Chaves</p> <pre><code>\" \u274c Evitar DEFAULT KEY (amb\u00edguo)\nDATA lt_data TYPE STANDARD TABLE OF ty_struct WITH DEFAULT KEY.\n\n\" \u2705 Ser expl\u00edcito\nDATA lt_data TYPE STANDARD TABLE OF ty_struct WITH EMPTY KEY.\n\" ou\nDATA lt_data TYPE STANDARD TABLE OF ty_struct \n  WITH NON-UNIQUE KEY campo1 campo2.\n</code></pre> <p>Tags: #Fundamentos #Tabelas-Internas #Modern-ABAP #Performance</p>"},{"location":"fundamentos/7_OO_basica/","title":"Orienta\u00e7\u00e3o a Objetos - Fundamentos","text":""},{"location":"fundamentos/7_OO_basica/#definicao-de-classe","title":"Defini\u00e7\u00e3o de Classe","text":""},{"location":"fundamentos/7_OO_basica/#estrutura-basica","title":"Estrutura B\u00e1sica","text":"<pre><code>CLASS lcl_calculadora DEFINITION.\n\n  PUBLIC SECTION.\n    \" M\u00e9todos p\u00fablicos (acess\u00edveis externamente)\n    METHODS somar\n      IMPORTING iv_num1 TYPE i\n                iv_num2 TYPE i\n      RETURNING VALUE(rv_resultado) TYPE i.\n\n    METHODS subtrair\n      IMPORTING iv_num1 TYPE i\n                iv_num2 TYPE i\n      RETURNING VALUE(rv_resultado) TYPE i.\n\n  PROTECTED SECTION.\n    \" Acess\u00edvel na classe e subclasses\n    METHODS validar_numero\n      IMPORTING iv_numero TYPE i\n      RETURNING VALUE(rv_valido) TYPE abap_bool.\n\n  PRIVATE SECTION.\n    \" Apenas nesta classe\n    DATA mv_historico TYPE string.\n\n    METHODS registar_operacao\n      IMPORTING iv_operacao TYPE string.\n\nENDCLASS.\n\nCLASS lcl_calculadora IMPLEMENTATION.\n\n  METHOD somar.\n    rv_resultado = iv_num1 + iv_num2.\n    registar_operacao( |Soma: { iv_num1 } + { iv_num2 } = { rv_resultado }| ).\n  ENDMETHOD.\n\n  METHOD subtrair.\n    rv_resultado = iv_num1 - iv_num2.\n    registar_operacao( |Subtra\u00e7\u00e3o: { iv_num1 } - { iv_num2 } = { rv_resultado }| ).\n  ENDMETHOD.\n\n  METHOD validar_numero.\n    rv_valido = xsdbool( iv_numero &gt;= 0 ).\n  ENDMETHOD.\n\n  METHOD registar_operacao.\n    mv_historico = mv_historico &amp;&amp; iv_operacao &amp;&amp; cl_abap_char_utilities=&gt;newline.\n  ENDMETHOD.\n\nENDCLASS.\n</code></pre>"},{"location":"fundamentos/7_OO_basica/#instanciacao-e-uso","title":"Instancia\u00e7\u00e3o e Uso","text":""},{"location":"fundamentos/7_OO_basica/#criar-objeto","title":"Criar Objeto","text":"<pre><code>\" Forma tradicional\nDATA lo_calc TYPE REF TO lcl_calculadora.\nCREATE OBJECT lo_calc.\n\n\" Forma moderna (preferir)\nDATA(lo_calc) = NEW lcl_calculadora( ).\n\n\" Verificar se criado\nIF lo_calc IS BOUND.\n  \" Objeto existe\nENDIF.\n</code></pre>"},{"location":"fundamentos/7_OO_basica/#chamar-metodos","title":"Chamar M\u00e9todos","text":"<pre><code>\" Chamada de m\u00e9todo\nDATA(lv_resultado) = lo_calc-&gt;somar( \n  iv_num1 = 10 \n  iv_num2 = 20 \n).\n\nWRITE: / |Resultado: { lv_resultado }|.  \" 30\n\n\" M\u00e9todo sem retorno\nlo_calc-&gt;registar_operacao( 'Opera\u00e7\u00e3o manual' ).\n\n\" Encadear chamadas (method chaining)\nDATA(lv_final) = NEW lcl_calculadora( )-&gt;somar( \n  iv_num1 = 5 \n  iv_num2 = 3 \n).\n</code></pre>"},{"location":"fundamentos/7_OO_basica/#atributos-variaveis-de-instancia","title":"Atributos (Vari\u00e1veis de Inst\u00e2ncia)","text":""},{"location":"fundamentos/7_OO_basica/#tipos-de-atributos","title":"Tipos de Atributos","text":"<pre><code>CLASS lcl_cliente DEFINITION.\n\n  PUBLIC SECTION.\n    \" Atributos p\u00fablicos (evitar quando poss\u00edvel)\n    DATA mv_id TYPE i READ-ONLY.  \" Leitura p\u00fablica, escrita privada\n\n    \" M\u00e9todos getter/setter (preferir)\n    METHODS get_nome\n      RETURNING VALUE(rv_nome) TYPE string.\n\n    METHODS set_nome\n      IMPORTING iv_nome TYPE string.\n\n  PRIVATE SECTION.\n    DATA mv_nome TYPE string.\n    DATA mv_email TYPE string.\n    DATA mv_ativo TYPE abap_bool.\n    DATA mv_data_criacao TYPE timestamp.\n\nENDCLASS.\n\nCLASS lcl_cliente IMPLEMENTATION.\n\n  METHOD get_nome.\n    rv_nome = mv_nome.\n  ENDMETHOD.\n\n  METHOD set_nome.\n    mv_nome = iv_nome.\n    \" Pode adicionar valida\u00e7\u00e3o aqui\n  ENDMETHOD.\n\nENDCLASS.\n</code></pre>"},{"location":"fundamentos/7_OO_basica/#constantes-de-classe","title":"Constantes de Classe","text":"<pre><code>CLASS lcl_config DEFINITION.\n\n  PUBLIC SECTION.\n    CONSTANTS:\n      gc_versao TYPE string VALUE '1.0.0',\n      gc_max_tentativas TYPE i VALUE 3,\n      gc_timeout TYPE i VALUE 30.\n\n    CONSTANTS:\n      BEGIN OF gc_status,\n        ativo     TYPE c LENGTH 1 VALUE 'A',\n        inativo   TYPE c LENGTH 1 VALUE 'I',\n        pendente  TYPE c LENGTH 1 VALUE 'P',\n        cancelado TYPE c LENGTH 1 VALUE 'C',\n      END OF gc_status.\n\nENDCLASS.\n\n\" Uso\nIF lv_status = lcl_config=&gt;gc_status-ativo.\n  \" Processar\nENDIF.\n</code></pre>"},{"location":"fundamentos/7_OO_basica/#construtor","title":"Construtor","text":""},{"location":"fundamentos/7_OO_basica/#constructor-simples","title":"Constructor Simples","text":"<pre><code>CLASS lcl_produto DEFINITION.\n\n  PUBLIC SECTION.\n    METHODS constructor\n      IMPORTING iv_id        TYPE i\n                iv_descricao TYPE string\n                iv_preco     TYPE p.\n\n  PRIVATE SECTION.\n    DATA: mv_id        TYPE i,\n          mv_descricao TYPE string,\n          mv_preco     TYPE p.\n\nENDCLASS.\n\nCLASS lcl_produto IMPLEMENTATION.\n\n  METHOD constructor.\n    mv_id = iv_id.\n    mv_descricao = iv_descricao.\n    mv_preco = iv_preco.\n  ENDMETHOD.\n\nENDCLASS.\n\n\" Criar com construtor\nDATA(lo_produto) = NEW lcl_produto(\n  iv_id        = 1\n  iv_descricao = 'Laptop'\n  iv_preco     = '999.99'\n).\n</code></pre>"},{"location":"fundamentos/7_OO_basica/#construtor-com-validacao","title":"Construtor com Valida\u00e7\u00e3o","text":"<pre><code>CLASS lcl_email DEFINITION.\n\n  PUBLIC SECTION.\n    METHODS constructor\n      IMPORTING iv_endereco TYPE string\n      RAISING   cx_invalid_email.\n\n    METHODS get_endereco\n      RETURNING VALUE(rv_endereco) TYPE string.\n\n  PRIVATE SECTION.\n    DATA mv_endereco TYPE string.\n\n    METHODS validar_email\n      IMPORTING iv_email         TYPE string\n      RETURNING VALUE(rv_valido) TYPE abap_bool.\n\nENDCLASS.\n\nCLASS lcl_email IMPLEMENTATION.\n\n  METHOD constructor.\n    IF NOT validar_email( iv_endereco ).\n      RAISE EXCEPTION TYPE cx_invalid_email.\n    ENDIF.\n    mv_endereco = iv_endereco.\n  ENDMETHOD.\n\n  METHOD get_endereco.\n    rv_endereco = mv_endereco.\n  ENDMETHOD.\n\n  METHOD validar_email.\n    rv_valido = xsdbool( iv_email CS '@' AND iv_email CS '.' ).\n  ENDMETHOD.\n\nENDCLASS.\n\n\" Uso com tratamento de exce\u00e7\u00e3o\nTRY.\n    DATA(lo_email) = NEW lcl_email( 'usuario@example.com' ).\n  CATCH cx_invalid_email.\n    WRITE: / 'Email inv\u00e1lido'.\nENDTRY.\n</code></pre>"},{"location":"fundamentos/7_OO_basica/#metodos-estaticos","title":"M\u00e9todos Est\u00e1ticos","text":""},{"location":"fundamentos/7_OO_basica/#definicao-e-uso","title":"Defini\u00e7\u00e3o e Uso","text":"<pre><code>CLASS lcl_utilitarios DEFINITION.\n\n  PUBLIC SECTION.\n    \" M\u00e9todos de classe (est\u00e1ticos)\n    CLASS-METHODS formatar_moeda\n      IMPORTING iv_valor          TYPE p\n                iv_moeda          TYPE waers DEFAULT 'EUR'\n      RETURNING VALUE(rv_formato) TYPE string.\n\n    CLASS-METHODS gerar_uuid\n      RETURNING VALUE(rv_uuid) TYPE sysuuid_c32.\n\n  PRIVATE SECTION.\n    \" Atributos de classe (compartilhados)\n    CLASS-DATA gv_contador TYPE i.\n\nENDCLASS.\n\nCLASS lcl_utilitarios IMPLEMENTATION.\n\n  METHOD formatar_moeda.\n    rv_formato = |{ iv_valor CURRENCY = iv_moeda }|.\n  ENDMETHOD.\n\n  METHOD gerar_uuid.\n    TRY.\n        rv_uuid = cl_system_uuid=&gt;create_uuid_c32_static( ).\n      CATCH cx_uuid_error.\n        \" Tratar erro\n    ENDTRY.\n  ENDMETHOD.\n\nENDCLASS.\n\n\" Chamar m\u00e9todo est\u00e1tico (sem instanciar)\nDATA(lv_preco_fmt) = lcl_utilitarios=&gt;formatar_moeda( \n  iv_valor = '1234.56' \n).\n\nDATA(lv_uuid) = lcl_utilitarios=&gt;gerar_uuid( ).\n</code></pre>"},{"location":"fundamentos/7_OO_basica/#me-e-self-reference","title":"Me e Self-Reference","text":"<pre><code>CLASS lcl_exemplo DEFINITION.\n\n  PUBLIC SECTION.\n    METHODS set_valor\n      IMPORTING iv_valor TYPE i\n      RETURNING VALUE(ro_self) TYPE REF TO lcl_exemplo.\n\n    METHODS processar\n      RETURNING VALUE(ro_self) TYPE REF TO lcl_exemplo.\n\n    METHODS exibir.\n\n  PRIVATE SECTION.\n    DATA mv_valor TYPE i.\n\nENDCLASS.\n\nCLASS lcl_exemplo IMPLEMENTATION.\n\n  METHOD set_valor.\n    mv_valor = iv_valor.  \" 'me-&gt;' \u00e9 opcional para atributos\n    ro_self = me.         \" Retorna refer\u00eancia a si mesmo\n  ENDMETHOD.\n\n  METHOD processar.\n    me-&gt;mv_valor = me-&gt;mv_valor * 2.\n    ro_self = me.\n  ENDMETHOD.\n\n  METHOD exibir.\n    WRITE: / |Valor: { mv_valor }|.\n  ENDMETHOD.\n\nENDCLASS.\n\n\" Method chaining (encadeamento)\nNEW lcl_exemplo( )-&gt;set_valor( 10 )-&gt;processar( )-&gt;exibir( ).\n\" Output: Valor: 20\n</code></pre>"},{"location":"fundamentos/7_OO_basica/#heranca-simples","title":"Heran\u00e7a Simples","text":""},{"location":"fundamentos/7_OO_basica/#classe-base-e-derivada","title":"Classe Base e Derivada","text":"<pre><code>\" Classe base\nCLASS lcl_veiculo DEFINITION.\n\n  PUBLIC SECTION.\n    METHODS constructor\n      IMPORTING iv_marca TYPE string\n                iv_modelo TYPE string.\n\n    METHODS acelerar.\n    METHODS travar.\n\n    METHODS get_info\n      RETURNING VALUE(rv_info) TYPE string.\n\n  PROTECTED SECTION.\n    DATA: mv_marca     TYPE string,\n          mv_modelo    TYPE string,\n          mv_velocidade TYPE i.\n\nENDCLASS.\n\nCLASS lcl_veiculo IMPLEMENTATION.\n\n  METHOD constructor.\n    mv_marca = iv_marca.\n    mv_modelo = iv_modelo.\n    mv_velocidade = 0.\n  ENDMETHOD.\n\n  METHOD acelerar.\n    mv_velocidade = mv_velocidade + 10.\n  ENDMETHOD.\n\n  METHOD travar.\n    mv_velocidade = COND #( WHEN mv_velocidade &gt;= 10 \n                            THEN mv_velocidade - 10 \n                            ELSE 0 ).\n  ENDMETHOD.\n\n  METHOD get_info.\n    rv_info = |{ mv_marca } { mv_modelo } - { mv_velocidade } km/h|.\n  ENDMETHOD.\n\nENDCLASS.\n\n\" Classe derivada\nCLASS lcl_carro DEFINITION INHERITING FROM lcl_veiculo.\n\n  PUBLIC SECTION.\n    METHODS constructor\n      IMPORTING iv_marca      TYPE string\n                iv_modelo     TYPE string\n                iv_num_portas TYPE i.\n\n    \" Sobrescrever m\u00e9todo (redefini\u00e7\u00e3o)\n    METHODS acelerar REDEFINITION.\n\n    METHODS get_num_portas\n      RETURNING VALUE(rv_portas) TYPE i.\n\n  PRIVATE SECTION.\n    DATA mv_num_portas TYPE i.\n\nENDCLASS.\n\nCLASS lcl_carro IMPLEMENTATION.\n\n  METHOD constructor.\n    super-&gt;constructor(\n      iv_marca  = iv_marca\n      iv_modelo = iv_modelo\n    ).\n    mv_num_portas = iv_num_portas.\n  ENDMETHOD.\n\n  METHOD acelerar.\n    \" Carros aceleram mais r\u00e1pido\n    mv_velocidade = mv_velocidade + 20.\n  ENDMETHOD.\n\n  METHOD get_num_portas.\n    rv_portas = mv_num_portas.\n  ENDMETHOD.\n\nENDCLASS.\n\n\" Uso\nDATA(lo_carro) = NEW lcl_carro(\n  iv_marca      = 'Tesla'\n  iv_modelo     = 'Model 3'\n  iv_num_portas = 4\n).\n\nlo_carro-&gt;acelerar( ).\nWRITE: / lo_carro-&gt;get_info( ).  \" Tesla Model 3 - 20 km/h\n</code></pre>"},{"location":"fundamentos/7_OO_basica/#interfaces-basicas","title":"Interfaces B\u00e1sicas","text":""},{"location":"fundamentos/7_OO_basica/#definir-e-implementar","title":"Definir e Implementar","text":"<pre><code>\" Definir interface\nINTERFACE lif_imprimivel.\n  METHODS imprimir.\nENDINTERFACE.\n\nINTERFACE lif_exportavel.\n  METHODS exportar_pdf\n    RETURNING VALUE(rv_pdf) TYPE xstring.\n\n  METHODS exportar_excel\n    RETURNING VALUE(rv_excel) TYPE xstring.\nENDINTERFACE.\n\n\" Classe que implementa interfaces\nCLASS lcl_relatorio DEFINITION.\n\n  PUBLIC SECTION.\n    INTERFACES: lif_imprimivel,\n                lif_exportavel.\n\n    ALIASES: imprimir      FOR lif_imprimivel~imprimir,\n             exportar_pdf  FOR lif_exportavel~exportar_pdf,\n             exportar_excel FOR lif_exportavel~exportar_excel.\n\n  PRIVATE SECTION.\n    DATA mv_conteudo TYPE string.\n\nENDCLASS.\n\nCLASS lcl_relatorio IMPLEMENTATION.\n\n  METHOD lif_imprimivel~imprimir.\n    WRITE: / 'Imprimindo relat\u00f3rio...'.\n    WRITE: / mv_conteudo.\n  ENDMETHOD.\n\n  METHOD lif_exportavel~exportar_pdf.\n    \" L\u00f3gica de exporta\u00e7\u00e3o PDF\n    WRITE: / 'Exportando para PDF...'.\n  ENDMETHOD.\n\n  METHOD lif_exportavel~exportar_excel.\n    \" L\u00f3gica de exporta\u00e7\u00e3o Excel\n    WRITE: / 'Exportando para Excel...'.\n  ENDMETHOD.\n\nENDCLASS.\n\n\" Uso com polimorfismo\nDATA lo_relatorio TYPE REF TO lcl_relatorio.\nlo_relatorio = NEW #( ).\n\n\" Chamar atrav\u00e9s da interface\nDATA lo_imprimivel TYPE REF TO lif_imprimivel.\nlo_imprimivel = lo_relatorio.\nlo_imprimivel-&gt;imprimir( ).\n\n\" Ou direto atrav\u00e9s de alias\nlo_relatorio-&gt;imprimir( ).\nlo_relatorio-&gt;exportar_pdf( ).\n</code></pre>"},{"location":"fundamentos/7_OO_basica/#friend-classes-classes-amigas","title":"Friend Classes (Classes Amigas)","text":"<pre><code>CLASS lcl_conta_bancaria DEFINITION.\n\n  PUBLIC SECTION.\n    METHODS constructor\n      IMPORTING iv_numero TYPE string\n                iv_saldo  TYPE p.\n\n    METHODS get_saldo\n      RETURNING VALUE(rv_saldo) TYPE p.\n\n  PRIVATE SECTION.\n    DATA: mv_numero TYPE string,\n          mv_saldo  TYPE p.\n\n    \" Permitir acesso privado a esta classe\n    FRIENDS lcl_banco.\n\nENDCLASS.\n\nCLASS lcl_banco DEFINITION.\n\n  PUBLIC SECTION.\n    METHODS transferir\n      IMPORTING io_origem  TYPE REF TO lcl_conta_bancaria\n                io_destino TYPE REF TO lcl_conta_bancaria\n                iv_valor   TYPE p.\n\nENDCLASS.\n\nCLASS lcl_banco IMPLEMENTATION.\n\n  METHOD transferir.\n    \" Pode aceder diretamente aos atributos privados\n    io_origem-&gt;mv_saldo = io_origem-&gt;mv_saldo - iv_valor.\n    io_destino-&gt;mv_saldo = io_destino-&gt;mv_saldo + iv_valor.\n  ENDMETHOD.\n\nENDCLASS.\n</code></pre>"},{"location":"fundamentos/7_OO_basica/#referencias-e-cast","title":"Refer\u00eancias e CAST","text":"<pre><code>\" Refer\u00eancia gen\u00e9rica\nDATA lo_objeto TYPE REF TO object.\nlo_objeto = NEW lcl_carro(\n  iv_marca      = 'BMW'\n  iv_modelo     = 'X5'\n  iv_num_portas = 5\n).\n\n\" Cast para tipo espec\u00edfico\nDATA(lo_carro) = CAST lcl_carro( lo_objeto ).\nlo_carro-&gt;acelerar( ).\n\n\" Cast seguro com verifica\u00e7\u00e3o\nIF lo_objeto IS INSTANCE OF lcl_carro.\n  DATA(lo_meu_carro) = CAST lcl_carro( lo_objeto ).\nENDIF.\n\n\" Com exce\u00e7\u00e3o\nTRY.\n    DATA(lo_veiculo) = CAST lcl_veiculo( lo_objeto ).\n  CATCH cx_sy_move_cast_error.\n    WRITE: / 'Cast falhou'.\nENDTRY.\n</code></pre>"},{"location":"fundamentos/7_OO_basica/#factory-pattern-simples","title":"Factory Pattern Simples","text":"<pre><code>CLASS lcl_veiculo_factory DEFINITION.\n\n  PUBLIC SECTION.\n    CLASS-METHODS criar_veiculo\n      IMPORTING iv_tipo           TYPE string\n                iv_marca          TYPE string\n                iv_modelo         TYPE string\n      RETURNING VALUE(ro_veiculo) TYPE REF TO lcl_veiculo.\n\nENDCLASS.\n\nCLASS lcl_veiculo_factory IMPLEMENTATION.\n\n  METHOD criar_veiculo.\n    CASE iv_tipo.\n      WHEN 'CARRO'.\n        ro_veiculo = NEW lcl_carro(\n          iv_marca      = iv_marca\n          iv_modelo     = iv_modelo\n          iv_num_portas = 4\n        ).\n\n      WHEN 'MOTA'.\n        ro_veiculo = NEW lcl_mota(\n          iv_marca  = iv_marca\n          iv_modelo = iv_modelo\n        ).\n\n      WHEN OTHERS.\n        \" Retornar tipo base\n        ro_veiculo = NEW lcl_veiculo(\n          iv_marca  = iv_marca\n          iv_modelo = iv_modelo\n        ).\n    ENDCASE.\n  ENDMETHOD.\n\nENDCLASS.\n\n\" Uso\nDATA(lo_veiculo) = lcl_veiculo_factory=&gt;criar_veiculo(\n  iv_tipo   = 'CARRO'\n  iv_marca  = 'Audi'\n  iv_modelo = 'A4'\n).\n</code></pre>"},{"location":"fundamentos/7_OO_basica/#singleton-pattern","title":"Singleton Pattern","text":"<pre><code>CLASS lcl_config_manager DEFINITION.\n\n  PUBLIC SECTION.\n    CLASS-METHODS get_instance\n      RETURNING VALUE(ro_instance) TYPE REF TO lcl_config_manager.\n\n    METHODS get_config\n      IMPORTING iv_chave        TYPE string\n      RETURNING VALUE(rv_valor) TYPE string.\n\n    METHODS set_config\n      IMPORTING iv_chave TYPE string\n                iv_valor TYPE string.\n\n  PRIVATE SECTION.\n    CLASS-DATA go_instance TYPE REF TO lcl_config_manager.\n\n    DATA mt_config TYPE HASHED TABLE OF ty_config WITH UNIQUE KEY chave.\n\n    \" Construtor privado\n    METHODS constructor.\n\nENDCLASS.\n\nCLASS lcl_config_manager IMPLEMENTATION.\n\n  METHOD get_instance.\n    IF go_instance IS NOT BOUND.\n      go_instance = NEW #( ).\n    ENDIF.\n    ro_instance = go_instance.\n  ENDMETHOD.\n\n  METHOD constructor.\n    \" Carregar configura\u00e7\u00f5es\n  ENDMETHOD.\n\n  METHOD get_config.\n    TRY.\n        rv_valor = mt_config[ chave = iv_chave ]-valor.\n      CATCH cx_sy_itab_line_not_found.\n        rv_valor = ''.\n    ENDTRY.\n  ENDMETHOD.\n\n  METHOD set_config.\n    INSERT VALUE #( chave = iv_chave valor = iv_valor ) \n      INTO TABLE mt_config.\n  ENDMETHOD.\n\nENDCLASS.\n\n\" Uso (sempre retorna a mesma inst\u00e2ncia)\nDATA(lo_config) = lcl_config_manager=&gt;get_instance( ).\nlo_config-&gt;set_config( iv_chave = 'TIMEOUT' iv_valor = '30' ).\n\nDATA(lo_config2) = lcl_config_manager=&gt;get_instance( ).\nDATA(lv_timeout) = lo_config2-&gt;get_config( 'TIMEOUT' ).  \" '30'\n</code></pre>"},{"location":"fundamentos/7_OO_basica/#event-handling-eventos","title":"Event Handling (Eventos)","text":"<pre><code>\" Classe que dispara eventos\nCLASS lcl_processador DEFINITION.\n\n  PUBLIC SECTION.\n    \" Definir evento\n    EVENTS processamento_completo\n      EXPORTING VALUE(ev_resultado) TYPE string.\n\n    METHODS processar.\n\nENDCLASS.\n\nCLASS lcl_processador IMPLEMENTATION.\n\n  METHOD processar.\n    \" Processar dados\n    WAIT UP TO 1 SECONDS.\n\n    \" Disparar evento\n    RAISE EVENT processamento_completo\n      EXPORTING ev_resultado = 'Processamento conclu\u00eddo'.\n  ENDMETHOD.\n\nENDCLASS.\n\n\" Classe que trata eventos\nCLASS lcl_listener DEFINITION.\n\n  PUBLIC SECTION.\n    METHODS on_processamento_completo\n      FOR EVENT processamento_completo OF lcl_processador\n      IMPORTING ev_resultado.\n\nENDCLASS.\n\nCLASS lcl_listener IMPLEMENTATION.\n\n  METHOD on_processamento_completo.\n    WRITE: / |Evento recebido: { ev_resultado }|.\n  ENDMETHOD.\n\nENDCLASS.\n\n\" Uso\nDATA(lo_processador) = NEW lcl_processador( ).\nDATA(lo_listener) = NEW lcl_listener( ).\n\n\" Registar handler\nSET HANDLER lo_listener-&gt;on_processamento_completo FOR lo_processador.\n\n\" Executar (dispara evento)\nlo_processador-&gt;processar( ).\n</code></pre>"},{"location":"fundamentos/7_OO_basica/#dicas-de-boas-praticas","title":"Dicas de Boas Pr\u00e1ticas","text":"<p>Encapsulamento</p> <ul> <li>Mantenha atributos privados, use getters/setters</li> <li>Use READ-ONLY para atributos que s\u00f3 podem ser lidos externamente</li> <li>Evite atributos p\u00fablicos exceto para DTOs simples</li> </ul> <p>Armadilhas Comuns</p> <pre><code>\" \u274c Esquecer de verificar se objeto est\u00e1 bound\nDATA lo_cliente TYPE REF TO lcl_cliente.\nlo_cliente-&gt;processar( ).  \" DUMP se n\u00e3o criado!\n\n\" \u2705 Sempre verificar\nIF lo_cliente IS BOUND.\n  lo_cliente-&gt;processar( ).\nENDIF.\n\n\" \u274c Modificar atributos diretamente\nlo_produto-&gt;mv_preco = '100.00'.  \" Se p\u00fablico\n\n\" \u2705 Usar m\u00e9todos\nlo_produto-&gt;set_preco( '100.00' ).\n</code></pre> <p>NEW vs. CREATE OBJECT</p> <pre><code>\" \u274c Forma antiga\nDATA lo_objeto TYPE REF TO lcl_classe.\nCREATE OBJECT lo_objeto\n  EXPORTING\n    iv_param1 = lv_val1\n    iv_param2 = lv_val2.\n\n\" \u2705 Forma moderna\nDATA(lo_objeto) = NEW lcl_classe(\n  iv_param1 = lv_val1\n  iv_param2 = lv_val2\n).\n</code></pre> <p>Quando Usar M\u00e9todos Est\u00e1ticos</p> <ul> <li>Utilit\u00e1rios que n\u00e3o precisam de estado</li> <li>Factory methods</li> <li>Fun\u00e7\u00f5es puras (mesmo input = mesmo output)</li> <li>N\u00c3O use para aceder a dados da base de dados (dificulta testes)</li> </ul> <p>Organiza\u00e7\u00e3o de C\u00f3digo</p> <ul> <li>Uma responsabilidade por classe (Single Responsibility)</li> <li>Nomes descritivos: <code>lcl_validador_email</code> melhor que <code>lcl_util</code></li> <li>M\u00e9todos pequenos e focados</li> <li>Use interfaces para desacoplar depend\u00eancias</li> </ul> <p>Tags: #Fundamentos #OO #Classes #Objetos #Modern-ABAP</p>"},{"location":"fundamentos/8_nomenclaturas/","title":"Nomenclaturas e Conven\u00e7\u00f5es ABAP","text":"","tags":["ABAP","Fundamentos","Nomenclaturas","Conven\u00e7\u00f5es","Naming"]},{"location":"fundamentos/8_nomenclaturas/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Seguir conven\u00e7\u00f5es de nomenclatura garante c\u00f3digo leg\u00edvel, manuten\u00edvel e alinhado com as boas pr\u00e1ticas SAP. Esta p\u00e1gina documenta os prefixos e padr\u00f5es recomendados.</p>","tags":["ABAP","Fundamentos","Nomenclaturas","Conven\u00e7\u00f5es","Naming"]},{"location":"fundamentos/8_nomenclaturas/#regras-gerais","title":"\ud83d\udd24 Regras Gerais","text":"<ol> <li>Customer Namespace: Use <code>Z</code> ou <code>Y</code> para objetos customizados</li> <li>Sem espa\u00e7os: Use <code>_</code> (underscore) para separar palavras</li> <li>Nomes descritivos: Evite abrevia\u00e7\u00f5es obscuras</li> <li>Case-insensitive: ABAP n\u00e3o diferencia mai\u00fasculas/min\u00fasculas, mas use MAI\u00daSCULAS para constantes</li> </ol>","tags":["ABAP","Fundamentos","Nomenclaturas","Conven\u00e7\u00f5es","Naming"]},{"location":"fundamentos/8_nomenclaturas/#objetos-de-desenvolvimento","title":"\ud83d\udce6 Objetos de Desenvolvimento","text":"","tags":["ABAP","Fundamentos","Nomenclaturas","Conven\u00e7\u00f5es","Naming"]},{"location":"fundamentos/8_nomenclaturas/#programas","title":"Programas","text":"Tipo Prefixo Exemplo Descri\u00e7\u00e3o Report execut\u00e1vel <code>Z</code> ou <code>Y</code> <code>ZVENDA_RELATORIO</code> Programas tipo 1 Include <code>Z</code> ou <code>Y</code> <code>ZINCLUDE_VENDAS</code> Includes Module Pool <code>SAPMZ</code> <code>SAPMZVENDA</code> Programas tipo M Function Group <code>Z</code> ou <code>Y</code> <code>ZVENDA</code> Grupo de fun\u00e7\u00f5es","tags":["ABAP","Fundamentos","Nomenclaturas","Conven\u00e7\u00f5es","Naming"]},{"location":"fundamentos/8_nomenclaturas/#classes-e-interfaces","title":"Classes e Interfaces","text":"Tipo Prefixo Exemplo Descri\u00e7\u00e3o Classe global <code>ZCL_</code> <code>ZCL_VENDA_MANAGER</code> Classes globais Classe local <code>LCL_</code> <code>LCL_HELPER</code> Classes locais em programas Classe de teste <code>LTCL_</code> <code>LTCL_VENDA_TEST</code> Classes de teste ABAP Unit Interface global <code>ZIF_</code> <code>ZIF_CALCULADOR</code> Interfaces globais Interface local <code>LIF_</code> <code>LIF_HANDLER</code> Interfaces locais <p>Exemplos: <pre><code>\" \u2705 Correto\nCLASS zcl_customer_manager DEFINITION.\nCLASS zcl_order_processor DEFINITION.\n\n\" \u274c Evitar\nCLASS z_cust DEFINITION.        \" Muito curto\nCLASS CustomerManager DEFINITION.  \" Sem prefixo Z\n</code></pre></p>","tags":["ABAP","Fundamentos","Nomenclaturas","Conven\u00e7\u00f5es","Naming"]},{"location":"fundamentos/8_nomenclaturas/#tabelas-e-estruturas","title":"Tabelas e Estruturas","text":"Tipo Prefixo Exemplo Descri\u00e7\u00e3o Tabela transparente <code>Z</code> ou <code>Y</code> <code>ZVENDA_HEADER</code> Tabela de BD Estrutura <code>Z</code> ou <code>Y</code> <code>ZSTR_VENDA</code> Structure (sem tabela f\u00edsica) Tabela customizing <code>ZTC_</code> <code>ZTC_CONFIG_VENDA</code> Tabelas de configura\u00e7\u00e3o Append Structure <code>ZA_</code> <code>ZA_MARA</code> Extens\u00e3o de tabela standard","tags":["ABAP","Fundamentos","Nomenclaturas","Conven\u00e7\u00f5es","Naming"]},{"location":"fundamentos/8_nomenclaturas/#elementos-de-dados-e-dominios","title":"Elementos de Dados e Dom\u00ednios","text":"Tipo Prefixo Exemplo Descri\u00e7\u00e3o Elemento de dados <code>ZE_</code> <code>ZE_CUSTOMER_ID</code> Data element Dom\u00ednio <code>ZD_</code> <code>ZD_STATUS</code> Domain Type Pool <code>Z</code> <code>ZTYPE_POOL</code> Type pool (legacy) <p>Exemplo: <pre><code>\" Dom\u00ednio\nZD_STATUS: CHAR1 com value range (A, I, C)\n\n\" Elemento de dados\nZE_ORDER_STATUS \u2192 usa dom\u00ednio ZD_STATUS\n\n\" Campo na tabela\nZORDER_HEADER-STATUS \u2192 tipo ZE_ORDER_STATUS\n</code></pre></p>","tags":["ABAP","Fundamentos","Nomenclaturas","Conven\u00e7\u00f5es","Naming"]},{"location":"fundamentos/8_nomenclaturas/#function-modules","title":"Function Modules","text":"Tipo Prefixo Exemplo Descri\u00e7\u00e3o Function Module <code>Z_</code> <code>Z_CALC_PRICE</code> FM customizado RFC-enabled FM <code>Z_RFC_</code> <code>Z_RFC_GET_ORDERS</code> Remote-enabled <p>Exemplo: <pre><code>FUNCTION z_calc_discount.\n  IMPORTING iv_amount TYPE p.\n  EXPORTING ev_discount TYPE p.\nENDFUNCTION.\n</code></pre></p>","tags":["ABAP","Fundamentos","Nomenclaturas","Conven\u00e7\u00f5es","Naming"]},{"location":"fundamentos/8_nomenclaturas/#variaveis-e-campos","title":"\ud83d\udd22 Vari\u00e1veis e Campos","text":"","tags":["ABAP","Fundamentos","Nomenclaturas","Conven\u00e7\u00f5es","Naming"]},{"location":"fundamentos/8_nomenclaturas/#prefixos-de-variaveis-notacao-hungara","title":"Prefixos de Vari\u00e1veis (Nota\u00e7\u00e3o H\u00fangara)","text":"Tipo Prefixo Exemplo Descri\u00e7\u00e3o Local variable <code>lv_</code> <code>lv_customer_id</code> Vari\u00e1vel local Structure <code>ls_</code> <code>ls_customer</code> Estrutura local Internal table <code>lt_</code> <code>lt_orders</code> Tabela interna Global variable <code>gv_</code> <code>gv_total_amount</code> Vari\u00e1vel global Global structure <code>gs_</code> <code>gs_config</code> Estrutura global Global table <code>gt_</code> <code>gt_customers</code> Tabela global Parameter <code>iv_</code>, <code>ev_</code>, <code>cv_</code> <code>iv_input</code>, <code>ev_output</code> Importing/Exporting/Changing Field-symbol <code>&lt;fs_&gt;</code> <code>&lt;fs_customer&gt;</code> Field-symbol Reference <code>lr_</code> <code>lr_object</code> Refer\u00eancia local Constant <code>lc_</code> / <code>gc_</code> <code>lc_max_items</code> Constante local/global <p>Exemplo completo: <pre><code>METHOD calculate_total.\n  \" Par\u00e2metros\n  DATA(lv_input) = iv_amount.      \" Input parameter\n\n  \" Vari\u00e1veis locais\n  DATA: lv_total   TYPE p,          \" Local variable\n        lv_tax     TYPE p,\n        ls_order   TYPE zorder,     \" Local structure\n        lt_items   TYPE TABLE OF zorder_item,  \" Local table\n        &lt;fs_item&gt;  TYPE zorder_item.           \" Field-symbol\n\n  \" Constantes\n  CONSTANTS: lc_tax_rate TYPE p VALUE '0.23'.\n\n  \" Refer\u00eancias\n  DATA: lr_calculator TYPE REF TO zcl_calculator.\n\n  \" Global (atributo da classe)\n  gv_counter = gv_counter + 1.\nENDMETHOD.\n</code></pre></p>","tags":["ABAP","Fundamentos","Nomenclaturas","Conven\u00e7\u00f5es","Naming"]},{"location":"fundamentos/8_nomenclaturas/#objetos-de-dicionario","title":"\ud83d\udcdd Objetos de Dicion\u00e1rio","text":"","tags":["ABAP","Fundamentos","Nomenclaturas","Conven\u00e7\u00f5es","Naming"]},{"location":"fundamentos/8_nomenclaturas/#search-helps","title":"Search Helps","text":"Tipo Prefixo Exemplo Descri\u00e7\u00e3o Search Help <code>ZSH_</code> <code>ZSH_CUSTOMERS</code> F4 help Collective SH <code>ZSHC_</code> <code>ZSHC_ORDERS</code> Collective search help","tags":["ABAP","Fundamentos","Nomenclaturas","Conven\u00e7\u00f5es","Naming"]},{"location":"fundamentos/8_nomenclaturas/#table-types","title":"Table Types","text":"Tipo Prefixo Exemplo Descri\u00e7\u00e3o Table Type <code>ZTT_</code> <code>ZTT_ORDERS</code> Tipo tabela Range Table Type <code>ZRTT_</code> <code>ZRTT_CUSTOMER</code> RANGE table <p>Exemplo: <pre><code>\" Defini\u00e7\u00e3o\nTYPES: ztt_orders TYPE TABLE OF zorder.\n\n\" Uso\nDATA: lt_orders TYPE ztt_orders.\n</code></pre></p>","tags":["ABAP","Fundamentos","Nomenclaturas","Conven\u00e7\u00f5es","Naming"]},{"location":"fundamentos/8_nomenclaturas/#objetos-de-ui","title":"\ud83c\udfa8 Objetos de UI","text":"","tags":["ABAP","Fundamentos","Nomenclaturas","Conven\u00e7\u00f5es","Naming"]},{"location":"fundamentos/8_nomenclaturas/#dynpros-e-reports","title":"Dynpros e Reports","text":"Tipo Prefixo Exemplo Descri\u00e7\u00e3o Selection Screen - <code>PARAMETERS: p_kunnr</code> Tela de sele\u00e7\u00e3o Parameter <code>p_</code> <code>p_customer_id</code> PARAMETERS Select-Option <code>s_</code> <code>s_date</code> SELECT-OPTIONS <p>Exemplo: <pre><code>PARAMETERS: p_kunnr TYPE kunnr,\n            p_date  TYPE datum.\n\nSELECT-OPTIONS: s_vkorg FOR vbak-vkorg,\n                s_datum FOR sy-datum.\n</code></pre></p>","tags":["ABAP","Fundamentos","Nomenclaturas","Conven\u00e7\u00f5es","Naming"]},{"location":"fundamentos/8_nomenclaturas/#smartforms-e-adobe-forms","title":"Smartforms e Adobe Forms","text":"Tipo Prefixo Exemplo Descri\u00e7\u00e3o Smartform <code>Z_SF_</code> <code>Z_SF_INVOICE</code> Smartform Adobe Form <code>Z_AF_</code> <code>Z_AF_INVOICE</code> Adobe Form Form Interface <code>Z_FI_</code> <code>Z_FI_INVOICE</code> Interface do form","tags":["ABAP","Fundamentos","Nomenclaturas","Conven\u00e7\u00f5es","Naming"]},{"location":"fundamentos/8_nomenclaturas/#objetos-de-autorizacao","title":"\ud83d\udd10 Objetos de Autoriza\u00e7\u00e3o","text":"Tipo Prefixo Exemplo Descri\u00e7\u00e3o Authorization Object <code>Z_</code> <code>Z_VENDA</code> Objeto de autoriza\u00e7\u00e3o Authorization Class <code>Z</code> <code>ZVENDA</code> Classe de autoriza\u00e7\u00e3o","tags":["ABAP","Fundamentos","Nomenclaturas","Conven\u00e7\u00f5es","Naming"]},{"location":"fundamentos/8_nomenclaturas/#objetos-de-mensagem","title":"\ud83d\udcca Objetos de Mensagem","text":"Tipo Prefixo Exemplo Descri\u00e7\u00e3o Message Class <code>Z</code> ou <code>Y</code> <code>ZVENDA</code> Classe de mensagem <p>Exemplo: <pre><code>MESSAGE e001(zvenda) WITH lv_customer.\n\" zvenda = classe de mensagem\n\" e001 = mensagem n\u00famero 001, tipo erro\n</code></pre></p>","tags":["ABAP","Fundamentos","Nomenclaturas","Conven\u00e7\u00f5es","Naming"]},{"location":"fundamentos/8_nomenclaturas/#boas-praticas","title":"\ud83c\udfaf Boas Pr\u00e1ticas","text":"","tags":["ABAP","Fundamentos","Nomenclaturas","Conven\u00e7\u00f5es","Naming"]},{"location":"fundamentos/8_nomenclaturas/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" Nomes descritivos\nDATA: lv_customer_name TYPE string,\n      lv_total_amount  TYPE p,\n      lt_sales_orders  TYPE TABLE OF zvenda.\n\n\" Constantes em UPPER_CASE\nCONSTANTS: lc_max_items TYPE i VALUE 1000,\n           gc_tax_rate  TYPE p VALUE '0.23'.\n\n\" Classes com prefixo\nCLASS zcl_order_processor DEFINITION.\nCLASS zcl_customer_manager DEFINITION.\n\n\" Interfaces claras\nINTERFACE zif_calculator.\nINTERFACE zif_validator.\n\n\" Tabelas com namespace\nZVENDA_HEADER\nZVENDA_ITEM\nZTC_CONFIG_PRICING\n</code></pre>","tags":["ABAP","Fundamentos","Nomenclaturas","Conven\u00e7\u00f5es","Naming"]},{"location":"fundamentos/8_nomenclaturas/#evitar","title":"\u274c Evitar","text":"<pre><code>\" \u274c Nomes muito curtos\nDATA: x TYPE i,\n      tmp TYPE string.\n\n\" \u274c Sem prefixos\nDATA: customer TYPE kunnr,\n      amount TYPE p.\n\n\" \u274c Abrevia\u00e7\u00f5es obscuras\nDATA: lv_cst_nm TYPE string.  \" customer name?\n\n\" \u274c Classes sem ZCL\nCLASS customer_manager DEFINITION.\n\n\" \u274c Tabelas sem Z/Y\nTABLE my_orders.\n</code></pre>","tags":["ABAP","Fundamentos","Nomenclaturas","Conven\u00e7\u00f5es","Naming"]},{"location":"fundamentos/8_nomenclaturas/#convencoes-por-contexto","title":"\ud83d\udcda Conven\u00e7\u00f5es por Contexto","text":"","tags":["ABAP","Fundamentos","Nomenclaturas","Conven\u00e7\u00f5es","Naming"]},{"location":"fundamentos/8_nomenclaturas/#em-classes-globais","title":"Em Classes Globais","text":"<pre><code>CLASS zcl_order_processor DEFINITION PUBLIC.\n\n  PUBLIC SECTION.\n    \" Atributos p\u00fablicos (evitar)\n    DATA: gv_public_var TYPE i READ-ONLY.\n\n    \" M\u00e9todos p\u00fablicos\n    METHODS: process_order\n      IMPORTING iv_order_id TYPE zorder_id\n      RETURNING VALUE(rv_success) TYPE abap_bool.\n\n  PROTECTED SECTION.\n    \" Atributos protegidos\n    DATA: gv_config TYPE zconfig.\n\n  PRIVATE SECTION.\n    \" Atributos privados\n    DATA: gv_counter TYPE i,\n          gt_cache   TYPE TABLE OF zorder.\n\n    \" M\u00e9todos privados\n    METHODS: validate_order\n      IMPORTING iv_order_id TYPE zorder_id.\n\nENDCLASS.\n</code></pre>","tags":["ABAP","Fundamentos","Nomenclaturas","Conven\u00e7\u00f5es","Naming"]},{"location":"fundamentos/8_nomenclaturas/#em-function-modules","title":"Em Function Modules","text":"<pre><code>FUNCTION z_calculate_price.\n  IMPORTING\n    VALUE(iv_product_id) TYPE matnr\n    VALUE(iv_quantity)   TYPE menge_d\n  EXPORTING\n    VALUE(ev_price)      TYPE netpr\n  EXCEPTIONS\n    product_not_found\n    invalid_quantity.\n</code></pre>","tags":["ABAP","Fundamentos","Nomenclaturas","Conven\u00e7\u00f5es","Naming"]},{"location":"fundamentos/8_nomenclaturas/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>Orienta\u00e7\u00e3o a Objetos B\u00e1sica - Aplicar nomenclaturas em OO</li> <li>Classes e Objetos - Criar classes seguindo conven\u00e7\u00f5es</li> <li>Security - Nomenclaturas de objetos de autoriza\u00e7\u00e3o</li> </ul>","tags":["ABAP","Fundamentos","Nomenclaturas","Conven\u00e7\u00f5es","Naming"]},{"location":"fundamentos/8_nomenclaturas/#referencias","title":"\ud83d\udcd6 Refer\u00eancias","text":"<ul> <li>SAP Naming Conventions (SAP Help Portal)</li> <li>ABAP Code Inspector (SCI) - verifica nomenclaturas</li> <li>Clean ABAP Guidelines</li> </ul> <p>Tags: <code>#nomenclaturas</code> <code>#naming</code> <code>#conventions</code> <code>#best-practices</code> <code>#zcl</code> <code>#zif</code></p>","tags":["ABAP","Fundamentos","Nomenclaturas","Conven\u00e7\u00f5es","Naming"]},{"location":"integracoes/","title":"\ud83d\udd17 Integra\u00e7\u00f5es","text":"<p>Guia completo de integra\u00e7\u00e3o entre sistemas SAP e servi\u00e7os externos: RFC, BAPIs, OData, HTTP Client, Web Services, IDocs e APIs REST.</p>"},{"location":"integracoes/#conteudo","title":"\ud83d\udcd6 Conte\u00fado","text":""},{"location":"integracoes/#protocolos-e-tecnologias","title":"\ud83c\udf10 Protocolos e Tecnologias","text":"<ol> <li>RFC - Remote Function Call</li> <li>Tipos de RFC (sRFC, aRFC, tRFC, qRFC, bgRFC)</li> <li>Configura\u00e7\u00e3o SM59</li> <li>RFC s\u00edncrono vs ass\u00edncrono</li> <li>Chamadas para sistemas remotos</li> <li> <p>Seguran\u00e7a e performance</p> </li> <li> <p>BAPI - Business Application Programming Interface</p> </li> <li>O que s\u00e3o BAPIs</li> <li>BAPIs mais usados</li> <li>COMMIT e ROLLBACK</li> <li>Tratamento de erros (tabela RETURN)</li> <li> <p>Criar BAPIs customizados</p> </li> <li> <p>OData Services</p> </li> <li>OData V2 vs V4</li> <li>Criar servi\u00e7os OData (SEGW)</li> <li>Consumir OData (SAPUI5/Fiori)</li> <li>Query options ($filter, $select, $expand)</li> <li> <p>RAP e CDS Views</p> </li> <li> <p>HTTP Client</p> </li> <li>CL_HTTP_CLIENT</li> <li>M\u00e9todos GET, POST, PUT, DELETE</li> <li>Autentica\u00e7\u00e3o (Basic, Bearer, API Key)</li> <li>Headers e SSL</li> <li> <p>Trabalhar com JSON</p> </li> <li> <p>Web Services SOAP</p> </li> <li>SOAP vs REST</li> <li>Criar Web Service (SE80, SOAMANAGER)</li> <li>Consumir WSDL externo (SPROXY)</li> <li>WS-Security</li> <li> <p>Monitoriza\u00e7\u00e3o</p> </li> <li> <p>IDocs - Intermediate Documents</p> </li> <li>Estrutura de IDocs</li> <li>Configura\u00e7\u00e3o (SALE, WE20, WE21)</li> <li>Criar IDocs Outbound</li> <li>Processar IDocs Inbound</li> <li> <p>Monitoriza\u00e7\u00e3o (WE02, WE05)</p> </li> <li> <p>REST API em ABAP</p> </li> <li>Criar API REST (SICF)</li> <li>Handler classes</li> <li>JSON serialization</li> <li>CORS e autentica\u00e7\u00e3o</li> <li>Boas pr\u00e1ticas REST</li> </ol>"},{"location":"integracoes/#quick-start","title":"\ud83c\udfaf Quick Start","text":""},{"location":"integracoes/#chamar-bapi","title":"Chamar BAPI","text":"<pre><code>DATA: lt_return TYPE TABLE OF bapiret2.\n\nCALL FUNCTION 'BAPI_MATERIAL_GET_DETAIL'\n  EXPORTING\n    material = 'MAT-001'\n  TABLES\n    return = lt_return.\n\n\" Verificar erros\nREAD TABLE lt_return WITH KEY type = 'E' TRANSPORTING NO FIELDS.\nIF sy-subrc = 0.\n  WRITE: / '\u274c Erro ao buscar material'.\nELSE.\n  WRITE: / '\u2705 Material encontrado'.\nENDIF.\n</code></pre>"},{"location":"integracoes/#consumir-api-rest","title":"Consumir API REST","text":"<pre><code>DATA: lo_http_client TYPE REF TO if_http_client.\n\ncl_http_client=&gt;create_by_url(\n  EXPORTING url = 'https://api.example.com/users'\n  IMPORTING client = lo_http_client ).\n\nlo_http_client-&gt;request-&gt;set_method( if_http_request=&gt;co_request_method_get ).\nlo_http_client-&gt;send( ).\nlo_http_client-&gt;receive( ).\n\nDATA(lv_json) = lo_http_client-&gt;response-&gt;get_cdata( ).\nWRITE: / lv_json.\n\nlo_http_client-&gt;close( ).\n</code></pre>"},{"location":"integracoes/#criar-ordem-via-bapi","title":"Criar Ordem via BAPI","text":"<pre><code>DATA: ls_header TYPE bapisdhd1,\n      lt_items TYPE TABLE OF bapisditm,\n      lt_return TYPE TABLE OF bapiret2,\n      lv_order TYPE vbeln_va.\n\n\" Cabe\u00e7alho\nls_header-doc_type = 'TA'.\nls_header-sales_org = '1000'.\nls_header-distr_chan = '10'.\nls_header-division = '00'.\n\n\" Item\nAPPEND VALUE #(\n  itm_number = '000010'\n  material = 'MAT-001'\n  target_qty = '10'\n) TO lt_items.\n\n\" Criar ordem\nCALL FUNCTION 'BAPI_SALESORDER_CREATEFROMDAT2'\n  EXPORTING\n    order_header_in = ls_header\n  IMPORTING\n    salesdocument = lv_order\n  TABLES\n    return = lt_return\n    order_items_in = lt_items.\n\n\" Verificar e commit\nREAD TABLE lt_return WITH KEY type = 'E' TRANSPORTING NO FIELDS.\nIF sy-subrc = 0.\n  CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.\nELSE.\n  CALL FUNCTION 'BAPI_TRANSACTION_COMMIT' EXPORTING wait = 'X'.\n  WRITE: / |\u2705 Ordem criada: { lv_order }|.\nENDIF.\n</code></pre>"},{"location":"integracoes/#comparacao-de-tecnologias","title":"\ud83d\udcca Compara\u00e7\u00e3o de Tecnologias","text":"Tecnologia Tipo Formato Uso Performance Complexidade RFC S\u00ednc/Ass\u00ednc Bin\u00e1rio SAP \u2194 SAP \u26a1 R\u00e1pido \ud83d\udfe2 Baixa BAPI S\u00edncrono Bin\u00e1rio Processos de neg\u00f3cio \u26a1 R\u00e1pido \ud83d\udfe2 Baixa OData S\u00edncrono JSON/XML Fiori, Apps Web \u26a1 R\u00e1pido \ud83d\udfe1 M\u00e9dia HTTP Client S\u00edncrono JSON/XML APIs externas \u26a1 R\u00e1pido \ud83d\udfe2 Baixa SOAP S\u00edncrono XML Legacy, Sistemas externos \ud83d\udc0c Lento \ud83d\udd34 Alta IDoc Ass\u00edncrono Propriet\u00e1rio EDI, SAP \u2194 SAP \ud83d\udfe1 M\u00e9dio \ud83d\udfe1 M\u00e9dia REST S\u00edncrono JSON APIs modernas \u26a1 R\u00e1pido \ud83d\udfe2 Baixa"},{"location":"integracoes/#quando-usar-cada-tecnologia","title":"\ufffd Quando Usar Cada Tecnologia","text":""},{"location":"integracoes/#rfc","title":"\u2705 RFC","text":"<ul> <li>Comunica\u00e7\u00e3o entre sistemas SAP</li> <li>Chamadas ass\u00edncronas (background)</li> <li>Processos que precisam de garantia de execu\u00e7\u00e3o (tRFC)</li> </ul>"},{"location":"integracoes/#bapi","title":"\u2705 BAPI","text":"<ul> <li>Opera\u00e7\u00f5es de neg\u00f3cio padronizadas</li> <li>Criar/modificar dados mestres (clientes, materiais)</li> <li>Transa\u00e7\u00f5es (ordens, faturas)</li> </ul>"},{"location":"integracoes/#odata","title":"\u2705 OData","text":"<ul> <li>Aplica\u00e7\u00f5es Fiori/SAPUI5</li> <li>Apps web modernas</li> <li>Mobile apps</li> <li>RESTful APIs com metadata</li> </ul>"},{"location":"integracoes/#http-client","title":"\u2705 HTTP Client","text":"<ul> <li>Consumir APIs REST de terceiros</li> <li>Integra\u00e7\u00e3o com cloud services</li> <li>Webhooks e notifica\u00e7\u00f5es</li> </ul>"},{"location":"integracoes/#soapweb-services","title":"\u2705 SOAP/Web Services","text":"<ul> <li>Sistemas legados que exigem SOAP</li> <li>Contratos formais (WSDL)</li> <li>WS-Security necess\u00e1rio</li> </ul>"},{"location":"integracoes/#idocs","title":"\u2705 IDocs","text":"<ul> <li>EDI (Electronic Data Interchange)</li> <li>Integra\u00e7\u00e3o ass\u00edncrona com garantia de entrega</li> <li>Auditoria completa de mensagens</li> </ul>"},{"location":"integracoes/#rest-api","title":"\u2705 REST API","text":"<ul> <li>Criar APIs customizadas</li> <li>Expor dados SAP para sistemas externos</li> <li>Integra\u00e7\u00f5es modernas e leves</li> </ul>"},{"location":"integracoes/#ferramentas-e-transactions","title":"\ud83d\udd27 Ferramentas e Transactions","text":""},{"location":"integracoes/#desenvolvimento","title":"Desenvolvimento","text":"<ul> <li>SE37 - Function Builder (testar BAPIs)</li> <li>SE80 - Object Navigator (criar Web Services)</li> <li>SEGW - Gateway Service Builder (OData)</li> <li>SICF - HTTP Service Maintenance (REST API)</li> <li>SPROXY - Enterprise Service Builder</li> </ul>"},{"location":"integracoes/#configuracao","title":"Configura\u00e7\u00e3o","text":"<ul> <li>SM59 - RFC Destinations</li> <li>WE20 - Partner Profiles (IDoc)</li> <li>WE21 - Port Definition (IDoc)</li> <li>SOAMANAGER - Web Service Administration</li> <li>SALE - ALE Customizing</li> </ul>"},{"location":"integracoes/#monitorizacao","title":"Monitoriza\u00e7\u00e3o","text":"<ul> <li>WE02/WE05 - IDoc Display/List</li> <li>SRT_UTIL - Web Service Runtime</li> <li>SXMB_MONI - Integration Engine Monitoring</li> <li>/IWFND/ERROR_LOG - OData Error Log</li> <li>ST22 - ABAP Dumps</li> </ul>"},{"location":"integracoes/#recursos-de-aprendizagem","title":"\ud83c\udf93 Recursos de Aprendizagem","text":""},{"location":"integracoes/#documentacao-oficial-sap","title":"Documenta\u00e7\u00e3o Oficial SAP","text":"<ul> <li>SAP Help Portal - BAPIs</li> <li>SAP Gateway Developer Guide</li> <li>SAP IDoc Documentation</li> </ul>"},{"location":"integracoes/#tutoriais-praticos","title":"Tutoriais Pr\u00e1ticos","text":"<ul> <li>RFC Configuration Guide</li> <li>BAPI Best Practices</li> <li>OData Service Creation</li> <li>REST API Development</li> </ul>"},{"location":"integracoes/#seguranca","title":"\ud83d\udd12 Seguran\u00e7a","text":""},{"location":"integracoes/#authorization-objects","title":"Authorization Objects","text":"<p>RFC: - <code>S_RFC</code> - RFC Authorization</p> <p>OData: - <code>/IWFND/RT_GW</code> - Gateway Runtime</p> <p>IDocs: - <code>S_IDOC_ALL</code> - IDoc Administration</p>"},{"location":"integracoes/#boas-praticas","title":"Boas Pr\u00e1ticas","text":"<pre><code>\" \u2705 Validar input\nIF lv_input IS INITIAL.\n  RAISE EXCEPTION TYPE cx_invalid_parameter.\nENDIF.\n\n\" \u2705 Usar HTTPS\ncl_http_client=&gt;create_by_url(\n  EXPORTING url = 'https://api.example.com'  \" HTTPS!\n  IMPORTING client = lo_client ).\n\n\" \u2705 N\u00e3o expor dados sens\u00edveis\n\" Filtrar campos antes de enviar JSON\n\n\" \u2705 Rate limiting\nIF zcl_rate_limiter=&gt;check_limit( sy-uname ) = abap_false.\n  \" Reject request\nENDIF.\n</code></pre>"},{"location":"integracoes/#performance","title":"\ufffd Performance","text":""},{"location":"integracoes/#otimizacoes","title":"Otimiza\u00e7\u00f5es","text":"<pre><code>\" \u2705 Limitar dados\nSELECT * FROM mara\n  UP TO 100 ROWS  \" Limite!\n  INTO TABLE @DATA(lt_data).\n\n\" \u2705 Usar \u00edndices\n\" WHERE clauses com campos indexados\n\n\" \u2705 Pagina\u00e7\u00e3o em APIs\n\" ?page=1&amp;per_page=20\n\n\" \u2705 Compress\u00e3o\n\" SOAMANAGER \u2192 Enable compression\n\n\" \u2705 Cache\n\" Cachear respostas de APIs externas\n</code></pre>"},{"location":"integracoes/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>SQL - Otimizar queries de integra\u00e7\u00e3o</li> <li>Performance - Performance tuning</li> <li>Debug - Debugar integra\u00e7\u00f5es</li> </ul> <p>Tags: <code>#Integra\u00e7\u00f5es</code> <code>#RFC</code> <code>#BAPI</code> <code>#OData</code> <code>#REST</code> <code>#HTTP</code> <code>#WebServices</code> <code>#IDoc</code> <code>#API</code></p>"},{"location":"integracoes/#classes-uteis","title":"Classes \u00dateis","text":"<ul> <li><code>CL_HTTP_CLIENT</code> \u2014 Cliente HTTP</li> <li><code>/UI2/CL_JSON</code> \u2014 JSON serializer</li> <li><code>CL_IXML</code> \u2014 Parser XML</li> <li><code>CL_PROXY_CLIENT</code> \u2014 Web Service client</li> </ul>"},{"location":"integracoes/#exemplo-completo-integracao-rest","title":"\ud83d\udca1 Exemplo Completo: Integra\u00e7\u00e3o REST","text":"<pre><code>REPORT z_rest_integration.\n\nDATA: lo_client TYPE REF TO if_http_client,\n      lv_url TYPE string VALUE 'https://jsonplaceholder.typicode.com/posts/1',\n      lv_json TYPE string.\n\nTRY.\n    \" Criar cliente HTTP\n    cl_http_client=&gt;create_by_url(\n      EXPORTING url = lv_url\n      IMPORTING client = lo_client ).\n\n    \" Configurar m\u00e9todo GET\n    lo_client-&gt;request-&gt;set_method( 'GET' ).\n\n    \" Enviar request\n    lo_client-&gt;send( ).\n\n    \" Receber response\n    lo_client-&gt;receive( ).\n\n    \" Obter dados JSON\n    lv_json = lo_client-&gt;response-&gt;get_cdata( ).\n\n    \" Parse JSON\n    DATA: BEGIN OF ls_post,\n            userid TYPE i,\n            id     TYPE i,\n            title  TYPE string,\n            body   TYPE string,\n          END OF ls_post.\n\n    /ui2/cl_json=&gt;deserialize(\n      EXPORTING json = lv_json\n      CHANGING  data = ls_post ).\n\n    \" Exibir\n    WRITE: / 'T\u00edtulo:', ls_post-title,\n         / 'Corpo:', ls_post-body.\n\n  CATCH cx_root INTO DATA(lx_error).\n    WRITE: / 'Erro:', lx_error-&gt;get_text( ).\nENDTRY.\n</code></pre>"},{"location":"integracoes/#boas-praticas_1","title":"\ud83d\udea8 Boas Pr\u00e1ticas","text":""},{"location":"integracoes/#fazer","title":"\u2705 Fazer","text":"<ul> <li>Sempre usar <code>TRY...CATCH</code> em integra\u00e7\u00f5es</li> <li>Validar dados antes de enviar</li> <li>Usar <code>BAPI_TRANSACTION_COMMIT</code> ap\u00f3s BAPIs de atualiza\u00e7\u00e3o</li> <li>Configurar timeouts adequados</li> <li>Logar erros de integra\u00e7\u00e3o</li> </ul>"},{"location":"integracoes/#evitar","title":"\u274c Evitar","text":"<ul> <li>Expor credenciais em c\u00f3digo</li> <li>N\u00e3o tratar erros de rede</li> <li>Ignorar mensagens de retorno de BAPIs</li> <li>Fazer integra\u00e7\u00f5es s\u00edncronas pesadas sem fallback</li> </ul>"},{"location":"integracoes/#seguranca_1","title":"\ud83d\udd10 Seguran\u00e7a","text":"<ul> <li>Use SM59 para configurar autentica\u00e7\u00e3o RFC</li> <li>Credenciais devem estar em tabelas seguras (n\u00e3o hardcoded)</li> <li>Use HTTPS sempre que poss\u00edvel</li> <li>Valide certificados SSL</li> <li>Implemente OAuth quando dispon\u00edvel</li> </ul>"},{"location":"integracoes/#proximos-passos_1","title":"\ud83d\ude80 Pr\u00f3ximos Passos","text":"<ol> <li>Comece com RFC para entender chamadas remotas</li> <li>Aprenda BAPIs para processos de neg\u00f3cio</li> <li>Explore OData para aplica\u00e7\u00f5es Fiori</li> <li>Pratique com HTTP Client consumindo APIs externas</li> <li>Crie sua pr\u00f3pria REST API em ABAP</li> </ol>"},{"location":"integracoes/1_rfc/","title":"RFC - Remote Function Call","text":"","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>RFC (Remote Function Call) permite que programas ABAP chamem fun\u00e7\u00f5es em sistemas SAP remotos ou que sistemas externos chamem fun\u00e7\u00f5es ABAP. \u00c9 a base para comunica\u00e7\u00e3o entre sistemas SAP.</p>","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#tipos-de-rfc","title":"\ud83c\udfaf Tipos de RFC","text":"","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#1-srfc-synchronous-rfc","title":"1\ufe0f\u20e3 sRFC - Synchronous RFC","text":"<p>Chamada s\u00edncrona: o programa espera pela resposta.</p> <pre><code>CALL FUNCTION 'Z_REMOTE_FUNCTION'\n  DESTINATION 'SAP_SYSTEM'\n  EXPORTING\n    iv_param = lv_value\n  IMPORTING\n    ev_result = lv_result\n  EXCEPTIONS\n    system_failure = 1\n    communication_failure = 2\n    OTHERS = 3.\n\nIF sy-subrc &lt;&gt; 0.\n  MESSAGE 'Erro na chamada RFC' TYPE 'E'.\nENDIF.\n</code></pre> <p>Caracter\u00edsticas: - \u2705 Resposta imediata - \u2705 Simples de usar - \u274c Bloqueia execu\u00e7\u00e3o - \u274c N\u00e3o recomendado para opera\u00e7\u00f5es longas</p>","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#2-arfc-asynchronous-rfc","title":"2\ufe0f\u20e3 aRFC - Asynchronous RFC","text":"<p>Chamada ass\u00edncrona: n\u00e3o espera pela resposta.</p> <pre><code>CALL FUNCTION 'Z_PROCESSO_LONGO'\n  STARTING NEW TASK 'TASK1'\n  DESTINATION 'SAP_SYSTEM'\n  EXPORTING\n    iv_param = lv_value\n  EXCEPTIONS\n    communication_failure = 1\n    system_failure = 2\n    OTHERS = 3.\n\n\" Continua execu\u00e7\u00e3o sem esperar\nWRITE: / 'Processamento iniciado em background'.\n</code></pre> <p>Com callback: <pre><code>\" Chamada ass\u00edncrona com callback\nCALL FUNCTION 'Z_PROCESSO_LONGO'\n  STARTING NEW TASK 'TASK1'\n  DESTINATION 'SAP_SYSTEM'\n  PERFORMING callback_form ON END OF TASK\n  EXPORTING\n    iv_param = lv_value.\n\nWRITE: / 'Aguardando callback...'.\n\nFORM callback_form USING pv_taskname.\n  RECEIVE RESULTS FROM FUNCTION 'Z_PROCESSO_LONGO'\n    IMPORTING ev_result = DATA(lv_result).\n\n  WRITE: / |Resultado recebido: { lv_result }|.\nENDFORM.\n</code></pre></p>","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#3-trfc-transactional-rfc","title":"3\ufe0f\u20e3 tRFC - Transactional RFC","text":"<p>RFC com garantia de execu\u00e7\u00e3o \u00fanica.</p> <pre><code>CALL FUNCTION 'Z_UPDATE_DATA'\n  IN BACKGROUND TASK\n  DESTINATION 'SAP_SYSTEM'\n  EXPORTING\n    iv_data = lv_data.\n\n\" Commit para enviar\nCOMMIT WORK.\n</code></pre> <p>Caracter\u00edsticas: - \u2705 Executa exatamente uma vez - \u2705 Pode ser agendado - \u2705 Tolerante a falhas - \u26a0\ufe0f Ass\u00edncrono (sem retorno imediato)</p>","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#4-qrfc-queued-rfc","title":"4\ufe0f\u20e3 qRFC - Queued RFC","text":"<p>RFC com ordem garantida de execu\u00e7\u00e3o.</p> <pre><code>CALL FUNCTION 'Z_PROCESSO_SEQUENCIAL'\n  IN BACKGROUND TASK\n  DESTINATION 'SAP_SYSTEM'\n  QUEUE 'QUEUE_NAME'\n  EXPORTING\n    iv_sequence = lv_seq.\n\nCOMMIT WORK.\n</code></pre> <p>Uso: Quando a ordem de execu\u00e7\u00e3o \u00e9 cr\u00edtica.</p>","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#5-bgrfc-background-rfc","title":"5\ufe0f\u20e3 bgRFC - Background RFC","text":"<p>RFC moderno para processos em background.</p> <p>Caracter\u00edsticas: - Substitui\u00e7\u00e3o do tRFC/qRFC - Melhor monitoriza\u00e7\u00e3o - Mais controle sobre execu\u00e7\u00e3o</p>","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#configuracao-de-destinos-rfc-sm59","title":"\ud83d\udd27 Configura\u00e7\u00e3o de Destinos RFC (SM59)","text":"","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#transaction-sm59","title":"Transaction SM59","text":"<p>Caminho: SM59 \u2192 Create</p>","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#tipos-de-conexao","title":"Tipos de Conex\u00e3o","text":"Tipo Descri\u00e7\u00e3o Uso 3 ABAP Connection Sistema SAP remoto H HTTP Connection Servidor web G HTTP Connection to Ext. Server Gateway T TCP/IP Connection Sistemas n\u00e3o-SAP","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#criar-destino-rfc","title":"Criar Destino RFC","text":"<p>Exemplo: Conex\u00e3o para sistema SAP remoto</p> <ol> <li>SM59 \u2192 Create</li> <li>RFC Destination: <code>Z_SYSTEM_QAS</code></li> <li>Connection Type: 3 (ABAP Connection)</li> <li>Technical Settings:</li> <li>Target Host: <code>sap-server.empresa.com</code></li> <li>System Number: <code>00</code></li> <li>Instance Number: <code>00</code></li> <li>Logon &amp; Security:</li> <li>Language: <code>PT</code></li> <li>Client: <code>100</code></li> <li>User: <code>RFC_USER</code></li> <li>Password: <code>******</code></li> <li>Test Connection</li> <li>Save</li> </ol>","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#exemplos-praticos","title":"\ud83d\udca1 Exemplos Pr\u00e1ticos","text":"","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#exemplo-1-buscar-dados-de-sistema-remoto","title":"Exemplo 1: Buscar Dados de Sistema Remoto","text":"<pre><code>REPORT z_rfc_buscar_dados.\n\nDATA: lt_clientes TYPE TABLE OF kna1,\n      lv_dest TYPE rfcdest VALUE 'Z_SYSTEM_QAS'.\n\nTRY.\n    CALL FUNCTION 'Z_GET_CUSTOMERS'\n      DESTINATION lv_dest\n      IMPORTING\n        et_customers = lt_clientes\n      EXCEPTIONS\n        system_failure = 1 MESSAGE DATA(lv_msg)\n        communication_failure = 2 MESSAGE lv_msg\n        OTHERS = 3.\n\n    IF sy-subrc = 0.\n      WRITE: / |{ lines( lt_clientes ) } clientes obtidos|.\n\n      LOOP AT lt_clientes INTO DATA(ls_cliente) TO 10.\n        WRITE: / ls_cliente-kunnr, ls_cliente-name1.\n      ENDLOOP.\n    ELSE.\n      WRITE: / |Erro RFC: { lv_msg }|.\n    ENDIF.\n\n  CATCH cx_root INTO DATA(lo_ex).\n    WRITE: / lo_ex-&gt;get_text( ).\nENDTRY.\n</code></pre>","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#exemplo-2-rfc-assincrono-com-multiplas-tarefas","title":"Exemplo 2: RFC Ass\u00edncrono com M\u00faltiplas Tarefas","text":"<pre><code>REPORT z_rfc_async_multi.\n\nDATA: lt_tasks TYPE TABLE OF string,\n      lv_count TYPE i.\n\n\" Iniciar m\u00faltiplas tarefas\nDO 5 TIMES.\n  DATA(lv_task) = |TASK_{ sy-index }|.\n  APPEND lv_task TO lt_tasks.\n\n  CALL FUNCTION 'Z_PROCESSO_LONGO'\n    STARTING NEW TASK lv_task\n    DESTINATION 'Z_SYSTEM_QAS'\n    PERFORMING return_data ON END OF TASK\n    EXPORTING\n      iv_id = sy-index.\n\n  WRITE: / |Tarefa { lv_task } iniciada|.\nENDDO.\n\n\" Aguardar todas as tarefas\nWAIT UNTIL lv_count &gt;= lines( lt_tasks ) UP TO 60 SECONDS.\n\nWRITE: / |Todas as { lv_count } tarefas conclu\u00eddas|.\n\nFORM return_data USING pv_taskname.\n  DATA: lv_result TYPE string.\n\n  RECEIVE RESULTS FROM FUNCTION 'Z_PROCESSO_LONGO'\n    IMPORTING ev_resultado = lv_result\n    EXCEPTIONS\n      communication_failure = 1\n      system_failure = 2.\n\n  IF sy-subrc = 0.\n    ADD 1 TO lv_count.\n    WRITE: / |{ pv_taskname }: { lv_result }|.\n  ENDIF.\nENDFORM.\n</code></pre>","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#exemplo-3-trfc-para-atualizacao-garantida","title":"Exemplo 3: tRFC para Atualiza\u00e7\u00e3o Garantida","text":"<pre><code>REPORT z_trfc_update.\n\nDATA: lt_orders TYPE TABLE OF vbak.\n\nSELECT * FROM vbak INTO TABLE lt_orders UP TO 10 ROWS.\n\n\" Enviar dados para sistema remoto (tRFC)\nCALL FUNCTION 'Z_UPDATE_ORDERS'\n  IN BACKGROUND TASK\n  DESTINATION 'Z_SYSTEM_PRD'\n  TABLES\n    it_orders = lt_orders.\n\n\" Commit para executar tRFC\nCOMMIT WORK.\n\nIF sy-subrc = 0.\n  WRITE: / 'Dados enviados via tRFC (execu\u00e7\u00e3o garantida)'.\nELSE.\n  WRITE: / 'Erro ao agendar tRFC'.\nENDIF.\n\n\" Verificar status: SM58\n</code></pre>","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#exemplo-4-rfc-para-sistema-externo-javapython","title":"Exemplo 4: RFC para Sistema Externo (Java/Python)","text":"<p>Function Module RFC-enabled:</p> <pre><code>FUNCTION z_get_flight_info.\n*\"----------------------------------------------------------------------\n*\"*\"Interface Local:\n*\"  IMPORTING\n*\"     VALUE(IV_CARRID) TYPE  S_CARR_ID\n*\"     VALUE(IV_CONNID) TYPE  S_CONN_ID\n*\"  EXPORTING\n*\"     VALUE(ES_FLIGHT) TYPE  SFLIGHT\n*\"  EXCEPTIONS\n*\"      NOT_FOUND\n*\"----------------------------------------------------------------------\n\n  SELECT SINGLE * FROM sflight INTO es_flight\n    WHERE carrid = iv_carrid\n      AND connid = iv_connid.\n\n  IF sy-subrc &lt;&gt; 0.\n    RAISE not_found.\n  ENDIF.\n\nENDFUNCTION.\n</code></pre> <p>Ativar RFC: SE37 \u2192 Attributes \u2192 \u2611 Remote-Enabled Module</p> <p>Chamar de Python (usando pyrfc): <pre><code>from pyrfc import Connection\n\nconn = Connection(\n    user='RFC_USER',\n    passwd='password',\n    ashost='sap-server.com',\n    sysnr='00',\n    client='100'\n)\n\nresult = conn.call('Z_GET_FLIGHT_INFO', \n    IV_CARRID='LH',\n    IV_CONNID='0400'\n)\n\nprint(result['ES_FLIGHT'])\nconn.close()\n</code></pre></p>","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#monitorizacao-de-rfc","title":"\ud83d\udee0\ufe0f Monitoriza\u00e7\u00e3o de RFC","text":"","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#sm58-transactional-rfc-monitor","title":"SM58 - Transactional RFC Monitor","text":"<p>Ver tRFCs falhados ou pendentes:</p> <ol> <li>SM58</li> <li>Ver lista de tRFCs</li> <li>Reprocessar manualmente se necess\u00e1rio</li> </ol>","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#sm59-rfc-destinations","title":"SM59 - RFC Destinations","text":"<ul> <li>Listar todos os destinos</li> <li>Testar conex\u00f5es</li> <li>Ver estat\u00edsticas</li> </ul>","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#st22-dumps-rfc","title":"ST22 - Dumps RFC","text":"<p>Analisar erros de RFC que geraram dump.</p>","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#seguranca-rfc","title":"\ud83d\udd12 Seguran\u00e7a RFC","text":"","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#autenticacao","title":"Autentica\u00e7\u00e3o","text":"<p>Usu\u00e1rio/Senha: <pre><code>\" Configurado em SM59\nUser: RFC_USER\nPassword: ******\n</code></pre></p> <p>Certificado: <pre><code>SM59 \u2192 Logon &amp; Security \u2192 Use SSL/TLS\n</code></pre></p> <p>Trusted RFC: <pre><code>SM59 \u2192 Logon &amp; Security \u2192 Trusted System\n</code></pre></p>","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#autorizacao","title":"Autoriza\u00e7\u00e3o","text":"<p>Perfil necess\u00e1rio: <code>S_RFC</code></p> <pre><code>Authorization Object: S_RFC\nActivity: Execute (16)\nFunction Group: Z_FUNC_GROUP\n</code></pre>","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#performance-e-boas-praticas","title":"\u26a1 Performance e Boas Pr\u00e1ticas","text":"","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Limitar quantidade de dados\nCALL FUNCTION 'Z_GET_DATA'\n  DESTINATION lv_dest\n  EXPORTING\n    iv_max_rows = 1000  \" \u2705 Limite\n  IMPORTING\n    et_data = lt_data.\n\n\" 2. Timeout adequado\nCALL FUNCTION 'Z_LONG_PROCESS'\n  DESTINATION lv_dest\n  EXPORTING\n    iv_param = lv_value\n  EXCEPTIONS\n    system_failure = 1\n    communication_failure = 2\n    resource_failure = 3.  \" Timeout\n\n\" 3. Usar aRFC para opera\u00e7\u00f5es longas\nCALL FUNCTION 'Z_BATCH_PROCESS'\n  STARTING NEW TASK 'ASYNC'\n  DESTINATION lv_dest.\n\n\" 4. Pool de conex\u00f5es (gerenciado pelo sistema)\n\" SM59 \u2192 Advanced Options \u2192 Connection Pooling\n</code></pre>","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. RFC s\u00edncrono para opera\u00e7\u00f5es longas\nCALL FUNCTION 'Z_PROCESSO_3_HORAS'\n  DESTINATION lv_dest.  \" \u274c Timeout!\n\n\" 2. Loops com RFC\nLOOP AT lt_items INTO DATA(ls_item).\n  CALL FUNCTION 'Z_PROCESS_ITEM'  \" \u274c Muito lento!\n    DESTINATION lv_dest\n    EXPORTING iv_item = ls_item.\nENDLOOP.\n\n\" \u2705 Melhor: enviar tabela completa\nCALL FUNCTION 'Z_PROCESS_ALL_ITEMS'\n  DESTINATION lv_dest\n  TABLES it_items = lt_items.\n\n\" 3. N\u00e3o tratar exce\u00e7\u00f5es\nCALL FUNCTION 'Z_RFC_CALL'\n  DESTINATION lv_dest.  \" \u274c E se falhar?\n\n\" 4. Credenciais hardcoded\nDATA lv_password TYPE string VALUE 'senha123'.  \" \u274c NUNCA!\n</code></pre>","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#troubleshooting","title":"\ud83d\udd27 Troubleshooting","text":"","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#erro-destination-not-found","title":"Erro: \"Destination not found\"","text":"<p>Solu\u00e7\u00e3o: - Verificar SM59 - Destino existe? - Nome correto?</p>","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#erro-communication-failure","title":"Erro: \"Communication failure\"","text":"<p>Causas: - Rede down - Servidor remoto offline - Firewall bloqueando</p> <p>Solu\u00e7\u00e3o: <pre><code>\" Implementar retry\nDATA lv_tentativas TYPE i VALUE 0.\n\nDO 3 TIMES.\n  lv_tentativas = lv_tentativas + 1.\n\n  CALL FUNCTION 'Z_RFC_CALL'\n    DESTINATION lv_dest\n    EXCEPTIONS\n      communication_failure = 1.\n\n  IF sy-subrc = 0.\n    EXIT.  \" Sucesso\n  ELSE.\n    WAIT UP TO 2 SECONDS.  \" Aguardar antes de tentar novamente\n  ENDIF.\nENDDO.\n\nIF sy-subrc &lt;&gt; 0.\n  MESSAGE 'Falha ap\u00f3s 3 tentativas' TYPE 'E'.\nENDIF.\n</code></pre></p>","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#erro-authorization-failure","title":"Erro: \"Authorization failure\"","text":"<p>Solu\u00e7\u00e3o: - Verificar usu\u00e1rio em SM59 - Verificar perfil S_RFC - PFCG para ajustar autoriza\u00e7\u00f5es</p>","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#exemplo-completo-sistema-de-sincronizacao","title":"\ud83d\udca1 Exemplo Completo: Sistema de Sincroniza\u00e7\u00e3o","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_RFC_SYNC_CUSTOMERS\n*&amp;---------------------------------------------------------------------*\nREPORT z_rfc_sync_customers.\n\nPARAMETERS: p_dest TYPE rfcdest DEFAULT 'Z_SYSTEM_QAS'.\n\nDATA: lt_customers TYPE TABLE OF kna1,\n      lv_synced TYPE i,\n      lv_errors TYPE i.\n\nSTART-OF-SELECTION.\n\n  WRITE: / '\u2550\u2550\u2550 SINCRONIZA\u00c7\u00c3O DE CLIENTES \u2550\u2550\u2550', /.\n\n  \" 1. Buscar clientes do sistema local\n  SELECT * FROM kna1 INTO TABLE lt_customers UP TO 100 ROWS\n    WHERE land1 = 'PT'.\n\n  WRITE: / |Clientes a sincronizar: { lines( lt_customers ) }|, /.\n\n  \" 2. Validar destino RFC\n  DATA(lv_dest_exists) = abap_false.\n\n  CALL FUNCTION 'RFC_PING'\n    DESTINATION p_dest\n    EXCEPTIONS\n      communication_failure = 1\n      system_failure = 2\n      OTHERS = 3.\n\n  IF sy-subrc = 0.\n    WRITE: / |\u2705 Conex\u00e3o RFC ativa: { p_dest }|.\n    lv_dest_exists = abap_true.\n  ELSE.\n    WRITE: / |\u274c Erro ao conectar: { p_dest }|.\n    WRITE: / 'Abortando sincroniza\u00e7\u00e3o'.\n    RETURN.\n  ENDIF.\n\n  SKIP.\n\n  \" 3. Sincronizar dados (tRFC para garantir execu\u00e7\u00e3o)\n  IF lv_dest_exists = abap_true.\n    CALL FUNCTION 'Z_SYNC_CUSTOMERS'\n      IN BACKGROUND TASK\n      DESTINATION p_dest\n      TABLES\n        it_customers = lt_customers\n      EXCEPTIONS\n        communication_failure = 1\n        system_failure = 2\n        OTHERS = 3.\n\n    IF sy-subrc = 0.\n      COMMIT WORK.\n      WRITE: / '\u2705 Sincroniza\u00e7\u00e3o agendada via tRFC'.\n      WRITE: / 'Verificar status em SM58'.\n    ELSE.\n      WRITE: / '\u274c Erro ao agendar sincroniza\u00e7\u00e3o'.\n    ENDIF.\n  ENDIF.\n\n  SKIP.\n  WRITE: / '\u2550\u2550\u2550 FIM \u2550\u2550\u2550'.\n</code></pre>","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/1_rfc/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>BAPI - BAPIs s\u00e3o RFCs especiais</li> <li>HTTP Client - Alternativa moderna a RFC</li> <li>IDocs - Outro m\u00e9todo de integra\u00e7\u00e3o</li> </ul> <p>Tags: <code>#RFC</code> <code>#Integra\u00e7\u00f5es</code> <code>#RemoteFunctionCall</code> <code>#SM59</code> <code>#ABAP</code></p>","tags":["ABAP","RFC","Integra\u00e7\u00f5es","Remote Function Call"]},{"location":"integracoes/2_bapi/","title":"BAPI - Business Application Programming Interface","text":"","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/2_bapi/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>BAPI (Business Application Programming Interface) s\u00e3o m\u00e9todos padronizados de Business Objects SAP que permitem integra\u00e7\u00e3o com processos de neg\u00f3cio.</p> <p>Caracter\u00edsticas: - \u2705 RFC-enabled (podem ser chamados remotamente) - \u2705 Padronizados e documentados - \u2705 Valida\u00e7\u00f5es de neg\u00f3cio inclu\u00eddas - \u2705 Versionados e est\u00e1veis - \u2705 Suportados oficialmente pela SAP</p>","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/2_bapi/#diferenca-bapi-vs-rfc-vs-function-module","title":"\ud83c\udfaf Diferen\u00e7a: BAPI vs RFC vs Function Module","text":"Aspecto Function Module RFC BAPI Prop\u00f3sito Qualquer l\u00f3gica Chamada remota Processo de neg\u00f3cio Padroniza\u00e7\u00e3o N\u00e3o N\u00e3o Sim Documenta\u00e7\u00e3o Opcional Opcional Obrigat\u00f3ria Valida\u00e7\u00e3o Manual Manual Autom\u00e1tica Estabilidade Pode mudar Pode mudar Versionado Uso Externo N\u00e3o recomendado Sim Sim (preferido)","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/2_bapi/#encontrar-bapis","title":"\ud83d\udd0d Encontrar BAPIs","text":"","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/2_bapi/#transaction-bapi","title":"Transaction BAPI","text":"<p>Explorador de BAPIs:</p> <ol> <li>BAPI ou BAPI Explorer</li> <li>Navegar pela \u00e1rvore de Business Objects</li> <li>Ver m\u00e9todos dispon\u00edveis</li> </ol> <p>Exemplo de estrutura: <pre><code>\ud83d\udcc1 SalesOrder\n  \u2514\u2500 \ud83d\udcc4 BAPI_SALESORDER_CREATEFROMDAT2\n  \u2514\u2500 \ud83d\udcc4 BAPI_SALESORDER_CHANGE\n  \u2514\u2500 \ud83d\udcc4 BAPI_SALESORDER_GETLIST\n\n\ud83d\udcc1 Material\n  \u2514\u2500 \ud83d\udcc4 BAPI_MATERIAL_SAVEDATA\n  \u2514\u2500 \ud83d\udcc4 BAPI_MATERIAL_GET_DETAIL\n</code></pre></p>","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/2_bapi/#se37-function-builder","title":"SE37 - Function Builder","text":"<p>Procurar BAPIs: - Padr\u00e3o de nome: <code>BAPI_*</code> - Exemplo: <code>BAPI_*CUSTOMER*</code></p>","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/2_bapi/#estrutura-comum-de-bapis","title":"\ud83d\udcca Estrutura Comum de BAPIs","text":"","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/2_bapi/#parametros-tipicos","title":"Par\u00e2metros T\u00edpicos","text":"<pre><code>CALL FUNCTION 'BAPI_EXEMPLO'\n  EXPORTING\n    iv_objeto_key    = lv_key           \" Chave do objeto\n  IMPORTING\n    ev_resultado     = lv_resultado      \" Resultado\n  TABLES\n    it_dados         = lt_dados          \" Dados de entrada\n    et_return        = lt_return         \" Mensagens\n  EXCEPTIONS\n    error            = 1\n    OTHERS           = 2.\n</code></pre>","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/2_bapi/#tabela-return","title":"Tabela RETURN","text":"<p>Todas as BAPIs retornam mensagens via tabela <code>RETURN</code>:</p> <pre><code>TYPES: BEGIN OF ty_return,\n         type   TYPE bapireturn-type,   \" S/E/W/I/A\n         id     TYPE bapireturn-id,      \" Message Class\n         number TYPE bapireturn-number,  \" Message Number\n         message TYPE bapireturn-message,\" Texto\n       END OF ty_return.\n\nDATA: lt_return TYPE TABLE OF bapiret2.\n</code></pre> <p>Tipos de mensagem: - <code>S</code> - Success - <code>E</code> - Error - <code>W</code> - Warning - <code>I</code> - Information - <code>A</code> - Abort</p>","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/2_bapi/#bapis-mais-usados","title":"\ud83d\udca1 BAPIs Mais Usados","text":"","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/2_bapi/#1-bapi_salesorder_createfromdat2","title":"1\ufe0f\u20e3 BAPI_SALESORDER_CREATEFROMDAT2","text":"<p>Criar Ordem de Venda:</p> <pre><code>DATA: ls_header    TYPE bapisdhd1,\n      lt_items     TYPE TABLE OF bapisditm,\n      lt_partners  TYPE TABLE OF bapiparnr,\n      lt_return    TYPE TABLE OF bapiret2,\n      lv_order     TYPE vbeln_va.\n\n\" Cabe\u00e7alho\nls_header-doc_type = 'TA'.\nls_header-sales_org = '1000'.\nls_header-distr_chan = '10'.\nls_header-division = '00'.\n\n\" Item\nAPPEND VALUE #(\n  itm_number = '000010'\n  material   = 'MAT-001'\n  target_qty = '10'\n  plant      = '1000'\n) TO lt_items.\n\n\" Parceiro (Cliente)\nAPPEND VALUE #(\n  partn_role = 'AG'  \" Sold-to Party\n  partn_numb = '1000'\n) TO lt_partners.\n\n\" Criar ordem\nCALL FUNCTION 'BAPI_SALESORDER_CREATEFROMDAT2'\n  EXPORTING\n    order_header_in = ls_header\n  IMPORTING\n    salesdocument   = lv_order\n  TABLES\n    return          = lt_return\n    order_items_in  = lt_items\n    order_partners  = lt_partners.\n\n\" Verificar erros\nREAD TABLE lt_return WITH KEY type = 'E' TRANSPORTING NO FIELDS.\nIF sy-subrc = 0.\n  WRITE: / '\u274c Erro ao criar ordem:'.\n  LOOP AT lt_return INTO DATA(ls_msg) WHERE type = 'E'.\n    WRITE: / ls_msg-message.\n  ENDLOOP.\n\n  \" Desfazer\n  CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.\nELSE.\n  \" Commit\n  CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'\n    EXPORTING\n      wait = 'X'.\n\n  WRITE: / |\u2705 Ordem criada: { lv_order }|.\nENDIF.\n</code></pre>","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/2_bapi/#2-bapi_material_get_detail","title":"2\ufe0f\u20e3 BAPI_MATERIAL_GET_DETAIL","text":"<p>Buscar Detalhes de Material:</p> <pre><code>DATA: ls_material TYPE bapi_mara,\n      lt_return   TYPE TABLE OF bapiret2.\n\nCALL FUNCTION 'BAPI_MATERIAL_GET_DETAIL'\n  EXPORTING\n    material       = 'MAT-001'\n  IMPORTING\n    material_general_data = ls_material\n  TABLES\n    return         = lt_return.\n\nIF ls_material IS NOT INITIAL.\n  WRITE: / |Material: { ls_material-material }|.\n  WRITE: / |Descri\u00e7\u00e3o: { ls_material-matl_desc }|.\n  WRITE: / |Tipo: { ls_material-matl_type }|.\nELSE.\n  WRITE: / '\u274c Material n\u00e3o encontrado'.\nENDIF.\n</code></pre>","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/2_bapi/#3-bapi_goodsmvt_create","title":"3\ufe0f\u20e3 BAPI_GOODSMVT_CREATE","text":"<p>Criar Movimento de Mercadorias:</p> <pre><code>DATA: ls_header TYPE bapi2017_gm_head_01,\n      ls_code   TYPE bapi2017_gm_code,\n      lt_items  TYPE TABLE OF bapi2017_gm_item_create,\n      lt_return TYPE TABLE OF bapiret2,\n      lv_matdoc TYPE bapi2017_gm_head_ret-mat_doc.\n\n\" C\u00f3digo de movimento (MB01)\nls_code-gm_code = '01'.  \" Goods Receipt\n\n\" Cabe\u00e7alho\nls_header-pstng_date = sy-datum.\nls_header-doc_date   = sy-datum.\n\n\" Item\nAPPEND VALUE #(\n  material    = 'MAT-001'\n  plant       = '1000'\n  stge_loc    = '0001'\n  move_type   = '501'      \" GR sem pedido\n  entry_qnt   = '100'\n  entry_uom   = 'PC'\n) TO lt_items.\n\n\" Criar movimento\nCALL FUNCTION 'BAPI_GOODSMVT_CREATE'\n  EXPORTING\n    goodsmvt_header  = ls_header\n    goodsmvt_code    = ls_code\n  IMPORTING\n    materialdocument = lv_matdoc\n  TABLES\n    goodsmvt_item    = lt_items\n    return           = lt_return.\n\n\" Verificar\nREAD TABLE lt_return WITH KEY type = 'E' TRANSPORTING NO FIELDS.\nIF sy-subrc = 0.\n  CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.\n  WRITE: / '\u274c Erro ao criar movimento'.\nELSE.\n  CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'\n    EXPORTING wait = 'X'.\n  WRITE: / |\u2705 Material document: { lv_matdoc }|.\nENDIF.\n</code></pre>","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/2_bapi/#4-bapi_acc_document_post","title":"4\ufe0f\u20e3 BAPI_ACC_DOCUMENT_POST","text":"<p>Lan\u00e7ar Documento Cont\u00e1bil:</p> <pre><code>DATA: ls_header TYPE bapiache09,\n      lt_gl     TYPE TABLE OF bapiacgl09,\n      lt_curr   TYPE TABLE OF bapiaccr09,\n      lt_return TYPE TABLE OF bapiret2,\n      lv_docnr  TYPE bapi_acc_doc_header_ret.\n\n\" Cabe\u00e7alho\nls_header-username   = sy-uname.\nls_header-comp_code  = '1000'.\nls_header-doc_date   = sy-datum.\nls_header-pstng_date = sy-datum.\nls_header-doc_type   = 'SA'.\nls_header-ref_doc_no = 'REF-001'.\n\n\" Item GL - D\u00e9bito\nAPPEND VALUE #(\n  itemno_acc = '1'\n  gl_account = '400000'\n  comp_code  = '1000'\n  pstng_date = sy-datum\n  doc_type   = 'SA'\n) TO lt_gl.\n\n\" Item GL - Cr\u00e9dito\nAPPEND VALUE #(\n  itemno_acc = '2'\n  gl_account = '500000'\n  comp_code  = '1000'\n  pstng_date = sy-datum\n  doc_type   = 'SA'\n) TO lt_gl.\n\n\" Valores\nAPPEND VALUE #(\n  itemno_acc = '1'\n  currency   = 'EUR'\n  amt_doccur = '1000.00'\n) TO lt_curr.\n\nAPPEND VALUE #(\n  itemno_acc = '2'\n  currency   = 'EUR'\n  amt_doccur = '-1000.00'\n) TO lt_curr.\n\n\" Lan\u00e7ar\nCALL FUNCTION 'BAPI_ACC_DOCUMENT_POST'\n  EXPORTING\n    documentheader = ls_header\n  IMPORTING\n    obj_key        = lv_docnr\n  TABLES\n    accountgl      = lt_gl\n    currencyamount = lt_curr\n    return         = lt_return.\n\n\" Verificar\nREAD TABLE lt_return WITH KEY type = 'E' TRANSPORTING NO FIELDS.\nIF sy-subrc = 0.\n  CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.\n  WRITE: / '\u274c Erro ao lan\u00e7ar documento'.\nELSE.\n  CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'\n    EXPORTING wait = 'X'.\n  WRITE: / |\u2705 Documento cont\u00e1bil: { lv_docnr }|.\nENDIF.\n</code></pre>","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/2_bapi/#5-bapi_customer_getlist","title":"5\ufe0f\u20e3 BAPI_CUSTOMER_GETLIST","text":"<p>Buscar Lista de Clientes:</p> <pre><code>DATA: lt_customers TYPE TABLE OF bapi_customer_data,\n      lt_return    TYPE TABLE OF bapiret2,\n      ls_maxrows   TYPE bapi_maxrows.\n\nls_maxrows-maxrows = 100.\n\nCALL FUNCTION 'BAPI_CUSTOMER_GETLIST'\n  EXPORTING\n    maxrows = ls_maxrows\n  TABLES\n    customer_list = lt_customers\n    return        = lt_return.\n\nWRITE: / |Clientes encontrados: { lines( lt_customers ) }|, /.\n\nLOOP AT lt_customers INTO DATA(ls_customer) TO 20.\n  WRITE: / |{ ls_customer-customer } - { ls_customer-name }|.\nENDLOOP.\n</code></pre>","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/2_bapi/#commit-e-rollback","title":"\ud83d\udd04 Commit e Rollback","text":"","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/2_bapi/#bapi_transaction_commit","title":"BAPI_TRANSACTION_COMMIT","text":"<p>SEMPRE necess\u00e1rio ap\u00f3s BAPIs de modifica\u00e7\u00e3o:</p> <pre><code>\" \u2705 Forma correta\nCALL FUNCTION 'BAPI_SALESORDER_CREATEFROMDAT2'\n  \" ... par\u00e2metros ...\n\nIF sy-subrc = 0.\n  CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'\n    EXPORTING\n      wait = 'X'.  \" Aguardar commit\nENDIF.\n</code></pre> <p>Par\u00e2metro WAIT: - <code>wait = 'X'</code> - Aguarda commit terminar (recomendado) - <code>wait = ' '</code> - Commit ass\u00edncrono</p>","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/2_bapi/#bapi_transaction_rollback","title":"BAPI_TRANSACTION_ROLLBACK","text":"<p>Desfazer altera\u00e7\u00f5es em caso de erro:</p> <pre><code>READ TABLE lt_return WITH KEY type = 'E' TRANSPORTING NO FIELDS.\nIF sy-subrc = 0.\n  \" Erro encontrado - desfazer\n  CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.\n  MESSAGE 'Opera\u00e7\u00e3o cancelada' TYPE 'E'.\nELSE.\n  \" Sucesso - confirmar\n  CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'\n    EXPORTING wait = 'X'.\nENDIF.\n</code></pre>","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/2_bapi/#tratamento-de-erros","title":"\ud83d\udee1\ufe0f Tratamento de Erros","text":"","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/2_bapi/#analise-de-mensagens-return","title":"An\u00e1lise de Mensagens RETURN","text":"<pre><code>CLASS lcl_bapi_helper DEFINITION.\n  PUBLIC SECTION.\n    CLASS-METHODS:\n      check_return\n        IMPORTING it_return TYPE bapiret2_t\n        RETURNING VALUE(rv_has_error) TYPE abap_bool,\n\n      display_messages\n        IMPORTING it_return TYPE bapiret2_t.\nENDCLASS.\n\nCLASS lcl_bapi_helper IMPLEMENTATION.\n  METHOD check_return.\n    \" Verifica se h\u00e1 erros\n    READ TABLE it_return WITH KEY type = 'E' TRANSPORTING NO FIELDS.\n    rv_has_error = xsdbool( sy-subrc = 0 ).\n\n    IF rv_has_error = abap_false.\n      \" Verificar aborts\n      READ TABLE it_return WITH KEY type = 'A' TRANSPORTING NO FIELDS.\n      rv_has_error = xsdbool( sy-subrc = 0 ).\n    ENDIF.\n  ENDMETHOD.\n\n  METHOD display_messages.\n    LOOP AT it_return INTO DATA(ls_msg).\n      DATA(lv_icon) = SWITCH #( ls_msg-type\n        WHEN 'E' THEN '\u274c'\n        WHEN 'W' THEN '\u26a0\ufe0f'\n        WHEN 'S' THEN '\u2705'\n        WHEN 'I' THEN '\u2139\ufe0f'\n        ELSE '\u2022' ).\n\n      WRITE: / |{ lv_icon } { ls_msg-message }|.\n    ENDLOOP.\n  ENDMETHOD.\nENDCLASS.\n\n\" Uso\nSTART-OF-SELECTION.\n  DATA lt_return TYPE bapiret2_t.\n\n  \" ... chamar BAPI ...\n\n  IF lcl_bapi_helper=&gt;check_return( lt_return ) = abap_true.\n    WRITE: / '\u2550\u2550\u2550 ERROS \u2550\u2550\u2550', /.\n    lcl_bapi_helper=&gt;display_messages( lt_return ).\n    CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.\n  ELSE.\n    WRITE: / '\u2705 Sucesso!'.\n    CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'\n      EXPORTING wait = 'X'.\n  ENDIF.\n</code></pre>","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/2_bapi/#boas-praticas","title":"\u26a1 Boas Pr\u00e1ticas","text":"","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/2_bapi/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Sempre verificar RETURN\nCALL FUNCTION 'BAPI_XXX'\n  TABLES return = lt_return.\n\nREAD TABLE lt_return WITH KEY type = 'E' TRANSPORTING NO FIELDS.\nIF sy-subrc = 0.  \" \u2705 Verificar erros\n  \" Tratar erro\nENDIF.\n\n\" 2. SEMPRE fazer COMMIT ap\u00f3s modifica\u00e7\u00e3o\nCALL FUNCTION 'BAPI_XXX_CREATE'\n  \" ... par\u00e2metros ...\n\nCALL FUNCTION 'BAPI_TRANSACTION_COMMIT'  \" \u2705 Commit\n  EXPORTING wait = 'X'.\n\n\" 3. Usar WAIT = 'X' em commits\nCALL FUNCTION 'BAPI_TRANSACTION_COMMIT'\n  EXPORTING wait = 'X'.  \" \u2705 Aguardar\n\n\" 4. Rollback em caso de erro\nIF lv_error = abap_true.\n  CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.  \" \u2705 Desfazer\nENDIF.\n\n\" 5. Documentar BAPIs usados\n*&amp;---------------------------------------------------------------------*\n*&amp; Usa BAPI_SALESORDER_CREATEFROMDAT2 para criar ordens\n*&amp; Requer autoriza\u00e7\u00e3o V_VBAK_AAT\n*&amp;---------------------------------------------------------------------*\n</code></pre>","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/2_bapi/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. N\u00e3o verificar erros\nCALL FUNCTION 'BAPI_XXX'\n  TABLES return = lt_return.\n\" \u274c E se houve erro?\n\n\" 2. Esquecer COMMIT\nCALL FUNCTION 'BAPI_XXX_CREATE'\n  \" ... criar algo ...\n\" \u274c Nada foi salvo!\n\n\" 3. COMMIT sem WAIT\nCALL FUNCTION 'BAPI_TRANSACTION_COMMIT'.  \" \u274c Pode n\u00e3o ter terminado\n\n\" 4. Usar COMMIT WORK direto\nCOMMIT WORK.  \" \u274c Usar BAPI_TRANSACTION_COMMIT\n\n\" 5. Misturar BAPI com UPDATE\nCALL FUNCTION 'BAPI_XXX_CREATE'.\nUPDATE dbtab SET field = value.  \" \u274c Inconsistente!\n</code></pre>","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/2_bapi/#criar-bapi-customizado","title":"\ud83d\udd27 Criar BAPI Customizado","text":"","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/2_bapi/#1-criar-function-module-se37","title":"1. Criar Function Module (SE37)","text":"<pre><code>FUNCTION z_bapi_customer_create.\n*\"----------------------------------------------------------------------\n*\"*\"Interface Local:\n*\"  IMPORTING\n*\"     VALUE(IS_CUSTOMER) TYPE  ZST_CUSTOMER\n*\"  EXPORTING\n*\"     VALUE(EV_KUNNR) TYPE  KUNNR\n*\"  TABLES\n*\"      RETURN STRUCTURE  BAPIRET2\n*\"----------------------------------------------------------------------\n\n  \" Valida\u00e7\u00f5es\n  IF is_customer-name1 IS INITIAL.\n    APPEND VALUE bapiret2(\n      type    = 'E'\n      id      = 'Z_MSG'\n      number  = '001'\n      message = 'Nome \u00e9 obrigat\u00f3rio'\n    ) TO return.\n    RETURN.\n  ENDIF.\n\n  \" L\u00f3gica de neg\u00f3cio\n  TRY.\n      \" Gerar n\u00famero\n      CALL FUNCTION 'NUMBER_GET_NEXT'\n        EXPORTING\n          nr_range_nr = '01'\n          object      = 'Z_KUNNR'\n        IMPORTING\n          number      = ev_kunnr.\n\n      \" Inserir cliente\n      INSERT kna1 FROM VALUE #(\n        kunnr = ev_kunnr\n        name1 = is_customer-name1\n        land1 = is_customer-land1\n      ).\n\n      IF sy-subrc = 0.\n        APPEND VALUE bapiret2(\n          type    = 'S'\n          id      = 'Z_MSG'\n          number  = '002'\n          message = |Cliente { ev_kunnr } criado|\n        ) TO return.\n      ENDIF.\n\n    CATCH cx_root INTO DATA(lo_ex).\n      APPEND VALUE bapiret2(\n        type    = 'E'\n        message = lo_ex-&gt;get_text( )\n      ) TO return.\n  ENDTRY.\n\nENDFUNCTION.\n</code></pre>","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/2_bapi/#2-configurar-como-bapi","title":"2. Configurar como BAPI","text":"<ol> <li>SE37 \u2192 Attributes</li> <li>\u2611 Remote-Enabled Module</li> <li>Processing Type: Normal</li> <li>Save &amp; Activate</li> </ol>","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/2_bapi/#3-criar-business-object-swo1","title":"3. Criar Business Object (SWO1)","text":"<p>Opcional, mas recomendado para integra\u00e7\u00e3o completa.</p>","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/2_bapi/#exemplo-completo-criar-pedido-de-compra","title":"\ud83d\udca1 Exemplo Completo: Criar Pedido de Compra","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_BAPI_CREATE_PO\n*&amp;---------------------------------------------------------------------*\nREPORT z_bapi_create_po.\n\nDATA: ls_header  TYPE bapimepoheader,\n      ls_headerx TYPE bapimepoheaderx,\n      lt_items   TYPE TABLE OF bapimepoitem,\n      lt_itemsx  TYPE TABLE OF bapimepoitemx,\n      lt_return  TYPE TABLE OF bapiret2,\n      lv_ponumber TYPE ebeln.\n\nSTART-OF-SELECTION.\n\n  \" Cabe\u00e7alho do pedido\n  ls_header-comp_code = '1000'.\n  ls_header-doc_type  = 'NB'.\n  ls_header-vendor    = '1000'.\n  ls_header-purch_org = '1000'.\n  ls_header-pur_group = '001'.\n\n  \" Flags de atualiza\u00e7\u00e3o\n  ls_headerx-comp_code = 'X'.\n  ls_headerx-doc_type  = 'X'.\n  ls_headerx-vendor    = 'X'.\n  ls_headerx-purch_org = 'X'.\n  ls_headerx-pur_group = 'X'.\n\n  \" Item 1\n  APPEND VALUE #(\n    po_item   = '00010'\n    material  = 'MAT-001'\n    plant     = '1000'\n    quantity  = '100'\n    net_price = '10.50'\n    price_unit = '1'\n  ) TO lt_items.\n\n  APPEND VALUE #(\n    po_item   = '00010'\n    material  = 'X'\n    plant     = 'X'\n    quantity  = 'X'\n    net_price = 'X'\n    price_unit = 'X'\n  ) TO lt_itemsx.\n\n  \" Item 2\n  APPEND VALUE #(\n    po_item   = '00020'\n    material  = 'MAT-002'\n    plant     = '1000'\n    quantity  = '50'\n    net_price = '25.00'\n    price_unit = '1'\n  ) TO lt_items.\n\n  APPEND VALUE #(\n    po_item   = '00020'\n    material  = 'X'\n    plant     = 'X'\n    quantity  = 'X'\n    net_price = 'X'\n    price_unit = 'X'\n  ) TO lt_itemsx.\n\n  \" Criar pedido\n  CALL FUNCTION 'BAPI_PO_CREATE1'\n    EXPORTING\n      poheader  = ls_header\n      poheaderx = ls_headerx\n    IMPORTING\n      exppurchaseorder = lv_ponumber\n    TABLES\n      return    = lt_return\n      poitem    = lt_items\n      poitemx   = lt_itemsx.\n\n  \" Verificar resultado\n  READ TABLE lt_return WITH KEY type = 'E' TRANSPORTING NO FIELDS.\n\n  IF sy-subrc = 0.\n    \" Erro\n    WRITE: / '\u274c Erro ao criar pedido:', /.\n    LOOP AT lt_return INTO DATA(ls_msg) WHERE type CA 'EA'.\n      WRITE: / ls_msg-message.\n    ENDLOOP.\n\n    CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.\n\n  ELSE.\n    \" Sucesso\n    CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'\n      EXPORTING wait = 'X'.\n\n    WRITE: / '\u2705 Pedido criado com sucesso!'.\n    WRITE: / |N\u00famero: { lv_ponumber }|.\n    WRITE: / |Itens: { lines( lt_items ) }|, /.\n\n    \" Mensagens de sucesso\n    LOOP AT lt_return INTO ls_msg WHERE type = 'S'.\n      WRITE: / ls_msg-message.\n    ENDLOOP.\n  ENDIF.\n</code></pre>","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/2_bapi/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>RFC - BAPIs s\u00e3o RFCs especiais</li> <li>OData - Expor BAPIs via OData</li> <li>Web Services - Consumir BAPIs via SOAP</li> </ul> <p>Tags: <code>#BAPI</code> <code>#Integra\u00e7\u00f5es</code> <code>#BusinessAPI</code> <code>#ABAP</code> <code>#RFC</code></p>","tags":["ABAP","BAPI","Integra\u00e7\u00f5es","Business API"]},{"location":"integracoes/3_odata/","title":"OData Services","text":"","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>OData (Open Data Protocol) \u00e9 um protocolo RESTful para consumir e expor dados via HTTP. \u00c9 a base para aplica\u00e7\u00f5es SAP Fiori.</p> <p>Caracter\u00edsticas: - \u2705 Baseado em REST/HTTP - \u2705 Formato JSON ou XML - \u2705 Query options padronizadas - \u2705 CRUD completo (Create, Read, Update, Delete) - \u2705 Suporte a metadata - \u2705 Versionamento (V2/V4)</p>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#odata-v2-vs-v4","title":"\ud83c\udfaf OData V2 vs V4","text":"Aspecto OData V2 OData V4 Vers\u00e3o SAP NetWeaver 7.4+ S/4HANA Sintaxe Mais simples Mais poderosa Fun\u00e7\u00f5es Limitadas Actions/Functions Batch Sim Sim (melhorado) Anota\u00e7\u00f5es B\u00e1sicas Avan\u00e7adas (CDS) Uso Fiori cl\u00e1ssico Fiori moderno","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#criar-odata-service-v2","title":"\ud83d\udee0\ufe0f Criar OData Service (V2)","text":"","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#transaction-segw","title":"Transaction SEGW","text":"<p>SAP Gateway Service Builder</p>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#passo-a-passo","title":"Passo a Passo","text":"","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#1-criar-projeto","title":"1. Criar Projeto","text":"<ol> <li>SEGW \u2192 Create Project</li> <li>Nome: <code>Z_PRODUCTS_SRV</code></li> <li>Descri\u00e7\u00e3o: \"Servi\u00e7o de Produtos\"</li> <li>Save</li> </ol>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#2-definir-data-model","title":"2. Definir Data Model","text":"<p>Entity Type (Tabela):</p> <pre><code>Nome: Product\nProperties:\n  - ProductId (Edm.String) [Key]\n  - ProductName (Edm.String)\n  - Category (Edm.String)\n  - Price (Edm.Decimal)\n  - Currency (Edm.String)\n  - Stock (Edm.Int32)\n</code></pre> <p>Criar: 1. Data Model \u2192 Entity Types \u2192 Create 2. Adicionar properties 3. Marcar ProductId como key</p>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#3-criar-entity-set","title":"3. Criar Entity Set","text":"<p>Entity Set (Cole\u00e7\u00e3o):</p> <pre><code>Nome: ProductSet\nEntity Type: Product\n</code></pre>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#4-gerar-runtime-objects","title":"4. Gerar Runtime Objects","text":"<ol> <li>Generate \u2192 Runtime Objects</li> <li>Classe gerada: <code>ZCL_Z_PRODUCTS_SRV_DPC_EXT</code></li> </ol>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#5-implementar-metodos","title":"5. Implementar M\u00e9todos","text":"<p>Redefinir m\u00e9todos na classe <code>_DPC_EXT</code>:</p>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#get-read","title":"GET (Read)","text":"<pre><code>METHOD productset_get_entity.\n  \" Ler um produto espec\u00edfico\n  DATA: ls_key TYPE zcl_z_products_srv_mpc=&gt;ts_product.\n\n  \" Obter chave da URL\n  io_tech_request_context-&gt;get_converted_keys(\n    IMPORTING es_key_values = ls_key ).\n\n  \" Buscar produto\n  SELECT SINGLE\n    matnr AS product_id,\n    maktx AS product_name,\n    mtart AS category,\n    netpr AS price,\n    waers AS currency,\n    labst AS stock\n  FROM mara\n  JOIN makt ON mara~matnr = makt~matnr\n  JOIN mbew ON mara~matnr = mbew~matnr\n  WHERE mara~matnr = @ls_key-product_id\n    AND makt~spras = @sy-langu\n  INTO CORRESPONDING FIELDS OF @er_entity.\n\n  IF sy-subrc &lt;&gt; 0.\n    \" Erro 404 - Not Found\n    RAISE EXCEPTION TYPE /iwbep/cx_mgw_busi_exception\n      EXPORTING\n        textid            = /iwbep/cx_mgw_busi_exception=&gt;resource_not_found\n        message_unlimited = |Produto { ls_key-product_id } n\u00e3o encontrado|.\n  ENDIF.\nENDMETHOD.\n</code></pre>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#get_entityset-query","title":"GET_ENTITYSET (Query)","text":"<pre><code>METHOD productset_get_entityset.\n  \" Ler m\u00faltiplos produtos\n  DATA: lt_products TYPE zcl_z_products_srv_mpc=&gt;tt_product,\n        lv_top      TYPE i,\n        lv_skip     TYPE i,\n        lv_filter   TYPE string.\n\n  \" Query options\n  lv_top   = io_tech_request_context-&gt;get_top( ).\n  lv_skip  = io_tech_request_context-&gt;get_skip( ).\n  lv_filter = io_tech_request_context-&gt;get_filter( )-&gt;get_filter_string( ).\n\n  \" Buscar produtos\n  SELECT\n    matnr AS product_id,\n    maktx AS product_name,\n    mtart AS category,\n    netpr AS price,\n    waers AS currency,\n    labst AS stock\n  FROM mara\n  JOIN makt ON mara~matnr = makt~matnr\n  JOIN mbew ON mara~matnr = mbew~matnr\n  WHERE makt~spras = @sy-langu\n  ORDER BY matnr\n  INTO CORRESPONDING FIELDS OF TABLE @lt_products\n  UP TO @lv_top ROWS\n  OFFSET @lv_skip.\n\n  \" Aplicar filtros (se houver)\n  IF lv_filter IS NOT INITIAL.\n    \" Processar filtro OData\n    \" Exemplo: $filter=Price gt 100\n    \" (simplificado - usar /IWBEP/CL_MGW_RUNTIME_PARSER)\n  ENDIF.\n\n  er_entityset = lt_products.\nENDMETHOD.\n</code></pre>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#create","title":"CREATE","text":"<pre><code>METHOD productset_create_entity.\n  \" Criar novo produto\n  DATA: ls_product TYPE zcl_z_products_srv_mpc=&gt;ts_product,\n        lv_matnr   TYPE matnr.\n\n  \" Ler dados do request\n  io_data_provider-&gt;read_entry_data(\n    IMPORTING es_data = ls_product ).\n\n  \" Valida\u00e7\u00f5es\n  IF ls_product-product_name IS INITIAL.\n    RAISE EXCEPTION TYPE /iwbep/cx_mgw_busi_exception\n      EXPORTING\n        textid = /iwbep/cx_mgw_busi_exception=&gt;business_error\n        message_unlimited = 'Nome do produto \u00e9 obrigat\u00f3rio'.\n  ENDIF.\n\n  \" Criar produto via BAPI\n  CALL FUNCTION 'BAPI_MATERIAL_SAVEDATA'\n    EXPORTING\n      headdata = VALUE bapimathead(\n        material  = ls_product-product_id\n        matl_type = ls_product-category\n      )\n    IMPORTING\n      material = lv_matnr\n    TABLES\n      \" ... par\u00e2metros ...\n      return = DATA(lt_return).\n\n  \" Verificar erros\n  READ TABLE lt_return WITH KEY type = 'E' TRANSPORTING NO FIELDS.\n  IF sy-subrc = 0.\n    CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.\n    RAISE EXCEPTION TYPE /iwbep/cx_mgw_busi_exception\n      EXPORTING message_unlimited = 'Erro ao criar produto'.\n  ELSE.\n    CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'\n      EXPORTING wait = 'X'.\n\n    \" Retornar produto criado\n    er_entity = ls_product.\n    er_entity-product_id = lv_matnr.\n  ENDIF.\nENDMETHOD.\n</code></pre>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#update","title":"UPDATE","text":"<pre><code>METHOD productset_update_entity.\n  \" Atualizar produto\n  DATA: ls_product TYPE zcl_z_products_srv_mpc=&gt;ts_product,\n        ls_key     TYPE zcl_z_products_srv_mpc=&gt;ts_product.\n\n  \" Obter chave\n  io_tech_request_context-&gt;get_converted_keys(\n    IMPORTING es_key_values = ls_key ).\n\n  \" Ler novos dados\n  io_data_provider-&gt;read_entry_data(\n    IMPORTING es_data = ls_product ).\n\n  \" Atualizar via BAPI ou direto\n  UPDATE makt SET maktx = @ls_product-product_name\n    WHERE matnr = @ls_key-product_id\n      AND spras = @sy-langu.\n\n  IF sy-subrc = 0.\n    er_entity = ls_product.\n  ELSE.\n    RAISE EXCEPTION TYPE /iwbep/cx_mgw_busi_exception\n      EXPORTING message_unlimited = 'Erro ao atualizar produto'.\n  ENDIF.\nENDMETHOD.\n</code></pre>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#delete","title":"DELETE","text":"<pre><code>METHOD productset_delete_entity.\n  \" Deletar produto\n  DATA ls_key TYPE zcl_z_products_srv_mpc=&gt;ts_product.\n\n  \" Obter chave\n  io_tech_request_context-&gt;get_converted_keys(\n    IMPORTING es_key_values = ls_key ).\n\n  \" Deletar produto (exemplo simplificado)\n  DELETE FROM mara WHERE matnr = @ls_key-product_id.\n\n  IF sy-subrc &lt;&gt; 0.\n    RAISE EXCEPTION TYPE /iwbep/cx_mgw_busi_exception\n      EXPORTING message_unlimited = 'Erro ao deletar produto'.\n  ENDIF.\nENDMETHOD.\n</code></pre>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#6-registrar-servico","title":"6. Registrar Servi\u00e7o","text":"<ol> <li>SEGW \u2192 Service \u2192 Register</li> <li>System Alias: LOCAL</li> <li>Package: $TMP ou ZPACKAGE</li> </ol>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#7-ativar-servico","title":"7. Ativar Servi\u00e7o","text":"<p>Transaction /IWFND/MAINT_SERVICE:</p> <ol> <li>Add Service</li> <li>System: LOCAL</li> <li>Technical Service Name: <code>Z_PRODUCTS_SRV</code></li> <li>Add Selected Services</li> </ol>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#consumir-odata-service","title":"\ud83c\udf10 Consumir OData Service","text":"","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#browser","title":"Browser","text":"<p>URL Base: <pre><code>http://server:port/sap/opu/odata/sap/Z_PRODUCTS_SRV/\n</code></pre></p> <p>Metadata: <pre><code>http://server:port/sap/opu/odata/sap/Z_PRODUCTS_SRV/$metadata\n</code></pre></p> <p>Entity Set: <pre><code>http://server:port/sap/opu/odata/sap/Z_PRODUCTS_SRV/ProductSet\n</code></pre></p> <p>Entity espec\u00edfica: <pre><code>http://server:port/sap/opu/odata/sap/Z_PRODUCTS_SRV/ProductSet('MAT-001')\n</code></pre></p>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#query-options","title":"Query Options","text":"","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#filter","title":"$filter","text":"<p>Filtrar resultados:</p> <pre><code>GET ProductSet?$filter=Price gt 100\nGET ProductSet?$filter=Category eq 'FERT'\nGET ProductSet?$filter=ProductName eq 'Produto A' and Price lt 50\n</code></pre> <p>Operadores: - <code>eq</code> - Igual - <code>ne</code> - Diferente - <code>gt</code> - Maior que - <code>ge</code> - Maior ou igual - <code>lt</code> - Menor que - <code>le</code> - Menor ou igual - <code>and</code> - E l\u00f3gico - <code>or</code> - Ou l\u00f3gico</p>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#select","title":"$select","text":"<p>Selecionar campos:</p> <pre><code>GET ProductSet?$select=ProductId,ProductName,Price\n</code></pre>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#orderby","title":"$orderby","text":"<p>Ordenar:</p> <pre><code>GET ProductSet?$orderby=Price desc\nGET ProductSet?$orderby=ProductName asc\n</code></pre>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#top-e-skip","title":"$top e $skip","text":"<p>Pagina\u00e7\u00e3o:</p> <pre><code>GET ProductSet?$top=10              # Primeiros 10\nGET ProductSet?$top=10&amp;$skip=20     # Itens 21-30\n</code></pre>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#expand","title":"$expand","text":"<p>Expandir navega\u00e7\u00e3o:</p> <pre><code>GET ProductSet?$expand=Supplier\n</code></pre>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#count","title":"$count","text":"<p>Contar registros:</p> <pre><code>GET ProductSet/$count\nGET ProductSet?$count=true\n</code></pre>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#javascript-sapui5fiori","title":"JavaScript (SAPUI5/Fiori)","text":"<pre><code>// Criar modelo OData\nvar oModel = new sap.ui.model.odata.v2.ODataModel({\n    serviceUrl: \"/sap/opu/odata/sap/Z_PRODUCTS_SRV/\"\n});\n\n// GET - Ler produtos\noModel.read(\"/ProductSet\", {\n    success: function(oData) {\n        console.log(oData.results);\n    },\n    error: function(oError) {\n        console.error(oError);\n    }\n});\n\n// GET com filtros\noModel.read(\"/ProductSet\", {\n    filters: [\n        new sap.ui.model.Filter(\"Price\", \"GT\", 100),\n        new sap.ui.model.Filter(\"Category\", \"EQ\", \"FERT\")\n    ],\n    success: function(oData) {\n        console.log(oData.results);\n    }\n});\n\n// POST - Criar produto\noModel.create(\"/ProductSet\", {\n    ProductId: \"MAT-999\",\n    ProductName: \"Novo Produto\",\n    Category: \"FERT\",\n    Price: \"99.90\",\n    Currency: \"EUR\",\n    Stock: 100\n}, {\n    success: function(oData) {\n        console.log(\"Produto criado:\", oData);\n    },\n    error: function(oError) {\n        console.error(oError);\n    }\n});\n\n// PUT - Atualizar produto\noModel.update(\"/ProductSet('MAT-001')\", {\n    ProductName: \"Produto Atualizado\",\n    Price: \"149.90\"\n}, {\n    success: function() {\n        console.log(\"Produto atualizado\");\n    }\n});\n\n// DELETE - Deletar produto\noModel.remove(\"/ProductSet('MAT-001')\", {\n    success: function() {\n        console.log(\"Produto deletado\");\n    }\n});\n</code></pre>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#postman-curl","title":"Postman / cURL","text":"","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#get","title":"GET","text":"<pre><code>curl -X GET \\\n  \"http://server:port/sap/opu/odata/sap/Z_PRODUCTS_SRV/ProductSet\" \\\n  -H \"Accept: application/json\" \\\n  -u username:password\n</code></pre>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#post","title":"POST","text":"<pre><code>curl -X POST \\\n  \"http://server:port/sap/opu/odata/sap/Z_PRODUCTS_SRV/ProductSet\" \\\n  -H \"Content-Type: application/json\" \\\n  -H \"X-CSRF-Token: Fetch\" \\\n  -u username:password \\\n  -d '{\n    \"ProductId\": \"MAT-999\",\n    \"ProductName\": \"Novo Produto\",\n    \"Price\": \"99.90\",\n    \"Currency\": \"EUR\"\n  }'\n</code></pre> <p>Nota: Para POST/PUT/DELETE, primeiro fazer GET para obter X-CSRF-Token.</p>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#get-token","title":"GET Token","text":"<pre><code>curl -X GET \\\n  \"http://server:port/sap/opu/odata/sap/Z_PRODUCTS_SRV/\" \\\n  -H \"X-CSRF-Token: Fetch\" \\\n  -u username:password \\\n  -i\n</code></pre> <p>Retorna no header: <code>X-CSRF-Token: &lt;token&gt;</code></p>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#odata-via-cds-views-rap","title":"\ud83d\udcca OData via CDS Views (RAP)","text":"<p>ABAP RESTful Application Programming Model</p>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#criar-cds-view-com-odata","title":"Criar CDS View com OData","text":"<pre><code>@AbapCatalog.sqlViewName: 'ZPRODUCTS_V'\n@AbapCatalog.compiler.compareFilter: true\n@AccessControl.authorizationCheck: #NOT_REQUIRED\n@EndUserText.label: 'Products'\n\n@OData.publish: true  // \u2705 Expor como OData automaticamente\n\ndefine view Z_Products_CDS\n  as select from mara\n  inner join makt on mara.matnr = makt.matnr\n{\n  key mara.matnr as ProductId,\n      makt.maktx as ProductName,\n      mara.mtart as Category,\n      mara.meins as Unit\n}\nwhere makt.spras = $session.system_language\n</code></pre> <p>Ativa\u00e7\u00e3o autom\u00e1tica: Gateway cria servi\u00e7o OData automaticamente!</p> <p>URL: <pre><code>/sap/opu/odata/sap/Z_PRODUCTS_CDS_CDS/\n</code></pre></p>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#rap-behavior-definition","title":"RAP - Behavior Definition","text":"<p>Adicionar opera\u00e7\u00f5es CRUD:</p> <pre><code>managed implementation in class zbp_products unique;\n\ndefine behavior for Z_Products_CDS alias Product\npersistent table mara\nlock master\n{\n  create;\n  update;\n  delete;\n\n  field ( readonly ) ProductId;\n  field ( mandatory ) ProductName;\n\n  mapping for mara {\n    ProductId = matnr;\n    ProductName = maktx;\n  }\n}\n</code></pre>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#seguranca-odata","title":"\ud83d\udd12 Seguran\u00e7a OData","text":"","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#autenticacao","title":"Autentica\u00e7\u00e3o","text":"<p>Tipos: 1. Basic Auth - Usu\u00e1rio/Senha 2. OAuth 2.0 - Token 3. SAML - SSO</p>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#autorizacao","title":"Autoriza\u00e7\u00e3o","text":"<p>Authorization Object: <code>/IWFND/RT_GW</code></p> <p>Perfis necess\u00e1rios: - <code>/IWFND/RT_SERV_USER</code> - Usu\u00e1rio de servi\u00e7o - Autoriza\u00e7\u00f5es espec\u00edficas do objeto</p>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#csrf-protection","title":"CSRF Protection","text":"<p>OData POST/PUT/DELETE requerem X-CSRF-Token.</p> <p>Obter token: <pre><code>// SAPUI5\nvar oModel = new sap.ui.model.odata.v2.ODataModel({\n    serviceUrl: \"/sap/opu/odata/sap/Z_SERVICE/\",\n    tokenHandling: true  // Autom\u00e1tico\n});\n</code></pre></p>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#troubleshooting","title":"\ud83d\udd27 Troubleshooting","text":"","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#gateway-client-iwfndgw_client","title":"Gateway Client (/IWFND/GW_CLIENT)","text":"<p>Testar servi\u00e7o:</p> <ol> <li>/IWFND/GW_CLIENT</li> <li>Service: <code>Z_PRODUCTS_SRV</code></li> <li>Request: <code>ProductSet</code></li> <li>Execute</li> </ol>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#error-log-iwfnderror_log","title":"Error Log (/IWFND/ERROR_LOG)","text":"<p>Ver erros detalhados de execu\u00e7\u00e3o.</p>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#trace-iwfndtraces","title":"Trace (/IWFND/TRACES)","text":"<p>Ativar trace para debug:</p> <ol> <li>/IWFND/TRACES</li> <li>Create Trace</li> <li>User: seu usu\u00e1rio</li> <li>Executar request</li> <li>Ver trace detalhado</li> </ol>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#performance","title":"\u26a1 Performance","text":"","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#boas-praticas","title":"\u2705 Boas Pr\u00e1ticas","text":"<pre><code>\" 1. Usar $select para limitar campos\nGET ProductSet?$select=ProductId,ProductName\n\n\" 2. Usar $top para limitar registros\nGET ProductSet?$top=50\n\n\" 3. Implementar pagina\u00e7\u00e3o server-side\nMETHOD productset_get_entityset.\n  DATA(lv_top) = io_tech_request_context-&gt;get_top( ).\n  DATA(lv_skip) = io_tech_request_context-&gt;get_skip( ).\n\n  SELECT * FROM mara\n    UP TO @lv_top ROWS\n    OFFSET @lv_skip\n    INTO TABLE @lt_data.\nENDMETHOD.\n\n\" 4. Usar CDS Views com anota\u00e7\u00f5es\n@Analytics.query: true\n@ObjectModel.representativeKey: 'ProductId'\n\n\" 5. Implementar filtros eficientes\n\" Converter filtros OData em WHERE clause\n</code></pre>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. SELECT * sem limites\nSELECT * FROM huge_table INTO TABLE @lt_data.  \" \u274c\n\n\" 2. N\u00e3o implementar pagina\u00e7\u00e3o\nMETHOD productset_get_entityset.\n  SELECT * FROM mara INTO TABLE @lt_all.  \" \u274c Todos os registros!\nENDMETHOD.\n\n\" 3. Processar filtros em ABAP em vez de SQL\nSELECT * FROM mara INTO TABLE @lt_data.\nLOOP AT lt_data ASSIGNING FIELD-SYMBOL(&lt;fs&gt;).\n  IF &lt;fs&gt;-price &lt; 100.  \" \u274c Filtrar no SELECT!\n    DELETE lt_data.\n  ENDIF.\nENDLOOP.\n</code></pre>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#exemplo-completo-fiori-app","title":"\ud83d\udca1 Exemplo Completo: Fiori App","text":"","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#backend-segw-service","title":"Backend (SEGW Service)","text":"<p>J\u00e1 implementado acima: <code>Z_PRODUCTS_SRV</code></p>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#frontend-sapui5","title":"Frontend (SAPUI5)","text":"<p>manifest.json: <pre><code>{\n  \"sap.app\": {\n    \"id\": \"com.example.products\",\n    \"dataSources\": {\n      \"mainService\": {\n        \"uri\": \"/sap/opu/odata/sap/Z_PRODUCTS_SRV/\",\n        \"type\": \"OData\",\n        \"settings\": {\n          \"odataVersion\": \"2.0\"\n        }\n      }\n    }\n  },\n  \"sap.ui5\": {\n    \"models\": {\n      \"\": {\n        \"dataSource\": \"mainService\",\n        \"preload\": true\n      }\n    }\n  }\n}\n</code></pre></p> <p>View (List.view.xml): <pre><code>&lt;mvc:View\n  controllerName=\"com.example.products.controller.List\"\n  xmlns:mvc=\"sap.ui.core.mvc\"\n  xmlns=\"sap.m\"&gt;\n\n  &lt;Page title=\"Produtos\"&gt;\n    &lt;content&gt;\n      &lt;Table\n        items=\"{\n          path: '/ProductSet',\n          sorter: { path: 'ProductName' }\n        }\"&gt;\n        &lt;columns&gt;\n          &lt;Column&gt;&lt;Text text=\"ID\"/&gt;&lt;/Column&gt;\n          &lt;Column&gt;&lt;Text text=\"Nome\"/&gt;&lt;/Column&gt;\n          &lt;Column&gt;&lt;Text text=\"Pre\u00e7o\"/&gt;&lt;/Column&gt;\n        &lt;/columns&gt;\n        &lt;items&gt;\n          &lt;ColumnListItem&gt;\n            &lt;cells&gt;\n              &lt;Text text=\"{ProductId}\"/&gt;\n              &lt;Text text=\"{ProductName}\"/&gt;\n              &lt;ObjectNumber\n                number=\"{Price}\"\n                unit=\"{Currency}\"/&gt;\n            &lt;/cells&gt;\n          &lt;/ColumnListItem&gt;\n        &lt;/items&gt;\n      &lt;/Table&gt;\n    &lt;/content&gt;\n  &lt;/Page&gt;\n&lt;/mvc:View&gt;\n</code></pre></p> <p>Controller (List.controller.js): <pre><code>sap.ui.define([\n  \"sap/ui/core/mvc/Controller\",\n  \"sap/m/MessageToast\"\n], function (Controller, MessageToast) {\n  \"use strict\";\n\n  return Controller.extend(\"com.example.products.controller.List\", {\n\n    onInit: function () {\n      var oModel = this.getView().getModel();\n\n      // Refresh autom\u00e1tico\n      oModel.attachRequestCompleted(function() {\n        MessageToast.show(\"Produtos carregados\");\n      });\n    },\n\n    onCreate: function () {\n      var oModel = this.getView().getModel();\n\n      oModel.create(\"/ProductSet\", {\n        ProductId: \"MAT-NEW\",\n        ProductName: \"Novo Produto\",\n        Price: \"199.90\",\n        Currency: \"EUR\"\n      }, {\n        success: function () {\n          MessageToast.show(\"Produto criado!\");\n          oModel.refresh();\n        },\n        error: function (oError) {\n          MessageToast.show(\"Erro: \" + oError.message);\n        }\n      });\n    }\n  });\n});\n</code></pre></p>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/3_odata/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>HTTP Client - Consumir OData de sistemas externos</li> <li>REST API - Criar APIs RESTful customizadas</li> <li>Web Services - Alternativa SOAP ao OData</li> </ul> <p>Tags: <code>#OData</code> <code>#RESTful</code> <code>#Fiori</code> <code>#Integra\u00e7\u00f5es</code> <code>#SAPUI5</code> <code>#SEGW</code> <code>#CDS</code></p>","tags":["ABAP","OData","Integra\u00e7\u00f5es","RESTful","Fiori"]},{"location":"integracoes/4_http_client/","title":"HTTP Client","text":"","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>CL_HTTP_CLIENT permite que programas ABAP fa\u00e7am chamadas HTTP/HTTPS para sistemas externos, consumindo APIs REST, Web Services, e outros recursos web.</p> <p>Casos de uso: - \u2705 Consumir APIs REST externas - \u2705 Integra\u00e7\u00e3o com servi\u00e7os web - \u2705 Download de arquivos - \u2705 Webhooks e notifica\u00e7\u00f5es - \u2705 Integra\u00e7\u00e3o com cloud services</p>","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#criar-http-client","title":"\ud83d\ude80 Criar HTTP Client","text":"","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#metodo-create_by_url","title":"M\u00e9todo CREATE_BY_URL","text":"<pre><code>DATA: lo_http_client TYPE REF TO if_http_client,\n      lv_url         TYPE string VALUE 'https://api.example.com/users'.\n\n\" Criar cliente HTTP\ncl_http_client=&gt;create_by_url(\n  EXPORTING\n    url                = lv_url\n    ssl_id             = 'ANONYM'  \" Certificado SSL\n  IMPORTING\n    client             = lo_http_client\n  EXCEPTIONS\n    argument_not_found = 1\n    plugin_not_active  = 2\n    internal_error     = 3\n    OTHERS             = 4 ).\n\nIF sy-subrc &lt;&gt; 0.\n  MESSAGE 'Erro ao criar HTTP client' TYPE 'E'.\nENDIF.\n</code></pre>","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#metodo-create_by_destination","title":"M\u00e9todo CREATE_BY_DESTINATION","text":"<p>Usar destino RFC HTTP (SM59):</p> <pre><code>DATA: lo_http_client TYPE REF TO if_http_client,\n      lv_destination TYPE rfcdest VALUE 'Z_HTTP_DEST'.\n\n\" Criar via destino RFC\ncl_http_client=&gt;create_by_destination(\n  EXPORTING\n    destination        = lv_destination\n  IMPORTING\n    client             = lo_http_client\n  EXCEPTIONS\n    destination_not_found = 1\n    internal_error        = 2\n    OTHERS                = 3 ).\n\nIF sy-subrc = 0.\n  WRITE: / '\u2705 Cliente HTTP criado via destino'.\nENDIF.\n</code></pre> <p>Configurar destino em SM59: 1. SM59 \u2192 Create 2. RFC Destination: <code>Z_HTTP_DEST</code> 3. Connection Type: G (HTTP Connection) 4. Target Host: <code>api.example.com</code> 5. Path Prefix: <code>/api/v1</code></p>","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#metodos-http","title":"\ud83c\udf10 M\u00e9todos HTTP","text":"","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#get","title":"GET","text":"<p>Ler dados:</p> <pre><code>DATA: lo_http_client TYPE REF TO if_http_client,\n      lv_response    TYPE string.\n\n\" Criar cliente\ncl_http_client=&gt;create_by_url(\n  EXPORTING url    = 'https://jsonplaceholder.typicode.com/users'\n  IMPORTING client = lo_http_client ).\n\n\" Configurar m\u00e9todo GET\nlo_http_client-&gt;request-&gt;set_method( if_http_request=&gt;co_request_method_get ).\n\n\" Executar\nlo_http_client-&gt;send(\n  EXCEPTIONS\n    http_communication_failure = 1\n    http_invalid_state         = 2 ).\n\nIF sy-subrc = 0.\n  \" Receber resposta\n  lo_http_client-&gt;receive(\n    EXCEPTIONS\n      http_communication_failure = 1\n      http_invalid_state         = 2 ).\n\n  IF sy-subrc = 0.\n    \" Obter body da resposta\n    lv_response = lo_http_client-&gt;response-&gt;get_cdata( ).\n\n    \" Status code\n    DATA(lv_code) = lo_http_client-&gt;response-&gt;get_status( )-code.\n\n    WRITE: / |Status: { lv_code }|.\n    WRITE: / |Response: { lv_response }|.\n  ENDIF.\nENDIF.\n\n\" Fechar conex\u00e3o\nlo_http_client-&gt;close( ).\n</code></pre>","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#post","title":"POST","text":"<p>Enviar dados:</p> <pre><code>DATA: lo_http_client TYPE REF TO if_http_client,\n      lv_json_request TYPE string,\n      lv_json_response TYPE string.\n\n\" JSON para enviar\nlv_json_request = '{ \"name\": \"Jo\u00e3o Silva\", \"email\": \"joao@example.com\" }'.\n\n\" Criar cliente\ncl_http_client=&gt;create_by_url(\n  EXPORTING url    = 'https://api.example.com/users'\n  IMPORTING client = lo_http_client ).\n\n\" Configurar POST\nlo_http_client-&gt;request-&gt;set_method( if_http_request=&gt;co_request_method_post ).\n\n\" Headers\nlo_http_client-&gt;request-&gt;set_header_field(\n  name  = 'Content-Type'\n  value = 'application/json' ).\n\n\" Body\nlo_http_client-&gt;request-&gt;set_cdata( lv_json_request ).\n\n\" Enviar\nlo_http_client-&gt;send( ).\nlo_http_client-&gt;receive( ).\n\n\" Resposta\nlv_json_response = lo_http_client-&gt;response-&gt;get_cdata( ).\nDATA(lv_status) = lo_http_client-&gt;response-&gt;get_status( )-code.\n\nIF lv_status = 201.  \" Created\n  WRITE: / '\u2705 Usu\u00e1rio criado com sucesso'.\nELSE.\n  WRITE: / |\u274c Erro: { lv_status }|.\nENDIF.\n\nlo_http_client-&gt;close( ).\n</code></pre>","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#put","title":"PUT","text":"<p>Atualizar dados:</p> <pre><code>DATA: lo_http_client TYPE REF TO if_http_client,\n      lv_json TYPE string.\n\nlv_json = '{ \"name\": \"Jo\u00e3o Silva Updated\", \"email\": \"joao.new@example.com\" }'.\n\ncl_http_client=&gt;create_by_url(\n  EXPORTING url    = 'https://api.example.com/users/1'\n  IMPORTING client = lo_http_client ).\n\n\" PUT\nlo_http_client-&gt;request-&gt;set_method( if_http_request=&gt;co_request_method_put ).\nlo_http_client-&gt;request-&gt;set_header_field(\n  name  = 'Content-Type'\n  value = 'application/json' ).\nlo_http_client-&gt;request-&gt;set_cdata( lv_json ).\n\nlo_http_client-&gt;send( ).\nlo_http_client-&gt;receive( ).\n\nDATA(lv_status) = lo_http_client-&gt;response-&gt;get_status( )-code.\nIF lv_status = 200.\n  WRITE: / '\u2705 Usu\u00e1rio atualizado'.\nENDIF.\n\nlo_http_client-&gt;close( ).\n</code></pre>","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#delete","title":"DELETE","text":"<p>Deletar dados:</p> <pre><code>DATA: lo_http_client TYPE REF TO if_http_client.\n\ncl_http_client=&gt;create_by_url(\n  EXPORTING url    = 'https://api.example.com/users/1'\n  IMPORTING client = lo_http_client ).\n\n\" DELETE\nlo_http_client-&gt;request-&gt;set_method( if_http_request=&gt;co_request_method_delete ).\n\nlo_http_client-&gt;send( ).\nlo_http_client-&gt;receive( ).\n\nDATA(lv_status) = lo_http_client-&gt;response-&gt;get_status( )-code.\nIF lv_status = 204.  \" No Content\n  WRITE: / '\u2705 Usu\u00e1rio deletado'.\nENDIF.\n\nlo_http_client-&gt;close( ).\n</code></pre>","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#autenticacao","title":"\ud83d\udd10 Autentica\u00e7\u00e3o","text":"","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#basic-authentication","title":"Basic Authentication","text":"<pre><code>DATA: lo_http_client TYPE REF TO if_http_client,\n      lv_username TYPE string VALUE 'admin',\n      lv_password TYPE string VALUE 'password123'.\n\ncl_http_client=&gt;create_by_url(\n  EXPORTING url    = 'https://api.example.com/data'\n  IMPORTING client = lo_http_client ).\n\n\" Autentica\u00e7\u00e3o b\u00e1sica\nlo_http_client-&gt;authenticate(\n  username = lv_username\n  password = lv_password ).\n\nlo_http_client-&gt;request-&gt;set_method( if_http_request=&gt;co_request_method_get ).\nlo_http_client-&gt;send( ).\nlo_http_client-&gt;receive( ).\n\nDATA(lv_response) = lo_http_client-&gt;response-&gt;get_cdata( ).\nWRITE: / lv_response.\n\nlo_http_client-&gt;close( ).\n</code></pre>","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#bearer-token-oauth","title":"Bearer Token (OAuth)","text":"<pre><code>DATA: lo_http_client TYPE REF TO if_http_client,\n      lv_token TYPE string VALUE 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...'.\n\ncl_http_client=&gt;create_by_url(\n  EXPORTING url    = 'https://api.example.com/protected'\n  IMPORTING client = lo_http_client ).\n\n\" Header de autoriza\u00e7\u00e3o\nlo_http_client-&gt;request-&gt;set_header_field(\n  name  = 'Authorization'\n  value = |Bearer { lv_token }| ).\n\nlo_http_client-&gt;request-&gt;set_method( if_http_request=&gt;co_request_method_get ).\nlo_http_client-&gt;send( ).\nlo_http_client-&gt;receive( ).\n\nlo_http_client-&gt;close( ).\n</code></pre>","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#api-key","title":"API Key","text":"<pre><code>DATA: lo_http_client TYPE REF TO if_http_client,\n      lv_api_key TYPE string VALUE 'abc123xyz789'.\n\ncl_http_client=&gt;create_by_url(\n  EXPORTING url    = 'https://api.example.com/data'\n  IMPORTING client = lo_http_client ).\n\n\" API Key no header\nlo_http_client-&gt;request-&gt;set_header_field(\n  name  = 'X-API-Key'\n  value = lv_api_key ).\n\n\" Ou na URL\nDATA(lv_url) = |https://api.example.com/data?api_key={ lv_api_key }|.\n\nlo_http_client-&gt;send( ).\nlo_http_client-&gt;receive( ).\n\nlo_http_client-&gt;close( ).\n</code></pre>","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#headers-customizados","title":"\ud83d\udce4 Headers Customizados","text":"","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#adicionar-headers","title":"Adicionar Headers","text":"<pre><code>\" Content-Type\nlo_http_client-&gt;request-&gt;set_header_field(\n  name  = 'Content-Type'\n  value = 'application/json' ).\n\n\" Accept\nlo_http_client-&gt;request-&gt;set_header_field(\n  name  = 'Accept'\n  value = 'application/json' ).\n\n\" Custom headers\nlo_http_client-&gt;request-&gt;set_header_field(\n  name  = 'X-Custom-Header'\n  value = 'CustomValue' ).\n\n\" User-Agent\nlo_http_client-&gt;request-&gt;set_header_field(\n  name  = 'User-Agent'\n  value = 'SAP-ABAP-Client/1.0' ).\n</code></pre>","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#ler-headers-da-resposta","title":"Ler Headers da Resposta","text":"<pre><code>\" Ap\u00f3s receive()\nDATA(lv_content_type) = lo_http_client-&gt;response-&gt;get_header_field( 'Content-Type' ).\nDATA(lv_server) = lo_http_client-&gt;response-&gt;get_header_field( 'Server' ).\n\nWRITE: / |Content-Type: { lv_content_type }|.\nWRITE: / |Server: { lv_server }|.\n\n\" Todos os headers\nDATA: lt_headers TYPE tihttpnvp.\nlo_http_client-&gt;response-&gt;get_header_fields( CHANGING fields = lt_headers ).\n\nLOOP AT lt_headers INTO DATA(ls_header).\n  WRITE: / |{ ls_header-name }: { ls_header-value }|.\nENDLOOP.\n</code></pre>","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#trabalhar-com-json","title":"\ud83d\udcca Trabalhar com JSON","text":"","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#ui2cl_json-parse-json","title":"/UI2/CL_JSON - Parse JSON","text":"<pre><code>DATA: lv_json TYPE string,\n      lo_json TYPE REF TO /ui2/cl_json.\n\n\" JSON recebido\nlv_json = lo_http_client-&gt;response-&gt;get_cdata( ).\n\n\" Estrutura ABAP\nTYPES: BEGIN OF ty_user,\n         id    TYPE i,\n         name  TYPE string,\n         email TYPE string,\n       END OF ty_user.\n\nDATA: ls_user TYPE ty_user.\n\n\" Converter JSON \u2192 ABAP\n/ui2/cl_json=&gt;deserialize(\n  EXPORTING\n    json = lv_json\n  CHANGING\n    data = ls_user ).\n\nWRITE: / |ID: { ls_user-id }|.\nWRITE: / |Nome: { ls_user-name }|.\nWRITE: / |Email: { ls_user-email }|.\n</code></pre>","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#criar-json-para-enviar","title":"Criar JSON para Enviar","text":"<pre><code>TYPES: BEGIN OF ty_product,\n         name  TYPE string,\n         price TYPE p DECIMALS 2,\n         stock TYPE i,\n       END OF ty_product.\n\nDATA: ls_product TYPE ty_product,\n      lv_json TYPE string.\n\nls_product-name  = 'Produto ABC'.\nls_product-price = '99.90'.\nls_product-stock = 50.\n\n\" Converter ABAP \u2192 JSON\nlv_json = /ui2/cl_json=&gt;serialize(\n  data = ls_product\n  compress = abap_false  \" Formatado\n  pretty_name = /ui2/cl_json=&gt;pretty_mode-low_case ).  \" camelCase\n\n\" Enviar JSON\nlo_http_client-&gt;request-&gt;set_cdata( lv_json ).\n</code></pre>","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#configuracoes-avancadas","title":"\ud83d\udd27 Configura\u00e7\u00f5es Avan\u00e7adas","text":"","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#ssltls","title":"SSL/TLS","text":"<pre><code>\" Criar com SSL\ncl_http_client=&gt;create_by_url(\n  EXPORTING\n    url    = 'https://api.example.com'\n    ssl_id = 'ANONYM'  \" ou certificado espec\u00edfico\n  IMPORTING\n    client = lo_http_client ).\n\n\" Desabilitar verifica\u00e7\u00e3o SSL (n\u00e3o recomendado em produ\u00e7\u00e3o)\nlo_http_client-&gt;propertytype_logon_popup = lo_http_client-&gt;co_disabled.\n</code></pre> <p>Configurar certificado SSL: 1. STRUST - Trust Manager 2. Importar certificado 3. Usar SSL ID em <code>create_by_url</code></p>","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#timeout","title":"Timeout","text":"<pre><code>\" Timeout em segundos\nlo_http_client-&gt;set_timeout(\n  timeout = 30  \" 30 segundos\n).\n</code></pre>","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#proxy","title":"Proxy","text":"<pre><code>\" Configurar proxy\nlo_http_client-&gt;get_proxy( )-&gt;set_proxy(\n  proxy_host = 'proxy.empresa.com'\n  proxy_port = '8080' ).\n\n\" Autentica\u00e7\u00e3o no proxy\nlo_http_client-&gt;get_proxy( )-&gt;set_proxy_authentication(\n  proxy_user = 'proxy_user'\n  proxy_password = 'proxy_pass' ).\n</code></pre>","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#compression","title":"Compression","text":"<pre><code>\" Aceitar resposta comprimida (gzip)\nlo_http_client-&gt;request-&gt;set_header_field(\n  name  = 'Accept-Encoding'\n  value = 'gzip' ).\n</code></pre>","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#exemplos-completos","title":"\ud83d\udca1 Exemplos Completos","text":"","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#exemplo-1-consultar-api-rest-publica","title":"Exemplo 1: Consultar API REST P\u00fablica","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_HTTP_GET_USERS\n*&amp;---------------------------------------------------------------------*\nREPORT z_http_get_users.\n\nDATA: lo_http_client TYPE REF TO if_http_client,\n      lv_json TYPE string.\n\nSTART-OF-SELECTION.\n\n  TRY.\n      \" API p\u00fablica de teste\n      cl_http_client=&gt;create_by_url(\n        EXPORTING url = 'https://jsonplaceholder.typicode.com/users'\n        IMPORTING client = lo_http_client ).\n\n      \" GET\n      lo_http_client-&gt;request-&gt;set_method( if_http_request=&gt;co_request_method_get ).\n\n      \" Enviar e receber\n      lo_http_client-&gt;send( ).\n      lo_http_client-&gt;receive( ).\n\n      \" Status\n      DATA(ls_status) = lo_http_client-&gt;response-&gt;get_status( ).\n      WRITE: / |Status: { ls_status-code } - { ls_status-reason }|, /.\n\n      IF ls_status-code = 200.\n        \" JSON\n        lv_json = lo_http_client-&gt;response-&gt;get_cdata( ).\n\n        \" Parse JSON\n        TYPES: BEGIN OF ty_user,\n                 id       TYPE i,\n                 name     TYPE string,\n                 username TYPE string,\n                 email    TYPE string,\n               END OF ty_user.\n\n        DATA: lt_users TYPE TABLE OF ty_user.\n\n        /ui2/cl_json=&gt;deserialize(\n          EXPORTING json = lv_json\n          CHANGING data = lt_users ).\n\n        WRITE: / |Usu\u00e1rios encontrados: { lines( lt_users ) }|, /.\n\n        LOOP AT lt_users INTO DATA(ls_user).\n          WRITE: / |{ ls_user-id } - { ls_user-name } ({ ls_user-email })|.\n        ENDLOOP.\n      ELSE.\n        WRITE: / '\u274c Erro ao buscar usu\u00e1rios'.\n      ENDIF.\n\n      \" Fechar\n      lo_http_client-&gt;close( ).\n\n    CATCH cx_root INTO DATA(lo_ex).\n      WRITE: / |Exce\u00e7\u00e3o: { lo_ex-&gt;get_text( ) }|.\n  ENDTRY.\n</code></pre>","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#exemplo-2-post-com-json","title":"Exemplo 2: POST com JSON","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_HTTP_POST_DATA\n*&amp;---------------------------------------------------------------------*\nREPORT z_http_post_data.\n\nDATA: lo_http_client TYPE REF TO if_http_client,\n      lv_request TYPE string,\n      lv_response TYPE string.\n\nSTART-OF-SELECTION.\n\n  TRY.\n      \" Dados para enviar\n      DATA: BEGIN OF ls_post,\n              title  TYPE string VALUE 'Novo Post',\n              body   TYPE string VALUE 'Conte\u00fado do post',\n              userId TYPE i VALUE 1,\n            END OF ls_post.\n\n      \" Converter para JSON\n      lv_request = /ui2/cl_json=&gt;serialize(\n        data = ls_post\n        compress = abap_false ).\n\n      WRITE: / '\u2550\u2550\u2550 REQUEST \u2550\u2550\u2550'.\n      WRITE: / lv_request, /.\n\n      \" Criar cliente\n      cl_http_client=&gt;create_by_url(\n        EXPORTING url = 'https://jsonplaceholder.typicode.com/posts'\n        IMPORTING client = lo_http_client ).\n\n      \" Configurar POST\n      lo_http_client-&gt;request-&gt;set_method( if_http_request=&gt;co_request_method_post ).\n      lo_http_client-&gt;request-&gt;set_header_field(\n        name  = 'Content-Type'\n        value = 'application/json' ).\n      lo_http_client-&gt;request-&gt;set_cdata( lv_request ).\n\n      \" Enviar\n      lo_http_client-&gt;send( ).\n      lo_http_client-&gt;receive( ).\n\n      \" Resposta\n      DATA(lv_status) = lo_http_client-&gt;response-&gt;get_status( )-code.\n      lv_response = lo_http_client-&gt;response-&gt;get_cdata( ).\n\n      WRITE: / '\u2550\u2550\u2550 RESPONSE \u2550\u2550\u2550'.\n      WRITE: / |Status: { lv_status }|.\n      WRITE: / lv_response, /.\n\n      IF lv_status = 201.\n        WRITE: / '\u2705 Post criado com sucesso!'.\n      ELSE.\n        WRITE: / '\u274c Erro ao criar post'.\n      ENDIF.\n\n      lo_http_client-&gt;close( ).\n\n    CATCH cx_root INTO DATA(lo_ex).\n      WRITE: / |Erro: { lo_ex-&gt;get_text( ) }|.\n  ENDTRY.\n</code></pre>","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#exemplo-3-api-com-autenticacao","title":"Exemplo 3: API com Autentica\u00e7\u00e3o","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_HTTP_AUTH_API\n*&amp;---------------------------------------------------------------------*\nREPORT z_http_auth_api.\n\nPARAMETERS: p_user TYPE string LOWER CASE DEFAULT 'api_user',\n            p_pass TYPE string LOWER CASE DEFAULT 'api_pass',\n            p_url  TYPE string LOWER CASE DEFAULT 'https://api.example.com/data'.\n\nDATA: lo_http_client TYPE REF TO if_http_client.\n\nSTART-OF-SELECTION.\n\n  TRY.\n      \" Criar cliente\n      cl_http_client=&gt;create_by_url(\n        EXPORTING\n          url    = CONV string( p_url )\n          ssl_id = 'ANONYM'\n        IMPORTING\n          client = lo_http_client ).\n\n      \" Basic Auth\n      lo_http_client-&gt;authenticate(\n        username = CONV string( p_user )\n        password = CONV string( p_pass ) ).\n\n      \" Timeout\n      lo_http_client-&gt;set_timeout( timeout = 60 ).\n\n      \" GET\n      lo_http_client-&gt;request-&gt;set_method( if_http_request=&gt;co_request_method_get ).\n      lo_http_client-&gt;request-&gt;set_header_field(\n        name  = 'Accept'\n        value = 'application/json' ).\n\n      \" Executar\n      lo_http_client-&gt;send(\n        EXCEPTIONS\n          http_communication_failure = 1\n          http_invalid_state         = 2 ).\n\n      IF sy-subrc = 0.\n        lo_http_client-&gt;receive(\n          EXCEPTIONS\n            http_communication_failure = 1\n            http_invalid_state         = 2 ).\n\n        IF sy-subrc = 0.\n          DATA(ls_status) = lo_http_client-&gt;response-&gt;get_status( ).\n\n          CASE ls_status-code.\n            WHEN 200.\n              DATA(lv_data) = lo_http_client-&gt;response-&gt;get_cdata( ).\n              WRITE: / '\u2705 Dados recebidos:', /.\n              WRITE: / lv_data.\n\n            WHEN 401.\n              WRITE: / '\u274c N\u00e3o autorizado - verificar credenciais'.\n\n            WHEN 404.\n              WRITE: / '\u274c Recurso n\u00e3o encontrado'.\n\n            WHEN OTHERS.\n              WRITE: / |\u274c Erro { ls_status-code }: { ls_status-reason }|.\n          ENDCASE.\n        ELSE.\n          WRITE: / '\u274c Erro ao receber resposta'.\n        ENDIF.\n      ELSE.\n        WRITE: / '\u274c Erro ao enviar requisi\u00e7\u00e3o'.\n      ENDIF.\n\n      lo_http_client-&gt;close( ).\n\n    CATCH cx_root INTO DATA(lo_ex).\n      WRITE: / |Exce\u00e7\u00e3o: { lo_ex-&gt;get_text( ) }|.\n  ENDTRY.\n</code></pre>","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#boas-praticas","title":"\u26a1 Boas Pr\u00e1ticas","text":"","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Sempre fechar conex\u00e3o\nTRY.\n    \" ... usar lo_http_client ...\n  CATCH cx_root.\n    \" ... tratamento ...\nENDTRY.\nlo_http_client-&gt;close( ).  \" \u2705 Sempre fechar\n\n\" 2. Tratar exce\u00e7\u00f5es\nTRY.\n    cl_http_client=&gt;create_by_url(\n      EXPORTING url = lv_url\n      IMPORTING client = lo_http_client ).\n  CATCH cx_root INTO DATA(lo_ex).\n    WRITE: / lo_ex-&gt;get_text( ).  \" \u2705 Tratar erro\nENDTRY.\n\n\" 3. Verificar status code\nDATA(lv_code) = lo_http_client-&gt;response-&gt;get_status( )-code.\nIF lv_code &lt;&gt; 200.  \" \u2705 Verificar\n  \" Tratar erro\nENDIF.\n\n\" 4. Timeout adequado\nlo_http_client-&gt;set_timeout( timeout = 30 ).  \" \u2705 Timeout\n\n\" 5. Usar destinos RFC para URLs recorrentes\ncl_http_client=&gt;create_by_destination(\n  EXPORTING destination = 'Z_API_DEST'  \" \u2705 SM59\n  IMPORTING client = lo_http_client ).\n</code></pre>","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. N\u00e3o fechar conex\u00e3o\nlo_http_client-&gt;send( ).\nlo_http_client-&gt;receive( ).\n\" \u274c Esquecer close()\n\n\" 2. Hardcoded credentials\nDATA lv_password TYPE string VALUE 'senha123'.  \" \u274c NUNCA!\n\n\" 3. N\u00e3o tratar erros\nlo_http_client-&gt;send( ).  \" \u274c E se falhar?\n\n\" 4. Timeout muito alto\nlo_http_client-&gt;set_timeout( timeout = 300 ).  \" \u274c 5 minutos?\n\n\" 5. URLs hardcoded\nDATA lv_url TYPE string VALUE 'http://prod-server.com'.  \" \u274c Usar SM59\n</code></pre>","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/4_http_client/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>OData - Alternativa para APIs SAP</li> <li>REST API - Criar APIs REST em ABAP</li> <li>Web Services - SOAP Web Services</li> </ul> <p>Tags: <code>#HTTP</code> <code>#REST</code> <code>#API</code> <code>#Integra\u00e7\u00f5es</code> <code>#CL_HTTP_CLIENT</code> <code>#JSON</code></p>","tags":["ABAP","HTTP","REST","Integra\u00e7\u00f5es","API"]},{"location":"integracoes/5_web_services/","title":"Web Services SOAP","text":"","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Web Services SOAP (Simple Object Access Protocol) permitem integra\u00e7\u00e3o entre sistemas usando XML e protocolo HTTP/HTTPS.</p> <p>Caracter\u00edsticas: - \u2705 Baseado em XML - \u2705 Protocolo SOAP - \u2705 WSDL para defini\u00e7\u00e3o - \u2705 Suporte a tipos complexos - \u2705 WS-Security para seguran\u00e7a - \u26a0\ufe0f Mais pesado que REST</p>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#soap-vs-rest","title":"\ud83c\udfaf SOAP vs REST","text":"Aspecto SOAP REST Protocolo SOAP (XML) HTTP Formato Apenas XML JSON, XML, etc. Complexidade Alta Baixa Performance Mais lento Mais r\u00e1pido Seguran\u00e7a WS-Security HTTPS, OAuth Uso SAP Legacy, ERP Fiori, S/4HANA","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#criar-web-service-provider","title":"\ud83d\udee0\ufe0f Criar Web Service (Provider)","text":"","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#transaction-se80","title":"Transaction SE80","text":"<p>Criar Function Module:</p> <pre><code>FUNCTION z_ws_get_customer.\n*\"----------------------------------------------------------------------\n*\"*\"Interface Local:\n*\"  IMPORTING\n*\"     VALUE(IV_KUNNR) TYPE  KUNNR\n*\"  EXPORTING\n*\"     VALUE(ES_CUSTOMER) TYPE  KNA1\n*\"     VALUE(EV_MESSAGE) TYPE  STRING\n*\"  EXCEPTIONS\n*\"      CUSTOMER_NOT_FOUND\n*\"----------------------------------------------------------------------\n\n  SELECT SINGLE * FROM kna1 INTO es_customer\n    WHERE kunnr = iv_kunnr.\n\n  IF sy-subrc = 0.\n    ev_message = |Cliente { iv_kunnr } encontrado|.\n  ELSE.\n    ev_message = |Cliente { iv_kunnr } n\u00e3o existe|.\n    RAISE customer_not_found.\n  ENDIF.\n\nENDFUNCTION.\n</code></pre> <p>Atributos da Function: - \u2611 Remote-Enabled Module (SE37 \u2192 Attributes)</p>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#transaction-se37-enterprise-services","title":"Transaction SE37 - Enterprise Services","text":"<p>Criar Web Service:</p> <ol> <li>Utilities \u2192 More Utilities \u2192 Create Web Service</li> <li>Service Definition: <code>Z_CUSTOMER_WS</code></li> <li>Endpoint: <code>Z_CUSTOMER_EP</code></li> <li>Profile: <code>Default</code></li> <li>Save &amp; Activate</li> </ol>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#transaction-soamanager","title":"Transaction SOAMANAGER","text":"<p>Configurar e ativar Web Service:</p> <ol> <li>SOAMANAGER</li> <li>Web Service Configuration</li> <li>Search: <code>Z_CUSTOMER_WS</code></li> <li>Create Service</li> <li>Binding: <code>Z_CUSTOMER_BINDING</code></li> <li>Configure: HTTPS, autentica\u00e7\u00e3o</li> <li>Save</li> </ol> <p>URL do WSDL: <pre><code>https://server:port/sap/bc/srt/wsdl/flv_10002A111AD1/bndg_url/sap/bc/srt/rfc/sap/z_customer_ws/100/z_customer_binding/z_customer_binding\n</code></pre></p>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#consumir-web-service-consumer","title":"\ud83c\udf10 Consumir Web Service (Consumer)","text":"","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#transaction-se80_1","title":"Transaction SE80","text":"<p>Criar Proxy Local:</p> <ol> <li>SE80 \u2192 Enterprise Services</li> <li>Create \u2192 Service Consumer</li> <li>WSDL: URL ou upload arquivo</li> <li>Package: ZPACKAGE</li> <li>Prefix: ZCO_</li> <li>Generate</li> </ol>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#usar-proxy-gerado","title":"Usar Proxy Gerado","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_CONSUME_WEBSERVICE\n*&amp;---------------------------------------------------------------------*\nREPORT z_consume_webservice.\n\nDATA: lo_proxy TYPE REF TO zco_customer_ws,\n      ls_input TYPE zco_get_customer_request,\n      ls_output TYPE zco_get_customer_response.\n\nPARAMETERS: p_kunnr TYPE kunnr DEFAULT '0001000000'.\n\nSTART-OF-SELECTION.\n\n  TRY.\n      \" Criar proxy\n      CREATE OBJECT lo_proxy\n        EXPORTING\n          logical_port_name = 'Z_CUSTOMER_LP'.  \" SOAMANAGER\n\n      \" Input\n      ls_input-iv_kunnr = p_kunnr.\n\n      \" Chamar Web Service\n      CALL METHOD lo_proxy-&gt;get_customer\n        EXPORTING\n          input  = ls_input\n        IMPORTING\n          output = ls_output.\n\n      \" Resultado\n      WRITE: / '\u2550\u2550\u2550 RESULTADO \u2550\u2550\u2550', /.\n      WRITE: / |Cliente: { ls_output-es_customer-kunnr }|.\n      WRITE: / |Nome: { ls_output-es_customer-name1 }|.\n      WRITE: / |Cidade: { ls_output-es_customer-ort01 }|.\n      WRITE: / |Mensagem: { ls_output-ev_message }|, /.\n\n    CATCH cx_ai_system_fault INTO DATA(lo_sys_fault).\n      WRITE: / |Erro de sistema: { lo_sys_fault-&gt;get_text( ) }|.\n\n    CATCH cx_ai_application_fault INTO DATA(lo_app_fault).\n      WRITE: / |Erro de aplica\u00e7\u00e3o: { lo_app_fault-&gt;get_text( ) }|.\n\n    CATCH cx_root INTO DATA(lo_ex).\n      WRITE: / |Erro: { lo_ex-&gt;get_text( ) }|.\n  ENDTRY.\n</code></pre>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#configurar-logical-port-soamanager","title":"Configurar Logical Port (SOAMANAGER)","text":"<ol> <li>SOAMANAGER</li> <li>Single Service Administration</li> <li>Search: Proxy name</li> <li>Create Logical Port: <code>Z_CUSTOMER_LP</code></li> <li>URL: URL do WSDL remoto</li> <li>Authentication: Basic, SSL, etc.</li> <li>Save</li> </ol>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#seguranca","title":"\ud83d\udd10 Seguran\u00e7a","text":"","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#ws-security","title":"WS-Security","text":"<p>Username Token:</p> <pre><code>&lt;wsse:Security&gt;\n  &lt;wsse:UsernameToken&gt;\n    &lt;wsse:Username&gt;user&lt;/wsse:Username&gt;\n    &lt;wsse:Password Type=\"PasswordText\"&gt;pass&lt;/wsse:Password&gt;\n  &lt;/wsse:UsernameToken&gt;\n&lt;/wsse:Security&gt;\n</code></pre> <p>Configurar em SOAMANAGER: - Authentication: User ID/Password - Transport Level Security: HTTPS</p>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#certificado-ssl","title":"Certificado SSL","text":"<p>STRUST - Trust Manager:</p> <ol> <li>STRUST</li> <li>SSL Client (Anonymous)</li> <li>Import Certificate</li> <li>Add to Certificate List</li> </ol> <p>SOAMANAGER: - Authentication: SSL Client Certificate - Select Certificate</p>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#soap-requestresponse","title":"\ud83d\udcca SOAP Request/Response","text":"","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#request-example","title":"Request Example","text":"<pre><code>&lt;soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" \n                  xmlns:urn=\"urn:sap-com:document:sap:rfc:functions\"&gt;\n   &lt;soapenv:Header/&gt;\n   &lt;soapenv:Body&gt;\n      &lt;urn:Z_WS_GET_CUSTOMER&gt;\n         &lt;IV_KUNNR&gt;0001000000&lt;/IV_KUNNR&gt;\n      &lt;/urn:Z_WS_GET_CUSTOMER&gt;\n   &lt;/soapenv:Body&gt;\n&lt;/soapenv:Envelope&gt;\n</code></pre>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#response-example","title":"Response Example","text":"<pre><code>&lt;soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;\n   &lt;soapenv:Body&gt;\n      &lt;n0:Z_WS_GET_CUSTOMER.Response xmlns:n0=\"urn:sap-com:document:sap:rfc:functions\"&gt;\n         &lt;ES_CUSTOMER&gt;\n            &lt;KUNNR&gt;0001000000&lt;/KUNNR&gt;\n            &lt;NAME1&gt;Cliente Teste&lt;/NAME1&gt;\n            &lt;ORT01&gt;Lisboa&lt;/ORT01&gt;\n         &lt;/ES_CUSTOMER&gt;\n         &lt;EV_MESSAGE&gt;Cliente 0001000000 encontrado&lt;/EV_MESSAGE&gt;\n      &lt;/n0:Z_WS_GET_CUSTOMER.Response&gt;\n   &lt;/soapenv:Body&gt;\n&lt;/soapenv:Envelope&gt;\n</code></pre>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#exemplo-completo-integracao-externa","title":"\ud83d\udca1 Exemplo Completo: Integra\u00e7\u00e3o Externa","text":"","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#sistema-externo-sap-provider","title":"Sistema Externo \u2192 SAP (Provider)","text":"<p>Function Module:</p> <pre><code>FUNCTION z_ws_create_sales_order.\n*\"----------------------------------------------------------------------\n*\"*\"Interface Local:\n*\"  IMPORTING\n*\"     VALUE(IS_HEADER) TYPE  BAPISDHD1\n*\"  TABLES\n*\"      IT_ITEMS STRUCTURE  BAPISDITM\n*\"      ET_RETURN STRUCTURE  BAPIRET2\n*\"  EXPORTING\n*\"     VALUE(EV_ORDER_NUMBER) TYPE  VBELN_VA\n*\"----------------------------------------------------------------------\n\n  \" Criar ordem via BAPI\n  CALL FUNCTION 'BAPI_SALESORDER_CREATEFROMDAT2'\n    EXPORTING\n      order_header_in = is_header\n    IMPORTING\n      salesdocument   = ev_order_number\n    TABLES\n      return          = et_return\n      order_items_in  = it_items.\n\n  \" Commit\n  READ TABLE et_return WITH KEY type = 'E' TRANSPORTING NO FIELDS.\n  IF sy-subrc = 0.\n    CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.\n  ELSE.\n    CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'\n      EXPORTING wait = 'X'.\n  ENDIF.\n\nENDFUNCTION.\n</code></pre> <p>Expor via SOAMANAGER (passos acima).</p>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#sap-sistema-externo-consumer","title":"SAP \u2192 Sistema Externo (Consumer)","text":"<p>Consumir Web Service de terceiros:</p> <pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_CALL_EXTERNAL_WS\n*&amp;---------------------------------------------------------------------*\nREPORT z_call_external_ws.\n\nDATA: lo_proxy TYPE REF TO zco_external_service,\n      ls_request TYPE zco_weather_request,\n      ls_response TYPE zco_weather_response.\n\nPARAMETERS: p_city TYPE string DEFAULT 'Lisboa'.\n\nSTART-OF-SELECTION.\n\n  TRY.\n      \" Criar proxy (gerado a partir de WSDL externo)\n      CREATE OBJECT lo_proxy\n        EXPORTING\n          logical_port_name = 'Z_WEATHER_LP'.\n\n      \" Request\n      ls_request-city = p_city.\n\n      \" Chamar servi\u00e7o externo\n      CALL METHOD lo_proxy-&gt;get_weather\n        EXPORTING\n          input  = ls_request\n        IMPORTING\n          output = ls_response.\n\n      \" Resultado\n      WRITE: / |Cidade: { p_city }|.\n      WRITE: / |Temperatura: { ls_response-temperature }\u00b0C|.\n      WRITE: / |Condi\u00e7\u00e3o: { ls_response-condition }|.\n\n    CATCH cx_root INTO DATA(lo_ex).\n      WRITE: / |Erro: { lo_ex-&gt;get_text( ) }|.\n  ENDTRY.\n</code></pre>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#transaction-sproxy","title":"\ud83d\udd27 Transaction SPROXY","text":"<p>Service Proxy - alternativa a SE80 para criar proxies.</p>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#criar-proxy","title":"Criar Proxy","text":"<ol> <li>SPROXY</li> <li>Outside-In \u2192 External WSDL</li> <li>Upload WSDL ou URL</li> <li>Generate</li> </ol>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#vantagens","title":"Vantagens","text":"<ul> <li>\u2705 Interface mais moderna</li> <li>\u2705 Melhor para Enterprise Services</li> <li>\u2705 Suporte a XSD complexos</li> </ul>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#monitorizacao","title":"\ud83d\udee0\ufe0f Monitoriza\u00e7\u00e3o","text":"","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#transaction-srt_util","title":"Transaction SRT_UTIL","text":"<p>Runtime Administration: - Ver logs de execu\u00e7\u00e3o - Mensagens SOAP - Erros</p>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#transaction-sxmb_moni","title":"Transaction SXMB_MONI","text":"<p>Integration Engine Monitoring: - Monitorar mensagens XML - Ver payloads - Reprocessar mensagens</p>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#transaction-sicf","title":"Transaction SICF","text":"<p>HTTP Service Maintenance: - Ativar/desativar servi\u00e7os - Configurar handlers - Ver estat\u00edsticas</p>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#performance-e-boas-praticas","title":"\u26a1 Performance e Boas Pr\u00e1ticas","text":"","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Reutilizar inst\u00e2ncia do proxy\nDATA: go_proxy TYPE REF TO zco_service.  \" Global\n\nFORM call_service.\n  IF go_proxy IS NOT BOUND.\n    CREATE OBJECT go_proxy\n      EXPORTING logical_port_name = 'LP_NAME'.  \" \u2705 Criar uma vez\n  ENDIF.\n\n  \" Usar go_proxy...\nENDFORM.\n\n\" 2. Tratar exce\u00e7\u00f5es espec\u00edficas\nTRY.\n    CALL METHOD lo_proxy-&gt;method.\n  CATCH cx_ai_system_fault.\n    \" Erro de comunica\u00e7\u00e3o\n  CATCH cx_ai_application_fault.\n    \" Erro de neg\u00f3cio\n  CATCH cx_root.\n    \" Outros erros\nENDTRY.\n\n\" 3. Timeout adequado\n\" Configurar em SOAMANAGER \u2192 Logical Port \u2192 Timeouts\n\n\" 4. Comprimir grandes payloads\n\" SOAMANAGER \u2192 Service Definition \u2192 Compression\n\n\" 5. Usar logical ports (n\u00e3o hardcode URLs)\nCREATE OBJECT lo_proxy\n  EXPORTING logical_port_name = 'Z_LP'.  \" \u2705 SM59\n</code></pre>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Criar proxy em cada chamada\nFORM call_ws.\n  CREATE OBJECT lo_proxy.  \" \u274c Repetitivo!\n  CALL METHOD lo_proxy-&gt;method.\nENDFORM.\n\n\" 2. N\u00e3o tratar erros\nCALL METHOD lo_proxy-&gt;method.  \" \u274c E se falhar?\n\n\" 3. Hardcoded URLs\nDATA lv_url TYPE string VALUE 'http://prod.com/ws'.  \" \u274c Usar LP\n\n\" 4. Payloads muito grandes sem compress\u00e3o\n\" Configurar compress\u00e3o em SOAMANAGER\n\n\" 5. Sync chamadas para opera\u00e7\u00f5es longas\nCALL METHOD lo_proxy-&gt;long_operation.  \" \u274c Timeout!\n\" Melhor: usar RFC ass\u00edncrono ou job\n</code></pre>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#exemplo-integracao-com-sistema-bancario","title":"\ud83d\udca1 Exemplo: Integra\u00e7\u00e3o com Sistema Banc\u00e1rio","text":"","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#provider-sap-expoe","title":"Provider (SAP exp\u00f5e)","text":"<p>Function Module:</p> <pre><code>FUNCTION z_ws_payment_status.\n*\"----------------------------------------------------------------------\n*\"*\"Interface Local:\n*\"  IMPORTING\n*\"     VALUE(IV_PAYMENT_ID) TYPE  STRING\n*\"  EXPORTING\n*\"     VALUE(EV_STATUS) TYPE  STRING\n*\"     VALUE(EV_AMOUNT) TYPE  WRBTR\n*\"     VALUE(EV_CURRENCY) TYPE  WAERS\n*\"     VALUE(EV_DATE) TYPE  DATUM\n*\"----------------------------------------------------------------------\n\n  \" Buscar pagamento\n  SELECT SINGLE\n    status,\n    amount,\n    currency,\n    payment_date\n  FROM zpayments\n  WHERE payment_id = @iv_payment_id\n  INTO (@ev_status, @ev_amount, @ev_currency, @ev_date).\n\n  IF sy-subrc &lt;&gt; 0.\n    ev_status = 'NOT_FOUND'.\n  ENDIF.\n\nENDFUNCTION.\n</code></pre> <p>Expor via SOAMANAGER.</p>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#consumer-sap-consome","title":"Consumer (SAP consome)","text":"<p>Chamar API banc\u00e1ria:</p> <pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_BANK_API_CALL\n*&amp;---------------------------------------------------------------------*\nREPORT z_bank_api_call.\n\nDATA: lo_proxy TYPE REF TO zco_bank_api,\n      ls_request TYPE zco_transfer_request,\n      ls_response TYPE zco_transfer_response.\n\nPARAMETERS: p_from TYPE string DEFAULT 'PT50123456789',\n            p_to   TYPE string DEFAULT 'PT50987654321',\n            p_amnt TYPE p DECIMALS 2 DEFAULT '1000.00'.\n\nSTART-OF-SELECTION.\n\n  TRY.\n      \" Criar proxy para API do banco\n      CREATE OBJECT lo_proxy\n        EXPORTING\n          logical_port_name = 'Z_BANK_LP'.\n\n      \" Preparar transfer\u00eancia\n      ls_request-from_account = p_from.\n      ls_request-to_account   = p_to.\n      ls_request-amount       = p_amnt.\n      ls_request-currency     = 'EUR'.\n      ls_request-description  = 'Pagamento SAP'.\n\n      \" Executar transfer\u00eancia\n      CALL METHOD lo_proxy-&gt;transfer_funds\n        EXPORTING\n          input  = ls_request\n        IMPORTING\n          output = ls_response.\n\n      \" Resultado\n      IF ls_response-status = 'SUCCESS'.\n        WRITE: / '\u2705 Transfer\u00eancia realizada com sucesso!'.\n        WRITE: / |ID Transa\u00e7\u00e3o: { ls_response-transaction_id }|.\n        WRITE: / |Timestamp: { ls_response-timestamp }|.\n      ELSE.\n        WRITE: / '\u274c Erro na transfer\u00eancia:'.\n        WRITE: / |C\u00f3digo: { ls_response-error_code }|.\n        WRITE: / |Mensagem: { ls_response-error_message }|.\n      ENDIF.\n\n    CATCH cx_ai_system_fault INTO DATA(lo_sys_ex).\n      WRITE: / |Erro de comunica\u00e7\u00e3o: { lo_sys_ex-&gt;get_text( ) }|.\n\n    CATCH cx_ai_application_fault INTO DATA(lo_app_ex).\n      WRITE: / |Erro do banco: { lo_app_ex-&gt;get_text( ) }|.\n\n    CATCH cx_root INTO DATA(lo_ex).\n      WRITE: / |Erro: { lo_ex-&gt;get_text( ) }|.\n  ENDTRY.\n</code></pre>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#troubleshooting","title":"\ud83d\udd27 Troubleshooting","text":"","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#erro-logical-port-not-found","title":"Erro: \"Logical Port not found\"","text":"<p>Solu\u00e7\u00e3o: 1. SOAMANAGER 2. Criar Logical Port 3. Configurar URL e autentica\u00e7\u00e3o</p>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#erro-http-500-internal-server-error","title":"Erro: \"HTTP 500 - Internal Server Error\"","text":"<p>Causas: - Erro no c\u00f3digo do servi\u00e7o - Dados inv\u00e1lidos</p> <p>Solu\u00e7\u00e3o: - SRT_UTIL \u2192 Ver logs - ST22 \u2192 Dumps - Debugar function module</p>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#erro-connection-timeout","title":"Erro: \"Connection timeout\"","text":"<p>Solu\u00e7\u00e3o: 1. SOAMANAGER \u2192 Logical Port 2. Timeouts tab 3. Aumentar timeout (ex: 60s)</p>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#erro-certificate-validation-failed","title":"Erro: \"Certificate validation failed\"","text":"<p>Solu\u00e7\u00e3o: 1. STRUST 2. Import certificado do servidor 3. Add to Certificate List</p>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#alternativas-modernas","title":"\ud83d\udd17 Alternativas Modernas","text":"","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#rest-vs-soap","title":"REST vs SOAP","text":"<p>Preferir REST quando: - \u2705 Integra\u00e7\u00e3o com sistemas modernos - \u2705 Aplica\u00e7\u00f5es mobile/web - \u2705 Performance cr\u00edtica - \u2705 Simplicidade</p> <p>Usar SOAP quando: - \u2705 Sistemas legados - \u2705 WS-Security necess\u00e1rio - \u2705 Contratos formais (WSDL) - \u2705 Transa\u00e7\u00f5es distribu\u00eddas</p>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#migracao-para-odatarest","title":"Migra\u00e7\u00e3o para OData/REST","text":"<pre><code>\" SOAP (antigo)\nCALL METHOD lo_proxy-&gt;get_customer\n  EXPORTING input = ls_input\n  IMPORTING output = ls_output.\n\n\" REST (moderno)\nDATA(lo_http) = cl_http_client=&gt;create_by_url( 'https://api.com/customers' ).\nlo_http-&gt;request-&gt;set_method( if_http_request=&gt;co_request_method_get ).\nlo_http-&gt;send( ).\nlo_http-&gt;receive( ).\nDATA(lv_json) = lo_http-&gt;response-&gt;get_cdata( ).\n</code></pre>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/5_web_services/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>OData - Alternativa RESTful moderna</li> <li>HTTP Client - Consumir APIs REST</li> <li>REST API - Criar APIs REST em ABAP</li> </ul> <p>Tags: <code>#WebServices</code> <code>#SOAP</code> <code>#WSDL</code> <code>#Integra\u00e7\u00f5es</code> <code>#SPROXY</code> <code>#SOAMANAGER</code></p>","tags":["ABAP","Web Services","SOAP","WSDL","Integra\u00e7\u00f5es"]},{"location":"integracoes/6_idocs/","title":"IDocs - Intermediate Documents","text":"","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>IDoc (Intermediate Document) \u00e9 o formato padr\u00e3o SAP para troca de dados entre sistemas SAP ou entre SAP e sistemas externos via EDI (Electronic Data Interchange).</p> <p>Caracter\u00edsticas: - \u2705 Formato estruturado e padronizado - \u2705 Ass\u00edncrono - \u2705 Garantia de entrega - \u2705 Auditoria completa - \u2705 Suporte a EDI (EDIFACT, ANSI X12) - \u2705 Baseado em ALE (Application Link Enabling)</p>","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#conceitos-fundamentais","title":"\ud83c\udfaf Conceitos Fundamentais","text":"","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#estrutura-de-um-idoc","title":"Estrutura de um IDoc","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   CONTROL RECORD        \u2502  \u2190 Controle (EDIDC)\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502   DATA RECORDS          \u2502  \u2190 Dados (EDIDD)\n\u2502   - Segment 1           \u2502\n\u2502   - Segment 2           \u2502\n\u2502   - ...                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502   STATUS RECORDS        \u2502  \u2190 Status (EDIDS)\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#componentes","title":"Componentes","text":"<p>1. IDoc Type (Tipo de IDoc) - Define estrutura dos segments - Ex: <code>ORDERS05</code>, <code>DEBMAS06</code>, <code>MATMAS05</code></p> <p>2. Message Type - Tipo de mensagem de neg\u00f3cio - Ex: <code>ORDERS</code> (Ordem), <code>DEBMAS</code> (Cliente), <code>MATMAS</code> (Material)</p> <p>3. Segments - Blocos de dados - Hierarquia pai-filho - Ex: <code>E1EDK01</code> (Cabe\u00e7alho), <code>E1EDP01</code> (Item)</p> <p>4. Logical System - Identificador do sistema - Configurado em SALE</p> <p>5. Partner Profile - Configura\u00e7\u00e3o de parceiro - Transaction WE20</p>","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#configuracao-basica","title":"\ud83d\udd27 Configura\u00e7\u00e3o B\u00e1sica","text":"","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#1-logical-system-sale","title":"1. Logical System (SALE)","text":"<p>Definir sistemas l\u00f3gicos:</p> <ol> <li>SALE \u2192 Basic Settings \u2192 Logical Systems</li> <li>Define Logical System</li> <li>Nome: <code>SAPDEV100</code>, <code>SAPQAS100</code>, etc.</li> <li>Assign Logical System to Client</li> </ol>","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#2-partner-profile-we20","title":"2. Partner Profile (WE20)","text":"<p>Configurar parceiro:</p> <ol> <li>WE20</li> <li>Create Partner Profile</li> <li>Partner Number: <code>VENDOR001</code> ou <code>CUSTOMER001</code></li> <li>Partner Type: <code>KU</code> (Cliente), <code>LI</code> (Fornecedor), <code>LS</code> (Sistema)</li> <li>Outbound Parameters:</li> <li>Message Type: <code>ORDERS</code></li> <li>IDoc Type: <code>ORDERS05</code></li> <li>Process Code: <code>ORDE</code></li> <li>Inbound Parameters:</li> <li>Process Code: <code>ORDE</code></li> </ol>","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#3-port-definition-we21","title":"3. Port Definition (WE21)","text":"<p>Criar porta de comunica\u00e7\u00e3o:</p> <ol> <li>WE21</li> <li>Transactional RFC \u2192 Create</li> <li>Port: <code>SAPPORT</code></li> <li>RFC Destination: Destino em SM59</li> <li>Save</li> </ol> <p>Tipos de Port: - File Port - Gravar IDoc em arquivo - Transactional RFC - Enviar via RFC - ABAP/4 Connections - Conex\u00e3o direta - XML HTTP - Via HTTP/XML</p>","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#criar-idoc-outbound","title":"\ud83d\udce4 Criar IDoc Outbound","text":"","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#exemplo-enviar-ordem-de-venda","title":"Exemplo: Enviar Ordem de Venda","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_CREATE_IDOC_ORDERS\n*&amp;---------------------------------------------------------------------*\nREPORT z_create_idoc_orders.\n\nDATA: ls_control TYPE edidc,\n      lt_data    TYPE TABLE OF edidd,\n      ls_data    TYPE edidd,\n      lv_docnum  TYPE edi_docnum.\n\n\" \u2550\u2550\u2550 CONTROL RECORD \u2550\u2550\u2550\nls_control-mestyp = 'ORDERS'.        \" Message Type\nls_control-idoctp = 'ORDERS05'.      \" IDoc Type\nls_control-rcvprt = 'LS'.            \" Partner Type (Logical System)\nls_control-rcvprn = 'SAPQAS100'.     \" Partner (Destination System)\nls_control-sndprt = 'LS'.            \" Sender Type\nls_control-sndprn = 'SAPDEV100'.     \" Sender\nls_control-direct = '2'.             \" Direction (2=Outbound)\n\n\" \u2550\u2550\u2550 DATA RECORDS \u2550\u2550\u2550\n\n\" Segment: E1EDK01 (Cabe\u00e7alho da Ordem)\nCLEAR ls_data.\nls_data-segnam = 'E1EDK01'.\nls_data-sdata  = '0000100000ORDRE1001'.  \" N\u00famero da ordem\nAPPEND ls_data TO lt_data.\n\n\" Segment: E1EDKA1 (Parceiro - Cliente)\nCLEAR ls_data.\nls_data-segnam = 'E1EDKA1'.\nls_data-sdata  = 'AG0001000000'.  \" AG = Sold-to Party\nAPPEND ls_data TO lt_data.\n\n\" Segment: E1EDP01 (Item)\nCLEAR ls_data.\nls_data-segnam = 'E1EDP01'.\nls_data-sdata  = '000010MAT-001    00000100PC'.  \" Item 10, Material, Qtd\nAPPEND ls_data TO lt_data.\n\n\" \u2550\u2550\u2550 CRIAR IDOC \u2550\u2550\u2550\nCALL FUNCTION 'MASTER_IDOC_DISTRIBUTE'\n  EXPORTING\n    master_idoc_control = ls_control\n  IMPORTING\n    communication_idoc_control = ls_control\n  TABLES\n    communication_idoc_data = lt_data\n  EXCEPTIONS\n    error_in_idoc_control = 1\n    error_writing_idoc_status = 2\n    error_in_idoc_data = 3\n    OTHERS = 4.\n\nIF sy-subrc = 0.\n  lv_docnum = ls_control-docnum.\n  WRITE: / |\u2705 IDoc criado: { lv_docnum }|.\n  WRITE: / 'Verificar: WE02 ou WE05'.\nELSE.\n  WRITE: / '\u274c Erro ao criar IDoc'.\nENDIF.\n</code></pre>","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#processar-idoc-inbound","title":"\ud83d\udce5 Processar IDoc Inbound","text":"","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#function-module-de-processamento","title":"Function Module de Processamento","text":"<p>Criar FM para processar IDoc recebido:</p> <pre><code>FUNCTION z_idoc_input_orders.\n*\"----------------------------------------------------------------------\n*\"*\"Interface Local:\n*\"  IMPORTING\n*\"     VALUE(INPUT_METHOD) TYPE  BDWFAP_PAR-INPUTMETHD\n*\"  TABLES\n*\"      IDOC_CONTRL STRUCTURE  EDIDC\n*\"      IDOC_DATA STRUCTURE  EDIDD\n*\"      IDOC_STATUS STRUCTURE  BDIDOCSTAT\n*\"----------------------------------------------------------------------\n\n  DATA: ls_control TYPE edidc,\n        lt_data    TYPE TABLE OF edidd,\n        ls_data    TYPE edidd,\n        ls_status  TYPE bdidocstat.\n\n  \" Ler control record\n  READ TABLE idoc_contrl INTO ls_control INDEX 1.\n\n  \" Ler dados\n  lt_data = idoc_data[].\n\n  \" Processar segments\n  LOOP AT lt_data INTO ls_data.\n    CASE ls_data-segnam.\n      WHEN 'E1EDK01'.\n        \" Processar cabe\u00e7alho\n        DATA(lv_order) = ls_data-sdata+0(10).\n        WRITE: / |Ordem: { lv_order }|.\n\n      WHEN 'E1EDP01'.\n        \" Processar item\n        DATA(lv_item) = ls_data-sdata+0(6).\n        DATA(lv_material) = ls_data-sdata+6(18).\n        WRITE: / |Item: { lv_item }, Material: { lv_material }|.\n    ENDCASE.\n  ENDLOOP.\n\n  \" \u2550\u2550\u2550 L\u00d3GICA DE NEG\u00d3CIO \u2550\u2550\u2550\n  \" Criar documento SAP (ordem, nota, etc.)\n\n  TRY.\n      \" Exemplo: Criar ordem via BAPI\n      \" ...\n\n      \" Sucesso\n      ls_status-docnum = ls_control-docnum.\n      ls_status-status = '53'.  \" Successfully posted\n      ls_status-msgty  = 'S'.\n      ls_status-msgv1  = 'Ordem criada com sucesso'.\n      APPEND ls_status TO idoc_status.\n\n    CATCH cx_root INTO DATA(lo_ex).\n      \" Erro\n      ls_status-docnum = ls_control-docnum.\n      ls_status-status = '51'.  \" Error\n      ls_status-msgty  = 'E'.\n      ls_status-msgv1  = lo_ex-&gt;get_text( ).\n      APPEND ls_status TO idoc_status.\n  ENDTRY.\n\nENDFUNCTION.\n</code></pre>","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#registrar-process-code-we42","title":"Registrar Process Code (WE42)","text":"<p>Associar FM ao IDoc Type:</p> <ol> <li>WE42 - Process Code</li> <li>Create \u2192 Processing with function module</li> <li>Process Code: <code>ZORD</code> (Inbound)</li> <li>Function Module: <code>Z_IDOC_INPUT_ORDERS</code></li> <li>IDoc Type: <code>ORDERS05</code></li> <li>Save</li> </ol>","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#monitorizacao-de-idocs","title":"\ud83d\udd0d Monitoriza\u00e7\u00e3o de IDocs","text":"","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#we02-idoc-display","title":"WE02 - IDoc Display","text":"<p>Ver IDoc espec\u00edfico:</p> <ol> <li>WE02</li> <li>N\u00famero do IDoc</li> <li>Display</li> </ol> <p>Informa\u00e7\u00f5es: - Control Record - Data Records (Segments) - Status Records</p>","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#we05-idoc-list","title":"WE05 - IDoc List","text":"<p>Buscar IDocs:</p> <ol> <li>WE05</li> <li>Filtros:</li> <li>Data de cria\u00e7\u00e3o</li> <li>Message Type</li> <li>Status</li> <li>Parceiro</li> <li>Execute</li> </ol> <p>Status comuns: - <code>01</code> - IDoc gerado - <code>03</code> - Enviado para partner - <code>12</code> - Enviado ao port - <code>30</code> - IDoc pronto para envio (outbound) - <code>50</code> - IDoc adicionado (inbound) - <code>51</code> - Erro na aplica\u00e7\u00e3o - <code>53</code> - Postado com sucesso - <code>64</code> - IDoc pronto para processamento</p>","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#we09-idoc-search-via-message-type","title":"WE09 - IDoc Search via Message Type","text":"<p>Buscar por tipo de mensagem.</p>","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#we19-test-tool","title":"WE19 - Test Tool","text":"<p>Testar processamento de IDocs:</p> <ol> <li>WE19</li> <li>Existing IDoc ou Create New</li> <li>Edit Segments</li> <li>Standard Inbound</li> <li>Process</li> </ol>","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#exemplos-praticos","title":"\ud83d\udca1 Exemplos Pr\u00e1ticos","text":"","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#exemplo-1-criar-cliente-debmas","title":"Exemplo 1: Criar Cliente (DEBMAS)","text":"<pre><code>REPORT z_create_idoc_customer.\n\nDATA: ls_control TYPE edidc,\n      lt_data    TYPE TABLE OF edidd,\n      ls_data    TYPE edidd.\n\n\" Control\nls_control-mestyp = 'DEBMAS'.\nls_control-idoctp = 'DEBMAS06'.\nls_control-rcvprt = 'LS'.\nls_control-rcvprn = 'SAPQAS100'.\nls_control-sndprt = 'LS'.\nls_control-sndprn = 'SAPDEV100'.\nls_control-direct = '2'.\n\n\" E1KNA1M - Dados gerais do cliente\nCLEAR ls_data.\nls_data-segnam = 'E1KNA1M'.\nls_data-sdata+0(10)  = '0001000099'.  \" N\u00famero do cliente\nls_data-sdata+10(4)  = 'KUNA'.        \" Account group\nls_data-sdata+14(35) = 'Cliente Teste SA'.  \" Nome\nls_data-sdata+49(2)  = 'PT'.          \" Pa\u00eds\nAPPEND ls_data TO lt_data.\n\n\" E1KNVVM - Dados de vendas\nCLEAR ls_data.\nls_data-segnam = 'E1KNVVM'.\nls_data-sdata+0(4)  = '1000'.  \" Org. Vendas\nls_data-sdata+4(2)  = '10'.    \" Canal\nls_data-sdata+6(2)  = '00'.    \" Setor\nAPPEND ls_data TO lt_data.\n\n\" Criar IDoc\nCALL FUNCTION 'MASTER_IDOC_DISTRIBUTE'\n  EXPORTING\n    master_idoc_control = ls_control\n  TABLES\n    communication_idoc_data = lt_data.\n\nIF sy-subrc = 0.\n  WRITE: / |\u2705 IDoc Cliente criado: { ls_control-docnum }|.\nENDIF.\n</code></pre>","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#exemplo-2-criar-material-matmas","title":"Exemplo 2: Criar Material (MATMAS)","text":"<pre><code>REPORT z_create_idoc_material.\n\nDATA: ls_control TYPE edidc,\n      lt_data    TYPE TABLE OF edidd,\n      ls_data    TYPE edidd.\n\n\" Control\nls_control-mestyp = 'MATMAS'.\nls_control-idoctp = 'MATMAS05'.\nls_control-rcvprt = 'LS'.\nls_control-rcvprn = 'SAPQAS100'.\nls_control-direct = '2'.\n\n\" E1MARAM - Dados gerais\nCLEAR ls_data.\nls_data-segnam = 'E1MARAM'.\nls_data-sdata+0(18) = 'MAT-TEST-001'.     \" Material\nls_data-sdata+18(4) = 'FERT'.             \" Tipo\nls_data-sdata+22(40) = 'Material de Teste'.  \" Descri\u00e7\u00e3o\nAPPEND ls_data TO lt_data.\n\n\" E1MARCM - Dados de centro\nCLEAR ls_data.\nls_data-segnam = 'E1MARCM'.\nls_data-sdata+0(4)  = '1000'.  \" Centro\nAPPEND ls_data TO lt_data.\n\n\" Criar\nCALL FUNCTION 'MASTER_IDOC_DISTRIBUTE'\n  EXPORTING\n    master_idoc_control = ls_control\n  TABLES\n    communication_idoc_data = lt_data.\n\nWRITE: / |IDoc: { ls_control-docnum }|.\n</code></pre>","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#exemplo-3-processar-idoc-de-arquivo","title":"Exemplo 3: Processar IDoc de Arquivo","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_PROCESS_IDOC_FILE\n*&amp;---------------------------------------------------------------------*\nREPORT z_process_idoc_file.\n\nPARAMETERS: p_file TYPE string DEFAULT 'C:\\idocs\\order.dat'.\n\nDATA: lv_filename TYPE string,\n      lt_idoc_data TYPE TABLE OF edidd,\n      ls_idoc_control TYPE edidc.\n\nlv_filename = p_file.\n\n\" Ler arquivo IDoc\nCALL FUNCTION 'EDI_DATA_INCOMING'\n  EXPORTING\n    file_name = lv_filename\n  IMPORTING\n    idoc_control = ls_idoc_control\n  TABLES\n    idoc_data = lt_idoc_data\n  EXCEPTIONS\n    file_not_found = 1\n    OTHERS = 2.\n\nIF sy-subrc = 0.\n  \" Processar IDoc\n  CALL FUNCTION 'IDOC_INBOUND_ASYNCHRONOUS'\n    EXPORTING\n      idoc_control = ls_idoc_control\n    TABLES\n      idoc_data = lt_idoc_data.\n\n  WRITE: / |\u2705 IDoc processado: { ls_idoc_control-docnum }|.\nELSE.\n  WRITE: / '\u274c Erro ao ler arquivo'.\nENDIF.\n</code></pre>","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#extensao-de-idocs","title":"\ud83d\udd27 Extens\u00e3o de IDocs","text":"","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#criar-extension-we30","title":"Criar Extension (WE30)","text":"<p>Adicionar campos customizados:</p> <ol> <li>WE30 - IDoc Type Development</li> <li>IDoc Type: <code>ORDERS05</code></li> <li>Create Extension</li> <li>Extension: <code>Z_ORDERS05_EXT</code></li> <li>Add Segment: <code>Z1EDP01</code> (c\u00f3pia de E1EDP01 com campos extras)</li> <li>Activate</li> </ol>","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#usar-extension","title":"Usar Extension","text":"<pre><code>\" Control com extension\nls_control-idoctp = 'ORDERS05'.\nls_control-cimtyp = 'Z_ORDERS05_EXT'.  \" Extension\n\n\" Segment customizado\nCLEAR ls_data.\nls_data-segnam = 'Z1EDP01'.\nls_data-sdata  = '...[dados com campos extras]...'.\nAPPEND ls_data TO lt_data.\n</code></pre>","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#seguranca-e-autorizacao","title":"\ud83d\udd12 Seguran\u00e7a e Autoriza\u00e7\u00e3o","text":"","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#authorization-objects","title":"Authorization Objects","text":"<p>S_IDOCDEFT - IDoc Definition - Criar/modificar IDoc types</p> <p>S_IDOC_ALL - IDoc Administration - Processar IDocs - Ver status</p> <p>S_ALE_OBJ - ALE Distribution - Enviar IDocs</p>","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#performance-e-boas-praticas","title":"\u26a1 Performance e Boas Pr\u00e1ticas","text":"","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Processar IDocs em background\nSUBMIT rseinb00 WITH docnum = lv_docnum AND RETURN.\n\n\" 2. Usar Packet Processing para volume alto\n\" BD87 - Processar IDocs em massa\n\n\" 3. Monitorar regularmente\n\" WE05 - Verificar IDocs com erro (Status 51)\n\n\" 4. Implementar retry para erros tempor\u00e1rios\nIF ls_status-status = '51'.\n  \" Verificar se \u00e9 erro tempor\u00e1rio\n  \" Reprocessar: BD87\nENDIF.\n\n\" 5. Usar filter em partner profile\n\" WE20 \u2192 Inbound Parameters \u2192 Filter\n\n\" 6. Documentar estrutura de segments\n*&amp;---------------------------------------------------------------------*\n*&amp; Segment E1EDP01 - Item:\n*&amp;   Posi\u00e7\u00e3o 0-6:   N\u00famero do item\n*&amp;   Posi\u00e7\u00e3o 6-24:  Material\n*&amp;   Posi\u00e7\u00e3o 24-39: Quantidade\n*&amp;---------------------------------------------------------------------*\n</code></pre>","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Processar um a um quando h\u00e1 volume\nLOOP AT lt_idocs INTO DATA(lv_idoc).\n  \" Processar individualmente  \u274c Lento!\nENDLOOP.\n\" Use BD87 para massa\n\n\" 2. N\u00e3o tratar status de erro\n\" Sempre verificar WE05 para status 51\n\n\" 3. IDocs muito grandes\n\" Dividir em m\u00faltiplos IDocs menores\n\n\" 4. N\u00e3o testar antes de produ\u00e7\u00e3o\n\" Sempre usar WE19 para testes\n\n\" 5. Hardcoded partner profiles\nDATA lv_partner TYPE edi_rcvprn VALUE 'SYSTEM'.  \" \u274c Configurar em WE20\n</code></pre>","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#troubleshooting","title":"\ud83d\udd27 Troubleshooting","text":"","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#idoc-com-status-51-error","title":"IDoc com Status 51 (Error)","text":"<p>Solu\u00e7\u00e3o: 1. WE02 \u2192 Ver IDoc 2. Status tab \u2192 Ver mensagem de erro 3. Corrigir dados 4. WE19 \u2192 Reprocessar ou BD87</p>","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#idoc-nao-processado-status-64","title":"IDoc n\u00e3o processado (Status 64)","text":"<p>Solu\u00e7\u00e3o: 1. BD87 - Process Inbound IDocs 2. Selecionar IDocs 3. Process</p>","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#idoc-nao-enviado","title":"IDoc n\u00e3o enviado","text":"<p>Solu\u00e7\u00e3o: 1. Verificar WE20 - Partner Profile 2. Verificar SM59 - RFC Destination 3. WE21 - Port ativo? 4. BD87 - Process Outbound IDocs</p>","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#erro-de-autorizacao","title":"Erro de autoriza\u00e7\u00e3o","text":"<p>Solu\u00e7\u00e3o: - PFCG \u2192 Adicionar S_IDOC_ALL - SU53 \u2192 Verificar autoriza\u00e7\u00e3o faltante</p>","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#comparacao-idoc-vs-outras-integracoes","title":"\ud83d\udcca Compara\u00e7\u00e3o: IDoc vs Outras Integra\u00e7\u00f5es","text":"Aspecto IDoc RFC OData Web Service Tipo Ass\u00edncrono S\u00edncrono/Async S\u00edncrono S\u00edncrono Formato Propriet\u00e1rio Bin\u00e1rio JSON/XML XML (SOAP) Auditoria \u2705 Completa \u274c Limitada \u274c N\u00e3o \u26a0\ufe0f Depende Reprocessamento \u2705 Sim \u274c N\u00e3o \u274c N\u00e3o \u274c N\u00e3o Performance \u26a0\ufe0f M\u00e9dia \u2705 R\u00e1pido \u2705 R\u00e1pido \u26a0\ufe0f M\u00e9dia Uso SAP \u2705 Tradicional \u2705 Comum \u2705 Moderno \u26a0\ufe0f Legacy","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/6_idocs/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>RFC - Alternativa s\u00edncrona</li> <li>OData - Integra\u00e7\u00e3o moderna</li> <li>REST API - APIs customizadas</li> </ul> <p>Tags: <code>#IDoc</code> <code>#EDI</code> <code>#ALE</code> <code>#Integra\u00e7\u00f5es</code> <code>#WE02</code> <code>#WE05</code> <code>#DEBMAS</code> <code>#MATMAS</code> <code>#ORDERS</code></p>","tags":["ABAP","IDoc","EDI","Integra\u00e7\u00f5es","ALE"]},{"location":"integracoes/7_rest_api/","title":"REST API em ABAP","text":"","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>REST (Representational State Transfer) \u00e9 um estilo arquitetural para APIs web baseado em HTTP. Em ABAP, podemos criar e consumir APIs RESTful modernas.</p> <p>Caracter\u00edsticas REST: - \u2705 Stateless (sem estado) - \u2705 Baseado em recursos (URLs) - \u2705 M\u00e9todos HTTP (GET, POST, PUT, DELETE) - \u2705 Formato JSON (geralmente) - \u2705 Leve e perform\u00e1tico</p>","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#rest-vs-soap-vs-odata","title":"\ud83c\udfaf REST vs SOAP vs OData","text":"Aspecto REST SOAP OData Protocolo HTTP HTTP/SMTP HTTP Formato JSON, XML XML JSON, XML Complexidade Baixa Alta M\u00e9dia Performance R\u00e1pida Lenta R\u00e1pida Flexibilidade Alta Baixa M\u00e9dia Padr\u00e3o SAP Customizado Legacy Fiori","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#criar-rest-api-provider","title":"\ud83d\udee0\ufe0f Criar REST API (Provider)","text":"","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#transaction-sicf-http-service","title":"Transaction SICF - HTTP Service","text":"<p>Criar servi\u00e7o HTTP customizado:</p>","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#passo-1-criar-handler-class","title":"Passo 1: Criar Handler Class","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Class ZCL_REST_PRODUCTS\n*&amp;---------------------------------------------------------------------*\nCLASS zcl_rest_products DEFINITION\n  PUBLIC\n  CREATE PUBLIC.\n\n  PUBLIC SECTION.\n    INTERFACES if_http_extension.\nENDCLASS.\n\nCLASS zcl_rest_products IMPLEMENTATION.\n  METHOD if_http_extension~handle_request.\n\n    DATA: lv_method TYPE string,\n          lv_path   TYPE string,\n          lv_body   TYPE string,\n          lv_response TYPE string.\n\n    \" Obter m\u00e9todo HTTP\n    lv_method = server-&gt;request-&gt;get_method( ).\n\n    \" Obter path\n    lv_path = server-&gt;request-&gt;get_header_field( '~path_info' ).\n\n    \" Processar request\n    CASE lv_method.\n      WHEN 'GET'.\n        \" GET /api/products\n        IF lv_path CP '/api/products*'.\n          me-&gt;get_products(\n            EXPORTING iv_path = lv_path\n            IMPORTING ev_json = lv_response ).\n        ENDIF.\n\n      WHEN 'POST'.\n        \" POST /api/products\n        lv_body = server-&gt;request-&gt;get_cdata( ).\n        me-&gt;create_product(\n          EXPORTING iv_json = lv_body\n          IMPORTING ev_json = lv_response ).\n\n      WHEN 'PUT'.\n        \" PUT /api/products/{id}\n        lv_body = server-&gt;request-&gt;get_cdata( ).\n        me-&gt;update_product(\n          EXPORTING\n            iv_path = lv_path\n            iv_json = lv_body\n          IMPORTING\n            ev_json = lv_response ).\n\n      WHEN 'DELETE'.\n        \" DELETE /api/products/{id}\n        me-&gt;delete_product(\n          EXPORTING iv_path = lv_path\n          IMPORTING ev_json = lv_response ).\n\n      WHEN OTHERS.\n        lv_response = '{\"error\": \"Method not allowed\"}'.\n        server-&gt;response-&gt;set_status( code = 405 reason = 'Method Not Allowed' ).\n    ENDCASE.\n\n    \" Set response\n    server-&gt;response-&gt;set_header_field(\n      name  = 'Content-Type'\n      value = 'application/json' ).\n    server-&gt;response-&gt;set_cdata( lv_response ).\n\n  ENDMETHOD.\n\n  METHOD get_products.\n    \" Implementa\u00e7\u00e3o GET\n    TYPES: BEGIN OF ty_product,\n             id       TYPE matnr,\n             name     TYPE maktx,\n             category TYPE mtart,\n             price    TYPE netpr,\n           END OF ty_product.\n\n    DATA: lt_products TYPE TABLE OF ty_product,\n          lv_id       TYPE matnr.\n\n    \" Verificar se \u00e9 GET de um produto espec\u00edfico\n    \" /api/products/MAT-001\n    IF iv_path CP '/api/products/*'.\n      lv_id = substring_after( val = iv_path sub = '/api/products/' ).\n\n      \" Buscar produto espec\u00edfico\n      SELECT SINGLE\n        mara~matnr AS id,\n        makt~maktx AS name,\n        mara~mtart AS category,\n        mbew~verpr AS price\n      FROM mara\n      INNER JOIN makt ON mara~matnr = makt~matnr\n      INNER JOIN mbew ON mara~matnr = mbew~matnr\n      WHERE mara~matnr = @lv_id\n        AND makt~spras = @sy-langu\n      INTO @DATA(ls_product).\n\n      IF sy-subrc = 0.\n        \" Produto encontrado\n        ev_json = /ui2/cl_json=&gt;serialize(\n          data = ls_product\n          compress = abap_false ).\n      ELSE.\n        \" 404 Not Found\n        ev_json = |{{ \"error\": \"Product { lv_id } not found\" }}|.\n      ENDIF.\n\n    ELSE.\n      \" GET todos os produtos\n      SELECT\n        mara~matnr AS id,\n        makt~maktx AS name,\n        mara~mtart AS category,\n        mbew~verpr AS price\n      FROM mara\n      INNER JOIN makt ON mara~matnr = makt~matnr\n      INNER JOIN mbew ON mara~matnr = mbew~matnr\n      WHERE makt~spras = @sy-langu\n      INTO TABLE @lt_products\n      UP TO 100 ROWS.\n\n      \" Converter para JSON\n      ev_json = /ui2/cl_json=&gt;serialize(\n        data = lt_products\n        compress = abap_false ).\n    ENDIF.\n  ENDMETHOD.\n\n  METHOD create_product.\n    \" Implementa\u00e7\u00e3o POST\n    TYPES: BEGIN OF ty_product_in,\n             name     TYPE string,\n             category TYPE string,\n             price    TYPE string,\n           END OF ty_product_in.\n\n    DATA: ls_product TYPE ty_product_in,\n          lv_matnr   TYPE matnr.\n\n    TRY.\n        \" Parse JSON\n        /ui2/cl_json=&gt;deserialize(\n          EXPORTING json = iv_json\n          CHANGING data = ls_product ).\n\n        \" Gerar n\u00famero de material\n        CALL FUNCTION 'NUMBER_GET_NEXT'\n          EXPORTING\n            nr_range_nr = '01'\n            object      = 'MATERIALNR'\n          IMPORTING\n            number      = lv_matnr.\n\n        \" Inserir produto (simplificado)\n        INSERT mara FROM VALUE #(\n          matnr = lv_matnr\n          mtart = CONV mtart( ls_product-category )\n          meins = 'PC'\n        ).\n\n        IF sy-subrc = 0.\n          \" Sucesso - 201 Created\n          ev_json = |{{ \"id\": \"{ lv_matnr }\", \"message\": \"Product created\" }}|.\n        ELSE.\n          \" Erro\n          ev_json = '{\"error\": \"Failed to create product\"}'.\n        ENDIF.\n\n      CATCH cx_root INTO DATA(lo_ex).\n        ev_json = |{{ \"error\": \"{ lo_ex-&gt;get_text( ) }\" }}|.\n    ENDTRY.\n  ENDMETHOD.\n\n  METHOD update_product.\n    \" Implementa\u00e7\u00e3o PUT\n    DATA: lv_id TYPE matnr,\n          ls_product TYPE ty_product_in.\n\n    \" Extrair ID da URL\n    lv_id = substring_after( val = iv_path sub = '/api/products/' ).\n\n    TRY.\n        \" Parse JSON\n        /ui2/cl_json=&gt;deserialize(\n          EXPORTING json = iv_json\n          CHANGING data = ls_product ).\n\n        \" Atualizar (simplificado)\n        UPDATE mara SET mtart = CONV mtart( ls_product-category )\n          WHERE matnr = lv_id.\n\n        IF sy-subrc = 0.\n          ev_json = |{{ \"message\": \"Product { lv_id } updated\" }}|.\n        ELSE.\n          ev_json = |{{ \"error\": \"Product { lv_id } not found\" }}|.\n        ENDIF.\n\n      CATCH cx_root INTO DATA(lo_ex).\n        ev_json = |{{ \"error\": \"{ lo_ex-&gt;get_text( ) }\" }}|.\n    ENDTRY.\n  ENDMETHOD.\n\n  METHOD delete_product.\n    \" Implementa\u00e7\u00e3o DELETE\n    DATA lv_id TYPE matnr.\n\n    lv_id = substring_after( val = iv_path sub = '/api/products/' ).\n\n    \" Deletar\n    DELETE FROM mara WHERE matnr = lv_id.\n\n    IF sy-subrc = 0.\n      ev_json = |{{ \"message\": \"Product { lv_id } deleted\" }}|.\n    ELSE.\n      ev_json = |{{ \"error\": \"Product { lv_id } not found\" }}|.\n    ENDIF.\n  ENDMETHOD.\n\nENDCLASS.\n</code></pre>","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#passo-2-criar-http-service-sicf","title":"Passo 2: Criar HTTP Service (SICF)","text":"<ol> <li>SICF - Maintain Services</li> <li>Navegar: default_host \u2192 sap \u2192 Create Sub-Element</li> <li>Service Name: <code>zapi</code></li> <li>Description: \"REST API\"</li> <li>Handler List: <code>ZCL_REST_PRODUCTS</code></li> <li>Save e Activate</li> </ol> <p>URL resultante: <pre><code>http://server:port/sap/zapi/products\n</code></pre></p>","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#testar-api","title":"Testar API","text":"","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#curl","title":"cURL","text":"<pre><code># GET - Listar produtos\ncurl -X GET http://server:8000/sap/zapi/products \\\n  -u username:password \\\n  -H \"Accept: application/json\"\n\n# GET - Produto espec\u00edfico\ncurl -X GET http://server:8000/sap/zapi/products/MAT-001 \\\n  -u username:password\n\n# POST - Criar produto\ncurl -X POST http://server:8000/sap/zapi/products \\\n  -u username:password \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"name\":\"Produto Novo\",\"category\":\"FERT\",\"price\":\"99.90\"}'\n\n# PUT - Atualizar produto\ncurl -X PUT http://server:8000/sap/zapi/products/MAT-001 \\\n  -u username:password \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"name\":\"Produto Atualizado\",\"price\":\"149.90\"}'\n\n# DELETE - Deletar produto\ncurl -X DELETE http://server:8000/sap/zapi/products/MAT-001 \\\n  -u username:password\n</code></pre>","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#autenticacao-e-seguranca","title":"\ud83d\udd10 Autentica\u00e7\u00e3o e Seguran\u00e7a","text":"","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#basic-authentication","title":"Basic Authentication","text":"<p>J\u00e1 implementado via HTTP: <pre><code>curl -u username:password http://server/sap/zapi/products\n</code></pre></p>","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#oauth-20","title":"OAuth 2.0","text":"<p>Implementar valida\u00e7\u00e3o de token:</p> <pre><code>METHOD validate_oauth_token.\n  DATA: lv_token TYPE string,\n        lv_auth_header TYPE string.\n\n  \" Obter header Authorization\n  lv_auth_header = server-&gt;request-&gt;get_header_field( 'Authorization' ).\n\n  \" Bearer &lt;token&gt;\n  IF lv_auth_header CP 'Bearer *'.\n    lv_token = substring_after( val = lv_auth_header sub = 'Bearer ' ).\n\n    \" Validar token (exemplo simplificado)\n    \" Em produ\u00e7\u00e3o: validar com servidor OAuth\n    IF lv_token = 'valid-token-123'.\n      \" Token v\u00e1lido\n      RETURN.\n    ELSE.\n      \" Token inv\u00e1lido - 401 Unauthorized\n      server-&gt;response-&gt;set_status( code = 401 reason = 'Unauthorized' ).\n      server-&gt;response-&gt;set_cdata( '{\"error\":\"Invalid token\"}' ).\n      \" Abortar\n    ENDIF.\n  ELSE.\n    \" Sem token - 401\n    server-&gt;response-&gt;set_status( code = 401 reason = 'Unauthorized' ).\n  ENDIF.\nENDMETHOD.\n</code></pre>","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#api-key","title":"API Key","text":"<pre><code>METHOD validate_api_key.\n  DATA lv_api_key TYPE string.\n\n  \" Obter API key do header\n  lv_api_key = server-&gt;request-&gt;get_header_field( 'X-API-Key' ).\n\n  \" Validar\n  IF lv_api_key &lt;&gt; 'secret-api-key-abc123'.\n    server-&gt;response-&gt;set_status( code = 403 reason = 'Forbidden' ).\n    server-&gt;response-&gt;set_cdata( '{\"error\":\"Invalid API key\"}' ).\n  ENDIF.\nENDMETHOD.\n</code></pre>","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#cors-cross-origin-resource-sharing","title":"CORS (Cross-Origin Resource Sharing)","text":"<p>Permitir acesso de outros dom\u00ednios:</p> <pre><code>METHOD set_cors_headers.\n  \" Permitir qualquer origem (desenvolvimento)\n  server-&gt;response-&gt;set_header_field(\n    name  = 'Access-Control-Allow-Origin'\n    value = '*' ).\n\n  \" M\u00e9todos permitidos\n  server-&gt;response-&gt;set_header_field(\n    name  = 'Access-Control-Allow-Methods'\n    value = 'GET, POST, PUT, DELETE, OPTIONS' ).\n\n  \" Headers permitidos\n  server-&gt;response-&gt;set_header_field(\n    name  = 'Access-Control-Allow-Headers'\n    value = 'Content-Type, Authorization, X-API-Key' ).\n\n  \" Preflight OPTIONS request\n  IF server-&gt;request-&gt;get_method( ) = 'OPTIONS'.\n    server-&gt;response-&gt;set_status( code = 200 reason = 'OK' ).\n    \" N\u00e3o processar mais\n  ENDIF.\nENDMETHOD.\n</code></pre>","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#trabalhar-com-json","title":"\ud83d\udcca Trabalhar com JSON","text":"","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#serializar-abap-json","title":"Serializar ABAP \u2192 JSON","text":"<pre><code>\" Estrutura simples\nDATA: BEGIN OF ls_user,\n        id    TYPE i VALUE 1,\n        name  TYPE string VALUE 'Jo\u00e3o Silva',\n        email TYPE string VALUE 'joao@example.com',\n      END OF ls_user.\n\nDATA(lv_json) = /ui2/cl_json=&gt;serialize(\n  data = ls_user\n  compress = abap_false  \" Formatado\n  pretty_name = /ui2/cl_json=&gt;pretty_mode-low_case ).  \" camelCase\n\n\" Resultado:\n\" {\"id\":1,\"name\":\"Jo\u00e3o Silva\",\"email\":\"joao@example.com\"}\n</code></pre>","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#deserializar-json-abap","title":"Deserializar JSON \u2192 ABAP","text":"<pre><code>DATA: lv_json TYPE string,\n      ls_user TYPE ty_user.\n\nlv_json = '{\"id\":1,\"name\":\"Jo\u00e3o Silva\",\"email\":\"joao@example.com\"}'.\n\n/ui2/cl_json=&gt;deserialize(\n  EXPORTING\n    json = lv_json\n    pretty_name = /ui2/cl_json=&gt;pretty_mode-camel_case\n  CHANGING\n    data = ls_user ).\n\nWRITE: / ls_user-name.  \" Jo\u00e3o Silva\n</code></pre>","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#arrays-json","title":"Arrays JSON","text":"<pre><code>\" Tabela interna \u2192 JSON array\nDATA: lt_products TYPE TABLE OF ty_product.\n\nSELECT * FROM mara INTO TABLE @lt_products UP TO 10 ROWS.\n\nDATA(lv_json_array) = /ui2/cl_json=&gt;serialize( data = lt_products ).\n\n\" Resultado: [{\"id\":\"MAT-001\",...},{\"id\":\"MAT-002\",...}]\n</code></pre>","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#features-avancadas","title":"\u26a1 Features Avan\u00e7adas","text":"","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#paginacao","title":"Pagina\u00e7\u00e3o","text":"<pre><code>METHOD get_products_paginated.\n  DATA: lv_page TYPE i,\n        lv_per_page TYPE i VALUE 20,\n        lv_offset TYPE i.\n\n  \" Query parameters: ?page=2&amp;per_page=10\n  lv_page = server-&gt;request-&gt;get_form_field( 'page' ).\n  IF lv_page IS INITIAL.\n    lv_page = 1.\n  ENDIF.\n\n  lv_per_page = server-&gt;request-&gt;get_form_field( 'per_page' ).\n  IF lv_per_page IS INITIAL.\n    lv_per_page = 20.\n  ENDIF.\n\n  lv_offset = ( lv_page - 1 ) * lv_per_page.\n\n  \" Buscar com pagina\u00e7\u00e3o\n  SELECT * FROM mara\n    INTO TABLE @DATA(lt_products)\n    UP TO @lv_per_page ROWS\n    OFFSET @lv_offset.\n\n  \" Resposta com metadata de pagina\u00e7\u00e3o\n  DATA(lv_json) = |{{ \"page\": { lv_page }, | &amp;&amp;\n                  |\"per_page\": { lv_per_page }, | &amp;&amp;\n                  |\"data\": { /ui2/cl_json=&gt;serialize( lt_products ) } }}|.\n\n  ev_json = lv_json.\nENDMETHOD.\n</code></pre>","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#filtros-e-ordenacao","title":"Filtros e Ordena\u00e7\u00e3o","text":"<pre><code>METHOD get_products_filtered.\n  DATA: lv_category TYPE mtart,\n        lv_sort     TYPE string,\n        lv_order    TYPE string.\n\n  \" Query: ?category=FERT&amp;sort=name&amp;order=desc\n  lv_category = server-&gt;request-&gt;get_form_field( 'category' ).\n  lv_sort     = server-&gt;request-&gt;get_form_field( 'sort' ).\n  lv_order    = server-&gt;request-&gt;get_form_field( 'order' ).\n\n  \" SELECT din\u00e2mico\n  SELECT * FROM mara\n    WHERE mtart = @lv_category\n    ORDER BY (lv_sort) (lv_order)\n    INTO TABLE @DATA(lt_products)\n    UP TO 100 ROWS.\n\n  ev_json = /ui2/cl_json=&gt;serialize( data = lt_products ).\nENDMETHOD.\n</code></pre>","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#http-status-codes","title":"HTTP Status Codes","text":"<pre><code>METHOD set_http_status.\n  \" 200 OK\n  server-&gt;response-&gt;set_status( code = 200 reason = 'OK' ).\n\n  \" 201 Created\n  server-&gt;response-&gt;set_status( code = 201 reason = 'Created' ).\n\n  \" 400 Bad Request\n  server-&gt;response-&gt;set_status( code = 400 reason = 'Bad Request' ).\n\n  \" 401 Unauthorized\n  server-&gt;response-&gt;set_status( code = 401 reason = 'Unauthorized' ).\n\n  \" 403 Forbidden\n  server-&gt;response-&gt;set_status( code = 403 reason = 'Forbidden' ).\n\n  \" 404 Not Found\n  server-&gt;response-&gt;set_status( code = 404 reason = 'Not Found' ).\n\n  \" 500 Internal Server Error\n  server-&gt;response-&gt;set_status( code = 500 reason = 'Internal Server Error' ).\nENDMETHOD.\n</code></pre>","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#rate-limiting","title":"Rate Limiting","text":"<pre><code>CLASS zcl_rate_limiter DEFINITION.\n  PUBLIC SECTION.\n    CLASS-METHODS:\n      check_limit\n        IMPORTING iv_user TYPE string\n        RETURNING VALUE(rv_allowed) TYPE abap_bool.\nENDCLASS.\n\nCLASS zcl_rate_limiter IMPLEMENTATION.\n  METHOD check_limit.\n    \" Verificar requisi\u00e7\u00f5es por minuto\n    \" (Implementa\u00e7\u00e3o simplificada - usar cache ou DB)\n\n    DATA: lv_count TYPE i,\n          lv_timestamp TYPE timestamp.\n\n    GET TIME STAMP FIELD lv_timestamp.\n\n    \" Contar requisi\u00e7\u00f5es do usu\u00e1rio no \u00faltimo minuto\n    SELECT COUNT(*) FROM zapi_requests\n      INTO @lv_count\n      WHERE user = @iv_user\n        AND timestamp &gt; @( lv_timestamp - 60 ).\n\n    IF lv_count &lt; 100.  \" Limite: 100 req/min\n      rv_allowed = abap_true.\n    ELSE.\n      rv_allowed = abap_false.\n    ENDIF.\n  ENDMETHOD.\nENDCLASS.\n\n\" Uso:\nIF zcl_rate_limiter=&gt;check_limit( sy-uname ) = abap_false.\n  server-&gt;response-&gt;set_status( code = 429 reason = 'Too Many Requests' ).\n  server-&gt;response-&gt;set_cdata( '{\"error\":\"Rate limit exceeded\"}' ).\n  RETURN.\nENDIF.\n</code></pre>","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#exemplo-completo-api-de-pedidos","title":"\ud83d\udca1 Exemplo Completo: API de Pedidos","text":"","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#handler-class","title":"Handler Class","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Class ZCL_REST_ORDERS_API\n*&amp;---------------------------------------------------------------------*\nCLASS zcl_rest_orders_api DEFINITION PUBLIC CREATE PUBLIC.\n  PUBLIC SECTION.\n    INTERFACES if_http_extension.\n\n  PRIVATE SECTION.\n    DATA: mo_server TYPE REF TO if_http_server.\n\n    METHODS:\n      get_orders IMPORTING iv_path TYPE string\n                 EXPORTING ev_json TYPE string,\n      create_order IMPORTING iv_json TYPE string\n                   EXPORTING ev_json TYPE string,\n      get_order_details IMPORTING iv_order_id TYPE vbeln_va\n                        EXPORTING ev_json TYPE string.\nENDCLASS.\n\nCLASS zcl_rest_orders_api IMPLEMENTATION.\n  METHOD if_http_extension~handle_request.\n    DATA: lv_method TYPE string,\n          lv_path   TYPE string.\n\n    mo_server = server.\n\n    \" M\u00e9todo e path\n    lv_method = server-&gt;request-&gt;get_method( ).\n    lv_path = server-&gt;request-&gt;get_header_field( '~path_info' ).\n\n    \" CORS\n    server-&gt;response-&gt;set_header_field(\n      name = 'Access-Control-Allow-Origin' value = '*' ).\n\n    \" Roteamento\n    CASE lv_method.\n      WHEN 'GET'.\n        IF lv_path = '/api/orders' OR lv_path = '/api/orders/'.\n          \" GET /api/orders - Listar ordens\n          me-&gt;get_orders(\n            EXPORTING iv_path = lv_path\n            IMPORTING ev_json = DATA(lv_response) ).\n\n        ELSEIF lv_path CP '/api/orders/*'.\n          \" GET /api/orders/{id} - Ordem espec\u00edfica\n          DATA(lv_order_id) = substring_after( val = lv_path sub = '/api/orders/' ).\n          me-&gt;get_order_details(\n            EXPORTING iv_order_id = CONV vbeln_va( lv_order_id )\n            IMPORTING ev_json = lv_response ).\n        ENDIF.\n\n      WHEN 'POST'.\n        \" POST /api/orders - Criar ordem\n        DATA(lv_body) = server-&gt;request-&gt;get_cdata( ).\n        me-&gt;create_order(\n          EXPORTING iv_json = lv_body\n          IMPORTING ev_json = lv_response ).\n\n      WHEN OTHERS.\n        lv_response = '{\"error\":\"Method not allowed\"}'.\n        server-&gt;response-&gt;set_status( code = 405 reason = 'Method Not Allowed' ).\n    ENDCASE.\n\n    \" Response\n    server-&gt;response-&gt;set_header_field( name = 'Content-Type' value = 'application/json' ).\n    server-&gt;response-&gt;set_cdata( lv_response ).\n  ENDMETHOD.\n\n  METHOD get_orders.\n    TYPES: BEGIN OF ty_order,\n             order_id   TYPE vbeln_va,\n             customer   TYPE kunnr,\n             order_date TYPE erdat,\n             net_value  TYPE netwr,\n           END OF ty_order.\n\n    DATA lt_orders TYPE TABLE OF ty_order.\n\n    \" Buscar ordens\n    SELECT vbeln AS order_id,\n           kunnr AS customer,\n           erdat AS order_date,\n           netwr AS net_value\n    FROM vbak\n    INTO TABLE @lt_orders\n    UP TO 50 ROWS\n    ORDER BY erdat DESCENDING.\n\n    \" JSON\n    ev_json = /ui2/cl_json=&gt;serialize(\n      data = lt_orders\n      compress = abap_false ).\n  ENDMETHOD.\n\n  METHOD get_order_details.\n    TYPES: BEGIN OF ty_order_detail,\n             order_id   TYPE vbeln_va,\n             customer   TYPE kunnr,\n             order_date TYPE erdat,\n             net_value  TYPE netwr,\n             items      TYPE TABLE OF ty_item WITH DEFAULT KEY,\n           END OF ty_order_detail,\n           BEGIN OF ty_item,\n             item_number TYPE posnr_va,\n             material    TYPE matnr,\n             quantity    TYPE kwmeng,\n             price       TYPE netpr,\n           END OF ty_item.\n\n    DATA: ls_order TYPE ty_order_detail,\n          lt_items TYPE TABLE OF ty_item.\n\n    \" Cabe\u00e7alho da ordem\n    SELECT SINGLE\n      vbeln AS order_id,\n      kunnr AS customer,\n      erdat AS order_date,\n      netwr AS net_value\n    FROM vbak\n    WHERE vbeln = @iv_order_id\n    INTO CORRESPONDING FIELDS OF @ls_order.\n\n    IF sy-subrc &lt;&gt; 0.\n      ev_json = |{{ \"error\": \"Order { iv_order_id } not found\" }}|.\n      mo_server-&gt;response-&gt;set_status( code = 404 reason = 'Not Found' ).\n      RETURN.\n    ENDIF.\n\n    \" Itens da ordem\n    SELECT\n      posnr AS item_number,\n      matnr AS material,\n      kwmeng AS quantity,\n      netpr AS price\n    FROM vbap\n    WHERE vbeln = @iv_order_id\n    INTO TABLE @lt_items.\n\n    ls_order-items = lt_items.\n\n    \" JSON\n    ev_json = /ui2/cl_json=&gt;serialize(\n      data = ls_order\n      compress = abap_false ).\n  ENDMETHOD.\n\n  METHOD create_order.\n    TYPES: BEGIN OF ty_order_request,\n             customer TYPE kunnr,\n             items    TYPE TABLE OF ty_item_req WITH DEFAULT KEY,\n           END OF ty_order_request,\n           BEGIN OF ty_item_req,\n             material TYPE matnr,\n             quantity TYPE kwmeng,\n           END OF ty_item_req.\n\n    DATA: ls_request TYPE ty_order_request,\n          lv_order_id TYPE vbeln_va.\n\n    TRY.\n        \" Parse JSON\n        /ui2/cl_json=&gt;deserialize(\n          EXPORTING json = iv_json\n          CHANGING data = ls_request ).\n\n        \" Criar ordem via BAPI (simplificado)\n        DATA: ls_header TYPE bapisdhd1,\n              lt_items TYPE TABLE OF bapisditm,\n              lt_return TYPE TABLE OF bapiret2.\n\n        ls_header-doc_type = 'TA'.\n        ls_header-sales_org = '1000'.\n        ls_header-distr_chan = '10'.\n        ls_header-division = '00'.\n\n        LOOP AT ls_request-items INTO DATA(ls_item_req).\n          APPEND VALUE #(\n            itm_number = sy-tabix * 10\n            material   = ls_item_req-material\n            target_qty = ls_item_req-quantity\n          ) TO lt_items.\n        ENDLOOP.\n\n        CALL FUNCTION 'BAPI_SALESORDER_CREATEFROMDAT2'\n          EXPORTING\n            order_header_in = ls_header\n          IMPORTING\n            salesdocument = lv_order_id\n          TABLES\n            return = lt_return\n            order_items_in = lt_items.\n\n        READ TABLE lt_return WITH KEY type = 'E' TRANSPORTING NO FIELDS.\n        IF sy-subrc = 0.\n          CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.\n          ev_json = '{\"error\":\"Failed to create order\"}'.\n          mo_server-&gt;response-&gt;set_status( code = 400 reason = 'Bad Request' ).\n        ELSE.\n          CALL FUNCTION 'BAPI_TRANSACTION_COMMIT' EXPORTING wait = 'X'.\n          ev_json = |{{ \"order_id\": \"{ lv_order_id }\", \"message\": \"Order created\" }}|.\n          mo_server-&gt;response-&gt;set_status( code = 201 reason = 'Created' ).\n        ENDIF.\n\n      CATCH cx_root INTO DATA(lo_ex).\n        ev_json = |{{ \"error\": \"{ lo_ex-&gt;get_text( ) }\" }}|.\n        mo_server-&gt;response-&gt;set_status( code = 500 reason = 'Internal Server Error' ).\n    ENDTRY.\n  ENDMETHOD.\nENDCLASS.\n</code></pre>","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#documentacao-api-swaggeropenapi","title":"\ud83d\udd17 Documenta\u00e7\u00e3o API (Swagger/OpenAPI)","text":"","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#gerar-swagger-json","title":"Gerar Swagger JSON","text":"<pre><code>{\n  \"swagger\": \"2.0\",\n  \"info\": {\n    \"title\": \"SAP Products API\",\n    \"version\": \"1.0.0\"\n  },\n  \"host\": \"server:8000\",\n  \"basePath\": \"/sap/zapi\",\n  \"schemes\": [\"https\"],\n  \"paths\": {\n    \"/products\": {\n      \"get\": {\n        \"summary\": \"List all products\",\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful\"\n          }\n        }\n      },\n      \"post\": {\n        \"summary\": \"Create product\",\n        \"parameters\": [{\n          \"in\": \"body\",\n          \"name\": \"product\",\n          \"schema\": {\n            \"$ref\": \"#/definitions/Product\"\n          }\n        }],\n        \"responses\": {\n          \"201\": {\"description\": \"Created\"}\n        }\n      }\n    }\n  },\n  \"definitions\": {\n    \"Product\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"id\": {\"type\": \"string\"},\n        \"name\": {\"type\": \"string\"},\n        \"price\": {\"type\": \"number\"}\n      }\n    }\n  }\n}\n</code></pre>","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#boas-praticas","title":"\u26a1 Boas Pr\u00e1ticas","text":"","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Versionamento da API\n\" /api/v1/products\n\n\" 2. Usar c\u00f3digos HTTP corretos\nserver-&gt;response-&gt;set_status( code = 201 reason = 'Created' ).\n\n\" 3. Valida\u00e7\u00e3o de input\nIF ls_product-name IS INITIAL.\n  ev_json = '{\"error\":\"Name is required\"}'.\n  server-&gt;response-&gt;set_status( code = 400 reason = 'Bad Request' ).\n  RETURN.\nENDIF.\n\n\" 4. Tratamento de exce\u00e7\u00f5es\nTRY.\n    \" ... l\u00f3gica ...\n  CATCH cx_root INTO DATA(lo_ex).\n    ev_json = |{{ \"error\": \"{ lo_ex-&gt;get_text( ) }\" }}|.\n    server-&gt;response-&gt;set_status( code = 500 reason = 'Internal Server Error' ).\nENDTRY.\n\n\" 5. CORS headers\nserver-&gt;response-&gt;set_header_field(\n  name = 'Access-Control-Allow-Origin' value = '*' ).\n</code></pre>","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Expor erros t\u00e9cnicos\nev_json = |{{ \"error\": \"{ lo_ex-&gt;get_longtext( ) }\" }}|.  \" \u274c Detalhes internos\n\n\" 2. N\u00e3o validar input\n\" Sempre validar dados recebidos!\n\n\" 3. Hardcoded secrets\nDATA lv_secret TYPE string VALUE 'senha123'.  \" \u274c NUNCA!\n\n\" 4. Queries sem limite\nSELECT * FROM huge_table INTO TABLE @lt_data.  \" \u274c Timeout!\n\n\" 5. N\u00e3o tratar erros HTTP\n\" Sempre usar status codes corretos\n</code></pre>","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"integracoes/7_rest_api/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>OData - Alternativa SAP para REST</li> <li>HTTP Client - Consumir APIs REST</li> <li>Web Services - SOAP vs REST</li> </ul> <p>Tags: <code>#REST</code> <code>#API</code> <code>#HTTP</code> <code>#JSON</code> <code>#SICF</code> <code>#Integra\u00e7\u00f5es</code> <code>#ABAP</code></p>","tags":["ABAP","REST API","HTTP","JSON","Integra\u00e7\u00f5es"]},{"location":"jobs/","title":"\u23f0 Jobs em Background","text":"<p>Agendamento e execu\u00e7\u00e3o de programas ABAP em background: cria\u00e7\u00e3o de jobs, agendamento, monitoriza\u00e7\u00e3o e boas pr\u00e1ticas.</p>"},{"location":"jobs/#o-que-vais-aprender","title":"\ud83d\udcd6 O que vais aprender","text":"<ul> <li>Criar e agendar jobs em background</li> <li>Usar variantes de sele\u00e7\u00e3o</li> <li>Configurar agendamentos peri\u00f3dicos (di\u00e1rio, semanal, mensal)</li> <li>Monitorizar jobs (SM37)</li> <li>Analisar logs e troubleshooting</li> <li>Batch Input (BDC) para migra\u00e7\u00e3o de dados</li> <li>Jobs com depend\u00eancias</li> <li>Notifica\u00e7\u00f5es e tratamento de erros</li> </ul>"},{"location":"jobs/#topicos","title":"\ud83d\udcda T\u00f3picos","text":""},{"location":"jobs/#1-criar-jobs","title":"1\ufe0f\u20e3 Criar Jobs","text":"<p>Como criar jobs via SM36 e programaticamente.</p> <ul> <li>Job b\u00e1sico com JOB_OPEN e JOB_CLOSE</li> <li>Adicionar programas com SUBMIT</li> <li>Classes de job (A, B, C)</li> <li>Jobs com m\u00faltiplos steps</li> </ul>"},{"location":"jobs/#2-variantes","title":"2\ufe0f\u20e3 Variantes","text":"<p>Usar variantes de sele\u00e7\u00e3o em jobs.</p> <ul> <li>Criar variantes via SE38</li> <li>Selection variables</li> <li>Variantes program\u00e1ticas</li> <li>Atualizar e deletar variantes</li> </ul>"},{"location":"jobs/#3-agendamento","title":"3\ufe0f\u20e3 Agendamento","text":"<p>Op\u00e7\u00f5es avan\u00e7adas de agendamento.</p> <ul> <li>Execu\u00e7\u00e3o imediata, data/hora espec\u00edfica</li> <li>Jobs peri\u00f3dicos (di\u00e1rio, semanal, mensal)</li> <li>Jobs dependentes (ap\u00f3s outro job)</li> <li>Jobs disparados por eventos</li> </ul>"},{"location":"jobs/#4-monitorizacao-sm37","title":"4\ufe0f\u20e3 Monitoriza\u00e7\u00e3o (SM37)","text":"<p>Monitorar e gerenciar jobs.</p> <ul> <li>Status de jobs (Scheduled, Active, Finished, Cancelled)</li> <li>Ver logs e spool</li> <li>Cancelar e repetir jobs</li> <li>Monitoriza\u00e7\u00e3o program\u00e1tica</li> </ul>"},{"location":"jobs/#5-job-logs","title":"5\ufe0f\u20e3 Job Logs","text":"<p>An\u00e1lise de logs e troubleshooting.</p> <ul> <li>Job Log vs Spool vs Application Log</li> <li>Ler logs programaticamente</li> <li>Debugging de jobs com erro</li> <li>Boas pr\u00e1ticas de logging</li> </ul>"},{"location":"jobs/#6-batch-processing","title":"6\ufe0f\u20e3 Batch Processing","text":"<p>Batch Input para migra\u00e7\u00e3o de dados.</p> <ul> <li>CALL TRANSACTION vs Session Method</li> <li>Gravar transa\u00e7\u00f5es com SHDB</li> <li>Processar grande volume de dados</li> <li>BDC em background jobs</li> </ul>"},{"location":"jobs/#exemplo-rapido","title":"\ud83c\udfaf Exemplo R\u00e1pido","text":""},{"location":"jobs/#criar-job-simples","title":"Criar Job Simples","text":"<pre><code>DATA: lv_job_name   TYPE tbtcjob-jobname VALUE 'Z_JOB_AUTOMATICO',\n      lv_job_number TYPE tbtcjob-jobcount.\n\n\" 1. Abrir job\nCALL FUNCTION 'JOB_OPEN'\n  EXPORTING\n    jobname  = lv_job_name\n  IMPORTING\n    jobcount = lv_job_number.\n\n\" 2. Adicionar programa\nSUBMIT z_meu_report\n  WITH p_param = lv_value\n  VIA JOB lv_job_name NUMBER lv_job_number\n  AND RETURN.\n\n\" 3. Agendar job (imediato)\nCALL FUNCTION 'JOB_CLOSE'\n  EXPORTING\n    jobname   = lv_job_name\n    jobcount  = lv_job_number\n    strtimmed = 'X'.  \" Iniciar imediatamente\n\nWRITE: / |\u2705 Job { lv_job_number } criado|.\n</code></pre>"},{"location":"jobs/#ferramentas-sap","title":"\ud83d\udee0\ufe0f Ferramentas SAP","text":"Transa\u00e7\u00e3o Descri\u00e7\u00e3o SM36 Criar e agendar jobs SM37 Monitorizar jobs existentes SE38 Criar variantes de sele\u00e7\u00e3o SM35 Batch Input sessions SHDB Gravar Batch Input SLG1 Application Log ST22 Dumps de runtime"},{"location":"jobs/#monitorizacao-sm37","title":"\ud83d\udcca Monitoriza\u00e7\u00e3o (SM37)","text":"<pre><code>DATA: lt_jobs TYPE TABLE OF tbtcjob.\n\nCALL FUNCTION 'BP_JOB_SELECT'\n  EXPORTING\n    jobname       = 'Z_MEU_JOB*'\n    status_finish = 'X'\n  TABLES\n    joblist       = lt_jobs.\n\nLOOP AT lt_jobs INTO DATA(ls_job).\n  WRITE: / ls_job-jobname, ls_job-status.\nENDLOOP.\n</code></pre> <p>Status poss\u00edveis: - S \u2014 Scheduled (agendado) - R \u2014 Released/Ready (pronto) - A \u2014 Active (em execu\u00e7\u00e3o) - F \u2014 Finished (conclu\u00eddo) - X \u2014 Cancelled (cancelado/erro)</p>"},{"location":"jobs/#boas-praticas","title":"\ud83d\udea8 Boas Pr\u00e1ticas","text":""},{"location":"jobs/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Usar variantes para par\u00e2metros\nSUBMIT z_report USING SELECTION-SET 'VARIANTE_PROD'.\n\n\" 2. Agendar fora do hor\u00e1rio de pico\nsdlstrttm = '020000'  \" \u2705 02:00 AM\n\n\" 3. Logar execu\u00e7\u00e3o\nPERFORM log_message USING 'Job iniciado'.\n\n\" 4. Testar em foreground primeiro\nSUBMIT z_report AND RETURN.  \" Teste antes de job\n\n\" 5. Monitorar jobs cr\u00edticos\n\" Criar job de monitoriza\u00e7\u00e3o que verifica outros jobs\n</code></pre>"},{"location":"jobs/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Jobs sem tratamento de erro\n\" \u274c Sempre verificar sy-subrc e mensagens\n\n\" 2. Processar tudo em foreground\n\" \u274c Usar jobs para grande volume\n\n\" 3. Jobs sem logging\n\" \u274c Imposs\u00edvel troubleshooting\n\n\" 4. Ignorar jobs cancelados em SM37\n\" \u274c Sempre investigar causas\n\n\" 5. M\u00faltiplos jobs nos mesmos dados\n\" \u274c Pode causar deadlocks\n</code></pre>"},{"location":"jobs/#troubleshooting","title":"\ufffd Troubleshooting","text":""},{"location":"jobs/#job-cancelado","title":"Job Cancelado","text":"<ol> <li>SM37 \u2192 Selecionar job \u2192 Job Log</li> <li>ST22 \u2192 Verificar dumps</li> <li>Re-executar em foreground com debug</li> </ol>"},{"location":"jobs/#job-lento","title":"Job Lento","text":"<ol> <li>SM37 \u2192 Ver tempo de execu\u00e7\u00e3o</li> <li>ST12 \u2192 Analisar performance</li> <li>Otimizar SELECTs e loops</li> </ol>"},{"location":"jobs/#job-nao-inicia","title":"Job N\u00e3o Inicia","text":"<ol> <li>Verificar status (deve ser Released)</li> <li>RZ04 \u2192 Verificar processos background dispon\u00edveis</li> <li>Liberar manualmente se necess\u00e1rio</li> </ol>"},{"location":"jobs/#proximos-passos","title":"\ufffd Pr\u00f3ximos Passos","text":"<p>Explore os t\u00f3picos detalhados:</p> <ol> <li>Criar Jobs - Aprenda a criar jobs via SM36 e c\u00f3digo</li> <li>Variantes - Configure par\u00e2metros com variantes</li> <li>Agendamento - Agende execu\u00e7\u00f5es peri\u00f3dicas</li> <li>Monitoriza\u00e7\u00e3o - Monitore jobs em SM37</li> <li>Job Logs - Analise logs e fa\u00e7a troubleshooting</li> <li>Batch Processing - Migre dados com BDC</li> </ol> <p>Relacionado: - Performance - Otimize jobs lentos - Integra\u00e7\u00f5es - Processe dados externos em background</p> <p>Tags: <code>#Jobs</code> <code>#Background</code> <code>#SM36</code> <code>#SM37</code> <code>#Agendamento</code> <code>#BDC</code></p>"},{"location":"jobs/1_criar_jobs/","title":"Criar Jobs - SM36","text":"","tags":["ABAP","Jobs","Background","SM36"]},{"location":"jobs/1_criar_jobs/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Jobs em background permitem executar programas ABAP sem intera\u00e7\u00e3o do usu\u00e1rio, ideal para processos longos, peri\u00f3dicos ou agendados.</p> <p>Transaction SM36 - Define Background Jobs</p>","tags":["ABAP","Jobs","Background","SM36"]},{"location":"jobs/1_criar_jobs/#criar-job-via-sm36","title":"\ud83c\udfaf Criar Job via SM36","text":"","tags":["ABAP","Jobs","Background","SM36"]},{"location":"jobs/1_criar_jobs/#passo-a-passo","title":"Passo a Passo","text":"","tags":["ABAP","Jobs","Background","SM36"]},{"location":"jobs/1_criar_jobs/#1-abrir-sm36","title":"1. Abrir SM36","text":"<p>Transaction: <code>SM36</code></p>","tags":["ABAP","Jobs","Background","SM36"]},{"location":"jobs/1_criar_jobs/#2-definir-job","title":"2. Definir Job","text":"<p>Campos obrigat\u00f3rios: - Job Name: Nome do job (ex: <code>Z_PROCESS_INVOICES</code>) - Job Class: Prioridade (A=Alta, B=M\u00e9dia, C=Baixa)</p> <pre><code>Job Name: Z_DAILY_REPORT\nJob Class: C\n</code></pre>","tags":["ABAP","Jobs","Background","SM36"]},{"location":"jobs/1_criar_jobs/#3-adicionar-step","title":"3. Adicionar Step","text":"<p>Bot\u00e3o: <code>Step</code></p> <p>Tipos de step: - ABAP Program - Executar report ABAP - External Command - Comando do sistema operacional - External Program - Programa externo</p> <p>Exemplo - ABAP Program: <pre><code>Program Name: Z_SALES_REPORT\nVariant: DAILY_SALES (opcional)\n</code></pre></p>","tags":["ABAP","Jobs","Background","SM36"]},{"location":"jobs/1_criar_jobs/#4-definir-agendamento","title":"4. Definir Agendamento","text":"<p>Bot\u00e3o: <code>Start Condition</code></p> <p>Op\u00e7\u00f5es: - Immediate - Executar imediatamente - Date/Time - Data e hora espec\u00edfica - After Job - Ap\u00f3s outro job - After Event - Disparado por evento - At Operation Mode - Em modo espec\u00edfico</p> <p>Exemplo - Agendamento Di\u00e1rio: <pre><code>Period Values: Daily\nStart Date: 01.01.2025\nStart Time: 06:00:00\n</code></pre></p>","tags":["ABAP","Jobs","Background","SM36"]},{"location":"jobs/1_criar_jobs/#5-salvar","title":"5. Salvar","text":"<p>Bot\u00e3o: <code>Save</code></p> <p>O job fica com status Scheduled.</p>","tags":["ABAP","Jobs","Background","SM36"]},{"location":"jobs/1_criar_jobs/#criar-job-programaticamente","title":"\ud83d\udcbb Criar Job Programaticamente","text":"","tags":["ABAP","Jobs","Background","SM36"]},{"location":"jobs/1_criar_jobs/#function-modules","title":"Function Modules","text":"<p>Sequ\u00eancia: 1. <code>JOB_OPEN</code> - Abrir job 2. <code>SUBMIT</code> ou <code>JOB_SUBMIT</code> - Adicionar steps 3. <code>JOB_CLOSE</code> - Fechar e agendar</p>","tags":["ABAP","Jobs","Background","SM36"]},{"location":"jobs/1_criar_jobs/#exemplo-completo","title":"Exemplo Completo","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_CREATE_BACKGROUND_JOB\n*&amp;---------------------------------------------------------------------*\nREPORT z_create_background_job.\n\nDATA: lv_job_name   TYPE tbtcjob-jobname VALUE 'Z_AUTO_BACKUP',\n      lv_job_number TYPE tbtcjob-jobcount,\n      lv_print_params TYPE pri_params.\n\nSTART-OF-SELECTION.\n\n  \" \u2550\u2550\u2550 1. ABRIR JOB \u2550\u2550\u2550\n  CALL FUNCTION 'JOB_OPEN'\n    EXPORTING\n      jobname          = lv_job_name\n    IMPORTING\n      jobcount         = lv_job_number\n    EXCEPTIONS\n      cant_create_job  = 1\n      invalid_job_data = 2\n      jobname_missing  = 3\n      OTHERS           = 4.\n\n  IF sy-subrc &lt;&gt; 0.\n    MESSAGE 'Erro ao criar job' TYPE 'E'.\n    RETURN.\n  ENDIF.\n\n  WRITE: / |\u2705 Job criado: { lv_job_name } ({ lv_job_number })|.\n\n  \" \u2550\u2550\u2550 2. ADICIONAR STEP (SUBMIT) \u2550\u2550\u2550\n  SUBMIT z_backup_data\n    WITH p_date = sy-datum\n    VIA JOB lv_job_name NUMBER lv_job_number\n    AND RETURN.\n\n  WRITE: / '\u2705 Step adicionado'.\n\n  \" \u2550\u2550\u2550 3. AGENDAR JOB \u2550\u2550\u2550\n  CALL FUNCTION 'JOB_CLOSE'\n    EXPORTING\n      jobcount             = lv_job_number\n      jobname              = lv_job_name\n      strtimmed            = 'X'  \" Executar imediatamente\n    EXCEPTIONS\n      cant_start_immediate = 1\n      invalid_startdate    = 2\n      jobname_missing      = 3\n      job_close_failed     = 4\n      OTHERS               = 5.\n\n  IF sy-subrc = 0.\n    WRITE: / '\u2705 Job agendado com sucesso!'.\n    WRITE: / 'Verificar em SM37'.\n  ELSE.\n    WRITE: / '\u274c Erro ao agendar job'.\n  ENDIF.\n</code></pre>","tags":["ABAP","Jobs","Background","SM36"]},{"location":"jobs/1_criar_jobs/#tipos-de-agendamento","title":"\ud83d\uddd3\ufe0f Tipos de Agendamento","text":"","tags":["ABAP","Jobs","Background","SM36"]},{"location":"jobs/1_criar_jobs/#execucao-imediata","title":"Execu\u00e7\u00e3o Imediata","text":"<pre><code>CALL FUNCTION 'JOB_CLOSE'\n  EXPORTING\n    jobcount  = lv_job_number\n    jobname   = lv_job_name\n    strtimmed = 'X'.  \" Immediate\n</code></pre>","tags":["ABAP","Jobs","Background","SM36"]},{"location":"jobs/1_criar_jobs/#data-e-hora-especifica","title":"Data e Hora Espec\u00edfica","text":"<pre><code>DATA: lv_start_date TYPE btch0000-sdlstrtdt,\n      lv_start_time TYPE btch0000-sdlstrttm.\n\nlv_start_date = '20250115'.  \" 15/01/2025\nlv_start_time = '180000'.    \" 18:00:00\n\nCALL FUNCTION 'JOB_CLOSE'\n  EXPORTING\n    jobcount  = lv_job_number\n    jobname   = lv_job_name\n    sdlstrtdt = lv_start_date\n    sdlstrttm = lv_start_time.\n</code></pre>","tags":["ABAP","Jobs","Background","SM36"]},{"location":"jobs/1_criar_jobs/#periodico-diario","title":"Peri\u00f3dico (Di\u00e1rio)","text":"<pre><code>DATA: ls_periodic TYPE btch0000.\n\n\" Configurar periodicidade\nls_periodic-period    = 'D'.  \" Daily\nls_periodic-frequency = '1'.  \" Todos os dias\n\nCALL FUNCTION 'JOB_CLOSE'\n  EXPORTING\n    jobcount       = lv_job_number\n    jobname        = lv_job_name\n    sdlstrtdt      = sy-datum\n    sdlstrttm      = '060000'\n    periodic_job   = 'X'\n    periodic_param = ls_periodic.\n</code></pre> <p>Valores de period: - <code>D</code> - Daily (Di\u00e1rio) - <code>W</code> - Weekly (Semanal) - <code>M</code> - Monthly (Mensal)</p>","tags":["ABAP","Jobs","Background","SM36"]},{"location":"jobs/1_criar_jobs/#apos-outro-job","title":"Ap\u00f3s Outro Job","text":"<pre><code>DATA: lv_predecessor TYPE tbtcjob-jobname VALUE 'JOB_ANTERIOR'.\n\nCALL FUNCTION 'JOB_CLOSE'\n  EXPORTING\n    jobcount       = lv_job_number\n    jobname        = lv_job_name\n    pred_jobcount  = lv_pred_number\n    pred_jobname   = lv_predecessor.\n</code></pre>","tags":["ABAP","Jobs","Background","SM36"]},{"location":"jobs/1_criar_jobs/#disparado-por-evento","title":"Disparado por Evento","text":"<pre><code>DATA: lv_event TYPE btceventid VALUE 'SAP_TRIGGER_JOB'.\n\nCALL FUNCTION 'JOB_CLOSE'\n  EXPORTING\n    jobcount  = lv_job_number\n    jobname   = lv_job_name\n    event_id  = lv_event.\n</code></pre> <p>Disparar evento: <pre><code>CALL FUNCTION 'BP_EVENT_RAISE'\n  EXPORTING\n    eventid = 'SAP_TRIGGER_JOB'.\n</code></pre></p>","tags":["ABAP","Jobs","Background","SM36"]},{"location":"jobs/1_criar_jobs/#job-classes","title":"\ud83d\udcca Job Classes","text":"<p>Prioridade de execu\u00e7\u00e3o:</p> Class Prioridade Uso A Alta Jobs cr\u00edticos, urgentes B M\u00e9dia Jobs normais C Baixa Jobs menos importantes <p>Definir class: <pre><code>CALL FUNCTION 'JOB_OPEN'\n  EXPORTING\n    jobname  = lv_job_name\n    jobclass = 'A'.  \" Alta prioridade\n</code></pre></p>","tags":["ABAP","Jobs","Background","SM36"]},{"location":"jobs/1_criar_jobs/#multiplos-steps","title":"\ud83d\udd27 M\u00faltiplos Steps","text":"<p>Adicionar v\u00e1rios programas ao mesmo job:</p> <pre><code>\" Abrir job\nCALL FUNCTION 'JOB_OPEN'\n  EXPORTING jobname = 'Z_MULTI_STEP_JOB'\n  IMPORTING jobcount = lv_job_number.\n\n\" Step 1: Extrair dados\nSUBMIT z_extract_data\n  VIA JOB 'Z_MULTI_STEP_JOB' NUMBER lv_job_number\n  AND RETURN.\n\n\" Step 2: Processar dados\nSUBMIT z_process_data\n  VIA JOB 'Z_MULTI_STEP_JOB' NUMBER lv_job_number\n  AND RETURN.\n\n\" Step 3: Enviar email\nSUBMIT z_send_email\n  VIA JOB 'Z_MULTI_STEP_JOB' NUMBER lv_job_number\n  AND RETURN.\n\n\" Fechar job\nCALL FUNCTION 'JOB_CLOSE'\n  EXPORTING\n    jobcount  = lv_job_number\n    jobname   = 'Z_MULTI_STEP_JOB'\n    strtimmed = 'X'.\n</code></pre>","tags":["ABAP","Jobs","Background","SM36"]},{"location":"jobs/1_criar_jobs/#exemplo-job-diario-automatico","title":"\ud83d\udca1 Exemplo: Job Di\u00e1rio Autom\u00e1tico","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_SCHEDULE_DAILY_JOB\n*&amp;---------------------------------------------------------------------*\nREPORT z_schedule_daily_job.\n\nDATA: lv_job_name   TYPE tbtcjob-jobname VALUE 'Z_DAILY_SALES',\n      lv_job_number TYPE tbtcjob-jobcount.\n\nPARAMETERS: p_time TYPE sy-uzeit DEFAULT '060000'.\n\nSTART-OF-SELECTION.\n\n  \" Abrir job\n  CALL FUNCTION 'JOB_OPEN'\n    EXPORTING\n      jobname  = lv_job_name\n      jobclass = 'C'\n    IMPORTING\n      jobcount = lv_job_number.\n\n  \" Adicionar programa\n  SUBMIT z_sales_report\n    WITH p_date = sy-datum\n    WITH p_email = 'vendas@empresa.com'\n    VIA JOB lv_job_name NUMBER lv_job_number\n    AND RETURN.\n\n  \" Agendar diariamente\n  CALL FUNCTION 'JOB_CLOSE'\n    EXPORTING\n      jobcount       = lv_job_number\n      jobname        = lv_job_name\n      sdlstrtdt      = sy-datum\n      sdlstrttm      = p_time\n      periodic_job   = 'X'\n      periodic_param = VALUE #(\n        period    = 'D'\n        frequency = '1'\n      ).\n\n  IF sy-subrc = 0.\n    WRITE: / |\u2705 Job agendado: { lv_job_name }|.\n    WRITE: / |Execu\u00e7\u00e3o di\u00e1ria \u00e0s { p_time TIME = USER }|.\n    WRITE: / 'Monitorizar em SM37'.\n  ENDIF.\n</code></pre>","tags":["ABAP","Jobs","Background","SM36"]},{"location":"jobs/1_criar_jobs/#boas-praticas","title":"\u26a1 Boas Pr\u00e1ticas","text":"","tags":["ABAP","Jobs","Background","SM36"]},{"location":"jobs/1_criar_jobs/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Sempre verificar sy-subrc\nCALL FUNCTION 'JOB_OPEN'\n  IMPORTING jobcount = lv_job_number\n  EXCEPTIONS\n    cant_create_job = 1\n    OTHERS = 2.\n\nIF sy-subrc &lt;&gt; 0.  \" \u2705 Verificar\n  MESSAGE 'Erro' TYPE 'E'.\nENDIF.\n\n\" 2. Nome descritivo para job\nDATA lv_job_name TYPE tbtcjob-jobname VALUE 'Z_SALES_DAILY_RPT'.  \" \u2705\n\n\" 3. Usar variantes para par\u00e2metros\nSUBMIT z_report\n  USING SELECTION-SET 'VARIANT_001'  \" \u2705 Variante\n  VIA JOB lv_job_name NUMBER lv_job_number.\n\n\" 4. Definir prioridade apropriada\nCALL FUNCTION 'JOB_OPEN'\n  EXPORTING jobclass = 'C'.  \" \u2705 Baixa para jobs n\u00e3o-urgentes\n\n\" 5. Documentar jobs\n*&amp;---------------------------------------------------------------------*\n*&amp; Job: Z_DAILY_BACKUP\n*&amp; Descri\u00e7\u00e3o: Backup di\u00e1rio de dados de vendas\n*&amp; Frequ\u00eancia: Di\u00e1rio \u00e0s 22:00\n*&amp; Owner: SAP_ADMIN\n*&amp;---------------------------------------------------------------------*\n</code></pre>","tags":["ABAP","Jobs","Background","SM36"]},{"location":"jobs/1_criar_jobs/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. N\u00e3o verificar erros\nCALL FUNCTION 'JOB_OPEN'\n  IMPORTING jobcount = lv_job_number.\n\" \u274c E se falhar?\n\n\" 2. Nome gen\u00e9rico\nDATA lv_job_name TYPE tbtcjob-jobname VALUE 'JOB1'.  \" \u274c\n\n\" 3. Hardcoded parameters\nSUBMIT z_report\n  WITH p_date = '20250101'  \" \u274c Data fixa!\n  VIA JOB lv_job_name NUMBER lv_job_number.\n\n\" 4. Prioridade A para tudo\nCALL FUNCTION 'JOB_OPEN'\n  EXPORTING jobclass = 'A'.  \" \u274c S\u00f3 para cr\u00edticos!\n\n\" 5. N\u00e3o usar variantes\n\" Par\u00e2metros hardcoded no c\u00f3digo  \" \u274c\n</code></pre>","tags":["ABAP","Jobs","Background","SM36"]},{"location":"jobs/1_criar_jobs/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>Variantes - Criar e usar variantes de sele\u00e7\u00e3o</li> <li>Agendamento - Op\u00e7\u00f5es avan\u00e7adas de agendamento</li> <li>Monitoriza\u00e7\u00e3o - SM37 e an\u00e1lise de jobs</li> </ul> <p>Tags: <code>#Jobs</code> <code>#Background</code> <code>#SM36</code> <code>#ABAP</code> <code>#Agendamento</code></p>","tags":["ABAP","Jobs","Background","SM36"]},{"location":"jobs/2_variantes/","title":"Variantes de Sele\u00e7\u00e3o","text":"","tags":["ABAP","Variantes","Selection Screen","Jobs"]},{"location":"jobs/2_variantes/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Variantes permitem salvar valores de selection screen para reutiliza\u00e7\u00e3o em execu\u00e7\u00f5es futuras ou jobs em background.</p> <p>Vantagens: - \u2705 Reutilizar par\u00e2metros - \u2705 Facilitar execu\u00e7\u00e3o de jobs - \u2705 Padronizar processos - \u2705 Reduzir erros de digita\u00e7\u00e3o</p>","tags":["ABAP","Variantes","Selection Screen","Jobs"]},{"location":"jobs/2_variantes/#criar-variante","title":"\ud83d\udee0\ufe0f Criar Variante","text":"","tags":["ABAP","Variantes","Selection Screen","Jobs"]},{"location":"jobs/2_variantes/#via-se38","title":"Via SE38","text":"","tags":["ABAP","Variantes","Selection Screen","Jobs"]},{"location":"jobs/2_variantes/#passo-a-passo","title":"Passo a Passo","text":"<ol> <li>SE38 \u2192 Nome do programa \u2192 Execute</li> <li>Preencher selection screen com valores desejados</li> <li>Menu: Goto \u2192 Variants \u2192 Save as Variant</li> <li>Nome da variante: (ex: <code>DAILY_RUN</code>)</li> <li>Description: \"Execu\u00e7\u00e3o di\u00e1ria\"</li> <li>Save</li> </ol>","tags":["ABAP","Variantes","Selection Screen","Jobs"]},{"location":"jobs/2_variantes/#atributos-de-campos","title":"Atributos de Campos","text":"<p>Ao salvar variante, pode configurar cada campo:</p> Atributo Descri\u00e7\u00e3o Save field without values Campo vazio na variante Protect field N\u00e3o permite altera\u00e7\u00e3o Hide field Campo invis\u00edvel Required field Campo obrigat\u00f3rio Selection variable Valor din\u00e2mico (data atual, etc.)","tags":["ABAP","Variantes","Selection Screen","Jobs"]},{"location":"jobs/2_variantes/#selection-variables","title":"\ud83d\udca1 Selection Variables","text":"<p>Valores din\u00e2micos calculados em runtime:</p>","tags":["ABAP","Variantes","Selection Screen","Jobs"]},{"location":"jobs/2_variantes/#variaveis-de-data","title":"Vari\u00e1veis de Data","text":"Vari\u00e1vel Descri\u00e7\u00e3o <code>D</code> Data atual <code>T</code> Data atual - 1 dia <code>M</code> Primeiro dia do m\u00eas atual <code>H</code> Primeiro dia do m\u00eas anterior <p>Exemplo: <pre><code>Campo: S_DATE-LOW\nSelection Variable: D (Data atual)\n\u2192 Sempre executar\u00e1 com data de hoje\n</code></pre></p>","tags":["ABAP","Variantes","Selection Screen","Jobs"]},{"location":"jobs/2_variantes/#variaveis-de-tempo","title":"Vari\u00e1veis de Tempo","text":"Vari\u00e1vel Descri\u00e7\u00e3o <code>S</code> Hora atual <code>I</code> Hora atual - 1 hora","tags":["ABAP","Variantes","Selection Screen","Jobs"]},{"location":"jobs/2_variantes/#usar-variante-em-job","title":"\ud83d\udd27 Usar Variante em Job","text":"","tags":["ABAP","Variantes","Selection Screen","Jobs"]},{"location":"jobs/2_variantes/#via-sm36","title":"Via SM36","text":"<ol> <li>SM36 \u2192 Create Job</li> <li>Step \u2192 ABAP Program</li> <li>Program Name: <code>Z_SALES_REPORT</code></li> <li>Variant: <code>DAILY_RUN</code> \u2705</li> <li>Save</li> </ol>","tags":["ABAP","Variantes","Selection Screen","Jobs"]},{"location":"jobs/2_variantes/#programaticamente","title":"Programaticamente","text":"<pre><code>SUBMIT z_sales_report\n  USING SELECTION-SET 'DAILY_RUN'  \" \u2705 Usar variante\n  VIA JOB lv_job_name NUMBER lv_job_number\n  AND RETURN.\n</code></pre>","tags":["ABAP","Variantes","Selection Screen","Jobs"]},{"location":"jobs/2_variantes/#criar-variante-programaticamente","title":"\ud83d\udcbb Criar Variante Programaticamente","text":"","tags":["ABAP","Variantes","Selection Screen","Jobs"]},{"location":"jobs/2_variantes/#function-module-rs_variant_catalog","title":"Function Module: RS_VARIANT_CATALOG","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_CREATE_VARIANT\n*&amp;---------------------------------------------------------------------*\nREPORT z_create_variant.\n\nDATA: lt_valutab TYPE TABLE OF rsparams,\n      ls_valutab TYPE rsparams,\n      lv_variant TYPE raldb-variant VALUE 'AUTO_VARIANT'.\n\nSTART-OF-SELECTION.\n\n  \" Definir valores da variante\n  ls_valutab-selname = 'P_DATE'.\n  ls_valutab-kind    = 'P'.  \" Parameter\n  ls_valutab-sign    = 'I'.\n  ls_valutab-option  = 'EQ'.\n  ls_valutab-low     = sy-datum.\n  APPEND ls_valutab TO lt_valutab.\n\n  ls_valutab-selname = 'S_CARR'.\n  ls_valutab-kind    = 'S'.  \" Select-option\n  ls_valutab-sign    = 'I'.\n  ls_valutab-option  = 'EQ'.\n  ls_valutab-low     = 'LH'.\n  APPEND ls_valutab TO lt_valutab.\n\n  \" Criar variante\n  CALL FUNCTION 'RS_CREATE_VARIANT'\n    EXPORTING\n      report               = 'Z_MY_REPORT'\n      variant              = lv_variant\n      vtext                = 'Variante Autom\u00e1tica'\n    TABLES\n      valutab              = lt_valutab\n    EXCEPTIONS\n      variant_exists       = 1\n      variant_locked       = 2\n      OTHERS               = 3.\n\n  IF sy-subrc = 0.\n    WRITE: / |\u2705 Variante criada: { lv_variant }|.\n  ELSE.\n    WRITE: / '\u274c Erro ao criar variante'.\n  ENDIF.\n</code></pre>","tags":["ABAP","Variantes","Selection Screen","Jobs"]},{"location":"jobs/2_variantes/#estrutura-de-variantes","title":"\ud83d\uddc2\ufe0f Estrutura de Variantes","text":"","tags":["ABAP","Variantes","Selection Screen","Jobs"]},{"location":"jobs/2_variantes/#tabela-rsparams","title":"Tabela RSPARAMS","text":"<pre><code>TYPES: BEGIN OF ty_variant,\n  selname TYPE rsparams-selname,  \" Nome do campo\n  kind    TYPE rsparams-kind,     \" P=Parameter, S=Select-option\n  sign    TYPE rsparams-sign,     \" I=Include, E=Exclude\n  option  TYPE rsparams-option,   \" EQ, NE, GT, LT, BT, CP\n  low     TYPE rsparams-low,      \" Valor baixo\n  high    TYPE rsparams-high,     \" Valor alto (para BT)\nEND OF ty_variant.\n</code></pre>","tags":["ABAP","Variantes","Selection Screen","Jobs"]},{"location":"jobs/2_variantes/#exemplo-completo","title":"Exemplo Completo","text":"<pre><code>\" Parameter (P_DATE)\nAPPEND VALUE #(\n  selname = 'P_DATE'\n  kind    = 'P'\n  sign    = 'I'\n  option  = 'EQ'\n  low     = '20250101'\n) TO lt_valutab.\n\n\" Select-option (S_CARR) - Range\nAPPEND VALUE #(\n  selname = 'S_CARR'\n  kind    = 'S'\n  sign    = 'I'\n  option  = 'BT'\n  low     = 'AA'\n  high    = 'LH'\n) TO lt_valutab.\n\n\" Select-option (S_MATNR) - Multiple values\nAPPEND VALUE #(\n  selname = 'S_MATNR'\n  kind    = 'S'\n  sign    = 'I'\n  option  = 'EQ'\n  low     = 'MAT001'\n) TO lt_valutab.\n\nAPPEND VALUE #(\n  selname = 'S_MATNR'\n  kind    = 'S'\n  sign    = 'I'\n  option  = 'EQ'\n  low     = 'MAT002'\n) TO lt_valutab.\n</code></pre>","tags":["ABAP","Variantes","Selection Screen","Jobs"]},{"location":"jobs/2_variantes/#ler-variante-existente","title":"\ud83d\udcca Ler Variante Existente","text":"","tags":["ABAP","Variantes","Selection Screen","Jobs"]},{"location":"jobs/2_variantes/#function-module-rs_variant_contents","title":"Function Module: RS_VARIANT_CONTENTS","text":"<pre><code>DATA: lt_valutab TYPE TABLE OF rsparams,\n      lv_variant TYPE raldb-variant VALUE 'DAILY_RUN'.\n\nCALL FUNCTION 'RS_VARIANT_CONTENTS'\n  EXPORTING\n    report               = 'Z_SALES_REPORT'\n    variant              = lv_variant\n  TABLES\n    valutab              = lt_valutab\n  EXCEPTIONS\n    variant_non_existent = 1\n    variant_obsolete     = 2\n    OTHERS               = 3.\n\nIF sy-subrc = 0.\n  LOOP AT lt_valutab INTO DATA(ls_val).\n    WRITE: / ls_val-selname, ls_val-low.\n  ENDLOOP.\nENDIF.\n</code></pre>","tags":["ABAP","Variantes","Selection Screen","Jobs"]},{"location":"jobs/2_variantes/#atualizar-variante","title":"\ud83d\udd04 Atualizar Variante","text":"<pre><code>\" 1. Ler variante existente\nCALL FUNCTION 'RS_VARIANT_CONTENTS'\n  EXPORTING\n    report  = 'Z_REPORT'\n    variant = 'MY_VAR'\n  TABLES\n    valutab = lt_valutab.\n\n\" 2. Modificar valores\nREAD TABLE lt_valutab WITH KEY selname = 'P_DATE'\n  ASSIGNING FIELD-SYMBOL(&lt;fs_val&gt;).\nIF sy-subrc = 0.\n  &lt;fs_val&gt;-low = sy-datum.  \" Atualizar para data atual\nENDIF.\n\n\" 3. Deletar variante antiga\nCALL FUNCTION 'RS_DELETE_VARIANT'\n  EXPORTING\n    report  = 'Z_REPORT'\n    variant = 'MY_VAR'.\n\n\" 4. Criar variante atualizada\nCALL FUNCTION 'RS_CREATE_VARIANT'\n  EXPORTING\n    report  = 'Z_REPORT'\n    variant = 'MY_VAR'\n  TABLES\n    valutab = lt_valutab.\n</code></pre>","tags":["ABAP","Variantes","Selection Screen","Jobs"]},{"location":"jobs/2_variantes/#deletar-variante","title":"\ud83d\uddd1\ufe0f Deletar Variante","text":"<pre><code>CALL FUNCTION 'RS_DELETE_VARIANT'\n  EXPORTING\n    report               = 'Z_MY_REPORT'\n    variant              = 'OLD_VARIANT'\n  EXCEPTIONS\n    variant_non_existent = 1\n    variant_locked       = 2\n    OTHERS               = 3.\n\nIF sy-subrc = 0.\n  WRITE: / '\u2705 Variante deletada'.\nENDIF.\n</code></pre>","tags":["ABAP","Variantes","Selection Screen","Jobs"]},{"location":"jobs/2_variantes/#exemplo-completo-job-com-variante-dinamica","title":"\ud83d\udca1 Exemplo Completo: Job com Variante Din\u00e2mica","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_JOB_WITH_DYNAMIC_VARIANT\n*&amp;---------------------------------------------------------------------*\nREPORT z_job_with_dynamic_variant.\n\nDATA: lv_job_name   TYPE tbtcjob-jobname VALUE 'Z_MONTHLY_REPORT',\n      lv_job_number TYPE tbtcjob-jobcount,\n      lv_variant    TYPE raldb-variant VALUE 'MONTHLY',\n      lt_valutab    TYPE TABLE OF rsparams.\n\nSTART-OF-SELECTION.\n\n  \" \u2550\u2550\u2550 1. CRIAR VARIANTE COM DATAS DIN\u00c2MICAS \u2550\u2550\u2550\n\n  \" Primeiro dia do m\u00eas atual\n  DATA(lv_first_day) = CONV datum( |{ sy-datum(6) }01| ).\n\n  \" \u00daltimo dia do m\u00eas atual\n  DATA(lv_last_day) = lv_first_day.\n  CALL FUNCTION 'LAST_DAY_OF_MONTHS'\n    EXPORTING\n      day_in  = lv_first_day\n    IMPORTING\n      last_day_of_month = lv_last_day.\n\n  \" Configurar range de datas\n  APPEND VALUE #(\n    selname = 'S_DATE'\n    kind    = 'S'\n    sign    = 'I'\n    option  = 'BT'\n    low     = lv_first_day\n    high    = lv_last_day\n  ) TO lt_valutab.\n\n  \" Deletar variante antiga (se existir)\n  CALL FUNCTION 'RS_DELETE_VARIANT'\n    EXPORTING\n      report  = 'Z_SALES_MONTHLY'\n      variant = lv_variant\n    EXCEPTIONS\n      OTHERS  = 0.\n\n  \" Criar nova variante\n  CALL FUNCTION 'RS_CREATE_VARIANT'\n    EXPORTING\n      report  = 'Z_SALES_MONTHLY'\n      variant = lv_variant\n      vtext   = |M\u00eas { sy-datum+4(2) }/{ sy-datum(4) }|\n    TABLES\n      valutab = lt_valutab.\n\n  WRITE: / |\u2705 Variante criada: { lv_first_day } - { lv_last_day }|.\n\n  \" \u2550\u2550\u2550 2. CRIAR JOB COM VARIANTE \u2550\u2550\u2550\n\n  CALL FUNCTION 'JOB_OPEN'\n    EXPORTING\n      jobname  = lv_job_name\n    IMPORTING\n      jobcount = lv_job_number.\n\n  \" Submeter programa com variante\n  SUBMIT z_sales_monthly\n    USING SELECTION-SET lv_variant\n    VIA JOB lv_job_name NUMBER lv_job_number\n    AND RETURN.\n\n  \" Agendar para executar imediatamente\n  CALL FUNCTION 'JOB_CLOSE'\n    EXPORTING\n      jobcount  = lv_job_number\n      jobname   = lv_job_name\n      strtimmed = 'X'.\n\n  WRITE: / |\u2705 Job criado: { lv_job_name }|.\n  WRITE: / 'Verificar em SM37'.\n</code></pre>","tags":["ABAP","Variantes","Selection Screen","Jobs"]},{"location":"jobs/2_variantes/#boas-praticas","title":"\u26a1 Boas Pr\u00e1ticas","text":"","tags":["ABAP","Variantes","Selection Screen","Jobs"]},{"location":"jobs/2_variantes/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Nome descritivo para variante\nDATA lv_variant TYPE raldb-variant VALUE 'DAILY_SALES_EUR'.  \" \u2705\n\n\" 2. Usar selection variables para datas\n\" No SE38 \u2192 Save Variant \u2192 Campo S_DATE \u2192 Selection Variable = 'D'\n\n\" 3. Proteger campos cr\u00edticos\n\" Save Variant \u2192 Campo P_BUKRS \u2192 \u2611 Protect field\n\n\" 4. Documentar variantes\n*&amp;---------------------------------------------------------------------*\n*&amp; Variante: MONTHLY_RUN\n*&amp; Descri\u00e7\u00e3o: Relat\u00f3rio mensal com range de todo o m\u00eas\n*&amp; Campos: S_DATE (BT - primeiro a \u00faltimo dia do m\u00eas)\n*&amp;---------------------------------------------------------------------*\n\n\" 5. Verificar se variante existe antes de usar\nCALL FUNCTION 'RS_VARIANT_EXISTS'\n  EXPORTING\n    report  = 'Z_REPORT'\n    variant = lv_variant\n  EXCEPTIONS\n    not_existent = 1.\n\nIF sy-subrc = 0.  \" \u2705 Variante existe\n  SUBMIT z_report USING SELECTION-SET lv_variant.\nENDIF.\n</code></pre>","tags":["ABAP","Variantes","Selection Screen","Jobs"]},{"location":"jobs/2_variantes/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Nome gen\u00e9rico\nDATA lv_variant TYPE raldb-variant VALUE 'VAR1'.  \" \u274c\n\n\" 2. Hardcoded values em vez de variantes\nSUBMIT z_report\n  WITH s_date-low = '20250101'  \" \u274c Usar variante!\n  WITH s_date-high = '20251231'.\n\n\" 3. N\u00e3o verificar se variante existe\nSUBMIT z_report\n  USING SELECTION-SET 'INEXISTENTE'  \" \u274c Pode falhar!\n  AND RETURN.\n\n\" 4. Variantes sem descri\u00e7\u00e3o\n\" Dificulta manuten\u00e7\u00e3o  \" \u274c\n\n\" 5. Misturar variante com par\u00e2metros expl\u00edcitos\nSUBMIT z_report\n  USING SELECTION-SET 'MY_VAR'\n  WITH p_extra = lv_value.  \" \u274c Confuso!\n</code></pre>","tags":["ABAP","Variantes","Selection Screen","Jobs"]},{"location":"jobs/2_variantes/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>Criar Jobs - Usar variantes em jobs</li> <li>Agendamento - Agendar jobs com variantes</li> <li>Monitoriza\u00e7\u00e3o - Ver variantes usadas em SM37</li> </ul> <p>Tags: <code>#Variantes</code> <code>#SelectionScreen</code> <code>#Jobs</code> <code>#ABAP</code> <code>#SE38</code></p>","tags":["ABAP","Variantes","Selection Screen","Jobs"]},{"location":"jobs/3_agendamento/","title":"Agendamento de Jobs","text":"","tags":["ABAP","Jobs","Agendamento","Background"]},{"location":"jobs/3_agendamento/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Agendamento permite executar jobs automaticamente em hor\u00e1rios ou eventos espec\u00edficos, sem interven\u00e7\u00e3o manual.</p>","tags":["ABAP","Jobs","Agendamento","Background"]},{"location":"jobs/3_agendamento/#tipos-de-agendamento","title":"\ud83d\uddd3\ufe0f Tipos de Agendamento","text":"","tags":["ABAP","Jobs","Agendamento","Background"]},{"location":"jobs/3_agendamento/#1-imediato","title":"1\ufe0f\u20e3 Imediato","text":"<p>Executar agora:</p> <pre><code>CALL FUNCTION 'JOB_CLOSE'\n  EXPORTING\n    jobcount  = lv_job_number\n    jobname   = lv_job_name\n    strtimmed = 'X'.  \" \u2705 Immediate\n</code></pre>","tags":["ABAP","Jobs","Agendamento","Background"]},{"location":"jobs/3_agendamento/#2-datahora-especifica","title":"2\ufe0f\u20e3 Data/Hora Espec\u00edfica","text":"<p>Executar em momento futuro:</p> <pre><code>CALL FUNCTION 'JOB_CLOSE'\n  EXPORTING\n    jobcount  = lv_job_number\n    jobname   = lv_job_name\n    sdlstrtdt = '20250115'  \" Data\n    sdlstrttm = '143000'.   \" Hora: 14:30\n</code></pre>","tags":["ABAP","Jobs","Agendamento","Background"]},{"location":"jobs/3_agendamento/#3-periodico","title":"3\ufe0f\u20e3 Peri\u00f3dico","text":"","tags":["ABAP","Jobs","Agendamento","Background"]},{"location":"jobs/3_agendamento/#diario","title":"Di\u00e1rio","text":"<pre><code>CALL FUNCTION 'JOB_CLOSE'\n  EXPORTING\n    jobcount       = lv_job_number\n    jobname        = lv_job_name\n    sdlstrtdt      = sy-datum\n    sdlstrttm      = '060000'\n    periodic_job   = 'X'\n    periodic_param = VALUE tbtcjob(\n      period    = 'D'  \" Daily\n      frequency = '1'  \" Todos os dias\n    ).\n</code></pre>","tags":["ABAP","Jobs","Agendamento","Background"]},{"location":"jobs/3_agendamento/#semanal","title":"Semanal","text":"<pre><code>periodic_param = VALUE tbtcjob(\n  period    = 'W'  \" Weekly\n  frequency = '1'  \" Toda semana\n  weekdays  = VALUE #(  \" Dias da semana\n    ( day = 'MON' )\n    ( day = 'WED' )\n    ( day = 'FRI' )\n  )\n).\n</code></pre>","tags":["ABAP","Jobs","Agendamento","Background"]},{"location":"jobs/3_agendamento/#mensal","title":"Mensal","text":"<pre><code>periodic_param = VALUE tbtcjob(\n  period    = 'M'  \" Monthly\n  frequency = '1'  \" Todo m\u00eas\n  monthdays = VALUE #(  \" Dias do m\u00eas\n    ( day = '01' )  \" Dia 1\n    ( day = '15' )  \" Dia 15\n  )\n).\n</code></pre>","tags":["ABAP","Jobs","Agendamento","Background"]},{"location":"jobs/3_agendamento/#4-apos-outro-job","title":"4\ufe0f\u20e3 Ap\u00f3s Outro Job","text":"<p>Job dependente:</p> <pre><code>DATA: lv_pred_job    TYPE tbtcjob-jobname VALUE 'JOB_PREDECESSOR',\n      lv_pred_number TYPE tbtcjob-jobcount.\n\n\" Obter n\u00famero do job predecessor (via SM37 ou c\u00f3digo)\n\" ...\n\nCALL FUNCTION 'JOB_CLOSE'\n  EXPORTING\n    jobcount      = lv_job_number\n    jobname       = lv_job_name\n    pred_jobname  = lv_pred_job\n    pred_jobcount = lv_pred_number.\n</code></pre>","tags":["ABAP","Jobs","Agendamento","Background"]},{"location":"jobs/3_agendamento/#5-por-evento","title":"5\ufe0f\u20e3 Por Evento","text":"<p>Job disparado por evento SAP:</p> <pre><code>CALL FUNCTION 'JOB_CLOSE'\n  EXPORTING\n    jobcount = lv_job_number\n    jobname  = lv_job_name\n    event_id = 'SAP_TRIGGER_BACKUP'.\n</code></pre> <p>Disparar evento: <pre><code>CALL FUNCTION 'BP_EVENT_RAISE'\n  EXPORTING\n    eventid              = 'SAP_TRIGGER_BACKUP'\n  EXCEPTIONS\n    bad_eventid          = 1\n    eventid_does_not_exist = 2\n    OTHERS               = 3.\n</code></pre></p>","tags":["ABAP","Jobs","Agendamento","Background"]},{"location":"jobs/3_agendamento/#configuracao-avancada","title":"\ud83d\udcc5 Configura\u00e7\u00e3o Avan\u00e7ada","text":"","tags":["ABAP","Jobs","Agendamento","Background"]},{"location":"jobs/3_agendamento/#data-final","title":"Data Final","text":"<p>Job peri\u00f3dico com fim:</p> <pre><code>CALL FUNCTION 'JOB_CLOSE'\n  EXPORTING\n    jobcount       = lv_job_number\n    jobname        = lv_job_name\n    laststrtdt     = '20251231'  \" \u2705 \u00daltima execu\u00e7\u00e3o\n    periodic_job   = 'X'\n    periodic_param = VALUE #( period = 'D' frequency = '1' ).\n</code></pre>","tags":["ABAP","Jobs","Agendamento","Background"]},{"location":"jobs/3_agendamento/#restricoes-de-tempo","title":"Restri\u00e7\u00f5es de Tempo","text":"<p>Executar apenas em hor\u00e1rio espec\u00edfico:</p> <pre><code>\" SM36 \u2192 Start Condition \u2192 Period Values \u2192 Restrictions\n\" Executar apenas entre 00:00 e 06:00\n</code></pre>","tags":["ABAP","Jobs","Agendamento","Background"]},{"location":"jobs/3_agendamento/#modo-de-operacao","title":"Modo de Opera\u00e7\u00e3o","text":"<p>Executar em modo espec\u00edfico do sistema:</p> <pre><code>CALL FUNCTION 'JOB_CLOSE'\n  EXPORTING\n    jobcount    = lv_job_number\n    jobname     = lv_job_name\n    op_mode_switch = 'X'\n    op_mode_name   = 'BATCH_MODE'.\n</code></pre>","tags":["ABAP","Jobs","Agendamento","Background"]},{"location":"jobs/3_agendamento/#exemplos-praticos","title":"\ud83d\udca1 Exemplos Pr\u00e1ticos","text":"","tags":["ABAP","Jobs","Agendamento","Background"]},{"location":"jobs/3_agendamento/#exemplo-1-backup-diario-noturno","title":"Exemplo 1: Backup Di\u00e1rio Noturno","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_SCHEDULE_NIGHTLY_BACKUP\n*&amp;---------------------------------------------------------------------*\nREPORT z_schedule_nightly_backup.\n\nDATA: lv_job_name   TYPE tbtcjob-jobname VALUE 'Z_NIGHTLY_BACKUP',\n      lv_job_number TYPE tbtcjob-jobcount.\n\nSTART-OF-SELECTION.\n\n  \" Abrir job\n  CALL FUNCTION 'JOB_OPEN'\n    EXPORTING\n      jobname  = lv_job_name\n      jobclass = 'C'\n    IMPORTING\n      jobcount = lv_job_number.\n\n  \" Adicionar programa de backup\n  SUBMIT z_backup_database\n    VIA JOB lv_job_name NUMBER lv_job_number\n    AND RETURN.\n\n  \" Agendar diariamente \u00e0s 02:00\n  CALL FUNCTION 'JOB_CLOSE'\n    EXPORTING\n      jobcount       = lv_job_number\n      jobname        = lv_job_name\n      sdlstrtdt      = sy-datum\n      sdlstrttm      = '020000'  \" 02:00 AM\n      periodic_job   = 'X'\n      periodic_param = VALUE #(\n        period    = 'D'\n        frequency = '1'\n      ).\n\n  WRITE: / '\u2705 Backup di\u00e1rio agendado para 02:00'.\n</code></pre>","tags":["ABAP","Jobs","Agendamento","Background"]},{"location":"jobs/3_agendamento/#exemplo-2-relatorio-semanal","title":"Exemplo 2: Relat\u00f3rio Semanal","text":"<pre><code>REPORT z_schedule_weekly_report.\n\nDATA: lv_job_name   TYPE tbtcjob-jobname VALUE 'Z_WEEKLY_SALES',\n      lv_job_number TYPE tbtcjob-jobcount.\n\nSTART-OF-SELECTION.\n\n  CALL FUNCTION 'JOB_OPEN'\n    EXPORTING jobname = lv_job_name\n    IMPORTING jobcount = lv_job_number.\n\n  SUBMIT z_sales_report\n    USING SELECTION-SET 'WEEKLY'\n    VIA JOB lv_job_name NUMBER lv_job_number\n    AND RETURN.\n\n  \" Toda segunda-feira \u00e0s 08:00\n  CALL FUNCTION 'JOB_CLOSE'\n    EXPORTING\n      jobcount       = lv_job_number\n      jobname        = lv_job_name\n      sdlstrtdt      = sy-datum\n      sdlstrttm      = '080000'\n      periodic_job   = 'X'\n      periodic_param = VALUE #(\n        period    = 'W'\n        frequency = '1'\n        weekdays  = VALUE #( ( day = 'MON' ) )\n      ).\n\n  WRITE: / '\u2705 Relat\u00f3rio agendado para segundas \u00e0s 08:00'.\n</code></pre>","tags":["ABAP","Jobs","Agendamento","Background"]},{"location":"jobs/3_agendamento/#exemplo-3-processamento-em-cadeia","title":"Exemplo 3: Processamento em Cadeia","text":"<pre><code>REPORT z_chain_jobs.\n\nDATA: lv_job1_name   TYPE tbtcjob-jobname VALUE 'Z_EXTRACT',\n      lv_job1_number TYPE tbtcjob-jobcount,\n      lv_job2_name   TYPE tbtcjob-jobname VALUE 'Z_PROCESS',\n      lv_job2_number TYPE tbtcjob-jobcount.\n\nSTART-OF-SELECTION.\n\n  \" \u2550\u2550\u2550 JOB 1: EXTRAIR DADOS \u2550\u2550\u2550\n  CALL FUNCTION 'JOB_OPEN'\n    EXPORTING jobname = lv_job1_name\n    IMPORTING jobcount = lv_job1_number.\n\n  SUBMIT z_extract_data\n    VIA JOB lv_job1_name NUMBER lv_job1_number\n    AND RETURN.\n\n  CALL FUNCTION 'JOB_CLOSE'\n    EXPORTING\n      jobcount  = lv_job1_number\n      jobname   = lv_job1_name\n      strtimmed = 'X'.\n\n  WRITE: / |Job 1 criado: { lv_job1_number }|.\n\n  \" \u2550\u2550\u2550 JOB 2: PROCESSAR (AP\u00d3S JOB 1) \u2550\u2550\u2550\n  CALL FUNCTION 'JOB_OPEN'\n    EXPORTING jobname = lv_job2_name\n    IMPORTING jobcount = lv_job2_number.\n\n  SUBMIT z_process_data\n    VIA JOB lv_job2_name NUMBER lv_job2_number\n    AND RETURN.\n\n  \" Executar ap\u00f3s Job 1\n  CALL FUNCTION 'JOB_CLOSE'\n    EXPORTING\n      jobcount      = lv_job2_number\n      jobname       = lv_job2_name\n      pred_jobname  = lv_job1_name\n      pred_jobcount = lv_job1_number.\n\n  WRITE: / '\u2705 Jobs em cadeia criados'.\n  WRITE: / 'Job 2 executar\u00e1 ap\u00f3s conclus\u00e3o do Job 1'.\n</code></pre>","tags":["ABAP","Jobs","Agendamento","Background"]},{"location":"jobs/3_agendamento/#boas-praticas","title":"\u26a1 Boas Pr\u00e1ticas","text":"","tags":["ABAP","Jobs","Agendamento","Background"]},{"location":"jobs/3_agendamento/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Jobs noturnos fora do hor\u00e1rio de pico\nsdlstrttm = '020000'  \" \u2705 02:00 AM\n\n\" 2. Data final para jobs peri\u00f3dicos de teste\nlaststrtdt = '20250131'  \" \u2705 Termina em Jan/2025\n\n\" 3. Usar eventos para processos ass\u00edncronos\nevent_id = 'Z_CUSTOM_TRIGGER'  \" \u2705\n\n\" 4. Documentar depend\u00eancias\n*&amp;---------------------------------------------------------------------*\n*&amp; Job: Z_PROCESS_ORDERS\n*&amp; Prerequisite: Z_EXTRACT_ORDERS deve completar primeiro\n*&amp;---------------------------------------------------------------------*\n\n\" 5. Class apropriada\njobclass = 'C'  \" \u2705 Baixa para n\u00e3o-urgentes\n</code></pre>","tags":["ABAP","Jobs","Agendamento","Background"]},{"location":"jobs/3_agendamento/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Jobs em hor\u00e1rio de pico\nsdlstrttm = '140000'  \" \u274c 14:00 - hor\u00e1rio comercial\n\n\" 2. Peri\u00f3dicos sem data final em produ\u00e7\u00e3o\n\" periodic sem laststrtdt  \" \u274c Pode executar indefinidamente\n\n\" 3. Depend\u00eancias circulares\n\" Job A depende de Job B que depende de Job A  \" \u274c\n\n\" 4. Prioridade A para todos os jobs\njobclass = 'A'  \" \u274c Reservar para cr\u00edticos\n\n\" 5. Agendamentos muito frequentes\nfrequency = '1'  \" A cada 1 minuto  \" \u274c Sobrecarrega sistema\n</code></pre>","tags":["ABAP","Jobs","Agendamento","Background"]},{"location":"jobs/3_agendamento/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>Criar Jobs - Criar jobs b\u00e1sicos</li> <li>Monitoriza\u00e7\u00e3o - Monitorar jobs agendados (SM37)</li> <li>Job Logs - Analisar logs de execu\u00e7\u00e3o</li> </ul> <p>Tags: <code>#Agendamento</code> <code>#Jobs</code> <code>#Background</code> <code>#SM36</code> <code>#Peri\u00f3dico</code></p>","tags":["ABAP","Jobs","Agendamento","Background"]},{"location":"jobs/4_monitorizacao/","title":"Monitoriza\u00e7\u00e3o de Jobs (SM37)","text":"","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>SM37 \u00e9 a transa\u00e7\u00e3o para monitorar jobs em background - verificar status, logs, erros e hist\u00f3rico.</p>","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#acessar-sm37","title":"\ud83d\udd0d Acessar SM37","text":"<ol> <li>Executar transa\u00e7\u00e3o: <code>/nSM37</code></li> <li>Filtros principais:</li> <li>Job Name: Nome do job (wildcards <code>*</code> permitidos)</li> <li>User: Usu\u00e1rio que criou</li> <li>Start Date: Per\u00edodo de execu\u00e7\u00e3o</li> <li>Status: Scheduled, Released, Ready, Active, Finished, Cancelled</li> </ol>","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#status-de-jobs","title":"\ud83d\udcca Status de Jobs","text":"Status Significado A\u00e7\u00e3o Scheduled Agendado, aguardando hor\u00e1rio \u23f3 Aguardar Released Liberado para execu\u00e7\u00e3o \ud83d\udfe2 Normal Ready Pronto, aguardando server dispon\u00edvel \ud83d\udfe1 Verificar carga Active Executando agora \u26a1 Em progresso Finished Conclu\u00eddo com sucesso \u2705 OK Cancelled Cancelado/Com erro \u274c Ver log","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#operacoes-em-sm37","title":"\ud83d\udee0\ufe0f Opera\u00e7\u00f5es em SM37","text":"","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#ver-log-do-job","title":"Ver Log do Job","text":"<ol> <li>Selecionar job</li> <li>Job \u2192 Job Log (ou <code>F9</code>)</li> </ol> <p>Verificar: - \u2705 Mensagens de sucesso - \u26a0\ufe0f Warnings - \u274c Erros cr\u00edticos</p>","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#ver-spool-de-output","title":"Ver Spool de Output","text":"<ol> <li>Selecionar job</li> <li>Job \u2192 Spool list (ou <code>Shift+F7</code>)</li> </ol> <p>Ver impress\u00f5es/outputs: - Relat\u00f3rios gerados - Listas de dados - Arquivos exportados</p>","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#cancelar-job-ativo","title":"Cancelar Job Ativo","text":"<pre><code>1. Selecionar job Active\n2. Job \u2192 Cancel Active Job\n3. Confirmar\n</code></pre> <p>\u26a0\ufe0f Cuidado: Cancela imediatamente, pode deixar dados inconsistentes!</p>","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#repetir-job","title":"Repetir Job","text":"<pre><code>1. Selecionar job Finished\n2. Job \u2192 Copy to reschedule\n3. Ajustar agendamento se necess\u00e1rio\n4. Salvar\n</code></pre>","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#deletar-job","title":"Deletar Job","text":"<pre><code>1. Selecionar job Scheduled ou Cancelled\n2. Job \u2192 Delete\n3. Confirmar\n</code></pre> <p>\u274c N\u00e3o pode deletar jobs: Active ou Released</p>","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#filtros-uteis","title":"\ud83d\udccb Filtros \u00dateis","text":"","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#jobs-de-hoje","title":"Jobs de Hoje","text":"<pre><code>Job Name: *\nUser: &lt;seu usu\u00e1rio&gt;\nStart Date: &lt;data atual&gt;\nStatus: Finished + Cancelled\n</code></pre>","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#jobs-agendados-futuros","title":"Jobs Agendados Futuros","text":"<pre><code>Job Name: Z*\nStatus: Scheduled\nStart Date: &lt;hoje at\u00e9 futuro&gt;\n</code></pre>","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#jobs-com-erro-ultimos-7-dias","title":"Jobs com Erro (\u00faltimos 7 dias)","text":"<pre><code>Job Name: *\nStatus: Cancelled\nStart Date: &lt;-7 dias at\u00e9 hoje&gt;\n</code></pre>","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#monitorizacao-programatica","title":"\ud83d\udca1 Monitoriza\u00e7\u00e3o Program\u00e1tica","text":"","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#verificar-status-de-job","title":"Verificar Status de Job","text":"<pre><code>REPORT z_check_job_status.\n\nDATA: lv_job_name   TYPE tbtcjob-jobname VALUE 'Z_MY_JOB',\n      lv_job_number TYPE tbtcjob-jobcount VALUE '12345678',\n      lt_jobs       TYPE TABLE OF tbtcjob,\n      ls_job        TYPE tbtcjob.\n\nCALL FUNCTION 'BP_JOB_SELECT'\n  EXPORTING\n    jobname  = lv_job_name\n    jobcount = lv_job_number\n  TABLES\n    joblist  = lt_jobs.\n\nREAD TABLE lt_jobs INTO ls_job INDEX 1.\n\nIF sy-subrc = 0.\n  CASE ls_job-status.\n    WHEN 'S'.  \" Scheduled\n      WRITE: / '\u23f3 Job agendado'.\n    WHEN 'R'.  \" Released/Ready\n      WRITE: / '\ud83d\udfe2 Job liberado'.\n    WHEN 'A'.  \" Active\n      WRITE: / '\u26a1 Job executando'.\n    WHEN 'F'.  \" Finished\n      WRITE: / '\u2705 Job conclu\u00eddo'.\n    WHEN 'X'.  \" Cancelled\n      WRITE: / '\u274c Job cancelado/erro'.\n  ENDCASE.\nENDIF.\n</code></pre>","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#listar-jobs-em-execucao","title":"Listar Jobs em Execu\u00e7\u00e3o","text":"<pre><code>REPORT z_list_active_jobs.\n\nDATA: lt_jobs TYPE TABLE OF tbtcjob,\n      ls_job  TYPE tbtcjob.\n\nCALL FUNCTION 'BP_JOB_SELECT'\n  EXPORTING\n    status_active = 'X'\n  TABLES\n    joblist       = lt_jobs.\n\nLOOP AT lt_jobs INTO ls_job.\n  WRITE: / ls_job-jobname, ls_job-jobcount, ls_job-sdlstrtdt, ls_job-sdlstrttm.\nENDLOOP.\n\nWRITE: / |Total: { lines( lt_jobs ) } jobs ativos|.\n</code></pre>","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#obter-log-de-job","title":"Obter Log de Job","text":"<pre><code>REPORT z_get_job_log.\n\nDATA: lv_job_name   TYPE tbtcjob-jobname VALUE 'Z_MY_JOB',\n      lv_job_number TYPE tbtcjob-jobcount VALUE '12345678',\n      lt_log        TYPE TABLE OF tbtc7,\n      ls_log        TYPE tbtc7.\n\nCALL FUNCTION 'BP_JOBLOG_READ'\n  EXPORTING\n    jobname  = lv_job_name\n    jobcount = lv_job_number\n  TABLES\n    joblog   = lt_log.\n\nLOOP AT lt_log INTO ls_log.\n  WRITE: / ls_log-logtext.  \" Mensagem do log\nENDLOOP.\n</code></pre>","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#cancelar-job-programaticamente","title":"Cancelar Job Programaticamente","text":"<pre><code>REPORT z_cancel_job.\n\nDATA: lv_job_name   TYPE tbtcjob-jobname VALUE 'Z_MY_JOB',\n      lv_job_number TYPE tbtcjob-jobcount VALUE '12345678'.\n\nCALL FUNCTION 'BP_JOB_ABORT'\n  EXPORTING\n    jobname  = lv_job_name\n    jobcount = lv_job_number\n  EXCEPTIONS\n    OTHERS   = 1.\n\nIF sy-subrc = 0.\n  WRITE: / '\u2705 Job cancelado'.\nELSE.\n  WRITE: / '\u274c Erro ao cancelar job'.\nENDIF.\n</code></pre>","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#monitorizacao-automatica","title":"\ud83d\udd14 Monitoriza\u00e7\u00e3o Autom\u00e1tica","text":"","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#criar-monitor-de-jobs-criticos","title":"Criar Monitor de Jobs Cr\u00edticos","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_MONITOR_CRITICAL_JOBS\n*&amp; Verifica jobs cr\u00edticos e envia alerta se houver falhas\n*&amp;---------------------------------------------------------------------*\nREPORT z_monitor_critical_jobs.\n\nTYPES: BEGIN OF ty_critical_job,\n         jobname TYPE tbtcjob-jobname,\n         descr   TYPE char50,\n       END OF ty_critical_job.\n\nDATA: lt_critical TYPE TABLE OF ty_critical_job,\n      ls_critical TYPE ty_critical_job,\n      lt_jobs     TYPE TABLE OF tbtcjob,\n      ls_job      TYPE tbtcjob,\n      lv_has_errors TYPE abap_bool.\n\n\" Definir jobs cr\u00edticos a monitorar\nlt_critical = VALUE #(\n  ( jobname = 'Z_DAILY_BACKUP'    descr = 'Backup Di\u00e1rio' )\n  ( jobname = 'Z_SYNC_CUSTOMERS'  descr = 'Sincroniza\u00e7\u00e3o Clientes' )\n  ( jobname = 'Z_INVOICE_PROCESS' descr = 'Processamento Faturas' )\n).\n\nLOOP AT lt_critical INTO ls_critical.\n\n  CLEAR lt_jobs.\n\n  \" Buscar execu\u00e7\u00f5es das \u00faltimas 24h\n  CALL FUNCTION 'BP_JOB_SELECT'\n    EXPORTING\n      jobname       = ls_critical-jobname\n      from_date     = sy-datum - 1\n      to_date       = sy-datum\n      status_finish = 'X'\n      status_abort  = 'X'\n    TABLES\n      joblist       = lt_jobs.\n\n  \" Verificar se houve falhas\n  READ TABLE lt_jobs TRANSPORTING NO FIELDS\n    WITH KEY status = 'X'.  \" Cancelled\n\n  IF sy-subrc = 0.\n    lv_has_errors = abap_true.\n    WRITE: / |\u274c ERRO: { ls_critical-descr } ({ ls_critical-jobname })|.\n  ELSE.\n    READ TABLE lt_jobs TRANSPORTING NO FIELDS\n      WITH KEY status = 'F'.  \" Finished\n\n    IF sy-subrc = 0.\n      WRITE: / |\u2705 OK: { ls_critical-descr }|.\n    ELSE.\n      WRITE: / |\u26a0\ufe0f AVISO: { ls_critical-descr } n\u00e3o executou nas \u00faltimas 24h|.\n    ENDIF.\n  ENDIF.\n\nENDLOOP.\n\nIF lv_has_errors = abap_true.\n  \" Enviar e-mail de alerta (implementa\u00e7\u00e3o omitida)\n  WRITE: / '\ud83d\udce7 Alerta enviado aos administradores'.\nENDIF.\n</code></pre>","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#analise-de-performance","title":"\ud83d\udcc8 An\u00e1lise de Performance","text":"","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#jobs-mais-longos","title":"Jobs Mais Longos","text":"<pre><code>REPORT z_longest_jobs.\n\nDATA: lt_jobs TYPE TABLE OF tbtcjob,\n      ls_job  TYPE tbtcjob,\n      lv_duration TYPE i.\n\nCALL FUNCTION 'BP_JOB_SELECT'\n  EXPORTING\n    from_date     = sy-datum - 7\n    to_date       = sy-datum\n    status_finish = 'X'\n  TABLES\n    joblist       = lt_jobs.\n\nLOOP AT lt_jobs INTO ls_job.\n\n  \" Calcular dura\u00e7\u00e3o\n  lv_duration = ls_job-enddate - ls_job-sdlstrtdt.\n  lv_duration = lv_duration * 86400 +  \" Dias em segundos\n                ls_job-endtime - ls_job-sdlstrttm.\n\n  WRITE: / ls_job-jobname,\n           ls_job-jobcount,\n           lv_duration, 'segundos'.\n\nENDLOOP.\n\n\" Ordenar por dura\u00e7\u00e3o (implementa\u00e7\u00e3o simplificada)\n</code></pre>","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#boas-praticas","title":"\u26a1 Boas Pr\u00e1ticas","text":"","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Monitorar regularmente jobs cr\u00edticos\n\" Criar job de monitoriza\u00e7\u00e3o que executa a cada hora\n\n\" 2. Analisar logs de jobs com erro\n\" Sempre verificar Job Log em SM37\n\n\" 3. Manter hist\u00f3rico limitado\n\" Configurar reten\u00e7\u00e3o de logs em SM36\n\n\" 4. Alertas autom\u00e1ticos\n\" Implementar notifica\u00e7\u00f5es para falhas cr\u00edticas\n\n\" 5. Documentar jobs importantes\n\" Manter lista de jobs cr\u00edticos e respons\u00e1veis\n</code></pre>","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Ignorar jobs cancelados\n\" \u274c Sempre investigar causas\n\n\" 2. Deletar jobs sem an\u00e1lise\n\" \u274c Verificar log antes de deletar\n\n\" 3. Cancelar jobs sem necessidade\n\" \u274c Pode causar inconsist\u00eancias\n\n\" 4. Sobrecarregar com filtros amplos\n\" \u274c Usar filtros espec\u00edficos em SM37\n\n\" 5. N\u00e3o monitorar jobs peri\u00f3dicos\n\" \u274c Verificar execu\u00e7\u00f5es regulares\n</code></pre>","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#troubleshooting","title":"\ud83d\udd27 Troubleshooting","text":"","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#job-preso-em-ready","title":"Job Preso em \"Ready\"","text":"<p>Causa: Sem servidores background dispon\u00edveis</p> <p>Solu\u00e7\u00e3o: 1. SM50 - Verificar processos ativos 2. SM51 - Verificar servidores dispon\u00edveis 3. RZ04 - Configurar mais processos background 4. Ou aguardar libera\u00e7\u00e3o de recursos</p>","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#job-cancelado-sem-mensagem-clara","title":"Job Cancelado sem Mensagem Clara","text":"<p>Causa: Dump, timeout, ou kill manual</p> <p>Solu\u00e7\u00e3o: 1. SM37 \u2192 Ver Job Log 2. ST22 \u2192 Verificar dumps do usu\u00e1rio do job 3. SM21 \u2192 System Log para eventos do sistema</p>","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#job-nao-inicia-no-horario","title":"Job N\u00e3o Inicia no Hor\u00e1rio","text":"<p>Causa: Scheduled mas n\u00e3o Released</p> <p>Solu\u00e7\u00e3o: <pre><code>1. SM37 \u2192 Selecionar job\n2. Verificar Status (deve ser Released, n\u00e3o Scheduled)\n3. Job \u2192 Release para liberar manualmente\n</code></pre></p>","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/4_monitorizacao/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>Criar Jobs - Criar novos jobs</li> <li>Agendamento - Agendar execu\u00e7\u00f5es</li> <li>Job Logs - An\u00e1lise detalhada de logs</li> </ul> <p>Tags: <code>#SM37</code> <code>#Monitoriza\u00e7\u00e3o</code> <code>#Jobs</code> <code>#Troubleshooting</code></p>","tags":["ABAP","Jobs","SM37","Monitoriza\u00e7\u00e3o"]},{"location":"jobs/5_job_logs/","title":"Job Logs e Troubleshooting","text":"","tags":["ABAP","Jobs","Logs","Debugging","Troubleshooting"]},{"location":"jobs/5_job_logs/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Job Logs registram mensagens, erros e outputs da execu\u00e7\u00e3o de jobs, essenciais para debugging e auditoria.</p>","tags":["ABAP","Jobs","Logs","Debugging","Troubleshooting"]},{"location":"jobs/5_job_logs/#tipos-de-logs","title":"\ud83d\udcc4 Tipos de Logs","text":"","tags":["ABAP","Jobs","Logs","Debugging","Troubleshooting"]},{"location":"jobs/5_job_logs/#1-job-log-protocolo-do-job","title":"1\ufe0f\u20e3 Job Log (Protocolo do Job)","text":"<p>Cont\u00e9m: - \u2705 In\u00edcio e fim do job - \u2705 Programas executados - \u2705 Variantes usadas - \u2705 Mensagens do sistema - \u274c Erros e exce\u00e7\u00f5es</p> <p>Acessar: <pre><code>SM37 \u2192 Selecionar job \u2192 Job Log (F9)\n</code></pre></p>","tags":["ABAP","Jobs","Logs","Debugging","Troubleshooting"]},{"location":"jobs/5_job_logs/#2-spool-output","title":"2\ufe0f\u20e3 Spool Output","text":"<p>Cont\u00e9m: - Outputs de <code>WRITE</code> - Listas geradas - Relat\u00f3rios impressos</p> <p>Acessar: <pre><code>SM37 \u2192 Selecionar job \u2192 Spool list (Shift+F7)\n</code></pre></p>","tags":["ABAP","Jobs","Logs","Debugging","Troubleshooting"]},{"location":"jobs/5_job_logs/#3-application-log","title":"3\ufe0f\u20e3 Application Log","text":"<p>Cont\u00e9m: - Logs customizados via <code>BAL_LOG_*</code> - Estruturado para an\u00e1lise</p> <p>Acessar: <pre><code>SLG1 \u2192 Object e Subobject do job\n</code></pre></p>","tags":["ABAP","Jobs","Logs","Debugging","Troubleshooting"]},{"location":"jobs/5_job_logs/#analisar-job-log","title":"\ud83d\udd0d Analisar Job Log","text":"","tags":["ABAP","Jobs","Logs","Debugging","Troubleshooting"]},{"location":"jobs/5_job_logs/#mensagens-comuns","title":"Mensagens Comuns","text":"Tipo Mensagem Significado \u2705 <code>Job started</code> Job iniciou \u2705 <code>Job finished</code> Job conclu\u00eddo com sucesso \u26a0\ufe0f <code>Job has been released</code> Job liberado para execu\u00e7\u00e3o \u274c <code>Job cancelled after system exception</code> Dump/crash \u274c <code>Timeout during job execution</code> Excedeu tempo m\u00e1ximo \u274c <code>No more storage space</code> Mem\u00f3ria insuficiente","tags":["ABAP","Jobs","Logs","Debugging","Troubleshooting"]},{"location":"jobs/5_job_logs/#exemplo-de-log","title":"Exemplo de Log","text":"<pre><code>14.01.2025 14:30:00 Job started\n14.01.2025 14:30:01 Step 001 started (program Z_PROCESS_ORDERS, variant DAILY)\n14.01.2025 14:32:15 1000 orders processed\n14.01.2025 14:32:15 Step 001 ended\n14.01.2025 14:32:15 Job finished\n</code></pre>","tags":["ABAP","Jobs","Logs","Debugging","Troubleshooting"]},{"location":"jobs/5_job_logs/#ler-logs-programaticamente","title":"\ud83d\udee0\ufe0f Ler Logs Programaticamente","text":"","tags":["ABAP","Jobs","Logs","Debugging","Troubleshooting"]},{"location":"jobs/5_job_logs/#ler-job-log","title":"Ler Job Log","text":"<pre><code>REPORT z_read_job_log.\n\nDATA: lv_job_name   TYPE tbtcjob-jobname VALUE 'Z_MY_JOB',\n      lv_job_number TYPE tbtcjob-jobcount VALUE '12345678',\n      lt_log        TYPE TABLE OF tbtc7,\n      ls_log        TYPE tbtc7.\n\nCALL FUNCTION 'BP_JOBLOG_READ'\n  EXPORTING\n    jobname  = lv_job_name\n    jobcount = lv_job_number\n  TABLES\n    joblog   = lt_log\n  EXCEPTIONS\n    OTHERS   = 1.\n\nIF sy-subrc = 0.\n  LOOP AT lt_log INTO ls_log.\n    WRITE: / |{ ls_log-logdate } { ls_log-logtime } - { ls_log-logtext }|.\n  ENDLOOP.\nELSE.\n  WRITE: / '\u274c Erro ao ler log'.\nENDIF.\n</code></pre>","tags":["ABAP","Jobs","Logs","Debugging","Troubleshooting"]},{"location":"jobs/5_job_logs/#verificar-se-job-teve-erro","title":"Verificar se Job Teve Erro","text":"<pre><code>REPORT z_check_job_errors.\n\nDATA: lv_job_name   TYPE tbtcjob-jobname VALUE 'Z_MY_JOB',\n      lv_job_number TYPE tbtcjob-jobcount VALUE '12345678',\n      lt_log        TYPE TABLE OF tbtc7,\n      ls_log        TYPE tbtc7,\n      lv_has_error  TYPE abap_bool.\n\nCALL FUNCTION 'BP_JOBLOG_READ'\n  EXPORTING\n    jobname = lv_job_name\n    jobcount = lv_job_number\n  TABLES\n    joblog = lt_log.\n\nLOOP AT lt_log INTO ls_log.\n  \" Verificar se cont\u00e9m palavras-chave de erro\n  IF ls_log-logtext CS 'error' OR\n     ls_log-logtext CS 'exception' OR\n     ls_log-logtext CS 'cancelled'.\n    lv_has_error = abap_true.\n    WRITE: / |\u274c ERRO: { ls_log-logtext }|.\n  ENDIF.\nENDLOOP.\n\nIF lv_has_error = abap_false.\n  WRITE: / '\u2705 Job executou sem erros'.\nENDIF.\n</code></pre>","tags":["ABAP","Jobs","Logs","Debugging","Troubleshooting"]},{"location":"jobs/5_job_logs/#application-log-slg1","title":"\ud83d\udce7 Application Log (SLG1)","text":"","tags":["ABAP","Jobs","Logs","Debugging","Troubleshooting"]},{"location":"jobs/5_job_logs/#criar-application-log","title":"Criar Application Log","text":"<pre><code>REPORT z_job_with_applog.\n\nDATA: lv_log_handle TYPE balloghndl,\n      ls_log_header TYPE bal_s_log,\n      ls_msg        TYPE bal_s_msg.\n\nSTART-OF-SELECTION.\n\n  \" Criar cabe\u00e7alho do log\n  ls_log_header-object    = 'ZJOB'.        \" Objeto (criar em SLG0)\n  ls_log_header-subobject = 'ORDERS'.      \" Subobjeto\n  ls_log_header-extnumber = 'Daily Run'.   \" Identificador externo\n\n  CALL FUNCTION 'BAL_LOG_CREATE'\n    EXPORTING\n      i_s_log      = ls_log_header\n    IMPORTING\n      e_log_handle = lv_log_handle.\n\n  \" Processar dados...\n  DATA(lv_count) = 0.\n\n  \" Simular processamento\n  DO 1000 TIMES.\n    lv_count = lv_count + 1.\n  ENDDO.\n\n  \" Adicionar mensagem de sucesso\n  ls_msg-msgty = 'S'.  \" Success\n  ls_msg-msgid = '00'.\n  ls_msg-msgno = '001'.\n  ls_msg-msgv1 = |{ lv_count } ordens processadas|.\n\n  CALL FUNCTION 'BAL_LOG_MSG_ADD'\n    EXPORTING\n      i_log_handle = lv_log_handle\n      i_s_msg      = ls_msg.\n\n  \" Salvar log no banco\n  CALL FUNCTION 'BAL_DB_SAVE'\n    EXPORTING\n      i_log_handle = lv_log_handle.\n\n  COMMIT WORK.\n\n  WRITE: / '\u2705 Log salvo - Ver em SLG1'.\n</code></pre>","tags":["ABAP","Jobs","Logs","Debugging","Troubleshooting"]},{"location":"jobs/5_job_logs/#ler-application-log","title":"Ler Application Log","text":"<pre><code>REPORT z_read_application_log.\n\nDATA: lt_log_header TYPE TABLE OF balhdr,\n      ls_log_header TYPE balhdr,\n      lv_log_handle TYPE balloghndl,\n      lt_messages   TYPE TABLE OF bal_s_msg,\n      ls_message    TYPE bal_s_msg.\n\n\" Buscar logs do objeto ZJOB\nCALL FUNCTION 'BAL_DB_SEARCH'\n  EXPORTING\n    i_s_log_filter = VALUE balhdr( object = 'ZJOB' )\n  IMPORTING\n    e_t_log_header = lt_log_header.\n\nLOOP AT lt_log_header INTO ls_log_header.\n\n  \" Carregar log\n  CALL FUNCTION 'BAL_DB_LOAD'\n    EXPORTING\n      i_log_handle = ls_log_header-log_handle.\n\n  \" Ler mensagens\n  CALL FUNCTION 'BAL_LOG_MSG_READ'\n    EXPORTING\n      i_log_handle = ls_log_header-log_handle\n    IMPORTING\n      e_t_msg      = lt_messages.\n\n  WRITE: / |Log: { ls_log_header-extnumber }|.\n\n  LOOP AT lt_messages INTO ls_message.\n    WRITE: / |  { ls_message-msgty } - { ls_message-msgv1 }|.\n  ENDLOOP.\n\nENDLOOP.\n</code></pre>","tags":["ABAP","Jobs","Logs","Debugging","Troubleshooting"]},{"location":"jobs/5_job_logs/#debugging-de-jobs","title":"\ud83d\udc1b Debugging de Jobs","text":"","tags":["ABAP","Jobs","Logs","Debugging","Troubleshooting"]},{"location":"jobs/5_job_logs/#problema-job-com-erro","title":"Problema: Job com Erro","text":"<p>Passos:</p> <ol> <li> <p>SM37 \u2192 Ver Job Log <pre><code>- Identificar mensagem de erro\n- Ver timestamp do erro\n</code></pre></p> </li> <li> <p>ST22 \u2192 Verificar Dumps <pre><code>- Filtrar por usu\u00e1rio do job\n- Verificar data/hora do dump\n</code></pre></p> </li> <li> <p>Re-executar em Foreground <pre><code>\" Executar programa diretamente (n\u00e3o via job)\n\" Usar mesma variante\n\" Debugar (breakpoints)\n</code></pre></p> </li> </ol>","tags":["ABAP","Jobs","Logs","Debugging","Troubleshooting"]},{"location":"jobs/5_job_logs/#problema-job-lento","title":"Problema: Job Lento","text":"<p>Passos:</p> <ol> <li> <p>SM37 \u2192 Ver Spool Output <pre><code>- Verificar quantidade de dados processados\n</code></pre></p> </li> <li> <p>ST12 \u2192 Single Transaction Analysis <pre><code>- Analisar performance de SELECT\n- Identificar gargalos\n</code></pre></p> </li> <li> <p>Otimizar c\u00f3digo: <pre><code>\" Antes (lento)\nLOOP AT lt_orders INTO ls_order.\n  SELECT SINGLE * FROM kna1 WHERE kunnr = ls_order-kunnr.\n  \" ...\nENDLOOP.\n\n\" Depois (r\u00e1pido)\nSELECT * FROM kna1\n  FOR ALL ENTRIES IN lt_orders\n  WHERE kunnr = lt_orders-kunnr\n  INTO TABLE lt_customers.\n</code></pre></p> </li> </ol>","tags":["ABAP","Jobs","Logs","Debugging","Troubleshooting"]},{"location":"jobs/5_job_logs/#exemplos-praticos","title":"\ud83d\udca1 Exemplos Pr\u00e1ticos","text":"","tags":["ABAP","Jobs","Logs","Debugging","Troubleshooting"]},{"location":"jobs/5_job_logs/#exemplo-1-job-com-log-detalhado","title":"Exemplo 1: Job com Log Detalhado","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_JOB_WITH_DETAILED_LOG\n*&amp;---------------------------------------------------------------------*\nREPORT z_job_with_detailed_log.\n\nDATA: lv_log_handle TYPE balloghndl,\n      lt_orders     TYPE TABLE OF vbak,\n      ls_order      TYPE vbak,\n      lv_success    TYPE i,\n      lv_errors     TYPE i.\n\nSTART-OF-SELECTION.\n\n  \" Criar log\n  PERFORM create_app_log CHANGING lv_log_handle.\n\n  \" Processar dados\n  SELECT * FROM vbak UP TO 100 ROWS INTO TABLE lt_orders.\n\n  LOOP AT lt_orders INTO ls_order.\n\n    TRY.\n        \" Simular processamento\n        IF ls_order-vbeln IS NOT INITIAL.\n          lv_success = lv_success + 1.\n          PERFORM log_message USING lv_log_handle 'S'\n            |Ordem { ls_order-vbeln } processada|.\n        ENDIF.\n\n      CATCH cx_root INTO DATA(lx_error).\n        lv_errors = lv_errors + 1.\n        PERFORM log_message USING lv_log_handle 'E'\n          |Erro ordem { ls_order-vbeln }: { lx_error-&gt;get_text( ) }|.\n    ENDTRY.\n\n  ENDLOOP.\n\n  \" Log final\n  PERFORM log_message USING lv_log_handle 'I'\n    |Total: { lines( lt_orders ) } | Sucesso: { lv_success } | Erros: { lv_errors }|.\n\n  \" Salvar log\n  PERFORM save_app_log USING lv_log_handle.\n\n  WRITE: / '\u2705 Processamento conclu\u00eddo - Ver log em SLG1'.\n\n*&amp;---------------------------------------------------------------------*\nFORM create_app_log CHANGING cv_log_handle TYPE balloghndl.\n  DATA: ls_log TYPE bal_s_log.\n\n  ls_log-object    = 'ZJOB'.\n  ls_log-subobject = 'ORDERS'.\n  ls_log-extnumber = |Run { sy-datum } { sy-uzeit }|.\n\n  CALL FUNCTION 'BAL_LOG_CREATE'\n    EXPORTING i_s_log = ls_log\n    IMPORTING e_log_handle = cv_log_handle.\nENDFORM.\n\n*&amp;---------------------------------------------------------------------*\nFORM log_message USING iv_log_handle TYPE balloghndl\n                       iv_type        TYPE bapi_mtype\n                       iv_message     TYPE string.\n  DATA: ls_msg TYPE bal_s_msg.\n\n  ls_msg-msgty = iv_type.\n  ls_msg-msgid = '00'.\n  ls_msg-msgno = '001'.\n  ls_msg-msgv1 = iv_message.\n\n  CALL FUNCTION 'BAL_LOG_MSG_ADD'\n    EXPORTING\n      i_log_handle = iv_log_handle\n      i_s_msg      = ls_msg.\nENDFORM.\n\n*&amp;---------------------------------------------------------------------*\nFORM save_app_log USING iv_log_handle TYPE balloghndl.\n  CALL FUNCTION 'BAL_DB_SAVE'\n    EXPORTING i_log_handle = iv_log_handle.\n  COMMIT WORK.\nENDFORM.\n</code></pre>","tags":["ABAP","Jobs","Logs","Debugging","Troubleshooting"]},{"location":"jobs/5_job_logs/#exemplo-2-monitor-de-erros-em-jobs","title":"Exemplo 2: Monitor de Erros em Jobs","text":"<pre><code>REPORT z_monitor_job_errors.\n\nTYPES: BEGIN OF ty_error,\n         jobname  TYPE tbtcjob-jobname,\n         jobcount TYPE tbtcjob-jobcount,\n         sdlstrtdt TYPE tbtcjob-sdlstrtdt,\n         error    TYPE string,\n       END OF ty_error.\n\nDATA: lt_jobs   TYPE TABLE OF tbtcjob,\n      ls_job    TYPE tbtcjob,\n      lt_log    TYPE TABLE OF tbtc7,\n      ls_log    TYPE tbtc7,\n      lt_errors TYPE TABLE OF ty_error,\n      ls_error  TYPE ty_error.\n\n\" Buscar jobs cancelados das \u00faltimas 24h\nCALL FUNCTION 'BP_JOB_SELECT'\n  EXPORTING\n    from_date     = sy-datum - 1\n    to_date       = sy-datum\n    status_abort  = 'X'\n  TABLES\n    joblist       = lt_jobs.\n\nLOOP AT lt_jobs INTO ls_job.\n\n  \" Ler log do job\n  CALL FUNCTION 'BP_JOBLOG_READ'\n    EXPORTING\n      jobname = ls_job-jobname\n      jobcount = ls_job-jobcount\n    TABLES\n      joblog = lt_log.\n\n  \" Buscar mensagens de erro\n  LOOP AT lt_log INTO ls_log.\n    IF ls_log-logtext CS 'error' OR ls_log-logtext CS 'exception'.\n      ls_error-jobname   = ls_job-jobname.\n      ls_error-jobcount  = ls_job-jobcount.\n      ls_error-sdlstrtdt = ls_job-sdlstrtdt.\n      ls_error-error     = ls_log-logtext.\n      APPEND ls_error TO lt_errors.\n      EXIT.  \" Primeiro erro apenas\n    ENDIF.\n  ENDLOOP.\n\nENDLOOP.\n\n\" Exibir erros\nIF lt_errors IS NOT INITIAL.\n  WRITE: / '\u274c Jobs com erro nas \u00faltimas 24h:'.\n  WRITE: / ''.\n\n  LOOP AT lt_errors INTO ls_error.\n    WRITE: / |Job: { ls_error-jobname } ({ ls_error-jobcount })|.\n    WRITE: / |Data: { ls_error-sdlstrtdt }|.\n    WRITE: / |Erro: { ls_error-error }|.\n    WRITE: / '---------------------------------------------------------'.\n  ENDLOOP.\nELSE.\n  WRITE: / '\u2705 Nenhum job com erro nas \u00faltimas 24h'.\nENDIF.\n</code></pre>","tags":["ABAP","Jobs","Logs","Debugging","Troubleshooting"]},{"location":"jobs/5_job_logs/#boas-praticas","title":"\u26a1 Boas Pr\u00e1ticas","text":"","tags":["ABAP","Jobs","Logs","Debugging","Troubleshooting"]},{"location":"jobs/5_job_logs/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Sempre logar eventos importantes\nPERFORM log_message USING lv_log_handle 'I'\n  |{ lv_count } registros processados|.\n\n\" 2. Logar erros com contexto\nCATCH cx_root INTO DATA(lx_err).\n  PERFORM log_message USING lv_log_handle 'E'\n    |Erro ao processar { ls_data-key }: { lx_err-&gt;get_text( ) }|.\n\n\" 3. Usar Application Log para jobs complexos\n\" Estruturado, query f\u00e1cil em SLG1\n\n\" 4. Incluir estat\u00edsticas finais\nWRITE: / |Total: { lv_total } | OK: { lv_ok } | Erros: { lv_errors }|.\n\n\" 5. Manter logs por per\u00edodo limitado\n\" Configurar reten\u00e7\u00e3o em SLG2\n</code></pre>","tags":["ABAP","Jobs","Logs","Debugging","Troubleshooting"]},{"location":"jobs/5_job_logs/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Jobs sem logging\n\" \u274c Imposs\u00edvel troubleshooting\n\n\" 2. Mensagens gen\u00e9ricas\nWRITE: / 'Erro'.  \" \u274c Sem contexto\n\n\" 3. Logar tudo em WRITE\n\" \u274c Dificulta an\u00e1lise program\u00e1tica\n\" \u2705 Usar Application Log\n\n\" 4. Ignorar warnings\n\" \u26a0\ufe0f Podem indicar problemas futuros\n\n\" 5. N\u00e3o limpar logs antigos\n\" \u274c Degrada performance do banco\n</code></pre>","tags":["ABAP","Jobs","Logs","Debugging","Troubleshooting"]},{"location":"jobs/5_job_logs/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>Criar Jobs - Implementar logging desde cria\u00e7\u00e3o</li> <li>Monitoriza\u00e7\u00e3o - Verificar status em SM37</li> <li>Batch Processing - Logs em processamento batch</li> </ul> <p>Tags: <code>#Logs</code> <code>#Debugging</code> <code>#Troubleshooting</code> <code>#SLG1</code> <code>#ApplicationLog</code></p>","tags":["ABAP","Jobs","Logs","Debugging","Troubleshooting"]},{"location":"jobs/6_batch_processing/","title":"Processamento Batch (Batch Input)","text":"","tags":["ABAP","Batch Processing","Batch Input","CALL TRANSACTION","BDC"]},{"location":"jobs/6_batch_processing/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Batch Input (BDC) permite automatizar transa\u00e7\u00f5es SAP para processar grandes volumes de dados, simulando entrada manual de usu\u00e1rio.</p>","tags":["ABAP","Batch Processing","Batch Input","CALL TRANSACTION","BDC"]},{"location":"jobs/6_batch_processing/#quando-usar","title":"\ud83c\udfaf Quando Usar","text":"Cen\u00e1rio Solu\u00e7\u00e3o Migra\u00e7\u00e3o de dados legados \u2705 Batch Input Carga inicial de mestres \u2705 Batch Input Processamento di\u00e1rio autom\u00e1tico \u2705 Batch Input Atualiza\u00e7\u00e3o em massa \u2705 Batch Input Transa\u00e7\u00e3o sem BAPI/FM \u2705 Batch Input","tags":["ABAP","Batch Processing","Batch Input","CALL TRANSACTION","BDC"]},{"location":"jobs/6_batch_processing/#metodos-de-batch-input","title":"\ud83d\udd27 M\u00e9todos de Batch Input","text":"","tags":["ABAP","Batch Processing","Batch Input","CALL TRANSACTION","BDC"]},{"location":"jobs/6_batch_processing/#1-call-transaction","title":"1\ufe0f\u20e3 CALL TRANSACTION","text":"<p>R\u00e1pido, executa transa\u00e7\u00e3o diretamente com dados.</p> <p>Vantagens: - \u2705 R\u00e1pido - \u2705 Feedback imediato - \u2705 Permite commit/rollback por registro</p> <p>Desvantagens: - \u274c Sem log autom\u00e1tico detalhado - \u274c Precisa tratar erros manualmente</p>","tags":["ABAP","Batch Processing","Batch Input","CALL TRANSACTION","BDC"]},{"location":"jobs/6_batch_processing/#2-session-method-sm35","title":"2\ufe0f\u20e3 Session Method (SM35)","text":"<p>Cria sess\u00e3o para processar depois em background.</p> <p>Vantagens: - \u2705 Log completo em SM35 - \u2705 Permite reprocessamento - \u2705 Processar grande volume</p> <p>Desvantagens: - \u274c Mais lento - \u274c Processamento ass\u00edncrono</p>","tags":["ABAP","Batch Processing","Batch Input","CALL TRANSACTION","BDC"]},{"location":"jobs/6_batch_processing/#call-transaction","title":"\ud83d\udca1 CALL TRANSACTION","text":"","tags":["ABAP","Batch Processing","Batch Input","CALL TRANSACTION","BDC"]},{"location":"jobs/6_batch_processing/#estrutura-basica","title":"Estrutura B\u00e1sica","text":"<pre><code>DATA: lt_bdcdata TYPE TABLE OF bdcdata,\n      ls_bdcdata TYPE bdcdata,\n      lt_messages TYPE TABLE OF bdcmsgcoll,\n      ls_message TYPE bdcmsgcoll.\n\n\" Preencher BDC data\nPERFORM bdc_dynpro   USING 'SAPMF02D' '0100'.\nPERFORM bdc_field    USING 'RF02D-KUNNR' '1000'.\nPERFORM bdc_field    USING 'RF02D-D0110' 'X'.\n\" ... mais campos\n\n\" Executar transa\u00e7\u00e3o\nCALL TRANSACTION 'XD02'\n  USING lt_bdcdata\n  MODE 'N'  \" N=sem tela, A=todas, E=s\u00f3 erros\n  UPDATE 'S'  \" S=s\u00edncrono, A=ass\u00edncrono\n  MESSAGES INTO lt_messages.\n\n\" Verificar mensagens\nLOOP AT lt_messages INTO ls_message.\n  IF ls_message-msgtyp = 'E' OR ls_message-msgtyp = 'A'.\n    \" Erro\n  ENDIF.\nENDLOOP.\n</code></pre>","tags":["ABAP","Batch Processing","Batch Input","CALL TRANSACTION","BDC"]},{"location":"jobs/6_batch_processing/#funcoes-auxiliares","title":"Fun\u00e7\u00f5es Auxiliares","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Form BDC_DYNPRO\n*&amp;---------------------------------------------------------------------*\nFORM bdc_dynpro USING program TYPE bdcdata-program\n                      dynpro  TYPE bdcdata-dynpro.\n\n  CLEAR ls_bdcdata.\n  ls_bdcdata-program  = program.\n  ls_bdcdata-dynpro   = dynpro.\n  ls_bdcdata-dynbegin = 'X'.\n  APPEND ls_bdcdata TO lt_bdcdata.\n\nENDFORM.\n\n*&amp;---------------------------------------------------------------------*\n*&amp; Form BDC_FIELD\n*&amp;---------------------------------------------------------------------*\nFORM bdc_field USING fnam TYPE bdcdata-fnam\n                     fval TYPE bdcdata-fval.\n\n  CLEAR ls_bdcdata.\n  ls_bdcdata-fnam = fnam.\n  ls_bdcdata-fval = fval.\n  APPEND ls_bdcdata TO lt_bdcdata.\n\nENDFORM.\n</code></pre>","tags":["ABAP","Batch Processing","Batch Input","CALL TRANSACTION","BDC"]},{"location":"jobs/6_batch_processing/#exemplo-completo-criar-cliente-xd01","title":"Exemplo Completo: Criar Cliente (XD01)","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_BDC_CREATE_CUSTOMER\n*&amp;---------------------------------------------------------------------*\nREPORT z_bdc_create_customer.\n\nDATA: lt_bdcdata  TYPE TABLE OF bdcdata,\n      ls_bdcdata  TYPE bdcdata,\n      lt_messages TYPE TABLE OF bdcmsgcoll,\n      ls_message  TYPE bdcmsgcoll.\n\nPARAMETERS: p_kunnr TYPE kunnr,\n            p_bukrs TYPE bukrs,\n            p_name1 TYPE name1_gp,\n            p_land1 TYPE land1_gp,\n            p_ort01 TYPE ort01_gp.\n\nSTART-OF-SELECTION.\n\n  \" \u2550\u2550\u2550 Tela Inicial \u2550\u2550\u2550\n  PERFORM bdc_dynpro USING 'SAPMF02D' '0100'.\n  PERFORM bdc_field  USING 'BDC_CURSOR' 'RF02D-KUNNR'.\n  PERFORM bdc_field  USING 'BDC_OKCODE' '/00'.\n  PERFORM bdc_field  USING 'RF02D-KUNNR' p_kunnr.\n  PERFORM bdc_field  USING 'RF02D-BUKRS' p_bukrs.\n  PERFORM bdc_field  USING 'RF02D-D0110' 'X'.  \" Dados gerais\n\n  \" \u2550\u2550\u2550 Dados Gerais \u2550\u2550\u2550\n  PERFORM bdc_dynpro USING 'SAPMF02D' '0110'.\n  PERFORM bdc_field  USING 'BDC_CURSOR' 'KNA1-NAME1'.\n  PERFORM bdc_field  USING 'BDC_OKCODE' '/00'.\n  PERFORM bdc_field  USING 'KNA1-NAME1' p_name1.\n  PERFORM bdc_field  USING 'KNA1-LAND1' p_land1.\n  PERFORM bdc_field  USING 'KNA1-ORT01' p_ort01.\n\n  \" \u2550\u2550\u2550 Salvar \u2550\u2550\u2550\n  PERFORM bdc_dynpro USING 'SAPMF02D' '0110'.\n  PERFORM bdc_field  USING 'BDC_OKCODE' '=BU'.\n\n  \" \u2550\u2550\u2550 Executar Transa\u00e7\u00e3o \u2550\u2550\u2550\n  CALL TRANSACTION 'XD01'\n    USING lt_bdcdata\n    MODE 'N'\n    UPDATE 'S'\n    MESSAGES INTO lt_messages.\n\n  \" \u2550\u2550\u2550 Verificar Resultado \u2550\u2550\u2550\n  READ TABLE lt_messages INTO ls_message\n    WITH KEY msgtyp = 'S'.\n\n  IF sy-subrc = 0.\n    WRITE: / |\u2705 Cliente { p_kunnr } criado com sucesso|.\n  ELSE.\n    WRITE: / '\u274c Erro ao criar cliente:'.\n    LOOP AT lt_messages INTO ls_message\n      WHERE msgtyp = 'E' OR msgtyp = 'A'.\n\n      MESSAGE ID ls_message-msgid\n              TYPE ls_message-msgtyp\n              NUMBER ls_message-msgnr\n              INTO DATA(lv_msg)\n              WITH ls_message-msgv1\n                   ls_message-msgv2\n                   ls_message-msgv3\n                   ls_message-msgv4.\n\n      WRITE: / lv_msg.\n    ENDLOOP.\n  ENDIF.\n\n*&amp;---------------------------------------------------------------------*\n*&amp; Forms (BDC_DYNPRO e BDC_FIELD como acima)\n*&amp;---------------------------------------------------------------------*\nFORM bdc_dynpro USING program TYPE bdcdata-program\n                      dynpro  TYPE bdcdata-dynpro.\n  CLEAR ls_bdcdata.\n  ls_bdcdata-program  = program.\n  ls_bdcdata-dynpro   = dynpro.\n  ls_bdcdata-dynbegin = 'X'.\n  APPEND ls_bdcdata TO lt_bdcdata.\nENDFORM.\n\nFORM bdc_field USING fnam TYPE bdcdata-fnam\n                     fval TYPE bdcdata-fval.\n  CLEAR ls_bdcdata.\n  ls_bdcdata-fnam = fnam.\n  ls_bdcdata-fval = fval.\n  APPEND ls_bdcdata TO lt_bdcdata.\nENDFORM.\n</code></pre>","tags":["ABAP","Batch Processing","Batch Input","CALL TRANSACTION","BDC"]},{"location":"jobs/6_batch_processing/#session-method-sm35","title":"\ud83d\udce6 Session Method (SM35)","text":"","tags":["ABAP","Batch Processing","Batch Input","CALL TRANSACTION","BDC"]},{"location":"jobs/6_batch_processing/#criar-sessao-bdc","title":"Criar Sess\u00e3o BDC","text":"<pre><code>REPORT z_bdc_session_create.\n\nDATA: lv_session_name TYPE apqi-groupid VALUE 'Z_CUSTOMER_UPLOAD',\n      lt_bdcdata      TYPE TABLE OF bdcdata,\n      ls_bdcdata      TYPE bdcdata.\n\nSTART-OF-SELECTION.\n\n  \" \u2550\u2550\u2550 Abrir Sess\u00e3o \u2550\u2550\u2550\n  CALL FUNCTION 'BDC_OPEN_GROUP'\n    EXPORTING\n      client = sy-mandt\n      group  = lv_session_name\n      user   = sy-uname\n      keep   = 'X'.  \" Manter sess\u00e3o ap\u00f3s processamento\n\n  \" \u2550\u2550\u2550 Loop pelos dados (ex: tabela interna) \u2550\u2550\u2550\n  DATA: lt_customers TYPE TABLE OF ty_customer.\n\n  \" Simular dados\n  lt_customers = VALUE #(\n    ( kunnr = '1001' name1 = 'Cliente A' land1 = 'BR' ort01 = 'S\u00e3o Paulo' )\n    ( kunnr = '1002' name1 = 'Cliente B' land1 = 'BR' ort01 = 'Rio de Janeiro' )\n  ).\n\n  LOOP AT lt_customers INTO DATA(ls_customer).\n\n    REFRESH lt_bdcdata.\n\n    \" Preencher BDC (similar ao exemplo CALL TRANSACTION)\n    PERFORM bdc_dynpro USING 'SAPMF02D' '0100'.\n    PERFORM bdc_field  USING 'RF02D-KUNNR' ls_customer-kunnr.\n    \" ... mais campos\n\n    \" Inserir na sess\u00e3o\n    CALL FUNCTION 'BDC_INSERT'\n      EXPORTING\n        tcode = 'XD01'\n      TABLES\n        dynprotab = lt_bdcdata.\n\n  ENDLOOP.\n\n  \" \u2550\u2550\u2550 Fechar Sess\u00e3o \u2550\u2550\u2550\n  CALL FUNCTION 'BDC_CLOSE_GROUP'.\n\n  WRITE: / |\u2705 Sess\u00e3o { lv_session_name } criada|.\n  WRITE: / 'Processar em SM35'.\n</code></pre>","tags":["ABAP","Batch Processing","Batch Input","CALL TRANSACTION","BDC"]},{"location":"jobs/6_batch_processing/#processar-sessao-programaticamente","title":"Processar Sess\u00e3o Programaticamente","text":"<pre><code>REPORT z_bdc_process_session.\n\nDATA: lv_session_name TYPE apqi-groupid VALUE 'Z_CUSTOMER_UPLOAD'.\n\nSTART-OF-SELECTION.\n\n  CALL FUNCTION 'BDC_PROCESS'\n    EXPORTING\n      group   = lv_session_name\n      mode    = 'N'  \" Sem tela\n      update  = 'S'  \" S\u00edncrono\n      ctumode = 'P'  \" Process\n    EXCEPTIONS\n      OTHERS  = 1.\n\n  IF sy-subrc = 0.\n    WRITE: / '\u2705 Sess\u00e3o processada'.\n  ELSE.\n    WRITE: / '\u274c Erro ao processar sess\u00e3o'.\n  ENDIF.\n</code></pre>","tags":["ABAP","Batch Processing","Batch Input","CALL TRANSACTION","BDC"]},{"location":"jobs/6_batch_processing/#gravar-transacao-shdb","title":"\ud83d\udee0\ufe0f Gravar Transa\u00e7\u00e3o (SHDB)","text":"<p>SHDB permite gravar uma transa\u00e7\u00e3o para gerar c\u00f3digo BDC automaticamente.</p> <p>Passos:</p> <ol> <li>Executar SHDB</li> <li>New Recording</li> <li>Transaction Code: (ex: XD01)</li> <li>Recording Name: Z_XD01_RECORDING</li> <li>Executar transa\u00e7\u00e3o normalmente (preencher campos)</li> <li>Salvar</li> <li>Program \u2192 Generate Program \u2192 C\u00f3digo BDC gerado!</li> </ol>","tags":["ABAP","Batch Processing","Batch Input","CALL TRANSACTION","BDC"]},{"location":"jobs/6_batch_processing/#processamento-em-background","title":"\ud83d\udca1 Processamento em Background","text":"","tags":["ABAP","Batch Processing","Batch Input","CALL TRANSACTION","BDC"]},{"location":"jobs/6_batch_processing/#job-com-batch-input","title":"Job com Batch Input","text":"<pre><code>REPORT z_job_batch_input.\n\nDATA: lv_job_name   TYPE tbtcjob-jobname VALUE 'Z_BDC_CUSTOMERS',\n      lv_job_number TYPE tbtcjob-jobcount.\n\nSTART-OF-SELECTION.\n\n  \" Criar job\n  CALL FUNCTION 'JOB_OPEN'\n    EXPORTING\n      jobname  = lv_job_name\n    IMPORTING\n      jobcount = lv_job_number.\n\n  \" Executar programa BDC\n  SUBMIT z_bdc_create_customers\n    VIA JOB lv_job_name NUMBER lv_job_number\n    WITH s_file = '/data/customers.txt'  \" Par\u00e2metro de arquivo\n    AND RETURN.\n\n  \" Agendar imediatamente\n  CALL FUNCTION 'JOB_CLOSE'\n    EXPORTING\n      jobcount  = lv_job_number\n      jobname   = lv_job_name\n      strtimmed = 'X'.\n\n  WRITE: / |\u2705 Job { lv_job_number } agendado|.\n</code></pre>","tags":["ABAP","Batch Processing","Batch Input","CALL TRANSACTION","BDC"]},{"location":"jobs/6_batch_processing/#boas-praticas","title":"\u26a1 Boas Pr\u00e1ticas","text":"","tags":["ABAP","Batch Processing","Batch Input","CALL TRANSACTION","BDC"]},{"location":"jobs/6_batch_processing/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Sempre verificar mensagens\nLOOP AT lt_messages INTO ls_message\n  WHERE msgtyp = 'E' OR msgtyp = 'A' OR msgtyp = 'W'.\n  \" Processar erro\nENDLOOP.\n\n\" 2. Usar MODE 'N' em produ\u00e7\u00e3o\nMODE 'N'  \" \u2705 Sem tela, mais r\u00e1pido\n\n\" 3. Commit por pacote (n\u00e3o todos de uma vez)\nIF lv_counter MOD 100 = 0.\n  COMMIT WORK.\nENDIF.\n\n\" 4. Logar erros detalhadamente\nIF ls_message-msgtyp = 'E'.\n  WRITE: / |Erro cliente { ls_customer-kunnr }: { lv_msg }|.\nENDIF.\n\n\" 5. Usar Session Method para grande volume\n\" Permite reprocessamento em caso de erro\n</code></pre>","tags":["ABAP","Batch Processing","Batch Input","CALL TRANSACTION","BDC"]},{"location":"jobs/6_batch_processing/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. MODE 'A' em produ\u00e7\u00e3o\nMODE 'A'  \" \u274c Exibe todas as telas, muito lento\n\n\" 2. Ignorar mensagens de warning\n\" \u26a0\ufe0f Podem indicar problemas\n\n\" 3. Processar tudo em foreground\n\" \u274c Trava interface\n\" \u2705 Usar jobs em background\n\n\" 4. BDC sem tratamento de erro\nCALL TRANSACTION 'XD01' USING lt_bdcdata.\n\" \u274c Sem MESSAGES INTO, imposs\u00edvel saber se funcionou\n\n\" 5. N\u00e3o testar com MODE 'A' antes\n\" \u2705 Testar com tela vis\u00edvel primeiro\n</code></pre>","tags":["ABAP","Batch Processing","Batch Input","CALL TRANSACTION","BDC"]},{"location":"jobs/6_batch_processing/#troubleshooting","title":"\ud83d\udd27 Troubleshooting","text":"","tags":["ABAP","Batch Processing","Batch Input","CALL TRANSACTION","BDC"]},{"location":"jobs/6_batch_processing/#bdc-nao-funciona","title":"BDC N\u00e3o Funciona","text":"<p>Causa: Campos ou telas mudaram</p> <p>Solu\u00e7\u00e3o: 1. Executar SHDB novamente 2. Re-gravar transa\u00e7\u00e3o 3. Comparar c\u00f3digo antigo com novo</p>","tags":["ABAP","Batch Processing","Batch Input","CALL TRANSACTION","BDC"]},{"location":"jobs/6_batch_processing/#mensagens-de-erro-genericas","title":"Mensagens de Erro Gen\u00e9ricas","text":"<p>Causa: Campos obrigat\u00f3rios faltando</p> <p>Solu\u00e7\u00e3o: <pre><code>\" Executar com MODE 'E' (mostra s\u00f3 telas com erro)\nMODE 'E'\n</code></pre></p>","tags":["ABAP","Batch Processing","Batch Input","CALL TRANSACTION","BDC"]},{"location":"jobs/6_batch_processing/#performance-ruim","title":"Performance Ruim","text":"<p>Causa: Muitas transa\u00e7\u00f5es em sequ\u00eancia</p> <p>Solu\u00e7\u00e3o: <pre><code>\" Processar em pacotes\nDATA: lv_counter TYPE i.\n\nLOOP AT lt_customers INTO ls_customer.\n\n  lv_counter = lv_counter + 1.\n\n  \" ... BDC ...\n\n  \" Commit a cada 100\n  IF lv_counter MOD 100 = 0.\n    COMMIT WORK.\n    WAIT UP TO 1 SECONDS.  \" Respiro para o sistema\n  ENDIF.\n\nENDLOOP.\n</code></pre></p>","tags":["ABAP","Batch Processing","Batch Input","CALL TRANSACTION","BDC"]},{"location":"jobs/6_batch_processing/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>Criar Jobs - Executar BDC via jobs</li> <li>Agendamento - Agendar processamentos batch</li> <li>Job Logs - Logar resultados de BDC</li> </ul> <p>Tags: <code>#BatchInput</code> <code>#BDC</code> <code>#CALL_TRANSACTION</code> <code>#SM35</code> <code>#SHDB</code> <code>#DataMigration</code></p>","tags":["ABAP","Batch Processing","Batch Input","CALL TRANSACTION","BDC"]},{"location":"meus_programas/","title":"\ud83d\udcc2 Meus Programas","text":"<p>Bem-vindo \u00e0 sec\u00e7\u00e3o de programas e projetos pr\u00e1ticos! Aqui documentas os teus desenvolvimentos ABAP, desde relat\u00f3rios simples at\u00e9 integra\u00e7\u00f5es complexas.</p>","tags":["ABAP","Programas","Portfolio"]},{"location":"meus_programas/#o-que-encontras-aqui","title":"\ud83c\udfaf O Que Encontras Aqui?","text":"<p>Esta \u00e1rea serve como:</p> <ul> <li>Portfolio de projetos ABAP</li> <li>Refer\u00eancia r\u00e1pida para padr\u00f5es que usas</li> <li>Documenta\u00e7\u00e3o de solu\u00e7\u00f5es customizadas</li> <li>Biblioteca de snippets testados</li> </ul>","tags":["ABAP","Programas","Portfolio"]},{"location":"meus_programas/#categorias-sugeridas","title":"\ud83d\udccb Categorias Sugeridas","text":"<p>Podes criar p\u00e1ginas conforme fores desenvolvendo no trabalho:</p>","tags":["ABAP","Programas","Portfolio"]},{"location":"meus_programas/#relatorios","title":"Relat\u00f3rios","text":"<p>Reports cl\u00e1ssicos, ALVs, extraction programs.</p>","tags":["ABAP","Programas","Portfolio"]},{"location":"meus_programas/#interfaces","title":"Interfaces","text":"<p>Integra\u00e7\u00f5es inbound/outbound, IDocs, RFCs, APIs.</p>","tags":["ABAP","Programas","Portfolio"]},{"location":"meus_programas/#conversoes","title":"Convers\u00f5es","text":"<p>Programas de migra\u00e7\u00e3o de dados, LSMW, BDC.</p>","tags":["ABAP","Programas","Portfolio"]},{"location":"meus_programas/#user-exits-badis","title":"User-Exits &amp; BADIs","text":"<p>Enhancements, BADIs, User-Exits em processos standard.</p>","tags":["ABAP","Programas","Portfolio"]},{"location":"meus_programas/#bapis","title":"BAPIs","text":"<p>Chamadas a BAPIs standard e custom wrappers.</p>","tags":["ABAP","Programas","Portfolio"]},{"location":"meus_programas/#smartforms-adobe-forms","title":"Smartforms &amp; Adobe Forms","text":"<p>Formul\u00e1rios para impress\u00e3o (notas fiscais, pedidos, faturas).</p>","tags":["ABAP","Programas","Portfolio"]},{"location":"meus_programas/#workflows","title":"Workflows","text":"<p>Processos de aprova\u00e7\u00e3o e automa\u00e7\u00e3o.</p>","tags":["ABAP","Programas","Portfolio"]},{"location":"meus_programas/#classes-utilitarias","title":"Classes Utilit\u00e1rias","text":"<p>Helpers, wrappers, bibliotecas reutiliz\u00e1veis</p>","tags":["ABAP","Programas","Portfolio"]},{"location":"meus_programas/#como-usar-esta-seccao","title":"\ud83d\ude80 Como Usar Esta Sec\u00e7\u00e3o","text":"<ol> <li>Documenta cada projeto numa das categorias acima</li> <li>Adiciona c\u00f3digo-fonte ou links para reposit\u00f3rios</li> <li>Explica o contexto: problema, solu\u00e7\u00e3o, aprendizados</li> <li>Inclui screenshots ou exemplos de output quando relevante</li> </ol>","tags":["ABAP","Programas","Portfolio"]},{"location":"meus_programas/#template-de-documentacao","title":"\ud83d\udca1 Template de Documenta\u00e7\u00e3o","text":"<p>Para cada programa, considera documentar:</p> <pre><code>## Nome do Programa: Z_MEU_REPORT\n\n### \ud83d\udccb Descri\u00e7\u00e3o\n[O que o programa faz]\n\n### \ud83c\udfaf Objetivo\n[Problema que resolve]\n\n### \ud83d\udd27 Tecnologias\n- [ ] ABAP OO / Procedural\n- [ ] ALV\n- [ ] CDS / AMDP\n- [ ] RFC / IDoc\n- [ ] Smartforms / Adobe\n\n### \ud83d\udcdd C\u00f3digo Principal\n[Snippet ou link]\n\n### \ud83e\uddea Testes\n[Como testar, casos de teste]\n\n### \ud83d\udcda Aprendizados\n[O que aprendi desenvolvendo isto]\n</code></pre>","tags":["ABAP","Programas","Portfolio"]},{"location":"meus_programas/#boas-praticas-para-documentar","title":"\ud83c\udf93 Boas Pr\u00e1ticas para Documentar","text":"<ul> <li>\u2705 Nome descritivo do programa e transa\u00e7\u00e3o</li> <li>\u2705 Coment\u00e1rios no c\u00f3digo em portugu\u00eas ou ingl\u00eas</li> <li>\u2705 README.md para projetos complexos</li> <li>\u2705 Hist\u00f3rico de vers\u00f5es (mudan\u00e7as, melhorias)</li> <li>\u2705 Screenshots da tela de sele\u00e7\u00e3o / output</li> <li>\u2705 Dependency map (tabelas, fun\u00e7\u00f5es, BAPIs usados)</li> </ul>","tags":["ABAP","Programas","Portfolio"]},{"location":"meus_programas/#como-adicionar-novo-programa","title":"\ufffd Como Adicionar Novo Programa","text":"<ol> <li>Cria um ficheiro <code>.md</code> em <code>docs/meus_programas/</code></li> <li>Nome sugerido: <code>YYYYMMDD_nome_programa.md</code> ou <code>categoria_nome.md</code></li> <li>O awesome-pages (<code>...</code>) vai listar automaticamente</li> </ol> <p>Exemplo: <pre><code># Criar novo programa\ndocs/meus_programas/20251105_relatorio_vendas.md\ndocs/meus_programas/interface_sap_legado.md\ndocs/meus_programas/badi_pricing_custom.md\n</code></pre></p> <p>Tags: <code>#portfolio</code> <code>#programas</code> <code>#documentacao</code> <code>#abap-projects</code></p>","tags":["ABAP","Programas","Portfolio"]},{"location":"meus_programas/ZCL_UTIL_EXCEL_Documentacao/","title":"Classe Manipula\u00e7\u00e3o de Ficheiros Excel","text":""},{"location":"meus_programas/ZCL_UTIL_EXCEL_Documentacao/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Classe utilit\u00e1ria para upload, download e manipula\u00e7\u00e3o de ficheiros Excel (formato <code>.xlsx</code>) em ABAP. Permite convers\u00e3o de dados entre tabelas internas SAP e ficheiros Excel, incluindo formata\u00e7\u00e3o de datas e n\u00fameros decimais.</p>"},{"location":"meus_programas/ZCL_UTIL_EXCEL_Documentacao/#requisito-critico-classe-de-excecao","title":"\u26a0\ufe0f REQUISITO CR\u00cdTICO - Classe de Exce\u00e7\u00e3o","text":"<p>\u00c9 OBRIGAT\u00d3RIO criar a classe de exce\u00e7\u00e3o <code>ZCX_U_EXCEL_FILE</code> antes de utilizar esta classe!</p> <p>Esta classe deve ser do tipo Exception Class e conter, no m\u00ednimo, os seguintes IDs de texto (TEXTID):</p> <ul> <li><code>cx_create_excel_itab</code> - Erro ao criar ficheiro Excel a partir de tabela interna</li> <li><code>cx_no_file_selected</code> - Nenhum ficheiro foi selecionado</li> <li><code>cx_no_worksheet</code> - Worksheet n\u00e3o encontrado (com par\u00e2metro msgv1 para nome do worksheet)</li> </ul>"},{"location":"meus_programas/ZCL_UTIL_EXCEL_Documentacao/#criacao-da-classe-de-excecao","title":"Cria\u00e7\u00e3o da Classe de Exce\u00e7\u00e3o","text":"<pre><code>CLASS zcx_u_excel_file DEFINITION\n  PUBLIC\n  INHERITING FROM cx_static_check\n  FINAL\n  CREATE PUBLIC.\n\n  PUBLIC SECTION.\n    INTERFACES if_t100_message.\n\n    CONSTANTS:\n      BEGIN OF cx_create_excel_itab,\n        msgid TYPE symsgid VALUE 'Z_MSG_CLASS',\n        msgno TYPE symsgno VALUE '001',\n        attr1 TYPE scx_attrname VALUE '',\n        attr2 TYPE scx_attrname VALUE '',\n        attr3 TYPE scx_attrname VALUE '',\n        attr4 TYPE scx_attrname VALUE '',\n      END OF cx_create_excel_itab,\n\n      BEGIN OF cx_no_file_selected,\n        msgid TYPE symsgid VALUE 'Z_MSG_CLASS',\n        msgno TYPE symsgno VALUE '002',\n        attr1 TYPE scx_attrname VALUE '',\n        attr2 TYPE scx_attrname VALUE '',\n        attr3 TYPE scx_attrname VALUE '',\n        attr4 TYPE scx_attrname VALUE '',\n      END OF cx_no_file_selected,\n\n      BEGIN OF cx_no_worksheet,\n        msgid TYPE symsgid VALUE 'Z_MSG_CLASS',\n        msgno TYPE symsgno VALUE '003',\n        attr1 TYPE scx_attrname VALUE 'MSGV1',\n        attr2 TYPE scx_attrname VALUE '',\n        attr3 TYPE scx_attrname VALUE '',\n        attr4 TYPE scx_attrname VALUE '',\n      END OF cx_no_worksheet.\n\n    DATA msgv1 TYPE string.\n\n    METHODS constructor\n      IMPORTING\n        textid   LIKE if_t100_message=&gt;t100key OPTIONAL\n        previous LIKE previous OPTIONAL\n        msgv1    TYPE string OPTIONAL.\n\nENDCLASS.\n</code></pre>"},{"location":"meus_programas/ZCL_UTIL_EXCEL_Documentacao/#tipos-de-dados","title":"\ud83d\udce6 Tipos de Dados","text":""},{"location":"meus_programas/ZCL_UTIL_EXCEL_Documentacao/#ts_excel_file","title":"<code>ts_excel_file</code>","text":"<p>Estrutura que cont\u00e9m os atributos de um ficheiro Excel.</p> <pre><code>BEGIN OF ts_excel_file,\n  name  TYPE filename,    \" Nome do ficheiro\n  size  TYPE i,           \" Tamanho do ficheiro\n  xdata TYPE solix_tab,   \" Dados bin\u00e1rios do ficheiro\nEND OF ts_excel_file\n</code></pre>"},{"location":"meus_programas/ZCL_UTIL_EXCEL_Documentacao/#ts_number_delimiters","title":"<code>ts_number_delimiters</code>","text":"<p>Estrutura para delimitadores de n\u00fameros decimais.</p> <pre><code>BEGIN OF ts_number_delimiters,\n  thousand TYPE char01,   \" Delimitador de milhares (ex: . ou ,)\n  decimal  TYPE char01,   \" Delimitador decimal (ex: , ou .)\nEND OF ts_number_delimiters\n</code></pre>"},{"location":"meus_programas/ZCL_UTIL_EXCEL_Documentacao/#constantes-expressoes-regulares","title":"\ud83d\udd22 Constantes (Express\u00f5es Regulares)","text":"Constante Valor Descri\u00e7\u00e3o <code>co_int_pattern</code> <code>^\\d+$</code> Padr\u00e3o para n\u00famero inteiro <code>co_decimals_pattern</code> <code>^[+-]?(\\d+\\D\\d+)$</code> Padr\u00e3o para n\u00famero decimal <code>co_thd_dec_pattern</code> <code>^[+-]?((\\d+(\\T?\\d+)*)(\\D\\d+)?)$</code> Padr\u00e3o para n\u00famero com delimitador de milhares"},{"location":"meus_programas/ZCL_UTIL_EXCEL_Documentacao/#metodos-publicos","title":"\ud83d\udd27 M\u00e9todos P\u00fablicos","text":""},{"location":"meus_programas/ZCL_UTIL_EXCEL_Documentacao/#1-upload_local_excel","title":"1. <code>upload_local_excel</code>","text":"<p>Descri\u00e7\u00e3o: Faz upload de ficheiro Excel local e converte para tabela interna.</p> <p>Par\u00e2metros:</p> <pre><code>METHODS upload_local_excel\n  IMPORTING\n    iv_filename       TYPE string OPTIONAL      \" Caminho do ficheiro\n    iv_open_dialog    TYPE abap_bool DEFAULT space  \" Abrir dialog de sele\u00e7\u00e3o\n    iv_worksheet_name TYPE string OPTIONAL      \" Nome da worksheet (se vazio, usa primeira)\n  EXPORTING\n    er_excel_data     TYPE REF TO data          \" Refer\u00eancia aos dados do Excel\n  RAISING\n    zcx_u_excel_file                           \" Exce\u00e7\u00e3o customizada\n    cx_fdt_excel_core.                         \" Exce\u00e7\u00e3o standard\n</code></pre> <p>Exemplo de Uso:</p> <pre><code>DATA: lo_excel TYPE REF TO zcl_util_excel,\n      lr_data  TYPE REF TO data.\n\nFIELD-SYMBOLS: &lt;ft_data&gt; TYPE STANDARD TABLE.\n\nTRY.\n    CREATE OBJECT lo_excel.\n\n    \" Op\u00e7\u00e3o 1: Com dialog de sele\u00e7\u00e3o\n    lo_excel-&gt;upload_local_excel(\n      EXPORTING\n        iv_open_dialog    = abap_true\n        iv_worksheet_name = 'Dados'\n      IMPORTING\n        er_excel_data = lr_data\n    ).\n\n    \" Op\u00e7\u00e3o 2: Com caminho espec\u00edfico\n    lo_excel-&gt;upload_local_excel(\n      EXPORTING\n        iv_filename       = 'C:\\Temp\\dados.xlsx'\n        iv_worksheet_name = 'Sheet1'\n      IMPORTING\n        er_excel_data = lr_data\n    ).\n\n    \" Atribuir dados a field-symbol\n    ASSIGN lr_data-&gt;* TO &lt;ft_data&gt;.\n\n    \" Processar dados\n    LOOP AT &lt;ft_data&gt; ASSIGNING FIELD-SYMBOL(&lt;fs_row&gt;).\n      \" Processamento...\n    ENDLOOP.\n\n  CATCH zcx_u_excel_file INTO DATA(lx_excel).\n    MESSAGE lx_excel-&gt;get_text( ) TYPE 'E'.\n\n  CATCH cx_fdt_excel_core INTO DATA(lx_core).\n    MESSAGE lx_core-&gt;get_text( ) TYPE 'E'.\nENDTRY.\n</code></pre>"},{"location":"meus_programas/ZCL_UTIL_EXCEL_Documentacao/#2-download_itab_local_excel-estatico","title":"2. <code>download_itab_local_excel</code> (Est\u00e1tico)","text":"<p>Descri\u00e7\u00e3o: Faz download de tabela interna para ficheiro Excel local.</p> <p>Par\u00e2metros:</p> <pre><code>CLASS-METHODS download_itab_local_excel\n  IMPORTING\n    iv_filename TYPE string           \" Nome do ficheiro de destino\n    it_table    TYPE REF TO data      \" Refer\u00eancia \u00e0 tabela interna\n  RAISING\n    zcx_u_excel_file.\n</code></pre> <p>Exemplo de Uso:</p> <pre><code>DATA: lt_employees TYPE TABLE OF zemployee,\n      lr_table     TYPE REF TO data.\n\n\" Preencher dados\nSELECT * FROM zemployee INTO TABLE lt_employees UP TO 100 ROWS.\n\n\" Obter refer\u00eancia\nGET REFERENCE OF lt_employees INTO lr_table.\n\nTRY.\n    zcl_util_excel=&gt;download_itab_local_excel(\n      iv_filename = 'Funcionarios_2025.xlsx'\n      it_table    = lr_table\n    ).\n\n    MESSAGE 'Ficheiro exportado com sucesso!' TYPE 'S'.\n\n  CATCH zcx_u_excel_file INTO DATA(lx).\n    MESSAGE lx-&gt;get_text( ) TYPE 'E'.\nENDTRY.\n</code></pre>"},{"location":"meus_programas/ZCL_UTIL_EXCEL_Documentacao/#3-format_date-estatico","title":"3. <code>format_date</code> (Est\u00e1tico)","text":"<p>Descri\u00e7\u00e3o: Converte formato de data externa para formato interno SAP (YYYYMMDD).</p> <p>Par\u00e2metros:</p> <pre><code>CLASS-METHODS format_date\n  IMPORTING\n    iv_date_ext    TYPE clike         \" Data em formato externo\n  RETURNING\n    VALUE(rv_date) TYPE datum.        \" Data em formato SAP\n</code></pre> <p>Suporta os seguintes formatos:</p> <ul> <li>N\u00famero Excel (ex: <code>44927</code> = 01.01.2023)</li> <li>Formato com separadores: <code>DD.MM.YYYY</code>, <code>MM/DD/YYYY</code>, <code>YYYY-MM-DD</code></li> <li>Adapta-se ao formato de data do utilizador (USER01-DATFM)</li> </ul> <p>Exemplo de Uso:</p> <pre><code>DATA: lv_date_ext TYPE string VALUE '15.03.2025',\n      lv_date_sap TYPE datum.\n\n\" Converter data externa para formato SAP\nlv_date_sap = zcl_util_excel=&gt;format_date( lv_date_ext ).\n\" Resultado: 20250315\n\n\" Tamb\u00e9m funciona com n\u00fameros do Excel\nlv_date_sap = zcl_util_excel=&gt;format_date( '45737' ).\n\" Resultado: 20250315\n</code></pre>"},{"location":"meus_programas/ZCL_UTIL_EXCEL_Documentacao/#4-format_number_dec-estatico","title":"4. <code>format_number_dec</code> (Est\u00e1tico)","text":"<p>Descri\u00e7\u00e3o: Converte formato decimal externo para formato interno SAP.</p> <p>Par\u00e2metros:</p> <pre><code>CLASS-METHODS format_number_dec\n  IMPORTING\n    iv_value_ext         TYPE clike           \" N\u00famero em formato externo\n  RETURNING\n    VALUE(rv_value_user) TYPE string.         \" N\u00famero formatado\n</code></pre> <p>Suporta os seguintes formatos:</p> <ul> <li><code>1.234,56</code> (formato alem\u00e3o)</li> <li><code>1,234.56</code> (formato anglo-sax\u00f3nico)</li> <li><code>1 234,56</code> (formato franc\u00eas)</li> <li>Nota\u00e7\u00e3o cient\u00edfica (ex: <code>1.23E+05</code>)</li> </ul> <p>Exemplo de Uso:</p> <pre><code>DATA: lv_value_ext TYPE string VALUE '1.234,56',\n      lv_value_sap TYPE string.\n\n\" Converter n\u00famero decimal externo\nlv_value_sap = zcl_util_excel=&gt;format_number_dec( lv_value_ext ).\n\" Resultado: '1234.56' (formato SAP com ponto decimal)\n\n\" Outros formatos\nlv_value_sap = zcl_util_excel=&gt;format_number_dec( '1,234.56' ).\n\" Resultado: '1234.56'\n\n\" Nota\u00e7\u00e3o cient\u00edfica\nlv_value_sap = zcl_util_excel=&gt;format_number_dec( '1.23E+05' ).\n\" Resultado: '123000'\n</code></pre>"},{"location":"meus_programas/ZCL_UTIL_EXCEL_Documentacao/#metodos-protegidos","title":"\ud83d\udd12 M\u00e9todos Protegidos","text":"<p>Estes m\u00e9todos s\u00e3o para uso interno da classe:</p> M\u00e9todo Descri\u00e7\u00e3o <code>handle_frontend</code> Controla a pop-up de sele\u00e7\u00e3o de ficheiro local <code>set_excel_data</code> Define os dados em formato Excel <code>build_excel_xdata</code> Constr\u00f3i o ficheiro Excel (XSTRING) a partir de tabela interna <code>export_local</code> Exporta dados para ficheiro local (pop-up) <code>convert_date_numb_to_internal</code> Converte n\u00famero Excel para data SAP <code>conv_date_user_format</code> Converte data para formato do utilizador <code>extract_number_format</code> Extrai formato de n\u00famero decimal (delimitadores) <code>check_pattern</code> Valida padr\u00f5es usando express\u00f5es regulares"},{"location":"meus_programas/ZCL_UTIL_EXCEL_Documentacao/#codigo-completo-da-classe-colapsavel","title":"\ud83e\uddfe C\u00f3digo completo da classe (colaps\u00e1vel)","text":"Mostrar/ocultar c\u00f3digo fonte completo da classe `ZCL_UTIL_EXCEL` <pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Classe: ZCL_UTIL_EXCEL\n*&amp; Descri\u00e7\u00e3o: Classe utilit\u00e1ria para manipula\u00e7\u00e3o de ficheiros Excel\n*&amp; Autor: [Seu Nome]\n*&amp; Data: 06.11.2025\n*&amp;---------------------------------------------------------------------*\nCLASS zcl_util_excel DEFINITION\n  PUBLIC\n  CREATE PUBLIC .\n\n  PUBLIC SECTION.\n\n    TYPES:\n      \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Atributos ficheiro EXCEL&lt;/p&gt;\n      BEGIN OF ts_excel_file,\n        name  TYPE filename,\n        size  TYPE i,\n        xdata TYPE solix_tab,\n      END OF ts_excel_file.\n\n    TYPES:\n      \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Delimitadores numeros decimais&lt;/p&gt;\n      BEGIN OF ts_number_delimiters,\n        thousand TYPE char01,\n        decimal  TYPE char01,\n      END OF ts_number_delimiters.\n\n\n    CONSTANTS:\n      \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Express\u00e3o regular numero inteiro&lt;/p&gt;\n      co_int_pattern      TYPE string VALUE `^\\d+$` ##NO_TEXT,\n      \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Express\u00e3o regular numero decimal&lt;/p&gt;\n      co_decimals_pattern TYPE string VALUE `^[+-]?(\\d+\\D\\d+)$` ##NO_TEXT,\n      \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Express\u00e3o regular numero decimal com delimitador mil.&lt;/p&gt;\n      co_thd_dec_pattern  TYPE string VALUE `^[+-]?((\\d+(\\T?\\d+)*)(\\D\\d+)?)$` ##NO_TEXT.\n\n\n    \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Upload de ficheiro local (EXCEL)&lt;/p&gt;\n    METHODS upload_local_excel IMPORTING iv_filename       TYPE string OPTIONAL\n                                         iv_open_dialog    TYPE abap_bool DEFAULT space\n                                         iv_worksheet_name TYPE string OPTIONAL\n                               EXPORTING er_excel_data     TYPE REF TO data\n                               RAISING   zcx_u_excel_file\n                                         cx_fdt_excel_core.\n\n    \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Download de tabela a ficheiro local (EXCEL)&lt;/p&gt;\n    CLASS-METHODS download_itab_local_excel IMPORTING iv_filename TYPE string\n                                                      it_table    TYPE REF TO data\n                                            RAISING   zcx_u_excel_file.\n\n    \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Converter formato data externa a interno SAP&lt;/p&gt;\n    CLASS-METHODS format_date IMPORTING iv_date_ext    TYPE clike\n                              RETURNING VALUE(rv_date) TYPE datum.\n\n    \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Converter formato decimal externo a interno SAP&lt;/p&gt;\n    CLASS-METHODS format_number_dec IMPORTING iv_value_ext         TYPE clike\n                                    RETURNING VALUE(rv_value_user) TYPE string.\n\n\n  PROTECTED SECTION.\n\n    \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Atributos do ficheiro EXCEL&lt;/p&gt;\n    DATA ms_excel_file TYPE ts_excel_file .\n\n    \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Controlo da POP-UP para sele\u00e7\u00e3o de ficheiro local&lt;/p&gt;\n    METHODS handle_frontend IMPORTING iv_filename    TYPE string\n                                      iv_open_dialog TYPE abap_bool\n                            RAISING   zcx_u_excel_file.\n\n    \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Defini\u00e7\u00e3o dos dados em formato de EXCEL&lt;/p&gt;\n    METHODS set_excel_data IMPORTING iv_worksheet_name TYPE string\n                           EXPORTING er_excel_data     TYPE REF TO data\n                           RAISING   zcx_u_excel_file\n                                     cx_fdt_excel_core.\n\n    \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Constru\u00e7\u00e3o do EXCEL (download)&lt;/p&gt;\n    CLASS-METHODS build_excel_xdata IMPORTING it_table TYPE REF TO data\n                                    EXPORTING ev_xdata TYPE xstring\n                                    RAISING   zcx_u_excel_file.\n\n    \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Exportar tabela download (POP-UP)&lt;/p&gt;\n    CLASS-METHODS export_local IMPORTING iv_filename TYPE string\n                                         iv_xdata    TYPE xstring\n                               RAISING   zcx_u_excel_file.\n\n    \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;F\u00f3rmula de convers\u00e3o de numero a data&lt;/p&gt;\n    CLASS-METHODS convert_date_numb_to_internal IMPORTING iv_date_ext              TYPE clike\n                                                EXPORTING ev_date                  TYPE datum\n                                                RETURNING VALUE(rv_date_is_number) TYPE abap_bool.\n\n    \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Convers\u00e3o data formato externo ao formato de user&lt;/p&gt;\n    CLASS-METHODS conv_date_user_format IMPORTING iv_date_ext         TYPE clike\n                                        RETURNING VALUE(rv_date_user) TYPE string.\n\n    \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Extrai o formato decimal externo&lt;/p&gt;\n    CLASS-METHODS extract_number_format IMPORTING iv_value_ext            TYPE clike\n                                        RETURNING VALUE(rs_number_format) TYPE ts_number_delimiters.\n\n    \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Valida\u00e7\u00e3o de padr\u00f5es de formatos de um decimal&lt;/p&gt;\n    CLASS-METHODS check_pattern IMPORTING iv_value_ext TYPE clike\n                                          iv_pattern   TYPE string\n                                RETURNING VALUE(rv_ok) TYPE abap_bool .\n\n\n  PRIVATE SECTION.\n\n\nENDCLASS.\n\n\n\nCLASS zcl_util_excel IMPLEMENTATION.\n\n\n* &lt;SIGNATURE&gt;---------------------------------------------------------------------------------------+\n* | Static Protected Method ZCL_UTIL_EXCEL=&gt;BUILD_EXCEL_XDATA\n* +-------------------------------------------------------------------------------------------------+\n* | [---&gt;] IT_TABLE                       TYPE REF TO DATA\n* | [&lt;---] EV_XDATA                       TYPE        XSTRING\n* | [!CX!] ZCX_U_EXCEL_FILE\n* +--------------------------------------------------------------------------------------&lt;/SIGNATURE&gt;\n  METHOD build_excel_xdata.\n\n    CLEAR ev_xdata.\n\n    GET REFERENCE OF it_table-&gt;* INTO DATA(lr_excel_struct).\n    DATA(lo_table_desc) = CAST cl_abap_tabledescr( cl_abap_tabledescr=&gt;describe_by_data_ref( lr_excel_struct ) ).\n    DATA(lo_row_desc) = CAST cl_abap_structdescr( lo_table_desc-&gt;get_table_line_type( ) ).\n    DATA(lt_fields) = lo_row_desc-&gt;get_ddic_field_list( p_langu = sy-langu ).\n\n    TRY.\n        DATA(lo_tool_xls) = cl_salv_export_tool_ats_xls=&gt;create_for_excel( r_data = lr_excel_struct ).\n\n        DATA(lo_config) = lo_tool_xls-&gt;configuration( ).\n        LOOP AT lt_fields ASSIGNING FIELD-SYMBOL(&lt;ls_field&gt;) .\n          lo_config-&gt;add_column( header_text = CONV string( &lt;ls_field&gt;-scrtext_l )\n                                 field_name = CONV string( &lt;ls_field&gt;-fieldname )\n                                 display_type = if_salv_bs_model_column=&gt;uie_text_view ).\n        ENDLOOP.\n\n        lo_tool_xls-&gt;read_result( IMPORTING content = ev_xdata ).\n\n      CATCH cx_salv_ill_export_format_path cx_salv_export_error cx_salv_not_index_table INTO DATA(lx).\n        DATA(lv_msg) = lx-&gt;get_text( ). \" only for debug\n        RAISE EXCEPTION TYPE zcx_u_excel_file\n          EXPORTING\n            textid = zcx_u_excel_file=&gt;cx_create_excel_itab.\n    ENDTRY.\n\n  ENDMETHOD.\n\n\n* &lt;SIGNATURE&gt;---------------------------------------------------------------------------------------+\n* | Static Protected Method ZCL_UTIL_EXCEL=&gt;CHECK_PATTERN\n* +-------------------------------------------------------------------------------------------------+\n* | [---&gt;] IV_VALUE_EXT                   TYPE        CLIKE\n* | [---&gt;] IV_PATTERN                     TYPE        STRING\n* | [&lt;-()] RV_OK                          TYPE        ABAP_BOOL\n* +--------------------------------------------------------------------------------------&lt;/SIGNATURE&gt;\n  METHOD check_pattern.\n\n    rv_ok = abap_false.\n    TRY.\n        IF cl_abap_matcher=&gt;create_pcre( pattern = iv_pattern text = iv_value_ext )-&gt;match( ) EQ abap_true.\n          rv_ok = abap_true.\n        ENDIF.\n\n      CATCH cx_sy_regex cx_sy_matcher INTO DATA(lx).\n        DATA(lv_msg) = lx-&gt;get_text( ). \" only for debug\n    ENDTRY.\n\n  ENDMETHOD.\n\n\n* &lt;SIGNATURE&gt;---------------------------------------------------------------------------------------+\n* | Static Protected Method ZCL_UTIL_EXCEL=&gt;CONVERT_DATE_NUMB_TO_INTERNAL\n* +-------------------------------------------------------------------------------------------------+\n* | [---&gt;] IV_DATE_EXT                    TYPE        CLIKE\n* | [&lt;---] EV_DATE                        TYPE        DATUM\n* | [&lt;-()] RV_DATE_IS_NUMBER              TYPE        ABAP_BOOL\n* +--------------------------------------------------------------------------------------&lt;/SIGNATURE&gt;\n  METHOD convert_date_numb_to_internal.\n\n    CLEAR: ev_date.\n    rv_date_is_number = abap_false.\n\n    TRY.\n        IF cl_abap_matcher=&gt;create_pcre( pattern = co_int_pattern text = iv_date_ext )-&gt;match( ) EQ abap_true.\n\n          ev_date = '19000101'. \" initial date in excel\n*---------------------------------------------------------------------\n* subtract 2 because 01.01.19000 counts as a day and it count the\n* 29.02.1900 that does not exist\n          ev_date = ( ev_date + ( iv_date_ext DIV 1 ) ) - 2.\n*---------------------------------------------------------------------\n          rv_date_is_number = abap_true.\n        ENDIF.\n\n      CATCH cx_sy_regex cx_sy_matcher INTO DATA(lx).\n        DATA(lv_msg) = lx-&gt;get_text( ). \" only for debug\n    ENDTRY.\n\n  ENDMETHOD.\n\n\n* &lt;SIGNATURE&gt;---------------------------------------------------------------------------------------+\n* | Static Protected Method ZCL_UTIL_EXCEL=&gt;CONV_DATE_USER_FORMAT\n* +-------------------------------------------------------------------------------------------------+\n* | [---&gt;] IV_DATE_EXT                    TYPE        CLIKE\n* | [&lt;-()] RV_DATE_USER                   TYPE        STRING\n* +--------------------------------------------------------------------------------------&lt;/SIGNATURE&gt;\n  METHOD conv_date_user_format.\n\n    DATA: lv_datfm TYPE usr01-datfm.\n\n    CLEAR rv_date_user.\n    CHECK iv_date_ext IS NOT INITIAL.\n\n    DATA(lv_date_ext) = iv_date_ext.\n\n    \" user date format\n    SELECT SINGLE datfm FROM usr01\n      INTO lv_datfm WHERE bname = sy-uname.\n\n    DATA(lv_date_separator) = SWITCH #( lv_datfm WHEN 1 OR 4 THEN |.| \\\n                                                 WHEN 2 OR 5 THEN |/| \\\n                                                 WHEN 3 OR 6 THEN |-| ).\n\n    IF find_any_not_of( val = lv_date_ext sub = '0123456789' occ = 1 ) = 4 AND ( lv_datfm = 1 OR lv_datfm = 2 OR lv_datfm = 3 ).\n\n      lv_date_ext = lv_date_ext+8(2) &amp;&amp; lv_date_separator &amp;&amp; lv_date_ext+5(2)  &amp;&amp; lv_date_separator &amp;&amp; lv_date_ext(4).\n\n    ENDIF.\n\n    rv_date_user = SWITCH #( lv_datfm WHEN 1 OR 2 OR 3 \" DD.MM.YYYY or MM/DD/YYYY or MM-DD-YYYY\n                                      THEN |{ lv_date_ext(2) }{ lv_date_separator }{ lv_date_ext+3(2) }{ lv_date_separator }{ lv_date_ext+6(4) }|\n                                      WHEN 4 OR 5 OR 6 \" YYYY.MM.DD or YYYY/MM/DD or YYYY-MM-DD\n                                      THEN |{ lv_date_ext(4) }{ lv_date_separator }{ lv_date_ext+5(2) }{ lv_date_separator }{ lv_date_ext+8(2) }| ).\n\n  ENDMETHOD.\n\n\n* &lt;SIGNATURE&gt;---------------------------------------------------------------------------------------+\n* | Static Public Method ZCL_UTIL_EXCEL=&gt;DOWNLOAD_ITAB_LOCAL_EXCEL\n* +-------------------------------------------------------------------------------------------------+\n* | [---&gt;] IV_FILENAME                    TYPE        STRING\n* | [---&gt;] IT_TABLE                       TYPE REF TO DATA\n* | [!CX!] ZCX_U_EXCEL_FILE\n* +--------------------------------------------------------------------------------------&lt;/SIGNATURE&gt;\n  METHOD download_itab_local_excel.\n\n    TRY.\n        build_excel_xdata( EXPORTING it_table = it_table IMPORTING ev_xdata = DATA(lv_xdata) ).\n        export_local( iv_filename = iv_filename iv_xdata = lv_xdata ).\n\n      CATCH zcx_u_excel_file INTO DATA(lx).\n        RAISE EXCEPTION lx.\n    ENDTRY.\n\n  ENDMETHOD.\n\n\n* &lt;SIGNATURE&gt;---------------------------------------------------------------------------------------+\n* | Static Protected Method ZCL_UTIL_EXCEL=&gt;EXPORT_LOCAL\n* +-------------------------------------------------------------------------------------------------+\n* | [---&gt;] IV_FILENAME                    TYPE        STRING\n* | [---&gt;] IV_XDATA                       TYPE        XSTRING\n* | [!CX!] ZCX_U_EXCEL_FILE\n* +--------------------------------------------------------------------------------------&lt;/SIGNATURE&gt;\n  METHOD export_local.\n\n    CHECK iv_xdata IS NOT INITIAL.\n\n    CALL FUNCTION 'XML_EXPORT_DIALOG'\n      EXPORTING\n        i_xml                      = iv_xdata\n        i_default_extension        = 'XLSX'\n        i_initial_directory        = ''\n        i_default_file_name        = iv_filename\n        i_mask                     = 'Excel (*.XLSX)|*.XLSX' ##NO_TEXT\n        i_application              = ''\n      EXCEPTIONS\n        application_not_executable = 1\n        others                     = 2.\n\n    IF sy-subrc NE 0.\n      RAISE EXCEPTION TYPE zcx_u_excel_file MESSAGE ID sy-msgid TYPE 'E' NUMBER sy-msgno\n        WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.\n    ENDIF.\n\n  ENDMETHOD.\n\n\n* &lt;SIGNATURE&gt;---------------------------------------------------------------------------------------+\n* | Static Protected Method ZCL_UTIL_EXCEL=&gt;EXTRACT_NUMBER_FORMAT\n* +-------------------------------------------------------------------------------------------------+\n* | [---&gt;] IV_VALUE_EXT                   TYPE        CLIKE\n* | [&lt;-()] RS_NUMBER_FORMAT               TYPE        TS_NUMBER_DELIMITERS\n* +--------------------------------------------------------------------------------------&lt;/SIGNATURE&gt;\n  METHOD extract_number_format.\n    CLEAR rs_number_format.\n\n    \" format only with decimals 1.23\n    IF check_pattern( iv_value_ext = iv_value_ext iv_pattern = replace( val = co_decimals_pattern sub = 'D' with = '.' ) ) EQ abap_true.\n      rs_number_format = VALUE #( thousand = || decimal = |.| ).\n      RETURN.\n    ENDIF.\n\n    \" format only with decimals 1,23\n    IF check_pattern( iv_value_ext = iv_value_ext iv_pattern = replace( val = co_decimals_pattern sub = 'D' with = ',' ) ) EQ abap_true.\n      rs_number_format = VALUE #( thousand = || decimal = |,| ).\n      RETURN.\n    ENDIF.\n\n    \" format 1.234.567,89\n    IF check_pattern( iv_value_ext = iv_value_ext iv_pattern = replace( val = replace( val = co_thd_dec_pattern sub = 'D' with = ',' ) sub = 'T' with = '.' ) ) EQ abap_true.\n      rs_number_format = VALUE #( thousand = |.| decimal = |,| ).\n      RETURN.\n    ENDIF.\n\n    \" format 1,234,567.89\n    IF check_pattern( iv_value_ext = iv_value_ext iv_pattern = replace( val = replace( val = co_thd_dec_pattern sub = 'D' with = '.' ) sub = 'T' with = ',' ) ) EQ abap_true.\n      rs_number_format = VALUE #( thousand = |,| decimal = |.| ).\n      RETURN.\n    ENDIF.\n\n    \" format 1 234 567,89\n    IF check_pattern( iv_value_ext = iv_value_ext iv_pattern = replace( val = replace( val = co_thd_dec_pattern sub = 'D' with = ',' ) sub = 'T' with = ' ' ) ) EQ abap_true.\n      rs_number_format = VALUE #( thousand = | | decimal = |,| ).\n      RETURN.\n    ENDIF.\n\n  ENDMETHOD.\n\n\n* &lt;SIGNATURE&gt;---------------------------------------------------------------------------------------+\n* | Static Public Method ZCL_UTIL_EXCEL=&gt;FORMAT_DATE\n* +-------------------------------------------------------------------------------------------------+\n* | [---&gt;] IV_DATE_EXT                    TYPE        CLIKE\n* | [&lt;-()] RV_DATE                        TYPE        DATUM\n* +--------------------------------------------------------------------------------------&lt;/SIGNATURE&gt;\n  METHOD format_date.\n    CLEAR rv_date.\n\n    CHECK iv_date_ext IS NOT INITIAL.\n\n    IF convert_date_numb_to_internal( EXPORTING iv_date_ext = iv_date_ext IMPORTING ev_date = rv_date ) EQ abap_true.\n      RETURN.\n    ENDIF.\n\n    DATA(lv_date_ext) = conv_date_user_format( iv_date_ext ).\n    CALL FUNCTION 'CONVERT_DATE_TO_INTERNAL'\n      EXPORTING\n        date_external            = lv_date_ext\n      IMPORTING\n        date_internal            = rv_date\n      EXCEPTIONS\n        date_external_is_invalid = 1\n        others                   = 2.\n\n    IF sy-subrc &lt;&gt; 0 AND lv_date_ext IS NOT INITIAL.\n      rv_date = lv_date_ext+6(4) &amp;&amp; lv_date_ext+3(2) &amp;&amp; lv_date_ext(2).\n    ENDIF.\n\n  ENDMETHOD.\n\n\n* &lt;SIGNATURE&gt;---------------------------------------------------------------------------------------+\n* | Static Public Method ZCL_UTIL_EXCEL=&gt;FORMAT_NUMBER_DEC\n* +-------------------------------------------------------------------------------------------------+\n* | [---&gt;] IV_VALUE_EXT                   TYPE        CLIKE\n* | [&lt;-()] RV_VALUE_USER                  TYPE        STRING\n* +--------------------------------------------------------------------------------------&lt;/SIGNATURE&gt;\n  METHOD format_number_dec.\n\n    CLEAR rv_value_user.\n\n    IF iv_value_ext CS 'E'.\n      DATA lv_char_field TYPE cha_class_view-sollwert.\n\n      CALL FUNCTION 'QSS0_FLTP_TO_CHAR_CONVERSION'\n        EXPORTING\n          i_number_of_digits = 10\n          i_fltp_value       = CONV cha_class_data-sollwert( iv_value_ext )\n        IMPORTING\n          e_char_field       = lv_char_field.\n\n      rv_value_user = lv_char_field.\n      CONDENSE rv_value_user NO-GAPS.\n    ENDIF.\n\n    DATA(ls_format) = extract_number_format( COND #( WHEN rv_value_user IS NOT INITIAL THEN rv_value_user ELSE iv_value_ext ) ).\n    rv_value_user = COND #( WHEN rv_value_user IS NOT INITIAL THEN rv_value_user ELSE iv_value_ext ).\n\n    TRANSLATE: rv_value_user USING |{ ls_format-thousand } |,\n               rv_value_user USING |{ ls_format-decimal }.|.\n\n    CONDENSE rv_value_user NO-GAPS.\n\n  ENDMETHOD.\n</code></pre>"},{"location":"meus_programas/ZCL_UTIL_EXCEL_Documentacao/#casos-de-uso-praticos","title":"\ud83d\udca1 Casos de Uso Pr\u00e1ticos","text":""},{"location":"meus_programas/ZCL_UTIL_EXCEL_Documentacao/#caso-1-importar-dados-de-excel-e-processar","title":"Caso 1: Importar Dados de Excel e Processar","text":"<pre><code>DATA: lo_util  TYPE REF TO zcl_util_excel,\n      lr_data  TYPE REF TO data,\n      lv_lines TYPE i.\n\nFIELD-SYMBOLS: &lt;ft_excel&gt; TYPE STANDARD TABLE,\n               &lt;fs_row&gt;   TYPE any,\n               &lt;fs_field&gt; TYPE any.\n\nTRY.\n    CREATE OBJECT lo_util.\n\n    \" Upload com dialog\n    lo_util-&gt;upload_local_excel(\n      EXPORTING\n        iv_open_dialog = abap_true\n      IMPORTING\n        er_excel_data = lr_data\n    ).\n\n    ASSIGN lr_data-&gt;* TO &lt;ft_excel&gt;.\n\n    DESCRIBE TABLE &lt;ft_excel&gt; LINES lv_lines.\n    MESSAGE |{ lv_lines } linhas importadas com sucesso!| TYPE 'S'.\n\n    \" Processar cada linha\n    LOOP AT &lt;ft_excel&gt; ASSIGNING &lt;fs_row&gt;.\n      \" Aceder a campos espec\u00edficos\n      ASSIGN COMPONENT 'CAMPO1' OF STRUCTURE &lt;fs_row&gt; TO &lt;fs_field&gt;.\n      IF sy-subrc = 0.\n        \" Processar campo...\n      ENDIF.\n    ENDLOOP.\n\n  CATCH zcx_u_excel_file cx_fdt_excel_core INTO DATA(lx).\n    MESSAGE lx-&gt;get_text( ) TYPE 'E'.\nENDTRY.\n</code></pre>"},{"location":"meus_programas/ZCL_UTIL_EXCEL_Documentacao/#caso-2-exportar-relatorio-para-excel","title":"Caso 2: Exportar Relat\u00f3rio para Excel","text":"<pre><code>TYPES: BEGIN OF ty_report,\n         employee_id   TYPE pernr,\n         employee_name TYPE emnam,\n         department    TYPE orgeh,\n         salary        TYPE decfloat16,\n       END OF ty_report.\n\nDATA: lt_report TYPE TABLE OF ty_report,\n      lr_data   TYPE REF TO data.\n\n\" Preencher relat\u00f3rio\n\" ... c\u00f3digo para popular lt_report ...\n\n\" Exportar para Excel\nGET REFERENCE OF lt_report INTO lr_data.\n\nTRY.\n    zcl_util_excel=&gt;download_itab_local_excel(\n      iv_filename = |Relatorio_RH_{ sy-datum }.xlsx|\n      it_table    = lr_data\n    ).\n\n  CATCH zcx_u_excel_file INTO DATA(lx).\n    MESSAGE lx-&gt;get_text( ) TYPE 'E'.\nENDTRY.\n</code></pre>"},{"location":"meus_programas/ZCL_UTIL_EXCEL_Documentacao/#caso-3-conversao-de-formatos-em-loop","title":"Caso 3: Convers\u00e3o de Formatos em Loop","text":"<pre><code>DATA: lt_data TYPE TABLE OF ty_custom_data.\n\nFIELD-SYMBOLS: &lt;fs_data&gt; TYPE ty_custom_data.\n\nLOOP AT lt_data ASSIGNING &lt;fs_data&gt;.\n  \" Converter data\n  &lt;fs_data&gt;-datum = zcl_util_excel=&gt;format_date( &lt;fs_data&gt;-date_string ).\n\n  \" Converter valor decimal\n  &lt;fs_data&gt;-amount = zcl_util_excel=&gt;format_number_dec( &lt;fs_data&gt;-amount_string ).\nENDLOOP.\n</code></pre>"},{"location":"meus_programas/ZCL_UTIL_EXCEL_Documentacao/#dependencias-sap-standard","title":"\u2699\ufe0f Depend\u00eancias SAP Standard","text":"<p>Esta classe utiliza os seguintes componentes SAP:</p> <ul> <li><code>CL_FDT_XL_SPREADSHEET</code> - Manipula\u00e7\u00e3o de Excel</li> <li><code>CL_SALV_EXPORT_TOOL_ATS_XLS</code> - Exporta\u00e7\u00e3o SALV para Excel</li> <li><code>CL_GUI_FRONTEND_SERVICES</code> - Servi\u00e7os de frontend (upload/download)</li> <li><code>CL_BCS_CONVERT</code> - Convers\u00e3o de formatos</li> <li><code>CL_ABAP_MATCHER</code> - Express\u00f5es regulares</li> </ul>"},{"location":"meus_programas/ZCL_UTIL_EXCEL_Documentacao/#notas-importantes","title":"\ud83d\udcdd Notas Importantes","text":"<ol> <li> <p>Formato de Ficheiro: Esta classe trabalha exclusivamente com ficheiros <code>.xlsx</code> (Excel 2007+)</p> </li> <li> <p>Convers\u00e3o de Datas: A classe suporta tanto datas em formato de texto quanto n\u00fameros do Excel (onde 1 = 01.01.1900)</p> </li> <li> <p>Formato de N\u00fameros: Detecta automaticamente o formato decimal baseado nos delimitadores utilizados</p> </li> <li> <p>Performance: Para ficheiros grandes (&gt;10.000 linhas), considere processar em lotes</p> </li> <li> <p>Worksheets: Se n\u00e3o especificar o nome da worksheet, a primeira ser\u00e1 utilizada por padr\u00e3o</p> </li> <li> <p>Cabe\u00e7alhos: Os cabe\u00e7alhos das colunas no Excel devem corresponder aos nomes dos campos da estrutura/tabela</p> </li> <li> <p>Autoriza\u00e7\u00e3o: O utilizador precisa de autoriza\u00e7\u00e3o para acesso ao frontend (transa\u00e7\u00e3o SAP GUI)</p> </li> </ol>"},{"location":"meus_programas/ZCL_UTIL_EXCEL_Documentacao/#tratamento-de-erros","title":"\ud83d\udc1b Tratamento de Erros","text":"<p>Todas as exce\u00e7\u00f5es devem ser capturadas e tratadas adequadamente:</p> <pre><code>TRY.\n    \" C\u00f3digo...\n\n  CATCH zcx_u_excel_file INTO DATA(lx_excel).\n    \" Tratar erros espec\u00edficos da classe\n    MESSAGE lx_excel-&gt;get_text( ) TYPE 'E'.\n\n  CATCH cx_fdt_excel_core INTO DATA(lx_core).\n    \" Tratar erros do componente Excel SAP\n    MESSAGE lx_core-&gt;get_text( ) TYPE 'E'.\n\n  CATCH cx_root INTO DATA(lx_root).\n    \" Tratar erros gen\u00e9ricos\n    MESSAGE lx_root-&gt;get_text( ) TYPE 'E'.\nENDTRY.\n</code></pre>"},{"location":"meus_programas/ZCL_UTIL_EXCEL_Documentacao/#tags","title":"\ud83d\udcda Tags","text":"<p><code>#ABAP</code> <code>#Excel</code> <code>#Upload</code> <code>#Download</code> <code>#Utilities</code> <code>#FileHandling</code> <code>#DataConversion</code> <code>#XLSX</code> <code>#Frontend</code> <code>#Exception</code></p>"},{"location":"meus_programas/ZCL_UTIL_EXCEL_Documentacao/#versao","title":"\ud83d\udd04 Vers\u00e3o","text":"<p>Documenta\u00e7\u00e3o criada em: 06.11.2025 Classe: ZCL_UTIL_EXCEL Tipo: Utility Class Categoria: File Handling / Excel Processing</p>"},{"location":"meus_programas/ZCL_UTIL_EXCEL_Documentacao/#checklist-de-implementacao","title":"\u2705 Checklist de Implementa\u00e7\u00e3o","text":"<ul> <li>[ ] Criar classe de exce\u00e7\u00e3o <code>ZCX_U_EXCEL_FILE</code></li> <li>[ ] Criar mensagens na classe de mensagem (ex: Z_MSG_CLASS)</li> <li>[ ] Testar upload com diferentes formatos de Excel</li> <li>[ ] Testar download com diferentes tipos de tabelas</li> <li>[ ] Validar convers\u00f5es de data</li> <li>[ ] Validar convers\u00f5es de n\u00fameros decimais</li> <li>[ ] Documentar casos de uso espec\u00edficos do projeto</li> <li>[ ] Criar programa de teste (report) para valida\u00e7\u00e3o</li> </ul>"},{"location":"meus_programas/ZCL_UTIL_EXCEL_Documentacao/#-","title":"---","text":""},{"location":"meus_programas/ZCL_UTIL_EXCEL_Documentacao/#codigo-completo-da-classe","title":"\ud83d\udcbb C\u00f3digo Completo da Classe","text":"Clique para expandir o c\u00f3digo completo de ZCL_UTIL_EXCEL <pre><code>CLASS zcl_util_excel DEFINITION\n  PUBLIC\n  CREATE PUBLIC .\n\n  PUBLIC SECTION.\n\n    TYPES:\n      \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Atributos ficheiro EXCEL&lt;/p&gt;\n      BEGIN OF ts_excel_file,\n        name  TYPE filename,\n        size  TYPE i,\n        xdata TYPE solix_tab,\n      END OF ts_excel_file.\n\n    TYPES:\n      \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Delimitadores numeros decimais&lt;/p&gt;\n      BEGIN OF ts_number_delimiters,\n        thousand TYPE char01,\n        decimal  TYPE char01,\n      END OF ts_number_delimiters.\n\n\n    CONSTANTS:\n      \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Express\u00e3o regular numero inteiro&lt;/p&gt;\n      co_int_pattern      TYPE string VALUE `^\\d+$` ##NO_TEXT,\n      \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Express\u00e3o regular numero decimal&lt;/p&gt;\n      co_decimals_pattern TYPE string VALUE `^[+-]?(\\d+\\D\\d+)$` ##NO_TEXT,\n      \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Express\u00e3o regular numero decimal com delimitador mil.&lt;/p&gt;\n      co_thd_dec_pattern  TYPE string VALUE `^[+-]?((\\d+(\\T?\\d+)*)(\\D\\d+)?)$` ##NO_TEXT.\n\n\n    \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Upload de ficheiro local (EXCEL)&lt;/p&gt;\n    METHODS upload_local_excel IMPORTING iv_filename       TYPE string OPTIONAL\n                                         iv_open_dialog    TYPE abap_bool DEFAULT space\n                                         iv_worksheet_name TYPE string OPTIONAL\n                               EXPORTING er_excel_data     TYPE REF TO data\n                               RAISING   zcx_u_excel_file\n                                         cx_fdt_excel_core.\n\n    \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Download de tabela a ficheiro local (EXCEL)&lt;/p&gt;\n    CLASS-METHODS download_itab_local_excel IMPORTING iv_filename TYPE string\n                                                      it_table    TYPE REF TO data\n                                            RAISING   zcx_u_excel_file.\n\n    \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Converter formato data externa a interno SAP&lt;/p&gt;\n    CLASS-METHODS format_date IMPORTING iv_date_ext    TYPE clike\n                              RETURNING VALUE(rv_date) TYPE datum.\n\n    \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Converter formato decimal externo a interno SAP&lt;/p&gt;\n    CLASS-METHODS format_number_dec IMPORTING iv_value_ext         TYPE clike\n                                    RETURNING VALUE(rv_value_user) TYPE string.\n\n\n  PROTECTED SECTION.\n\n    \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Atributos do ficheiro EXCEL&lt;/p&gt;\n    DATA ms_excel_file TYPE ts_excel_file .\n\n    \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Controlo da POP-UP para sele\u00e7\u00e3o de ficheiro local&lt;/p&gt;\n    METHODS handle_frontend IMPORTING iv_filename    TYPE string\n                                      iv_open_dialog TYPE abap_bool\n                            RAISING   zcx_u_excel_file.\n\n    \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Defini\u00e7\u00e3o dos dados em formato de EXCEL&lt;/p&gt;\n    METHODS set_excel_data IMPORTING iv_worksheet_name TYPE string\n                           EXPORTING er_excel_data     TYPE REF TO data\n                           RAISING   zcx_u_excel_file\n                                     cx_fdt_excel_core.\n\n    \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Constru\u00e7\u00e3o do EXCEL (download)&lt;/p&gt;\n    CLASS-METHODS build_excel_xdata IMPORTING it_table TYPE REF TO data\n                                    EXPORTING ev_xdata TYPE xstring\n                                    RAISING   zcx_u_excel_file.\n\n    \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Exportar tabela download (POP-UP)&lt;/p&gt;\n    CLASS-METHODS export_local IMPORTING iv_filename TYPE string\n                                         iv_xdata    TYPE xstring\n                               RAISING   zcx_u_excel_file.\n\n    \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;F\u00f3rmula de convers\u00e3o de numero a data&lt;/p&gt;\n    CLASS-METHODS convert_date_numb_to_internal IMPORTING iv_date_ext              TYPE clike\n                                                EXPORTING ev_date                  TYPE datum\n                                                RETURNING VALUE(rv_date_is_number) TYPE abap_bool.\n\n    \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Convers\u00e3o data formato externo ao formato de user&lt;/p&gt;\n    CLASS-METHODS conv_date_user_format IMPORTING iv_date_ext         TYPE clike\n                                        RETURNING VALUE(rv_date_user) TYPE string.\n\n    \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Extrai o formato decimal externo&lt;/p&gt;\n    CLASS-METHODS extract_number_format IMPORTING iv_value_ext            TYPE clike\n                                        RETURNING VALUE(rs_number_format) TYPE ts_number_delimiters.\n\n    \"! &lt;p class=\"shorttext synchronized\" lang=\"pt\"&gt;Valida\u00e7\u00e3o de padr\u00f5es de formatos de um decimal&lt;/p&gt;\n    CLASS-METHODS check_pattern IMPORTING iv_value_ext TYPE clike\n                                          iv_pattern   TYPE string\n                                RETURNING VALUE(rv_ok) TYPE abap_bool .\n\n\n  PRIVATE SECTION.\n\n\nENDCLASS.\n\n\n\nCLASS zcl_util_excel IMPLEMENTATION.\n\n\n* &lt;SIGNATURE&gt;---------------------------------------------------------------------------------------+\n* | Static Protected Method ZCL_UTIL_EXCEL=&gt;BUILD_EXCEL_XDATA\n* +-------------------------------------------------------------------------------------------------+\n* | [---&gt;] IT_TABLE                       TYPE REF TO DATA\n* | [&lt;---] EV_XDATA                       TYPE        XSTRING\n* | [!CX!] ZCX_U_EXCEL_FILE\n* +--------------------------------------------------------------------------------------&lt;/SIGNATURE&gt;\n  METHOD build_excel_xdata.\n\n    CLEAR ev_xdata.\n\n    GET REFERENCE OF it_table-&gt;* INTO DATA(lr_excel_struct).\n    DATA(lo_table_desc) = CAST cl_abap_tabledescr( cl_abap_tabledescr=&gt;describe_by_data_ref( lr_excel_struct ) ).\n    DATA(lo_row_desc) = CAST cl_abap_structdescr( lo_table_desc-&gt;get_table_line_type( ) ).\n    DATA(lt_fields) = lo_row_desc-&gt;get_ddic_field_list( p_langu = sy-langu ).\n\n    TRY.\n        DATA(lo_tool_xls) = cl_salv_export_tool_ats_xls=&gt;create_for_excel( r_data = lr_excel_struct ).\n\n        DATA(lo_config) = lo_tool_xls-&gt;configuration( ).\n        LOOP AT lt_fields ASSIGNING FIELD-SYMBOL(&lt;ls_field&gt;) .\n          lo_config-&gt;add_column( header_text = CONV string( &lt;ls_field&gt;-scrtext_l )\n                                 field_name = CONV string( &lt;ls_field&gt;-fieldname )\n                                 display_type = if_salv_bs_model_column=&gt;uie_text_view ).\n        ENDLOOP.\n\n        lo_tool_xls-&gt;read_result( IMPORTING content = ev_xdata ).\n\n      CATCH cx_salv_ill_export_format_path cx_salv_export_error cx_salv_not_index_table INTO DATA(lx).\n        DATA(lv_msg) = lx-&gt;get_text( ). \" only for debug\n        RAISE EXCEPTION TYPE zcx_u_excel_file\n          EXPORTING\n            textid = zcx_u_excel_file=&gt;cx_create_excel_itab.\n    ENDTRY.\n\n  ENDMETHOD.\n\n\n* &lt;SIGNATURE&gt;---------------------------------------------------------------------------------------+\n* | Static Protected Method ZCL_UTIL_EXCEL=&gt;CHECK_PATTERN\n* +-------------------------------------------------------------------------------------------------+\n* | [---&gt;] IV_VALUE_EXT                   TYPE        CLIKE\n* | [---&gt;] IV_PATTERN                     TYPE        STRING\n* | [&lt;-()] RV_OK                          TYPE        ABAP_BOOL\n* +--------------------------------------------------------------------------------------&lt;/SIGNATURE&gt;\n  METHOD check_pattern.\n\n    rv_ok = abap_false.\n    TRY.\n        IF cl_abap_matcher=&gt;create_pcre( pattern = iv_pattern text = iv_value_ext )-&gt;match( ) EQ abap_true.\n          rv_ok = abap_true.\n        ENDIF.\n\n      CATCH cx_sy_regex cx_sy_matcher INTO DATA(lx).\n        DATA(lv_msg) = lx-&gt;get_text( ). \" only for debug\n    ENDTRY.\n\n  ENDMETHOD.\n\n\n* &lt;SIGNATURE&gt;---------------------------------------------------------------------------------------+\n* | Static Protected Method ZCL_UTIL_EXCEL=&gt;CONVERT_DATE_NUMB_TO_INTERNAL\n* +-------------------------------------------------------------------------------------------------+\n* | [---&gt;] IV_DATE_EXT                    TYPE        CLIKE\n* | [&lt;---] EV_DATE                        TYPE        DATUM\n* | [&lt;-()] RV_DATE_IS_NUMBER              TYPE        ABAP_BOOL\n* +--------------------------------------------------------------------------------------&lt;/SIGNATURE&gt;\n  METHOD convert_date_numb_to_internal.\n\n    CLEAR: ev_date.\n    rv_date_is_number = abap_false.\n\n    TRY.\n        IF cl_abap_matcher=&gt;create_pcre( pattern = co_int_pattern text = iv_date_ext )-&gt;match( ) EQ abap_true.\n\n          ev_date = '19000101'. \" initial date in excel\n*---------------------------------------------------------------------\n* subtract 2 because 01.01.19000 counts as a day and it count the\n* 29.02.1900 that does not exist\n          ev_date = ( ev_date + ( iv_date_ext DIV 1 ) ) - 2.\n*---------------------------------------------------------------------\n          rv_date_is_number = abap_true.\n        ENDIF.\n\n      CATCH cx_sy_regex cx_sy_matcher INTO DATA(lx).\n        DATA(lv_msg) = lx-&gt;get_text( ). \" only for debug\n    ENDTRY.\n\n  ENDMETHOD.\n\n\n* &lt;SIGNATURE&gt;---------------------------------------------------------------------------------------+\n* | Static Protected Method ZCL_UTIL_EXCEL=&gt;CONV_DATE_USER_FORMAT\n* +-------------------------------------------------------------------------------------------------+\n* | [---&gt;] IV_DATE_EXT                    TYPE        CLIKE\n* | [&lt;-()] RV_DATE_USER                   TYPE        STRING\n* +--------------------------------------------------------------------------------------&lt;/SIGNATURE&gt;\n  METHOD conv_date_user_format.\n\n    DATA: lv_datfm TYPE usr01-datfm.\n\n    CLEAR rv_date_user.\n    CHECK iv_date_ext IS NOT INITIAL.\n\n    DATA(lv_date_ext) = iv_date_ext.\n\n    \" user date format\n    SELECT SINGLE datfm FROM usr01\n      INTO lv_datfm WHERE bname = sy-uname.\n\n    DATA(lv_date_separator) = SWITCH #( lv_datfm WHEN 1 OR 4 THEN |.|\n                                                 WHEN 2 OR 5 THEN |/|\n                                                 WHEN 3 OR 6 THEN |-| ).\n\n    IF find_any_not_of( val = lv_date_ext sub = '0123456789' occ = 1 ) = 4 AND ( lv_datfm = 1 OR lv_datfm = 2 OR lv_datfm = 3 ).\n\n      lv_date_ext = lv_date_ext+8(2) &amp;&amp; lv_date_separator &amp;&amp; lv_date_ext+5(2)  &amp;&amp; lv_date_separator &amp;&amp; lv_date_ext(4).\n\n    ENDIF.\n\n    rv_date_user = SWITCH #( lv_datfm WHEN 1 OR 2 OR 3 \" DD.MM.YYYY or MM/DD/YYYY or MM-DD-YYYY\n                                      THEN |{ lv_date_ext(2) }{ lv_date_separator }{ lv_date_ext+3(2) }{ lv_date_separator }{ lv_date_ext+6(4) }|\n                                      WHEN 4 OR 5 OR 6 \" YYYY.MM.DD or YYYY/MM/DD or YYYY-MM-DD\n                                      THEN |{ lv_date_ext(4) }{ lv_date_separator }{ lv_date_ext+5(2) }{ lv_date_separator }{ lv_date_ext+8(2) }| ).\n\n  ENDMETHOD.\n\n\n* &lt;SIGNATURE&gt;---------------------------------------------------------------------------------------+\n* | Static Public Method ZCL_UTIL_EXCEL=&gt;DOWNLOAD_ITAB_LOCAL_EXCEL\n* +-------------------------------------------------------------------------------------------------+\n* | [---&gt;] IV_FILENAME                    TYPE        STRING\n* | [---&gt;] IT_TABLE                       TYPE REF TO DATA\n* | [!CX!] ZCX_U_EXCEL_FILE\n* +--------------------------------------------------------------------------------------&lt;/SIGNATURE&gt;\n  METHOD download_itab_local_excel.\n\n    TRY.\n        build_excel_xdata( EXPORTING it_table = it_table IMPORTING ev_xdata = DATA(lv_xdata) ).\n        export_local( iv_filename = iv_filename iv_xdata = lv_xdata ).\n\n      CATCH zcx_u_excel_file INTO DATA(lx).\n        RAISE EXCEPTION lx.\n    ENDTRY.\n\n  ENDMETHOD.\n\n\n* &lt;SIGNATURE&gt;---------------------------------------------------------------------------------------+\n* | Static Protected Method ZCL_UTIL_EXCEL=&gt;EXPORT_LOCAL\n* +-------------------------------------------------------------------------------------------------+\n* | [---&gt;] IV_FILENAME                    TYPE        STRING\n* | [---&gt;] IV_XDATA                       TYPE        XSTRING\n* | [!CX!] ZCX_U_EXCEL_FILE\n* +--------------------------------------------------------------------------------------&lt;/SIGNATURE&gt;\n  METHOD export_local.\n\n    CHECK iv_xdata IS NOT INITIAL.\n\n    CALL FUNCTION 'XML_EXPORT_DIALOG'\n      EXPORTING\n        i_xml                      = iv_xdata\n        i_default_extension        = 'XLSX'\n        i_initial_directory        = ''\n        i_default_file_name        = iv_filename\n        i_mask                     = 'Excel (*.XLSX)|*.XLSX' ##NO_TEXT\n        i_application              = ''\n      EXCEPTIONS\n        application_not_executable = 1\n        others                     = 2.\n\n    IF sy-subrc NE 0.\n      RAISE EXCEPTION TYPE zcx_u_excel_file MESSAGE ID sy-msgid TYPE 'E' NUMBER sy-msgno\n        WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.\n    ENDIF.\n\n  ENDMETHOD.\n\n\n* &lt;SIGNATURE&gt;---------------------------------------------------------------------------------------+\n* | Static Protected Method ZCL_UTIL_EXCEL=&gt;EXTRACT_NUMBER_FORMAT\n* +-------------------------------------------------------------------------------------------------+\n* | [---&gt;] IV_VALUE_EXT                   TYPE        CLIKE\n* | [&lt;-()] RS_NUMBER_FORMAT               TYPE        TS_NUMBER_DELIMITERS\n* +--------------------------------------------------------------------------------------&lt;/SIGNATURE&gt;\n  METHOD extract_number_format.\n    CLEAR rs_number_format.\n\n    \" format only with decimals 1.23\n    IF check_pattern( iv_value_ext = iv_value_ext iv_pattern = replace( val = co_decimals_pattern sub = 'D' with = '.' ) ) EQ abap_true.\n      rs_number_format = VALUE #( thousand = || decimal = |.| ).\n      RETURN.\n    ENDIF.\n\n    \" format only with decimals 1,23\n    IF check_pattern( iv_value_ext = iv_value_ext iv_pattern = replace( val = co_decimals_pattern sub = 'D' with = ',' ) ) EQ abap_true.\n      rs_number_format = VALUE #( thousand = || decimal = |,| ).\n      RETURN.\n    ENDIF.\n\n    \" format 1.234.567,89\n    IF check_pattern( iv_value_ext = iv_value_ext iv_pattern = replace( val = replace( val = co_thd_dec_pattern sub = 'D' with = ',' ) sub = 'T' with = '.' ) ) EQ abap_true.\n      rs_number_format = VALUE #( thousand = |.| decimal = |,| ).\n      RETURN.\n    ENDIF.\n\n    \" format 1,234,567.89\n    IF check_pattern( iv_value_ext = iv_value_ext iv_pattern = replace( val = replace( val = co_thd_dec_pattern sub = 'D' with = '.' ) sub = 'T' with = ',' ) ) EQ abap_true.\n      rs_number_format = VALUE #( thousand = |,| decimal = |.| ).\n      RETURN.\n    ENDIF.\n\n    \" format 1 234 567,89\n    IF check_pattern( iv_value_ext = iv_value_ext iv_pattern = replace( val = replace( val = co_thd_dec_pattern sub = 'D' with = ',' ) sub = 'T' with = ' ' ) ) EQ abap_true.\n      rs_number_format = VALUE #( thousand = | | decimal = |,| ).\n      RETURN.\n    ENDIF.\n\n  ENDMETHOD.\n\n\n* &lt;SIGNATURE&gt;---------------------------------------------------------------------------------------+\n* | Static Public Method ZCL_UTIL_EXCEL=&gt;FORMAT_DATE\n* +-------------------------------------------------------------------------------------------------+\n* | [---&gt;] IV_DATE_EXT                    TYPE        CLIKE\n* | [&lt;-()] RV_DATE                        TYPE        DATUM\n* +--------------------------------------------------------------------------------------&lt;/SIGNATURE&gt;\n  METHOD format_date.\n    CLEAR rv_date.\n\n    CHECK iv_date_ext IS NOT INITIAL.\n\n    IF convert_date_numb_to_internal( EXPORTING iv_date_ext = iv_date_ext IMPORTING ev_date = rv_date ) EQ abap_true.\n      RETURN.\n    ENDIF.\n\n    DATA(lv_date_ext) = conv_date_user_format( iv_date_ext ).\n    CALL FUNCTION 'CONVERT_DATE_TO_INTERNAL'\n      EXPORTING\n        date_external            = lv_date_ext\n      IMPORTING\n        date_internal            = rv_date\n      EXCEPTIONS\n        date_external_is_invalid = 1\n        others                   = 2.\n\n    IF sy-subrc &lt;&gt; 0 AND lv_date_ext IS NOT INITIAL.\n      rv_date = lv_date_ext+6(4) &amp;&amp; lv_date_ext+3(2) &amp;&amp; lv_date_ext(2).\n    ENDIF.\n\n  ENDMETHOD.\n\n\n* &lt;SIGNATURE&gt;---------------------------------------------------------------------------------------+\n* | Static Public Method ZCL_UTIL_EXCEL=&gt;FORMAT_NUMBER_DEC\n* +-------------------------------------------------------------------------------------------------+\n* | [---&gt;] IV_VALUE_EXT                   TYPE        CLIKE\n* | [&lt;-()] RV_VALUE_USER                  TYPE        STRING\n* +--------------------------------------------------------------------------------------&lt;/SIGNATURE&gt;\n  METHOD format_number_dec.\n\n    CLEAR rv_value_user.\n\n    IF iv_value_ext CS 'E'.\n      DATA lv_char_field TYPE cha_class_view-sollwert.\n\n      CALL FUNCTION 'QSS0_FLTP_TO_CHAR_CONVERSION'\n        EXPORTING\n          i_number_of_digits = 10\n          i_fltp_value       = CONV cha_class_data-sollwert( iv_value_ext )\n        IMPORTING\n          e_char_field       = lv_char_field.\n\n      rv_value_user = lv_char_field.\n      CONDENSE rv_value_user NO-GAPS.\n    ENDIF.\n\n    DATA(ls_format) = extract_number_format( COND #( WHEN rv_value_user IS NOT INITIAL THEN rv_value_user ELSE iv_value_ext ) ).\n    rv_value_user = COND #( WHEN rv_value_user IS NOT INITIAL THEN rv_value_user ELSE iv_value_ext ).\n\n    TRANSLATE: rv_value_user USING |{ ls_format-thousand } |,\n               rv_value_user USING |{ ls_format-decimal }.|.\n\n    CONDENSE rv_value_user NO-GAPS.\n\n  ENDMETHOD.\n\n\n* &lt;SIGNATURE&gt;---------------------------------------------------------------------------------------+\n* | Instance Protected Method ZCL_UTIL_EXCEL-&gt;HANDLE_FRONTEND\n* +-------------------------------------------------------------------------------------------------+\n* | [---&gt;] IV_FILENAME                    TYPE        STRING\n* | [---&gt;] IV_OPEN_DIALOG                 TYPE        ABAP_BOOL\n* | [!CX!] ZCX_U_EXCEL_FILE\n* +--------------------------------------------------------------------------------------&lt;/SIGNATURE&gt;\n  METHOD handle_frontend.\n\n    DATA: lv_rc        TYPE i,\n          lv_file_size TYPE i.\n\n    DATA: lt_file TYPE filetable.\n\n    CLEAR ms_excel_file.\n    ms_excel_file-name = iv_filename.\n\n    IF iv_open_dialog EQ abap_true.\n      CLEAR ms_excel_file-name.\n      cl_gui_frontend_services=&gt;file_open_dialog( EXPORTING  file_filter             = |xls (*.xlsx)\\|*.xlsx\\|{ cl_gui_frontend_services=&gt;filetype_all }|\n                                                  CHANGING   file_table              = lt_file\n                                                             rc                      = lv_rc\n                                                  EXCEPTIONS file_open_dialog_failed = 1\n                                                             cntl_error              = 2\n                                                             error_no_gui            = 3\n                                                             not_supported_by_gui    = 4\n                                                             others                  = 5 ).\n      IF sy-subrc &lt;&gt; 0.\n        RAISE EXCEPTION TYPE zcx_u_excel_file MESSAGE ID sy-msgid TYPE 'E' NUMBER sy-msgno\n            WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.\n      ENDIF.\n\n      IF lt_file IS INITIAL.\n        RAISE EXCEPTION TYPE zcx_u_excel_file\n          EXPORTING\n            textid = zcx_u_excel_file=&gt;cx_no_file_selected.\n      ENDIF.\n\n      ms_excel_file-name = lt_file[ 1 ]-filename.\n    ENDIF.\n\n    cl_gui_frontend_services=&gt;gui_upload( EXPORTING filename   = CONV #( ms_excel_file-name )\n                                                    filetype   = 'BIN'\n                                          IMPORTING filelength = ms_excel_file-size\n                                          CHANGING  data_tab   = ms_excel_file-xdata\n                                          EXCEPTIONS file_open_error         = 1\n                                                     file_read_error         = 2\n                                                     no_batch                = 3\n                                                     gui_refuse_filetransfer = 4\n                                                     invalid_type            = 5\n                                                     no_authority            = 6\n                                                     unknown_error           = 7\n                                                     bad_data_format         = 8\n                                                     header_not_allowed      = 9\n                                                     separator_not_allowed   = 10\n                                                     header_too_long         = 11\n                                                     unknown_dp_error        = 12\n                                                     access_denied           = 13\n                                                     dp_out_of_memory        = 14\n                                                     disk_full               = 15\n                                                     dp_timeout              = 16\n                                                     not_supported_by_gui    = 17\n                                                     error_no_gui            = 18\n                                                     others                  = 19 ).\n\n    IF sy-subrc NE 0.\n      RAISE EXCEPTION TYPE zcx_u_excel_file MESSAGE ID sy-msgid TYPE 'E' NUMBER sy-msgno\n        WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.\n    ENDIF.\n\n  ENDMETHOD.\n\n\n* &lt;SIGNATURE&gt;---------------------------------------------------------------------------------------+\n* | Instance Protected Method ZCL_UTIL_EXCEL-&gt;SET_EXCEL_DATA\n* +-------------------------------------------------------------------------------------------------+\n* | [---&gt;] IV_WORKSHEET_NAME              TYPE        STRING\n* | [&lt;---] ER_EXCEL_DATA                  TYPE REF TO DATA\n* | [!CX!] ZCX_U_EXCEL_FILE\n* | [!CX!] CX_FDT_EXCEL_CORE\n* +--------------------------------------------------------------------------------------&lt;/SIGNATURE&gt;\n  METHOD set_excel_data.\n\n    CLEAR er_excel_data.\n    TRY.\n        DATA(lo_excel) = NEW cl_fdt_xl_spreadsheet( document_name = CONV #( ms_excel_file-name )\n                                                    xdocument     = cl_bcs_convert=&gt;solix_to_xstring( it_solix = ms_excel_file-xdata ) ).\n\n        lo_excel-&gt;if_fdt_doc_spreadsheet~get_worksheet_names( IMPORTING worksheet_names = DATA(lt_worksheet_names) ).\n\n        DATA(lv_worksheet) = COND i( WHEN iv_worksheet_name IS NOT INITIAL THEN line_index( lt_worksheet_names[ table_line = iv_worksheet_name ] )\n                                                                           ELSE 1 ).\n\n        IF lv_worksheet EQ 0.\n          RAISE EXCEPTION TYPE zcx_u_excel_file\n            EXPORTING\n              textid = zcx_u_excel_file=&gt;cx_no_worksheet\n              msgv1  = CONV #( iv_worksheet_name ).\n        ENDIF.\n\n        er_excel_data = lo_excel-&gt;if_fdt_doc_spreadsheet~get_itab_from_worksheet( lt_worksheet_names[ lv_worksheet ] ).\n\n\n      CATCH cx_fdt_excel_core INTO DATA(lx).\n        RAISE EXCEPTION lx.\n    ENDTRY.\n\n  ENDMETHOD.\n\n\n* &lt;SIGNATURE&gt;---------------------------------------------------------------------------------------+\n* | Instance Public Method ZCL_UTIL_EXCEL-&gt;UPLOAD_LOCAL_EXCEL\n* +-------------------------------------------------------------------------------------------------+\n* | [---&gt;] IV_FILENAME                    TYPE        STRING(optional)\n* | [---&gt;] IV_OPEN_DIALOG                 TYPE        ABAP_BOOL (default =SPACE)\n* | [---&gt;] IV_WORKSHEET_NAME              TYPE        STRING(optional)\n* | [&lt;---] ER_EXCEL_DATA                  TYPE REF TO DATA\n* | [!CX!] ZCX_U_EXCEL_FILE\n* | [!CX!] CX_FDT_EXCEL_CORE\n* +--------------------------------------------------------------------------------------&lt;/SIGNATURE&gt;\n  METHOD upload_local_excel.\n\n    CLEAR er_excel_data.\n\n    handle_frontend( iv_filename    = iv_filename\n                     iv_open_dialog = iv_open_dialog ).\n\n    set_excel_data( EXPORTING iv_worksheet_name = iv_worksheet_name\n                    IMPORTING er_excel_data     = er_excel_data ).\n\n  ENDMETHOD.\nENDCLASS.\n</code></pre>"},{"location":"meus_programas/ZCL_UTIL_EXCEL_Documentacao/#codigo-completo-da-classe-de-excecao","title":"\ud83d\udd34 C\u00f3digo Completo da Classe de Exce\u00e7\u00e3o","text":"Clique para expandir o c\u00f3digo completo de ZCX_U_EXCEL_FILE <pre><code>CLASS zcx_u_excel_file DEFINITION\n  PUBLIC\n  INHERITING FROM cx_static_check\n  FINAL\n  CREATE PUBLIC .\n\n  PUBLIC SECTION.\n\n    INTERFACES if_t100_message .\n    INTERFACES if_t100_dyn_msg .\n\n    CONSTANTS:\n      BEGIN OF zcx_u_excel_file,\n        msgid TYPE symsgid VALUE 'ZEXCEL',\n        msgno TYPE symsgno VALUE '000',\n        attr1 TYPE scx_attrname VALUE '',\n        attr2 TYPE scx_attrname VALUE '',\n        attr3 TYPE scx_attrname VALUE '',\n        attr4 TYPE scx_attrname VALUE '',\n      END OF zcx_u_excel_file .\n    CONSTANTS:\n      BEGIN OF cx_create_excel_itab,\n        msgid TYPE symsgid VALUE 'ZEXCEL',\n        msgno TYPE symsgno VALUE '001',\n        attr1 TYPE scx_attrname VALUE '',\n        attr2 TYPE scx_attrname VALUE '',\n        attr3 TYPE scx_attrname VALUE '',\n        attr4 TYPE scx_attrname VALUE '',\n      END OF cx_create_excel_itab .\n    CONSTANTS:\n      BEGIN OF cx_no_file_selected,\n        msgid TYPE symsgid VALUE 'ZEXCEL',\n        msgno TYPE symsgno VALUE '002',\n        attr1 TYPE scx_attrname VALUE '',\n        attr2 TYPE scx_attrname VALUE '',\n        attr3 TYPE scx_attrname VALUE '',\n        attr4 TYPE scx_attrname VALUE '',\n      END OF cx_no_file_selected .\n    CONSTANTS:\n      BEGIN OF cx_no_worksheet,\n        msgid TYPE symsgid VALUE 'ZEXCEL',\n        msgno TYPE symsgno VALUE '003',\n        attr1 TYPE scx_attrname VALUE 'MSGV1',\n        attr2 TYPE scx_attrname VALUE '',\n        attr3 TYPE scx_attrname VALUE '',\n        attr4 TYPE scx_attrname VALUE '',\n      END OF cx_no_worksheet .\n    DATA msgv1 TYPE string .\n\n    METHODS constructor\n      IMPORTING\n        !textid   LIKE if_t100_message=&gt;t100key OPTIONAL\n        !previous LIKE previous OPTIONAL\n        !msgv1    TYPE string OPTIONAL .\n  PROTECTED SECTION.\n  PRIVATE SECTION.\nENDCLASS.\n\n\n\nCLASS zcx_u_excel_file IMPLEMENTATION.\n\n\n* &lt;SIGNATURE&gt;---------------------------------------------------------------------------------------+\n* | Instance Public Method ZCX_U_EXCEL_FILE-&gt;CONSTRUCTOR\n* +-------------------------------------------------------------------------------------------------+\n* | [---&gt;] TEXTID                         LIKE        IF_T100_MESSAGE=&gt;T100KEY(optional)\n* | [---&gt;] PREVIOUS                       LIKE        PREVIOUS(optional)\n* | [---&gt;] MSGV1                          TYPE        STRING(optional)\n* +--------------------------------------------------------------------------------------&lt;/SIGNATURE&gt;\n  METHOD constructor ##ADT_SUPPRESS_GENERATION.\n    CALL METHOD super-&gt;constructor\n      EXPORTING\n        previous = previous.\n    me-&gt;msgv1 = msgv1 .\n    CLEAR me-&gt;textid.\n    IF textid IS INITIAL.\n      if_t100_message~t100key = zcx_u_excel_file .\n    ELSE.\n      if_t100_message~t100key = textid.\n    ENDIF.\n  ENDMETHOD.\nENDCLASS.\n</code></pre>  **Nota:** Ap\u00f3s criar a classe, \u00e9 necess\u00e1rio criar as mensagens na SE91: - Classe de Mensagens: `ZEXCEL` - Mensagem 001: \"Erro ao criar ficheiro Excel a partir de tabela interna\" - Mensagem 002: \"Nenhum ficheiro foi selecionado\" - Mensagem 003: \"Worksheet '&amp;1' n\u00e3o encontrado\"   <p>Fim da Documenta\u00e7\u00e3o</p>"},{"location":"objetos/","title":"\ud83e\uddf1 Programa\u00e7\u00e3o Orientada a Objetos (OO)","text":"<p>Introdu\u00e7\u00e3o \u00e0 programa\u00e7\u00e3o orientada a objetos em ABAP: classes, m\u00e9todos, interfaces, heran\u00e7a e padr\u00f5es de design.</p>"},{"location":"objetos/#o-que-vais-aprender","title":"\ud83d\udcd6 O que vais aprender","text":"<ul> <li>Criar classes e objetos</li> <li>Definir e implementar m\u00e9todos</li> <li>Atributos p\u00fablicos, protegidos e privados</li> <li>Construtores (CONSTRUCTOR)</li> <li>Interfaces e polimorfismo</li> <li>Heran\u00e7a e redefini\u00e7\u00e3o de m\u00e9todos</li> <li>Padr\u00f5es de design (Singleton, Factory, etc.)</li> <li>Eventos e tratadores</li> </ul>"},{"location":"objetos/#ordem-de-aprendizagem","title":"\ud83c\udfaf Ordem de Aprendizagem","text":""},{"location":"objetos/#1-classes-e-objetos","title":"1\ufe0f\u20e3 Classes e Objetos","text":"<p>Como definir e usar classes locais e globais.</p> <p>Exemplo simples: <pre><code>CLASS lcl_calculadora DEFINITION.\n  PUBLIC SECTION.\n    METHODS: somar IMPORTING iv_a TYPE i iv_b TYPE i \n                   RETURNING VALUE(rv_result) TYPE i.\nENDCLASS.\n\nCLASS lcl_calculadora IMPLEMENTATION.\n  METHOD somar.\n    rv_result = iv_a + iv_b.\n  ENDMETHOD.\nENDCLASS.\n\nSTART-OF-SELECTION.\n  DATA(lo_calc) = NEW lcl_calculadora( ).\n  DATA(lv_soma) = lo_calc-&gt;somar( iv_a = 10 iv_b = 20 ).\n  WRITE: / |Resultado: { lv_soma }|.\n</code></pre></p>"},{"location":"objetos/#2-atributos-e-metodos","title":"2\ufe0f\u20e3 Atributos e M\u00e9todos","text":"<p>Controlar acesso aos dados da classe e definir comportamentos.</p>"},{"location":"objetos/#3-construtores","title":"3\ufe0f\u20e3 Construtores","text":"<p>Inicializar objetos com <code>CONSTRUCTOR</code>.</p>"},{"location":"objetos/#4-interfaces","title":"4\ufe0f\u20e3 Interfaces","text":"<p>Definir contratos que classes devem implementar.</p>"},{"location":"objetos/#5-heranca","title":"5\ufe0f\u20e3 Heran\u00e7a","text":"<p>Reutilizar c\u00f3digo atrav\u00e9s de <code>INHERITING FROM</code>.</p>"},{"location":"objetos/#6-polimorfismo","title":"6\ufe0f\u20e3 Polimorfismo","text":"<p>Tratar objetos diferentes atrav\u00e9s da mesma interface.</p>"},{"location":"objetos/#7-factory-pattern","title":"7\ufe0f\u20e3 Factory Pattern","text":"<p>Padr\u00e3o de cria\u00e7\u00e3o de objetos.</p>"},{"location":"objetos/#8-singleton-pattern","title":"8\ufe0f\u20e3 Singleton Pattern","text":"<p>Garantir uma \u00fanica inst\u00e2ncia de uma classe.</p>"},{"location":"objetos/#conceitos-importantes","title":"\ud83e\udde0 Conceitos Importantes","text":""},{"location":"objetos/#visibilidade-de-atributos","title":"Visibilidade de Atributos","text":"Se\u00e7\u00e3o Acesso <code>PUBLIC SECTION</code> Acess\u00edvel de qualquer lugar <code>PROTECTED SECTION</code> Acess\u00edvel na classe e subclasses <code>PRIVATE SECTION</code> Apenas dentro da classe"},{"location":"objetos/#criar-classes-globais-vs-locais","title":"Criar Classes Globais vs. Locais","text":"<ul> <li>Globais: SE24 / SE80 \u2192 reutiliz\u00e1veis em todo o sistema</li> <li>Locais: dentro do programa \u2192 escopo limitado</li> </ul>"},{"location":"objetos/#exemplo-com-interface","title":"\ud83d\udca1 Exemplo com Interface","text":"<pre><code>INTERFACE lif_forma.\n  METHODS calcular_area RETURNING VALUE(rv_area) TYPE f.\nENDINTERFACE.\n\nCLASS lcl_circulo DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_forma.\n    METHODS constructor IMPORTING iv_raio TYPE f.\n  PRIVATE SECTION.\n    DATA mv_raio TYPE f.\nENDCLASS.\n\nCLASS lcl_circulo IMPLEMENTATION.\n  METHOD constructor.\n    mv_raio = iv_raio.\n  ENDMETHOD.\n\n  METHOD lif_forma~calcular_area.\n    CONSTANTS lc_pi TYPE f VALUE '3.14159'.\n    rv_area = lc_pi * mv_raio * mv_raio.\n  ENDMETHOD.\nENDCLASS.\n\nSTART-OF-SELECTION.\n  DATA(lo_circulo) = NEW lcl_circulo( iv_raio = 5 ).\n  DATA(lv_area) = lo_circulo-&gt;lif_forma~calcular_area( ).\n  WRITE: / |\u00c1rea do c\u00edrculo: { lv_area }|.\n</code></pre>"},{"location":"objetos/#proximos-passos","title":"\ud83d\ude80 Pr\u00f3ximos Passos","text":"<ol> <li>Comece por Classes e Objetos</li> <li>Continue com Atributos e M\u00e9todos</li> <li>Aprenda sobre Construtores</li> <li>Explore padr\u00f5es de design em projetos reais</li> <li>Avance para ALV OO para aplicar OO em interfaces</li> </ol> <p>Tags: <code>#OO</code> <code>#Classes</code> <code>#ABAP</code> <code>#Programa\u00e7\u00e3o-Orientada-Objetos</code></p>"},{"location":"objetos/1_classes_objetos/","title":"Classes e Objetos em ABAP","text":"<p>A Programa\u00e7\u00e3o Orientada a Objetos (OOP) permite criar c\u00f3digo mais modular, reutiliz\u00e1vel e f\u00e1cil de manter.</p>","tags":["ABAP","OO","Classes","Objetos","Programa\u00e7\u00e3o"]},{"location":"objetos/1_classes_objetos/#o-que-e-uma-classe","title":"\ud83d\udd39 O que \u00e9 uma Classe?","text":"<p>Uma classe \u00e9 um modelo (template) que define: - Atributos (dados/vari\u00e1veis) - M\u00e9todos (comportamentos/fun\u00e7\u00f5es)</p> <p>Um objeto \u00e9 uma inst\u00e2ncia (exemplar) de uma classe.</p>","tags":["ABAP","OO","Classes","Objetos","Programa\u00e7\u00e3o"]},{"location":"objetos/1_classes_objetos/#estrutura-de-uma-classe","title":"\ud83d\udd39 Estrutura de uma Classe","text":"<pre><code>CLASS lcl_pessoa DEFINITION.\n  PUBLIC SECTION.\n    \" Atributos p\u00fablicos\n    DATA: mv_nome  TYPE string,\n          mv_idade TYPE i.\n\n    \" M\u00e9todos p\u00fablicos\n    METHODS: \n      set_nome IMPORTING iv_nome TYPE string,\n      get_nome RETURNING VALUE(rv_nome) TYPE string,\n      apresentar.\n\n  PRIVATE SECTION.\n    \" Atributos privados\n    DATA: mv_saldo TYPE p DECIMALS 2.\n\n    \" M\u00e9todos privados\n    METHODS: calcular_bonus RETURNING VALUE(rv_bonus) TYPE p DECIMALS 2.\nENDCLASS.\n\nCLASS lcl_pessoa IMPLEMENTATION.\n  METHOD set_nome.\n    mv_nome = iv_nome.\n  ENDMETHOD.\n\n  METHOD get_nome.\n    rv_nome = mv_nome.\n  ENDMETHOD.\n\n  METHOD apresentar.\n    WRITE: / |Ol\u00e1, eu sou { mv_nome } e tenho { mv_idade } anos.|.\n  ENDMETHOD.\n\n  METHOD calcular_bonus.\n    rv_bonus = mv_saldo * '0.10'.\n  ENDMETHOD.\nENDCLASS.\n</code></pre>","tags":["ABAP","OO","Classes","Objetos","Programa\u00e7\u00e3o"]},{"location":"objetos/1_classes_objetos/#criar-e-usar-objetos","title":"\ud83d\udd39 Criar e Usar Objetos","text":"<pre><code>REPORT z_oo_exemplo.\n\n\" 1. Definir a classe (acima)\n\nSTART-OF-SELECTION.\n\n  \" 2. Declarar refer\u00eancia ao objeto\n  DATA: lo_pessoa TYPE REF TO lcl_pessoa.\n\n  \" 3. Criar inst\u00e2ncia (objeto)\n  CREATE OBJECT lo_pessoa.\n\n  \" 4. Usar o objeto\n  lo_pessoa-&gt;set_nome( 'Bruno' ).\n  lo_pessoa-&gt;mv_idade = 25.\n  lo_pessoa-&gt;apresentar( ).\n\n  \" 5. Verificar se objeto existe\n  IF lo_pessoa IS BOUND.\n    WRITE: / 'Objeto existe e est\u00e1 ativo'.\n  ENDIF.\n</code></pre> <p>Sa\u00edda: <pre><code>Ol\u00e1, eu sou Bruno e tenho 25 anos.\nObjeto existe e est\u00e1 ativo\n</code></pre></p>","tags":["ABAP","OO","Classes","Objetos","Programa\u00e7\u00e3o"]},{"location":"objetos/1_classes_objetos/#sintaxe-moderna-new","title":"\ud83d\udd39 Sintaxe Moderna: NEW","text":"<pre><code>\" \u2705 Sintaxe moderna (ABAP 7.40+)\nDATA(lo_pessoa) = NEW lcl_pessoa( ).\nlo_pessoa-&gt;set_nome( 'Ana' ).\nlo_pessoa-&gt;mv_idade = 30.\n\n\" Inline com uso direto\nNEW lcl_pessoa( )-&gt;set_nome( 'Jo\u00e3o' )-&gt;apresentar( ).\n</code></pre>","tags":["ABAP","OO","Classes","Objetos","Programa\u00e7\u00e3o"]},{"location":"objetos/1_classes_objetos/#visibilidade-de-secoes","title":"\ud83d\udd39 Visibilidade de Se\u00e7\u00f5es","text":"Se\u00e7\u00e3o Acesso Uso PUBLIC Dentro e fora da classe Interface p\u00fablica PROTECTED Classe e subclasses Heran\u00e7a PRIVATE Apenas dentro da classe Implementa\u00e7\u00e3o interna <pre><code>CLASS lcl_conta DEFINITION.\n  PUBLIC SECTION.\n    METHODS: \n      depositar IMPORTING iv_valor TYPE p DECIMALS 2,\n      get_saldo RETURNING VALUE(rv_saldo) TYPE p DECIMALS 2.\n\n  PROTECTED SECTION.\n    DATA: mv_saldo TYPE p DECIMALS 2.\n\n  PRIVATE SECTION.\n    DATA: mv_senha TYPE string.\n    METHODS: validar_senha IMPORTING iv_senha TYPE string\n                           RETURNING VALUE(rv_ok) TYPE abap_bool.\nENDCLASS.\n\nCLASS lcl_conta IMPLEMENTATION.\n  METHOD depositar.\n    mv_saldo = mv_saldo + iv_valor.\n  ENDMETHOD.\n\n  METHOD get_saldo.\n    rv_saldo = mv_saldo.\n  ENDMETHOD.\n\n  METHOD validar_senha.\n    rv_ok = COND #( WHEN iv_senha = mv_senha THEN abap_true\n                    ELSE abap_false ).\n  ENDMETHOD.\nENDCLASS.\n</code></pre>","tags":["ABAP","OO","Classes","Objetos","Programa\u00e7\u00e3o"]},{"location":"objetos/1_classes_objetos/#classes-locais-vs-globais","title":"\ud83d\udd39 Classes Locais vs Globais","text":"","tags":["ABAP","OO","Classes","Objetos","Programa\u00e7\u00e3o"]},{"location":"objetos/1_classes_objetos/#classes-locais","title":"Classes Locais","text":"<p>Definidas dentro de um programa (report, function group, etc.).</p> <pre><code>REPORT z_classe_local.\n\n\" Defini\u00e7\u00e3o local\nCLASS lcl_calculadora DEFINITION.\n  PUBLIC SECTION.\n    CLASS-METHODS: somar IMPORTING iv_a TYPE i\n                                   iv_b TYPE i\n                         RETURNING VALUE(rv_soma) TYPE i.\nENDCLASS.\n\nCLASS lcl_calculadora IMPLEMENTATION.\n  METHOD somar.\n    rv_soma = iv_a + iv_b.\n  ENDMETHOD.\nENDCLASS.\n\nSTART-OF-SELECTION.\n  DATA(lv_resultado) = lcl_calculadora=&gt;somar( iv_a = 10 iv_b = 20 ).\n  WRITE: / lv_resultado.\n</code></pre>","tags":["ABAP","OO","Classes","Objetos","Programa\u00e7\u00e3o"]},{"location":"objetos/1_classes_objetos/#classes-globais","title":"Classes Globais","text":"<p>Criadas na SE24 ou SE80, reutiliz\u00e1veis em todo o sistema.</p> <pre><code>\" Usar classe global ZCL_UTILS\nDATA(lo_utils) = NEW zcl_utils( ).\nlo_utils-&gt;metodo_publico( ).\n</code></pre>","tags":["ABAP","OO","Classes","Objetos","Programa\u00e7\u00e3o"]},{"location":"objetos/1_classes_objetos/#metodos-de-instancia-vs-metodos-estaticos","title":"\ud83d\udd39 M\u00e9todos de Inst\u00e2ncia vs M\u00e9todos Est\u00e1ticos","text":"","tags":["ABAP","OO","Classes","Objetos","Programa\u00e7\u00e3o"]},{"location":"objetos/1_classes_objetos/#metodos-de-instancia","title":"M\u00e9todos de Inst\u00e2ncia","text":"<p>Requerem um objeto (<code>lo_obj-&gt;metodo()</code>):</p> <pre><code>CLASS lcl_contador DEFINITION.\n  PUBLIC SECTION.\n    DATA: mv_contador TYPE i.\n    METHODS: incrementar.\nENDCLASS.\n\nCLASS lcl_contador IMPLEMENTATION.\n  METHOD incrementar.\n    mv_contador = mv_contador + 1.\n  ENDMETHOD.\nENDCLASS.\n\n\" Uso\nDATA(lo_cont1) = NEW lcl_contador( ).\nlo_cont1-&gt;incrementar( ).\nlo_cont1-&gt;incrementar( ).\nWRITE: / lo_cont1-&gt;mv_contador.  \" 2\n\nDATA(lo_cont2) = NEW lcl_contador( ).\nlo_cont2-&gt;incrementar( ).\nWRITE: / lo_cont2-&gt;mv_contador.  \" 1\n</code></pre>","tags":["ABAP","OO","Classes","Objetos","Programa\u00e7\u00e3o"]},{"location":"objetos/1_classes_objetos/#metodos-estaticos-class-methods","title":"M\u00e9todos Est\u00e1ticos (CLASS-METHODS)","text":"<p>N\u00e3o requerem objeto (<code>lcl_classe=&gt;metodo()</code>):</p> <pre><code>CLASS lcl_utils DEFINITION.\n  PUBLIC SECTION.\n    CLASS-METHODS: \n      maiuscula IMPORTING iv_texto TYPE string\n                RETURNING VALUE(rv_result) TYPE string.\nENDCLASS.\n\nCLASS lcl_utils IMPLEMENTATION.\n  METHOD maiuscula.\n    rv_result = to_upper( iv_texto ).\n  ENDMETHOD.\nENDCLASS.\n\n\" Uso (sem criar objeto)\nDATA(lv_texto) = lcl_utils=&gt;maiuscula( 'ol\u00e1 mundo' ).\nWRITE: / lv_texto.  \" OL\u00c1 MUNDO\n</code></pre>","tags":["ABAP","OO","Classes","Objetos","Programa\u00e7\u00e3o"]},{"location":"objetos/1_classes_objetos/#exemplo-completo-sistema-de-biblioteca","title":"\ud83d\udd39 Exemplo Completo: Sistema de Biblioteca","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_OO_BIBLIOTECA\n*&amp;---------------------------------------------------------------------*\nREPORT z_oo_biblioteca.\n\n\" ============ DEFINI\u00c7\u00d5ES ============\nCLASS lcl_livro DEFINITION.\n  PUBLIC SECTION.\n    DATA: mv_titulo TYPE string,\n          mv_autor  TYPE string,\n          mv_isbn   TYPE string,\n          mv_disponivel TYPE abap_bool.\n\n    METHODS: \n      constructor IMPORTING iv_titulo TYPE string\n                            iv_autor  TYPE string\n                            iv_isbn   TYPE string,\n      emprestar,\n      devolver,\n      get_info RETURNING VALUE(rv_info) TYPE string.\nENDCLASS.\n\nCLASS lcl_biblioteca DEFINITION.\n  PUBLIC SECTION.\n    METHODS: \n      adicionar_livro IMPORTING io_livro TYPE REF TO lcl_livro,\n      listar_livros,\n      buscar_por_isbn IMPORTING iv_isbn TYPE string\n                      RETURNING VALUE(ro_livro) TYPE REF TO lcl_livro.\n\n  PRIVATE SECTION.\n    DATA: mt_livros TYPE TABLE OF REF TO lcl_livro.\nENDCLASS.\n\n\" ============ IMPLEMENTA\u00c7\u00d5ES ============\nCLASS lcl_livro IMPLEMENTATION.\n  METHOD constructor.\n    mv_titulo = iv_titulo.\n    mv_autor = iv_autor.\n    mv_isbn = iv_isbn.\n    mv_disponivel = abap_true.\n  ENDMETHOD.\n\n  METHOD emprestar.\n    IF mv_disponivel = abap_true.\n      mv_disponivel = abap_false.\n      WRITE: / |Livro \"{ mv_titulo }\" emprestado com sucesso.|.\n    ELSE.\n      WRITE: / |Livro \"{ mv_titulo }\" j\u00e1 est\u00e1 emprestado.|.\n    ENDIF.\n  ENDMETHOD.\n\n  METHOD devolver.\n    mv_disponivel = abap_true.\n    WRITE: / |Livro \"{ mv_titulo }\" devolvido.|.\n  ENDMETHOD.\n\n  METHOD get_info.\n    DATA(lv_status) = COND string( WHEN mv_disponivel = abap_true \n                                   THEN 'Dispon\u00edvel' \n                                   ELSE 'Emprestado' ).\n    rv_info = |{ mv_titulo } - { mv_autor } ({ lv_status })|.\n  ENDMETHOD.\nENDCLASS.\n\nCLASS lcl_biblioteca IMPLEMENTATION.\n  METHOD adicionar_livro.\n    APPEND io_livro TO mt_livros.\n    WRITE: / |Livro adicionado: { io_livro-&gt;mv_titulo }|.\n  ENDMETHOD.\n\n  METHOD listar_livros.\n    WRITE: / 'LIVROS NA BIBLIOTECA:', /.\n    ULINE.\n    LOOP AT mt_livros INTO DATA(lo_livro).\n      WRITE: / lo_livro-&gt;get_info( ).\n    ENDLOOP.\n  ENDMETHOD.\n\n  METHOD buscar_por_isbn.\n    LOOP AT mt_livros INTO DATA(lo_livro).\n      IF lo_livro-&gt;mv_isbn = iv_isbn.\n        ro_livro = lo_livro.\n        EXIT.\n      ENDIF.\n    ENDLOOP.\n  ENDMETHOD.\nENDCLASS.\n\n\" ============ PROGRAMA PRINCIPAL ============\nSTART-OF-SELECTION.\n\n  \" Criar biblioteca\n  DATA(lo_bib) = NEW lcl_biblioteca( ).\n\n  \" Adicionar livros\n  lo_bib-&gt;adicionar_livro( NEW lcl_livro( \n    iv_titulo = 'Clean Code'\n    iv_autor  = 'Robert Martin'\n    iv_isbn   = '978-0132350884'\n  ) ).\n\n  lo_bib-&gt;adicionar_livro( NEW lcl_livro( \n    iv_titulo = 'Design Patterns'\n    iv_autor  = 'Gang of Four'\n    iv_isbn   = '978-0201633610'\n  ) ).\n\n  SKIP.\n\n  \" Listar livros\n  lo_bib-&gt;listar_livros( ).\n\n  SKIP.\n\n  \" Emprestar livro\n  DATA(lo_livro) = lo_bib-&gt;buscar_por_isbn( '978-0132350884' ).\n  IF lo_livro IS BOUND.\n    lo_livro-&gt;emprestar( ).\n  ENDIF.\n\n  SKIP.\n\n  \" Listar novamente\n  lo_bib-&gt;listar_livros( ).\n</code></pre>","tags":["ABAP","OO","Classes","Objetos","Programa\u00e7\u00e3o"]},{"location":"objetos/1_classes_objetos/#boas-praticas","title":"\ud83d\udca1 Boas Pr\u00e1ticas","text":"\u2705 Fazer \u274c Evitar Usar nomes descritivos Abreviaturas confusas M\u00e9todos pequenos e focados M\u00e9todos gigantes Encapsular dados (private) Tudo p\u00fablico Usar NEW quando poss\u00edvel CREATE OBJECT desnecess\u00e1rio Verificar IS BOUND Usar objetos sem verificar","tags":["ABAP","OO","Classes","Objetos","Programa\u00e7\u00e3o"]},{"location":"objetos/1_classes_objetos/#proximo-passo","title":"\ud83d\ude80 Pr\u00f3ximo Passo","text":"<p>Aprenda sobre Atributos e M\u00e9todos em detalhe.</p>","tags":["ABAP","OO","Classes","Objetos","Programa\u00e7\u00e3o"]},{"location":"objetos/2_atributos_metodos/","title":"Atributos e M\u00e9todos","text":""},{"location":"objetos/2_atributos_metodos/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Atributos s\u00e3o as vari\u00e1veis/dados de uma classe, e m\u00e9todos s\u00e3o as fun\u00e7\u00f5es/comportamentos. Este cap\u00edtulo explora em detalhe como defini-los e us\u00e1-los.</p>"},{"location":"objetos/2_atributos_metodos/#atributos-data","title":"\ud83c\udfaf Atributos (DATA)","text":""},{"location":"objetos/2_atributos_metodos/#atributos-de-instancia","title":"Atributos de Inst\u00e2ncia","text":"<p>Cada objeto tem a sua pr\u00f3pria c\u00f3pia do atributo.</p> <pre><code>CLASS lcl_carro DEFINITION.\n  PUBLIC SECTION.\n    DATA: mv_marca  TYPE string,\n          mv_modelo TYPE string,\n          mv_ano    TYPE i,\n          mv_km     TYPE i.\nENDCLASS.\n\n\" Cada carro tem os seus pr\u00f3prios valores\nDATA(lo_carro1) = NEW lcl_carro( ).\nlo_carro1-&gt;mv_marca = 'BMW'.\nlo_carro1-&gt;mv_km = 50000.\n\nDATA(lo_carro2) = NEW lcl_carro( ).\nlo_carro2-&gt;mv_marca = 'Audi'.\nlo_carro2-&gt;mv_km = 30000.\n\n\" lo_carro1 e lo_carro2 s\u00e3o independentes\n</code></pre>"},{"location":"objetos/2_atributos_metodos/#atributos-estaticos-class-data","title":"Atributos Est\u00e1ticos (CLASS-DATA)","text":"<p>Partilhados por todos os objetos da classe.</p> <pre><code>CLASS lcl_contador DEFINITION.\n  PUBLIC SECTION.\n    CLASS-DATA: sv_total_objetos TYPE i.  \" Partilhado\n    DATA: mv_id TYPE i.                    \" Individual\n\n    METHODS: constructor.\nENDCLASS.\n\nCLASS lcl_contador IMPLEMENTATION.\n  METHOD constructor.\n    sv_total_objetos = sv_total_objetos + 1.\n    mv_id = sv_total_objetos.\n  ENDMETHOD.\nENDCLASS.\n\n\" Usar\nDATA(lo_obj1) = NEW lcl_contador( ).  \" sv_total_objetos = 1\nDATA(lo_obj2) = NEW lcl_contador( ).  \" sv_total_objetos = 2\nDATA(lo_obj3) = NEW lcl_contador( ).  \" sv_total_objetos = 3\n\nWRITE: / 'Total de objetos:', lcl_contador=&gt;sv_total_objetos.  \" 3\nWRITE: / 'ID do objeto 2:', lo_obj2-&gt;mv_id.                     \" 2\n</code></pre>"},{"location":"objetos/2_atributos_metodos/#atributos-read-only","title":"Atributos Read-Only","text":"<pre><code>CLASS lcl_produto DEFINITION.\n  PUBLIC SECTION.\n    METHODS: \n      get_preco RETURNING VALUE(rv_preco) TYPE p DECIMALS 2,\n      set_preco IMPORTING iv_preco TYPE p DECIMALS 2.\n\n  PRIVATE SECTION.\n    DATA: mv_preco TYPE p DECIMALS 2.  \" Privado = read-only de fora\nENDCLASS.\n\nCLASS lcl_produto IMPLEMENTATION.\n  METHOD get_preco.\n    rv_preco = mv_preco.\n  ENDMETHOD.\n\n  METHOD set_preco.\n    IF iv_preco &gt; 0.\n      mv_preco = iv_preco.\n    ELSE.\n      MESSAGE 'Pre\u00e7o deve ser positivo' TYPE 'E'.\n    ENDIF.\n  ENDMETHOD.\nENDCLASS.\n\n\" Uso\nDATA(lo_prod) = NEW lcl_produto( ).\nlo_prod-&gt;set_preco( '99.99' ).\nDATA(lv_preco) = lo_prod-&gt;get_preco( ).\n\" lo_prod-&gt;mv_preco = '50.00'.  \" \u274c ERRO: atributo privado\n</code></pre>"},{"location":"objetos/2_atributos_metodos/#metodos-methods","title":"\ud83d\udd27 M\u00e9todos (METHODS)","text":""},{"location":"objetos/2_atributos_metodos/#metodos-de-instancia","title":"M\u00e9todos de Inst\u00e2ncia","text":"<p>Operam sobre dados do objeto.</p> <pre><code>CLASS lcl_calculadora DEFINITION.\n  PUBLIC SECTION.\n    DATA: mv_valor TYPE i.\n\n    METHODS:\n      adicionar IMPORTING iv_num TYPE i,\n      subtrair  IMPORTING iv_num TYPE i,\n      get_resultado RETURNING VALUE(rv_result) TYPE i.\nENDCLASS.\n\nCLASS lcl_calculadora IMPLEMENTATION.\n  METHOD adicionar.\n    mv_valor = mv_valor + iv_num.\n  ENDMETHOD.\n\n  METHOD subtrair.\n    mv_valor = mv_valor - iv_num.\n  ENDMETHOD.\n\n  METHOD get_resultado.\n    rv_result = mv_valor.\n  ENDMETHOD.\nENDCLASS.\n\n\" Uso\nDATA(lo_calc) = NEW lcl_calculadora( ).\nlo_calc-&gt;adicionar( 10 ).\nlo_calc-&gt;adicionar( 5 ).\nlo_calc-&gt;subtrair( 3 ).\nWRITE: / 'Resultado:', lo_calc-&gt;get_resultado( ).  \" 12\n</code></pre>"},{"location":"objetos/2_atributos_metodos/#metodos-estaticos-class-methods","title":"M\u00e9todos Est\u00e1ticos (CLASS-METHODS)","text":"<p>N\u00e3o precisam de objeto, trabalham apenas com dados est\u00e1ticos.</p> <pre><code>CLASS lcl_utils DEFINITION.\n  PUBLIC SECTION.\n    CLASS-METHODS:\n      converter_celsius_fahrenheit \n        IMPORTING iv_celsius TYPE p DECIMALS 2\n        RETURNING VALUE(rv_fahrenheit) TYPE p DECIMALS 2,\n      validar_email\n        IMPORTING iv_email TYPE string\n        RETURNING VALUE(rv_valido) TYPE abap_bool.\nENDCLASS.\n\nCLASS lcl_utils IMPLEMENTATION.\n  METHOD converter_celsius_fahrenheit.\n    rv_fahrenheit = ( iv_celsius * '1.8' ) + 32.\n  ENDMETHOD.\n\n  METHOD validar_email.\n    rv_valido = COND #( WHEN iv_email CS '@' AND iv_email CS '.'\n                        THEN abap_true\n                        ELSE abap_false ).\n  ENDMETHOD.\nENDCLASS.\n\n\" Uso (sem criar objeto)\nDATA(lv_temp) = lcl_utils=&gt;converter_celsius_fahrenheit( '25.0' ).  \" 77.0\nDATA(lv_ok) = lcl_utils=&gt;validar_email( 'user@exemplo.com' ).      \" X\n</code></pre>"},{"location":"objetos/2_atributos_metodos/#parametros-de-metodos","title":"\ud83d\udce5 Par\u00e2metros de M\u00e9todos","text":""},{"location":"objetos/2_atributos_metodos/#importing","title":"IMPORTING","text":"<p>Recebe valores de entrada.</p> <pre><code>METHODS: calcular_desconto\n  IMPORTING iv_preco TYPE p DECIMALS 2\n            iv_desconto_percentual TYPE p DECIMALS 2\n  RETURNING VALUE(rv_preco_final) TYPE p DECIMALS 2.\n\nMETHOD calcular_desconto.\n  DATA(lv_desconto) = iv_preco * iv_desconto_percentual / 100.\n  rv_preco_final = iv_preco - lv_desconto.\nENDMETHOD.\n</code></pre>"},{"location":"objetos/2_atributos_metodos/#exporting","title":"EXPORTING","text":"<p>Retorna valores (menos comum, use RETURNING quando poss\u00edvel).</p> <pre><code>METHODS: dividir\n  IMPORTING iv_dividendo TYPE i\n            iv_divisor TYPE i\n  EXPORTING ev_quociente TYPE i\n            ev_resto TYPE i.\n\nMETHOD dividir.\n  ev_quociente = iv_dividendo DIV iv_divisor.\n  ev_resto = iv_dividendo MOD iv_divisor.\nENDMETHOD.\n\n\" Uso\nDATA: lv_quociente TYPE i,\n      lv_resto TYPE i.\n\nlo_obj-&gt;dividir(\n  EXPORTING iv_dividendo = 17\n            iv_divisor = 5\n  IMPORTING ev_quociente = lv_quociente\n            ev_resto = lv_resto ).\n\nWRITE: / lv_quociente, lv_resto.  \" 3 2\n</code></pre>"},{"location":"objetos/2_atributos_metodos/#returning","title":"RETURNING","text":"<p>Retorna um \u00fanico valor (recomendado).</p> <pre><code>METHODS: potencia\n  IMPORTING iv_base TYPE i\n            iv_expoente TYPE i\n  RETURNING VALUE(rv_resultado) TYPE i.\n\nMETHOD potencia.\n  rv_resultado = iv_base ** iv_expoente.\nENDMETHOD.\n\n\" Uso inline\nDATA(lv_result) = lo_obj-&gt;potencia( iv_base = 2 iv_expoente = 10 ).\nWRITE: / lv_result.  \" 1024\n</code></pre>"},{"location":"objetos/2_atributos_metodos/#changing","title":"CHANGING","text":"<p>Modifica par\u00e2metro existente.</p> <pre><code>METHODS: incrementar_contador\n  CHANGING cv_contador TYPE i.\n\nMETHOD incrementar_contador.\n  cv_contador = cv_contador + 1.\nENDMETHOD.\n\n\" Uso\nDATA lv_contador TYPE i VALUE 5.\nlo_obj-&gt;incrementar_contador( CHANGING cv_contador = lv_contador ).\nWRITE: / lv_contador.  \" 6\n</code></pre>"},{"location":"objetos/2_atributos_metodos/#method-chaining","title":"\ud83d\udd04 Method Chaining","text":"<p>Encadear chamadas de m\u00e9todos.</p> <pre><code>CLASS lcl_builder DEFINITION.\n  PUBLIC SECTION.\n    METHODS:\n      set_nome IMPORTING iv_nome TYPE string\n               RETURNING VALUE(ro_self) TYPE REF TO lcl_builder,\n      set_idade IMPORTING iv_idade TYPE i\n                RETURNING VALUE(ro_self) TYPE REF TO lcl_builder,\n      build RETURNING VALUE(rv_info) TYPE string.\n\n  PRIVATE SECTION.\n    DATA: mv_nome TYPE string,\n          mv_idade TYPE i.\nENDCLASS.\n\nCLASS lcl_builder IMPLEMENTATION.\n  METHOD set_nome.\n    mv_nome = iv_nome.\n    ro_self = me.  \" Retorna refer\u00eancia para si mesmo\n  ENDMETHOD.\n\n  METHOD set_idade.\n    mv_idade = iv_idade.\n    ro_self = me.\n  ENDMETHOD.\n\n  METHOD build.\n    rv_info = |{ mv_nome } tem { mv_idade } anos|.\n  ENDMETHOD.\nENDCLASS.\n\n\" Uso: method chaining\nDATA(lv_info) = NEW lcl_builder( )-&gt;set_nome( 'Jo\u00e3o' )\n                                   -&gt;set_idade( 30 )\n                                   -&gt;build( ).\nWRITE: / lv_info.  \" Jo\u00e3o tem 30 anos\n</code></pre>"},{"location":"objetos/2_atributos_metodos/#exemplo-completo-classe-conta-bancaria","title":"\ud83d\udca1 Exemplo Completo: Classe Conta Banc\u00e1ria","text":"<pre><code>CLASS lcl_conta_bancaria DEFINITION.\n  PUBLIC SECTION.\n    CLASS-DATA: sv_total_contas TYPE i.\n\n    METHODS:\n      constructor IMPORTING iv_titular TYPE string\n                            iv_saldo_inicial TYPE p DECIMALS 2 DEFAULT 0,\n      depositar IMPORTING iv_valor TYPE p DECIMALS 2,\n      levantar IMPORTING iv_valor TYPE p DECIMALS 2\n               RETURNING VALUE(rv_sucesso) TYPE abap_bool,\n      transferir IMPORTING iv_valor TYPE p DECIMALS 2\n                           io_destino TYPE REF TO lcl_conta_bancaria\n                 RETURNING VALUE(rv_sucesso) TYPE abap_bool,\n      get_saldo RETURNING VALUE(rv_saldo) TYPE p DECIMALS 2,\n      get_extrato RETURNING VALUE(rv_extrato) TYPE string.\n\n  PRIVATE SECTION.\n    DATA: mv_numero TYPE string,\n          mv_titular TYPE string,\n          mv_saldo TYPE p DECIMALS 2,\n          mt_transacoes TYPE TABLE OF string.\n\n    METHODS: \n      gerar_numero_conta RETURNING VALUE(rv_numero) TYPE string,\n      registrar_transacao IMPORTING iv_descricao TYPE string.\nENDCLASS.\n\nCLASS lcl_conta_bancaria IMPLEMENTATION.\n  METHOD constructor.\n    sv_total_contas = sv_total_contas + 1.\n    mv_numero = gerar_numero_conta( ).\n    mv_titular = iv_titular.\n    mv_saldo = iv_saldo_inicial.\n\n    registrar_transacao( |Conta aberta com saldo inicial: { iv_saldo_inicial }| ).\n  ENDMETHOD.\n\n  METHOD gerar_numero_conta.\n    rv_numero = |{ sy-datum }{ sy-uzeit }{ sv_total_contas }|.\n  ENDMETHOD.\n\n  METHOD depositar.\n    IF iv_valor &gt; 0.\n      mv_saldo = mv_saldo + iv_valor.\n      registrar_transacao( |Dep\u00f3sito: +{ iv_valor }| ).\n    ENDIF.\n  ENDMETHOD.\n\n  METHOD levantar.\n    IF iv_valor &gt; 0 AND iv_valor &lt;= mv_saldo.\n      mv_saldo = mv_saldo - iv_valor.\n      registrar_transacao( |Levantamento: -{ iv_valor }| ).\n      rv_sucesso = abap_true.\n    ELSE.\n      rv_sucesso = abap_false.\n    ENDIF.\n  ENDMETHOD.\n\n  METHOD transferir.\n    IF iv_valor &gt; 0 AND iv_valor &lt;= mv_saldo.\n      mv_saldo = mv_saldo - iv_valor.\n      io_destino-&gt;depositar( iv_valor ).\n      registrar_transacao( |Transfer\u00eancia enviada: -{ iv_valor } para { io_destino-&gt;mv_titular }| ).\n      rv_sucesso = abap_true.\n    ELSE.\n      rv_sucesso = abap_false.\n    ENDIF.\n  ENDMETHOD.\n\n  METHOD get_saldo.\n    rv_saldo = mv_saldo.\n  ENDMETHOD.\n\n  METHOD get_extrato.\n    rv_extrato = concat_lines_of( table = mt_transacoes sep = cl_abap_char_utilities=&gt;newline ).\n  ENDMETHOD.\n\n  METHOD registrar_transacao.\n    APPEND |{ sy-datum } { sy-uzeit }: { iv_descricao }| TO mt_transacoes.\n  ENDMETHOD.\nENDCLASS.\n\n\" Programa de teste\nSTART-OF-SELECTION.\n\n  DATA(lo_conta1) = NEW lcl_conta_bancaria( \n    iv_titular = 'Jo\u00e3o Silva'\n    iv_saldo_inicial = '1000.00'\n  ).\n\n  DATA(lo_conta2) = NEW lcl_conta_bancaria(\n    iv_titular = 'Maria Santos'\n    iv_saldo_inicial = '500.00'\n  ).\n\n  \" Opera\u00e7\u00f5es\n  lo_conta1-&gt;depositar( '200.00' ).\n  lo_conta1-&gt;levantar( '150.00' ).\n  lo_conta1-&gt;transferir( iv_valor = '300.00' io_destino = lo_conta2 ).\n\n  \" Exibir resultados\n  WRITE: / 'Saldo conta 1:', lo_conta1-&gt;get_saldo( ).\n  WRITE: / 'Saldo conta 2:', lo_conta2-&gt;get_saldo( ).\n  SKIP.\n  WRITE: / 'Extrato conta 1:', /, lo_conta1-&gt;get_extrato( ).\n</code></pre>"},{"location":"objetos/2_atributos_metodos/#boas-praticas","title":"\ud83c\udfaf Boas Pr\u00e1ticas","text":""},{"location":"objetos/2_atributos_metodos/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Atributos privados com getters/setters\nPRIVATE SECTION.\n  DATA mv_preco TYPE p DECIMALS 2.\nPUBLIC SECTION.\n  METHODS get_preco RETURNING VALUE(rv_preco) TYPE p DECIMALS 2.\n  METHODS set_preco IMPORTING iv_preco TYPE p DECIMALS 2.\n\n\" 2. M\u00e9todos pequenos e focados\nMETHOD calcular_total.\n  rv_total = calcular_subtotal( ) + calcular_impostos( ).\nENDMETHOD.\n\n\" 3. Usar RETURNING em vez de EXPORTING\nMETHODS calcular RETURNING VALUE(rv_result) TYPE i.  \" \u2705\n\" Em vez de:\n\" METHODS calcular EXPORTING ev_result TYPE i.  \" \u274c\n\n\" 4. Valida\u00e7\u00e3o em setters\nMETHOD set_idade.\n  IF iv_idade &gt;= 0 AND iv_idade &lt;= 150.\n    mv_idade = iv_idade.\n  ELSE.\n    RAISE EXCEPTION TYPE cx_parameter_invalid.\n  ENDIF.\nENDMETHOD.\n</code></pre>"},{"location":"objetos/2_atributos_metodos/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Atributos p\u00fablicos sem controlo\nPUBLIC SECTION.\n  DATA mv_saldo TYPE p DECIMALS 2.  \" \u274c Qualquer um pode alterar\n\n\" 2. M\u00e9todos gigantes\nMETHOD processar_tudo.\n  \" 500 linhas de c\u00f3digo  \" \u274c\nENDMETHOD.\n\n\" 3. Nomes n\u00e3o descritivos\nMETHODS x IMPORTING iv_y TYPE i.  \" \u274c\n\n\" 4. Modificar par\u00e2metros IMPORTING\nMETHOD processar.\n  iv_parametro = iv_parametro + 1.  \" \u274c Use CHANGING\nENDMETHOD.\n</code></pre>"},{"location":"objetos/2_atributos_metodos/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>Construtores - Inicializa\u00e7\u00e3o de objetos</li> <li>Interfaces - Contratos entre classes</li> <li>Heran\u00e7a - Reutiliza\u00e7\u00e3o de c\u00f3digo</li> </ul> <p>Tags: <code>#OO</code> <code>#Atributos</code> <code>#M\u00e9todos</code> <code>#Encapsulamento</code> <code>#ABAP</code></p>"},{"location":"objetos/3_construtores/","title":"Construtores","text":""},{"location":"objetos/3_construtores/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>O construtor \u00e9 um m\u00e9todo especial executado automaticamente quando um objeto \u00e9 criado. \u00c9 usado para inicializar o objeto com valores.</p>"},{"location":"objetos/3_construtores/#metodo-constructor","title":"\ud83c\udfaf M\u00e9todo CONSTRUCTOR","text":"<pre><code>CLASS lcl_pessoa DEFINITION.\n  PUBLIC SECTION.\n    METHODS: constructor IMPORTING iv_nome TYPE string\n                                   iv_idade TYPE i.\n    DATA: mv_nome TYPE string,\n          mv_idade TYPE i.\nENDCLASS.\n\nCLASS lcl_pessoa IMPLEMENTATION.\n  METHOD constructor.\n    mv_nome = iv_nome.\n    mv_idade = iv_idade.\n    WRITE: / |Objeto criado: { mv_nome }, { mv_idade } anos|.\n  ENDMETHOD.\nENDCLASS.\n\n\" Usar\nDATA(lo_pessoa) = NEW lcl_pessoa( iv_nome = 'Jo\u00e3o' iv_idade = 30 ).\n</code></pre>"},{"location":"objetos/3_construtores/#construtor-com-valores-padrao","title":"\ud83d\udd27 Construtor com Valores Padr\u00e3o","text":"<pre><code>CLASS lcl_produto DEFINITION.\n  PUBLIC SECTION.\n    METHODS: constructor \n      IMPORTING iv_nome TYPE string\n                iv_preco TYPE p DECIMALS 2 DEFAULT '0.00'\n                iv_stock TYPE i DEFAULT 0.\n\n  PRIVATE SECTION.\n    DATA: mv_nome TYPE string,\n          mv_preco TYPE p DECIMALS 2,\n          mv_stock TYPE i.\nENDCLASS.\n\nCLASS lcl_produto IMPLEMENTATION.\n  METHOD constructor.\n    mv_nome = iv_nome.\n    mv_preco = iv_preco.\n    mv_stock = iv_stock.\n  ENDMETHOD.\nENDCLASS.\n\n\" Uso com valores padr\u00e3o\nDATA(lo_prod1) = NEW lcl_produto( iv_nome = 'Caneta' ).\nDATA(lo_prod2) = NEW lcl_produto( \n  iv_nome = 'Caderno' \n  iv_preco = '5.50'\n  iv_stock = 100 \n).\n</code></pre>"},{"location":"objetos/3_construtores/#construtor-estatico-class_constructor","title":"\ud83c\udfed Construtor Est\u00e1tico (CLASS_CONSTRUCTOR)","text":"<p>Executado uma \u00fanica vez quando a classe \u00e9 usada pela primeira vez.</p> <pre><code>CLASS lcl_config DEFINITION.\n  PUBLIC SECTION.\n    CLASS-METHODS: class_constructor.\n    CLASS-DATA: sv_ambiente TYPE string,\n                sv_versao TYPE string.\nENDCLASS.\n\nCLASS lcl_config IMPLEMENTATION.\n  METHOD class_constructor.\n    sv_ambiente = 'PRODU\u00c7\u00c3O'.\n    sv_versao = '1.0.0'.\n    WRITE: / 'Configura\u00e7\u00e3o inicial carregada'.\n  ENDMETHOD.\nENDCLASS.\n\n\" Ao usar a classe pela primeira vez, class_constructor \u00e9 chamado\nWRITE: / lcl_config=&gt;sv_ambiente.  \" Trigger: class_constructor executado\nWRITE: / lcl_config=&gt;sv_versao.\n</code></pre>"},{"location":"objetos/3_construtores/#padrao-factory-com-construtor-privado","title":"\ud83d\udca1 Padr\u00e3o Factory com Construtor Privado","text":"<pre><code>CLASS lcl_singleton DEFINITION CREATE PRIVATE.\n  PUBLIC SECTION.\n    CLASS-METHODS: get_instance \n      RETURNING VALUE(ro_instance) TYPE REF TO lcl_singleton.\n    METHODS: fazer_algo.\n\n  PRIVATE SECTION.\n    CLASS-DATA: so_instance TYPE REF TO lcl_singleton.\n    METHODS: constructor.\nENDCLASS.\n\nCLASS lcl_singleton IMPLEMENTATION.\n  METHOD constructor.\n    WRITE: / 'Singleton criado'.\n  ENDMETHOD.\n\n  METHOD get_instance.\n    IF so_instance IS NOT BOUND.\n      CREATE OBJECT so_instance.\n    ENDIF.\n    ro_instance = so_instance.\n  ENDMETHOD.\n\n  METHOD fazer_algo.\n    WRITE: / 'Executando a\u00e7\u00e3o do singleton'.\n  ENDMETHOD.\nENDCLASS.\n\n\" Uso\nDATA(lo_obj1) = lcl_singleton=&gt;get_instance( ).\nDATA(lo_obj2) = lcl_singleton=&gt;get_instance( ).\n\" lo_obj1 e lo_obj2 apontam para o MESMO objeto\n</code></pre>"},{"location":"objetos/3_construtores/#validacao-no-construtor","title":"\ud83c\udfaf Valida\u00e7\u00e3o no Construtor","text":"<pre><code>CLASS lcl_conta DEFINITION.\n  PUBLIC SECTION.\n    METHODS: constructor \n      IMPORTING iv_numero TYPE string\n                iv_saldo_inicial TYPE p DECIMALS 2\n      RAISING cx_parameter_invalid.\n\n  PRIVATE SECTION.\n    DATA: mv_numero TYPE string,\n          mv_saldo TYPE p DECIMALS 2.\nENDCLASS.\n\nCLASS lcl_conta IMPLEMENTATION.\n  METHOD constructor.\n    \" Valida\u00e7\u00f5es\n    IF iv_numero IS INITIAL.\n      RAISE EXCEPTION TYPE cx_parameter_invalid.\n    ENDIF.\n\n    IF iv_saldo_inicial &lt; 0.\n      RAISE EXCEPTION TYPE cx_parameter_invalid.\n    ENDIF.\n\n    \" Inicializa\u00e7\u00e3o\n    mv_numero = iv_numero.\n    mv_saldo = iv_saldo_inicial.\n  ENDMETHOD.\nENDCLASS.\n\n\" Uso com tratamento de erro\nTRY.\n    DATA(lo_conta) = NEW lcl_conta( \n      iv_numero = '12345'\n      iv_saldo_inicial = '1000.00'\n    ).\n  CATCH cx_parameter_invalid.\n    WRITE: / 'Erro ao criar conta: par\u00e2metros inv\u00e1lidos'.\nENDTRY.\n</code></pre>"},{"location":"objetos/3_construtores/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>Interfaces - Definir contratos</li> <li>Heran\u00e7a - Reutilizar c\u00f3digo</li> <li>Singleton Pattern - Padr\u00e3o de design</li> </ul> <p>Tags: <code>#OO</code> <code>#Constructor</code> <code>#Singleton</code> <code>#Factory</code> <code>#ABAP</code></p>"},{"location":"objetos/4_interfaces/","title":"Interfaces em ABAP","text":"","tags":["ABAP","OO","Interfaces","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/4_interfaces/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Uma interface define um contrato que as classes devem cumprir. \u00c9 uma forma de garantir que diferentes classes implementem os mesmos m\u00e9todos, permitindo polimorfismo e desacoplamento.</p>","tags":["ABAP","OO","Interfaces","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/4_interfaces/#o-que-e-uma-interface","title":"\ud83c\udfaf O que \u00e9 uma Interface?","text":"<ul> <li>Contrato: Define m\u00e9todos que devem ser implementados</li> <li>Sem implementa\u00e7\u00e3o: Apenas assinaturas de m\u00e9todos</li> <li>M\u00faltiplas interfaces: Uma classe pode implementar v\u00e1rias interfaces</li> <li>Polimorfismo: Tratar objetos diferentes de forma uniforme</li> </ul>","tags":["ABAP","OO","Interfaces","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/4_interfaces/#definir-uma-interface","title":"\ud83d\udd39 Definir uma Interface","text":"<pre><code>INTERFACE lif_pagamento.\n  METHODS:\n    processar_pagamento \n      IMPORTING iv_valor TYPE p DECIMALS 2\n      RETURNING VALUE(rv_sucesso) TYPE abap_bool,\n    validar_dados\n      RETURNING VALUE(rv_valido) TYPE abap_bool,\n    obter_taxa\n      RETURNING VALUE(rv_taxa) TYPE p DECIMALS 2.\nENDINTERFACE.\n</code></pre>","tags":["ABAP","OO","Interfaces","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/4_interfaces/#implementar-uma-interface","title":"\ud83d\udd39 Implementar uma Interface","text":"<pre><code>CLASS lcl_cartao_credito DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_pagamento.\n\n    METHODS constructor\n      IMPORTING iv_numero TYPE string\n                iv_cvv TYPE string.\n\n  PRIVATE SECTION.\n    DATA: mv_numero TYPE string,\n          mv_cvv TYPE string.\nENDCLASS.\n\nCLASS lcl_cartao_credito IMPLEMENTATION.\n  METHOD constructor.\n    mv_numero = iv_numero.\n    mv_cvv = iv_cvv.\n  ENDMETHOD.\n\n  METHOD lif_pagamento~processar_pagamento.\n    IF validar_dados( ) = abap_true.\n      \" L\u00f3gica de processamento do cart\u00e3o\n      WRITE: / |Pagamento de { iv_valor } processado via cart\u00e3o|.\n      rv_sucesso = abap_true.\n    ELSE.\n      rv_sucesso = abap_false.\n    ENDIF.\n  ENDMETHOD.\n\n  METHOD lif_pagamento~validar_dados.\n    \" Validar n\u00famero e CVV\n    IF strlen( mv_numero ) = 16 AND strlen( mv_cvv ) = 3.\n      rv_valido = abap_true.\n    ELSE.\n      rv_valido = abap_false.\n    ENDIF.\n  ENDMETHOD.\n\n  METHOD lif_pagamento~obter_taxa.\n    rv_taxa = '2.5'.  \" 2.5% de taxa para cart\u00e3o\n  ENDMETHOD.\nENDCLASS.\n</code></pre>","tags":["ABAP","OO","Interfaces","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/4_interfaces/#multiplas-implementacoes","title":"\ud83d\udd39 M\u00faltiplas Implementa\u00e7\u00f5es","text":"<pre><code>CLASS lcl_paypal DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_pagamento.\n\n    METHODS constructor\n      IMPORTING iv_email TYPE string.\n\n  PRIVATE SECTION.\n    DATA: mv_email TYPE string.\nENDCLASS.\n\nCLASS lcl_paypal IMPLEMENTATION.\n  METHOD constructor.\n    mv_email = iv_email.\n  ENDMETHOD.\n\n  METHOD lif_pagamento~processar_pagamento.\n    WRITE: / |Pagamento de { iv_valor } via PayPal ({ mv_email })|.\n    rv_sucesso = abap_true.\n  ENDMETHOD.\n\n  METHOD lif_pagamento~validar_dados.\n    rv_valido = COND #( WHEN mv_email CS '@' THEN abap_true\n                        ELSE abap_false ).\n  ENDMETHOD.\n\n  METHOD lif_pagamento~obter_taxa.\n    rv_taxa = '3.5'.  \" 3.5% de taxa para PayPal\n  ENDMETHOD.\nENDCLASS.\n\nCLASS lcl_transferencia DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_pagamento.\n\n    METHODS constructor\n      IMPORTING iv_iban TYPE string.\n\n  PRIVATE SECTION.\n    DATA: mv_iban TYPE string.\nENDCLASS.\n\nCLASS lcl_transferencia IMPLEMENTATION.\n  METHOD constructor.\n    mv_iban = iv_iban.\n  ENDMETHOD.\n\n  METHOD lif_pagamento~processar_pagamento.\n    WRITE: / |Transfer\u00eancia de { iv_valor } para { mv_iban }|.\n    rv_sucesso = abap_true.\n  ENDMETHOD.\n\n  METHOD lif_pagamento~validar_dados.\n    rv_valido = COND #( WHEN strlen( mv_iban ) = 25 THEN abap_true\n                        ELSE abap_false ).\n  ENDMETHOD.\n\n  METHOD lif_pagamento~obter_taxa.\n    rv_taxa = '0.5'.  \" 0.5% de taxa para transfer\u00eancia\n  ENDMETHOD.\nENDCLASS.\n</code></pre>","tags":["ABAP","OO","Interfaces","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/4_interfaces/#usar-interfaces-polimorfismo","title":"\ud83d\udd39 Usar Interfaces (Polimorfismo)","text":"<pre><code>START-OF-SELECTION.\n\n  \" Tabela de refer\u00eancias \u00e0 interface\n  DATA: lt_pagamentos TYPE TABLE OF REF TO lif_pagamento.\n\n  \" Criar diferentes formas de pagamento\n  APPEND NEW lcl_cartao_credito( \n    iv_numero = '1234567890123456'\n    iv_cvv = '123'\n  ) TO lt_pagamentos.\n\n  APPEND NEW lcl_paypal( \n    iv_email = 'user@exemplo.com'\n  ) TO lt_pagamentos.\n\n  APPEND NEW lcl_transferencia(\n    iv_iban = 'PT50000000000000000000000'\n  ) TO lt_pagamentos.\n\n  \" Processar todos os pagamentos de forma uniforme\n  LOOP AT lt_pagamentos INTO DATA(lo_pagamento).\n    DATA(lv_valor) = CONV p( 100 DECIMALS 2 ).\n    DATA(lv_taxa) = lo_pagamento-&gt;obter_taxa( ).\n    DATA(lv_total) = lv_valor + ( lv_valor * lv_taxa / 100 ).\n\n    WRITE: / |Processando pagamento de { lv_total } (taxa: { lv_taxa }%)|.\n\n    IF lo_pagamento-&gt;processar_pagamento( lv_total ) = abap_true.\n      WRITE: / 'Sucesso!'.\n    ELSE.\n      WRITE: / 'Falhou!'.\n    ENDIF.\n    SKIP.\n  ENDLOOP.\n</code></pre>","tags":["ABAP","OO","Interfaces","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/4_interfaces/#interfaces-com-atributos","title":"\ud83d\udd39 Interfaces com Atributos","text":"<pre><code>INTERFACE lif_configuravel.\n  DATA: mv_versao TYPE string READ-ONLY.\n  CONSTANTS: mc_max_tentativas TYPE i VALUE 3.\n\n  METHODS:\n    configurar IMPORTING iv_config TYPE string,\n    obter_status RETURNING VALUE(rv_status) TYPE string.\nENDINTERFACE.\n\nCLASS lcl_servico DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_configuravel.\n\n  PRIVATE SECTION.\n    DATA: mv_configuracao TYPE string.\nENDCLASS.\n\nCLASS lcl_servico IMPLEMENTATION.\n  METHOD lif_configuravel~configurar.\n    mv_configuracao = iv_config.\n    lif_configuravel~mv_versao = '1.0.0'.\n  ENDMETHOD.\n\n  METHOD lif_configuravel~obter_status.\n    rv_status = |Config: { mv_configuracao }, Vers\u00e3o: { lif_configuravel~mv_versao }|.\n  ENDMETHOD.\nENDCLASS.\n</code></pre>","tags":["ABAP","OO","Interfaces","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/4_interfaces/#implementar-multiplas-interfaces","title":"\ud83d\udd39 Implementar M\u00faltiplas Interfaces","text":"<pre><code>INTERFACE lif_logavel.\n  METHODS: log IMPORTING iv_mensagem TYPE string.\nENDINTERFACE.\n\nINTERFACE lif_serializavel.\n  METHODS: \n    to_json RETURNING VALUE(rv_json) TYPE string,\n    from_json IMPORTING iv_json TYPE string.\nENDINTERFACE.\n\nCLASS lcl_entidade DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES: lif_logavel,\n                lif_serializavel.\n\n    DATA: mv_nome TYPE string,\n          mv_id TYPE i.\nENDCLASS.\n\nCLASS lcl_entidade IMPLEMENTATION.\n  METHOD lif_logavel~log.\n    WRITE: / |LOG: { iv_mensagem }|.\n  ENDMETHOD.\n\n  METHOD lif_serializavel~to_json.\n    rv_json = |{{ \"id\": { mv_id }, \"nome\": \"{ mv_nome }\" }}|.\n  ENDMETHOD.\n\n  METHOD lif_serializavel~from_json.\n    \" Parsing simplificado\n    mv_nome = 'Extra\u00eddo do JSON'.\n  ENDMETHOD.\nENDCLASS.\n\n\" Uso\nSTART-OF-SELECTION.\n  DATA(lo_obj) = NEW lcl_entidade( ).\n  lo_obj-&gt;mv_id = 1.\n  lo_obj-&gt;mv_nome = 'Teste'.\n\n  lo_obj-&gt;lif_logavel~log( 'Objeto criado' ).\n  DATA(lv_json) = lo_obj-&gt;lif_serializavel~to_json( ).\n  WRITE: / lv_json.\n</code></pre>","tags":["ABAP","OO","Interfaces","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/4_interfaces/#alias-para-metodos-de-interface","title":"\ud83d\udd39 Alias para M\u00e9todos de Interface","text":"<pre><code>CLASS lcl_produto DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_serializavel\n      ALL METHODS \n      ALIASES: exportar FOR lif_serializavel~to_json,\n               importar FOR lif_serializavel~from_json.\nENDCLASS.\n\nCLASS lcl_produto IMPLEMENTATION.\n  METHOD lif_serializavel~to_json.\n    rv_json = '{ \"produto\": \"exemplo\" }'.\n  ENDMETHOD.\n\n  METHOD lif_serializavel~from_json.\n    \" Implementa\u00e7\u00e3o\n  ENDMETHOD.\nENDCLASS.\n\n\" Uso com alias\nDATA(lo_prod) = NEW lcl_produto( ).\nDATA(lv_json) = lo_prod-&gt;exportar( ).  \" Mais leg\u00edvel que lif_serializavel~to_json\n</code></pre>","tags":["ABAP","OO","Interfaces","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/4_interfaces/#verificar-implementacao-de-interface","title":"\ud83d\udd39 Verificar Implementa\u00e7\u00e3o de Interface","text":"<pre><code>DATA lo_objeto TYPE REF TO object.\nlo_objeto = NEW lcl_cartao_credito( iv_numero = '1234' iv_cvv = '123' ).\n\n\" Verificar se implementa a interface\nIF lo_objeto IS INSTANCE OF lif_pagamento.\n  WRITE: / 'Implementa lif_pagamento'.\n\n  \" Cast para interface\n  DATA(lo_pag) = CAST lif_pagamento( lo_objeto ).\n  lo_pag-&gt;processar_pagamento( '100.00' ).\nENDIF.\n</code></pre>","tags":["ABAP","OO","Interfaces","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/4_interfaces/#exemplo-completo-sistema-de-notificacoes","title":"\ud83d\udca1 Exemplo Completo: Sistema de Notifica\u00e7\u00f5es","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_OO_NOTIFICACOES\n*&amp;---------------------------------------------------------------------*\nREPORT z_oo_notificacoes.\n\n\" Interface para notifica\u00e7\u00f5es\nINTERFACE lif_notificacao.\n  METHODS:\n    enviar \n      IMPORTING iv_destinatario TYPE string\n                iv_mensagem TYPE string\n      RETURNING VALUE(rv_sucesso) TYPE abap_bool,\n    validar_destinatario\n      IMPORTING iv_destinatario TYPE string\n      RETURNING VALUE(rv_valido) TYPE abap_bool.\nENDINTERFACE.\n\n\" Implementa\u00e7\u00e3o: Email\nCLASS lcl_email DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_notificacao.\nENDCLASS.\n\nCLASS lcl_email IMPLEMENTATION.\n  METHOD lif_notificacao~enviar.\n    IF validar_destinatario( iv_destinatario ) = abap_true.\n      WRITE: / |\ud83d\udce7 Email enviado para { iv_destinatario }: { iv_mensagem }|.\n      rv_sucesso = abap_true.\n    ELSE.\n      WRITE: / |\u274c Email inv\u00e1lido: { iv_destinatario }|.\n      rv_sucesso = abap_false.\n    ENDIF.\n  ENDMETHOD.\n\n  METHOD lif_notificacao~validar_destinatario.\n    rv_valido = COND #( WHEN iv_destinatario CS '@' AND iv_destinatario CS '.'\n                        THEN abap_true\n                        ELSE abap_false ).\n  ENDMETHOD.\nENDCLASS.\n\n\" Implementa\u00e7\u00e3o: SMS\nCLASS lcl_sms DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_notificacao.\nENDCLASS.\n\nCLASS lcl_sms IMPLEMENTATION.\n  METHOD lif_notificacao~enviar.\n    IF validar_destinatario( iv_destinatario ) = abap_true.\n      WRITE: / |\ud83d\udcf1 SMS enviado para { iv_destinatario }: { iv_mensagem }|.\n      rv_sucesso = abap_true.\n    ELSE.\n      WRITE: / |\u274c N\u00famero inv\u00e1lido: { iv_destinatario }|.\n      rv_sucesso = abap_false.\n    ENDIF.\n  ENDMETHOD.\n\n  METHOD lif_notificacao~validar_destinatario.\n    DATA(lv_len) = strlen( iv_destinatario ).\n    rv_valido = COND #( WHEN lv_len &gt;= 9 AND lv_len &lt;= 15\n                        THEN abap_true\n                        ELSE abap_false ).\n  ENDMETHOD.\nENDCLASS.\n\n\" Implementa\u00e7\u00e3o: Push Notification\nCLASS lcl_push DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_notificacao.\nENDCLASS.\n\nCLASS lcl_push IMPLEMENTATION.\n  METHOD lif_notificacao~enviar.\n    WRITE: / |\ud83d\udd14 Push enviado para dispositivo { iv_destinatario }: { iv_mensagem }|.\n    rv_sucesso = abap_true.\n  ENDMETHOD.\n\n  METHOD lif_notificacao~validar_destinatario.\n    rv_valido = COND #( WHEN strlen( iv_destinatario ) = 32\n                        THEN abap_true\n                        ELSE abap_false ).\n  ENDMETHOD.\nENDCLASS.\n\n\" Gestor de notifica\u00e7\u00f5es\nCLASS lcl_notificador DEFINITION.\n  PUBLIC SECTION.\n    METHODS:\n      adicionar_canal \n        IMPORTING io_canal TYPE REF TO lif_notificacao,\n      notificar_todos\n        IMPORTING iv_destinatario TYPE string\n                  iv_mensagem TYPE string.\n\n  PRIVATE SECTION.\n    DATA: mt_canais TYPE TABLE OF REF TO lif_notificacao.\nENDCLASS.\n\nCLASS lcl_notificador IMPLEMENTATION.\n  METHOD adicionar_canal.\n    APPEND io_canal TO mt_canais.\n  ENDMETHOD.\n\n  METHOD notificar_todos.\n    LOOP AT mt_canais INTO DATA(lo_canal).\n      lo_canal-&gt;enviar( \n        iv_destinatario = iv_destinatario\n        iv_mensagem = iv_mensagem\n      ).\n    ENDLOOP.\n  ENDMETHOD.\nENDCLASS.\n\n\" Programa principal\nSTART-OF-SELECTION.\n\n  DATA(lo_notificador) = NEW lcl_notificador( ).\n\n  \" Adicionar canais de notifica\u00e7\u00e3o\n  lo_notificador-&gt;adicionar_canal( NEW lcl_email( ) ).\n  lo_notificador-&gt;adicionar_canal( NEW lcl_sms( ) ).\n  lo_notificador-&gt;adicionar_canal( NEW lcl_push( ) ).\n\n  \" Enviar notifica\u00e7\u00e3o por todos os canais\n  WRITE: / '=== Notifica\u00e7\u00e3o 1 ==='.\n  lo_notificador-&gt;notificar_todos(\n    iv_destinatario = 'user@exemplo.com'\n    iv_mensagem = 'Bem-vindo ao sistema!'\n  ).\n\n  SKIP.\n  WRITE: / '=== Notifica\u00e7\u00e3o 2 ==='.\n  lo_notificador-&gt;notificar_todos(\n    iv_destinatario = '912345678'\n    iv_mensagem = 'C\u00f3digo de verifica\u00e7\u00e3o: 1234'\n  ).\n</code></pre>","tags":["ABAP","OO","Interfaces","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/4_interfaces/#boas-praticas","title":"\ud83c\udfaf Boas Pr\u00e1ticas","text":"","tags":["ABAP","OO","Interfaces","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/4_interfaces/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Nomes descritivos para interfaces\nINTERFACE lif_processador_pagamento.  \" \u2705\nINTERFACE lif_serializavel.           \" \u2705\n\n\" 2. Interfaces pequenas e focadas (Interface Segregation Principle)\nINTERFACE lif_gravavel.\n  METHODS gravar.\nENDINTERFACE.\n\nINTERFACE lif_removivel.\n  METHODS remover.\nENDINTERFACE.\n\n\" 3. Usar tabelas de interfaces para polimorfismo\nDATA: lt_processadores TYPE TABLE OF REF TO lif_processador.\n\n\" 4. Alias para m\u00e9todos complexos\nINTERFACES lif_longa~nome_muito_grande_de_metodo\n  ALIASES metodo FOR lif_longa~nome_muito_grande_de_metodo.\n</code></pre>","tags":["ABAP","OO","Interfaces","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/4_interfaces/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Interfaces muito grandes (viola\u00e7\u00e3o do ISP)\nINTERFACE lif_tudo.  \" \u274c\n  METHODS: metodo1, metodo2, metodo3, ..., metodo50.\nENDINTERFACE.\n\n\" 2. Interfaces sem prop\u00f3sito claro\nINTERFACE lif_utils.  \" \u274c Muito gen\u00e9rico\nENDINTERFACE.\n\n\" 3. Misturar implementa\u00e7\u00e3o e interface\nINTERFACE lif_exemplo.\n  METHODS calcular.  \" \u2705 OK\n  DATA mv_valor TYPE i.  \" \u26a0\ufe0f Evitar quando poss\u00edvel\nENDINTERFACE.\n</code></pre>","tags":["ABAP","OO","Interfaces","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/4_interfaces/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>Heran\u00e7a - Reutilizar c\u00f3digo com INHERITING FROM</li> <li>Polimorfismo - Casting e tratamento polim\u00f3rfico</li> <li>Factory Pattern - Criar objetos atrav\u00e9s de interfaces</li> </ul> <p>Tags: <code>#OO</code> <code>#Interfaces</code> <code>#Polimorfismo</code> <code>#Contratos</code> <code>#ABAP</code></p>","tags":["ABAP","OO","Interfaces","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/5_heranca/","title":"Heran\u00e7a em ABAP","text":"","tags":["ABAP","OO","Heran\u00e7a","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/5_heranca/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Heran\u00e7a permite criar uma nova classe (subclasse) baseada numa classe existente (superclasse), reutilizando e estendendo funcionalidades.</p>","tags":["ABAP","OO","Heran\u00e7a","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/5_heranca/#conceitos-fundamentais","title":"\ud83c\udfaf Conceitos Fundamentais","text":"<ul> <li>Superclasse: Classe base (pai)</li> <li>Subclasse: Classe derivada (filho) que herda da superclasse</li> <li>INHERITING FROM: Palavra-chave para herdar</li> <li>Redefini\u00e7\u00e3o: Alterar comportamento de m\u00e9todos herdados</li> <li>SUPER: Refer\u00eancia \u00e0 superclasse</li> </ul>","tags":["ABAP","OO","Heran\u00e7a","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/5_heranca/#sintaxe-basica","title":"\ud83d\udd39 Sintaxe B\u00e1sica","text":"<pre><code>CLASS lcl_animal DEFINITION.\n  PUBLIC SECTION.\n    DATA: mv_nome TYPE string.\n\n    METHODS:\n      constructor IMPORTING iv_nome TYPE string,\n      fazer_som,\n      mover.\n\n  PROTECTED SECTION.\n    DATA: mv_energia TYPE i VALUE 100.\nENDCLASS.\n\nCLASS lcl_animal IMPLEMENTATION.\n  METHOD constructor.\n    mv_nome = iv_nome.\n  ENDMETHOD.\n\n  METHOD fazer_som.\n    WRITE: / |{ mv_nome } faz um som gen\u00e9rico|.\n  ENDMETHOD.\n\n  METHOD mover.\n    mv_energia = mv_energia - 10.\n    WRITE: / |{ mv_nome } moveu-se. Energia: { mv_energia }|.\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== SUBCLASSE ==========\nCLASS lcl_cao DEFINITION INHERITING FROM lcl_animal.\n  PUBLIC SECTION.\n    METHODS:\n      fazer_som REDEFINITION,\n      abanar_cauda.\nENDCLASS.\n\nCLASS lcl_cao IMPLEMENTATION.\n  METHOD fazer_som.\n    WRITE: / |{ mv_nome } faz: Au au!|.\n  ENDMETHOD.\n\n  METHOD abanar_cauda.\n    WRITE: / |{ mv_nome } est\u00e1 a abanar a cauda!|.\n  ENDMETHOD.\nENDCLASS.\n</code></pre> <p>Uso:</p> <pre><code>START-OF-SELECTION.\n  DATA(lo_cao) = NEW lcl_cao( iv_nome = 'Rex' ).\n  lo_cao-&gt;fazer_som( ).      \" Au au! (redefinido)\n  lo_cao-&gt;mover( ).          \" Herdado da superclasse\n  lo_cao-&gt;abanar_cauda( ).   \" M\u00e9todo pr\u00f3prio\n</code></pre>","tags":["ABAP","OO","Heran\u00e7a","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/5_heranca/#niveis-de-acesso-em-heranca","title":"\ud83d\udd39 N\u00edveis de Acesso em Heran\u00e7a","text":"Se\u00e7\u00e3o Superclasse Subclasse Fora PUBLIC \u2705 \u2705 \u2705 PROTECTED \u2705 \u2705 \u274c PRIVATE \u2705 \u274c \u274c <pre><code>CLASS lcl_veiculo DEFINITION.\n  PUBLIC SECTION.\n    DATA: mv_marca TYPE string.  \" Acess\u00edvel em todo o lado\n\n  PROTECTED SECTION.\n    DATA: mv_velocidade TYPE i.  \" Acess\u00edvel na classe e subclasses\n    METHODS: acelerar.\n\n  PRIVATE SECTION.\n    DATA: mv_num_chassis TYPE string.  \" Apenas na pr\u00f3pria classe\n    METHODS: validar_chassis.\nENDCLASS.\n\nCLASS lcl_carro DEFINITION INHERITING FROM lcl_veiculo.\n  PUBLIC SECTION.\n    METHODS:\n      acelerar REDEFINITION,\n      buzinar.\nENDCLASS.\n\nCLASS lcl_carro IMPLEMENTATION.\n  METHOD acelerar.\n    mv_velocidade = mv_velocidade + 10.  \" \u2705 PROTECTED - OK\n    \" mv_num_chassis = '123'.  \" \u274c PRIVATE - ERRO!\n  ENDMETHOD.\n\n  METHOD buzinar.\n    WRITE: / 'Biiiiip!'.\n  ENDMETHOD.\nENDCLASS.\n</code></pre>","tags":["ABAP","OO","Heran\u00e7a","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/5_heranca/#usar-super-para-chamar-metodo-da-superclasse","title":"\ud83d\udd39 Usar SUPER para Chamar M\u00e9todo da Superclasse","text":"<pre><code>CLASS lcl_pessoa DEFINITION.\n  PUBLIC SECTION.\n    DATA: mv_nome TYPE string.\n\n    METHODS:\n      constructor IMPORTING iv_nome TYPE string,\n      apresentar.\nENDCLASS.\n\nCLASS lcl_pessoa IMPLEMENTATION.\n  METHOD constructor.\n    mv_nome = iv_nome.\n  ENDMETHOD.\n\n  METHOD apresentar.\n    WRITE: / |Ol\u00e1, eu sou { mv_nome }|.\n  ENDMETHOD.\nENDCLASS.\n\nCLASS lcl_funcionario DEFINITION INHERITING FROM lcl_pessoa.\n  PUBLIC SECTION.\n    DATA: mv_cargo TYPE string,\n          mv_salario TYPE p DECIMALS 2.\n\n    METHODS:\n      constructor IMPORTING iv_nome TYPE string\n                            iv_cargo TYPE string\n                            iv_salario TYPE p DECIMALS 2,\n      apresentar REDEFINITION.\nENDCLASS.\n\nCLASS lcl_funcionario IMPLEMENTATION.\n  METHOD constructor.\n    \" Chamar construtor da superclasse\n    super-&gt;constructor( iv_nome ).\n\n    \" Inicializar atributos pr\u00f3prios\n    mv_cargo = iv_cargo.\n    mv_salario = iv_salario.\n  ENDMETHOD.\n\n  METHOD apresentar.\n    \" Chamar m\u00e9todo da superclasse\n    super-&gt;apresentar( ).\n\n    \" Adicionar informa\u00e7\u00e3o extra\n    WRITE: / |Trabalho como { mv_cargo } e ganho { mv_salario }\u20ac|.\n  ENDMETHOD.\nENDCLASS.\n\n\" Uso\nSTART-OF-SELECTION.\n  DATA(lo_func) = NEW lcl_funcionario(\n    iv_nome = 'Jo\u00e3o'\n    iv_cargo = 'Programador'\n    iv_salario = '2500.00'\n  ).\n\n  lo_func-&gt;apresentar( ).\n  \" Sa\u00edda:\n  \" Ol\u00e1, eu sou Jo\u00e3o\n  \" Trabalho como Programador e ganho 2500.00\u20ac\n</code></pre>","tags":["ABAP","OO","Heran\u00e7a","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/5_heranca/#classes-abstratas-e-metodos-abstratos","title":"\ud83d\udd39 Classes Abstratas e M\u00e9todos Abstratos","text":"<pre><code>CLASS lcl_forma DEFINITION ABSTRACT.\n  PUBLIC SECTION.\n    DATA: mv_cor TYPE string.\n\n    METHODS:\n      constructor IMPORTING iv_cor TYPE string,\n      calcular_area ABSTRACT\n        RETURNING VALUE(rv_area) TYPE p DECIMALS 2,\n      calcular_perimetro ABSTRACT\n        RETURNING VALUE(rv_perimetro) TYPE p DECIMALS 2,\n      desenhar.\nENDCLASS.\n\nCLASS lcl_forma IMPLEMENTATION.\n  METHOD constructor.\n    mv_cor = iv_cor.\n  ENDMETHOD.\n\n  METHOD desenhar.\n    WRITE: / |Desenhando forma de cor { mv_cor }|.\n  ENDMETHOD.\nENDCLASS.\n\n\" Subclasse: C\u00edrculo\nCLASS lcl_circulo DEFINITION INHERITING FROM lcl_forma.\n  PUBLIC SECTION.\n    METHODS:\n      constructor IMPORTING iv_cor TYPE string\n                            iv_raio TYPE p DECIMALS 2,\n      calcular_area REDEFINITION,\n      calcular_perimetro REDEFINITION.\n\n  PRIVATE SECTION.\n    DATA: mv_raio TYPE p DECIMALS 2.\n    CONSTANTS: mc_pi TYPE p DECIMALS 5 VALUE '3.14159'.\nENDCLASS.\n\nCLASS lcl_circulo IMPLEMENTATION.\n  METHOD constructor.\n    super-&gt;constructor( iv_cor ).\n    mv_raio = iv_raio.\n  ENDMETHOD.\n\n  METHOD calcular_area.\n    rv_area = mc_pi * mv_raio * mv_raio.\n  ENDMETHOD.\n\n  METHOD calcular_perimetro.\n    rv_perimetro = 2 * mc_pi * mv_raio.\n  ENDMETHOD.\nENDCLASS.\n\n\" Subclasse: Ret\u00e2ngulo\nCLASS lcl_retangulo DEFINITION INHERITING FROM lcl_forma.\n  PUBLIC SECTION.\n    METHODS:\n      constructor IMPORTING iv_cor TYPE string\n                            iv_largura TYPE p DECIMALS 2\n                            iv_altura TYPE p DECIMALS 2,\n      calcular_area REDEFINITION,\n      calcular_perimetro REDEFINITION.\n\n  PRIVATE SECTION.\n    DATA: mv_largura TYPE p DECIMALS 2,\n          mv_altura TYPE p DECIMALS 2.\nENDCLASS.\n\nCLASS lcl_retangulo IMPLEMENTATION.\n  METHOD constructor.\n    super-&gt;constructor( iv_cor ).\n    mv_largura = iv_largura.\n    mv_altura = iv_altura.\n  ENDMETHOD.\n\n  METHOD calcular_area.\n    rv_area = mv_largura * mv_altura.\n  ENDMETHOD.\n\n  METHOD calcular_perimetro.\n    rv_perimetro = 2 * ( mv_largura + mv_altura ).\n  ENDMETHOD.\nENDCLASS.\n\n\" Uso\nSTART-OF-SELECTION.\n  \" DATA(lo_forma) = NEW lcl_forma( 'azul' ).  \" \u274c ERRO: classe abstrata!\n\n  DATA(lo_circulo) = NEW lcl_circulo(\n    iv_cor = 'vermelho'\n    iv_raio = '5.0'\n  ).\n\n  WRITE: / '\u00c1rea do c\u00edrculo:', lo_circulo-&gt;calcular_area( ).\n  WRITE: / 'Per\u00edmetro:', lo_circulo-&gt;calcular_perimetro( ).\n\n  DATA(lo_ret) = NEW lcl_retangulo(\n    iv_cor = 'azul'\n    iv_largura = '10.0'\n    iv_altura = '5.0'\n  ).\n\n  WRITE: / '\u00c1rea do ret\u00e2ngulo:', lo_ret-&gt;calcular_area( ).\n</code></pre>","tags":["ABAP","OO","Heran\u00e7a","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/5_heranca/#classes-finais-final","title":"\ud83d\udd39 Classes Finais (FINAL)","text":"<pre><code>\" Classe que N\u00c3O pode ser herdada\nCLASS lcl_configuracao DEFINITION FINAL.\n  PUBLIC SECTION.\n    CLASS-DATA: sv_ambiente TYPE string.\n    CLASS-METHODS: inicializar.\nENDCLASS.\n\nCLASS lcl_configuracao IMPLEMENTATION.\n  METHOD inicializar.\n    sv_ambiente = 'PRODU\u00c7\u00c3O'.\n  ENDMETHOD.\nENDCLASS.\n\n\" \u274c ERRO: n\u00e3o se pode herdar de classe FINAL\n\" CLASS lcl_config_extendida DEFINITION INHERITING FROM lcl_configuracao.\n\" ENDCLASS.\n</code></pre> <p>M\u00e9todos Finais:</p> <pre><code>CLASS lcl_base DEFINITION.\n  PUBLIC SECTION.\n    METHODS:\n      metodo_normal,\n      metodo_final FINAL.\nENDCLASS.\n\nCLASS lcl_base IMPLEMENTATION.\n  METHOD metodo_normal.\n    WRITE: / 'M\u00e9todo normal'.\n  ENDMETHOD.\n\n  METHOD metodo_final.\n    WRITE: / 'M\u00e9todo final - n\u00e3o pode ser redefinido'.\n  ENDMETHOD.\nENDCLASS.\n\nCLASS lcl_derivada DEFINITION INHERITING FROM lcl_base.\n  PUBLIC SECTION.\n    METHODS:\n      metodo_normal REDEFINITION.\n      \" metodo_final REDEFINITION.  \" \u274c ERRO: m\u00e9todo \u00e9 FINAL\nENDCLASS.\n\nCLASS lcl_derivada IMPLEMENTATION.\n  METHOD metodo_normal.\n    WRITE: / 'M\u00e9todo redefinido'.\n  ENDMETHOD.\nENDCLASS.\n</code></pre>","tags":["ABAP","OO","Heran\u00e7a","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/5_heranca/#exemplo-completo-sistema-de-funcionarios","title":"\ud83d\udca1 Exemplo Completo: Sistema de Funcion\u00e1rios","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_OO_HERANCA_FUNCIONARIOS\n*&amp;---------------------------------------------------------------------*\nREPORT z_oo_heranca_funcionarios.\n\n\" ========== CLASSE BASE ==========\nCLASS lcl_funcionario DEFINITION ABSTRACT.\n  PUBLIC SECTION.\n    METHODS:\n      constructor IMPORTING iv_nome TYPE string\n                            iv_id TYPE i,\n      calcular_salario ABSTRACT\n        RETURNING VALUE(rv_salario) TYPE p DECIMALS 2,\n      apresentar,\n      get_info RETURNING VALUE(rv_info) TYPE string.\n\n  PROTECTED SECTION.\n    DATA: mv_nome TYPE string,\n          mv_id TYPE i,\n          mv_anos_servico TYPE i VALUE 0.\n\n    METHODS:\n      calcular_bonus \n        RETURNING VALUE(rv_bonus) TYPE p DECIMALS 2.\nENDCLASS.\n\nCLASS lcl_funcionario IMPLEMENTATION.\n  METHOD constructor.\n    mv_nome = iv_nome.\n    mv_id = iv_id.\n  ENDMETHOD.\n\n  METHOD apresentar.\n    WRITE: / |ID: { mv_id }, Nome: { mv_nome }|.\n    WRITE: / |Sal\u00e1rio: { calcular_salario( ) }\u20ac|.\n  ENDMETHOD.\n\n  METHOD get_info.\n    rv_info = |{ mv_id } - { mv_nome }|.\n  ENDMETHOD.\n\n  METHOD calcular_bonus.\n    \" B\u00f3nus de 100\u20ac por ano de servi\u00e7o\n    rv_bonus = mv_anos_servico * 100.\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== SUBCLASSE: PROGRAMADOR ==========\nCLASS lcl_programador DEFINITION INHERITING FROM lcl_funcionario.\n  PUBLIC SECTION.\n    METHODS:\n      constructor IMPORTING iv_nome TYPE string\n                            iv_id TYPE i\n                            iv_linguagem TYPE string\n                            iv_salario_base TYPE p DECIMALS 2,\n      calcular_salario REDEFINITION,\n      apresentar REDEFINITION.\n\n  PRIVATE SECTION.\n    DATA: mv_linguagem TYPE string,\n          mv_salario_base TYPE p DECIMALS 2,\n          mv_projetos_completos TYPE i VALUE 0.\nENDCLASS.\n\nCLASS lcl_programador IMPLEMENTATION.\n  METHOD constructor.\n    super-&gt;constructor( \n      iv_nome = iv_nome\n      iv_id = iv_id\n    ).\n    mv_linguagem = iv_linguagem.\n    mv_salario_base = iv_salario_base.\n  ENDMETHOD.\n\n  METHOD calcular_salario.\n    DATA(lv_bonus_projetos) = mv_projetos_completos * 200.\n    rv_salario = mv_salario_base + calcular_bonus( ) + lv_bonus_projetos.\n  ENDMETHOD.\n\n  METHOD apresentar.\n    super-&gt;apresentar( ).\n    WRITE: / |Linguagem: { mv_linguagem }|.\n    WRITE: / |Projetos completos: { mv_projetos_completos }|.\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== SUBCLASSE: GESTOR ==========\nCLASS lcl_gestor DEFINITION INHERITING FROM lcl_funcionario.\n  PUBLIC SECTION.\n    METHODS:\n      constructor IMPORTING iv_nome TYPE string\n                            iv_id TYPE i\n                            iv_departamento TYPE string\n                            iv_salario_base TYPE p DECIMALS 2,\n      calcular_salario REDEFINITION,\n      apresentar REDEFINITION,\n      adicionar_subordinado IMPORTING io_func TYPE REF TO lcl_funcionario.\n\n  PRIVATE SECTION.\n    DATA: mv_departamento TYPE string,\n          mv_salario_base TYPE p DECIMALS 2,\n          mt_subordinados TYPE TABLE OF REF TO lcl_funcionario.\nENDCLASS.\n\nCLASS lcl_gestor IMPLEMENTATION.\n  METHOD constructor.\n    super-&gt;constructor(\n      iv_nome = iv_nome\n      iv_id = iv_id\n    ).\n    mv_departamento = iv_departamento.\n    mv_salario_base = iv_salario_base.\n  ENDMETHOD.\n\n  METHOD calcular_salario.\n    \" Gestor ganha b\u00f3nus por cada subordinado\n    DATA(lv_bonus_equipa) = lines( mt_subordinados ) * 300.\n    rv_salario = mv_salario_base + calcular_bonus( ) + lv_bonus_equipa.\n  ENDMETHOD.\n\n  METHOD apresentar.\n    super-&gt;apresentar( ).\n    WRITE: / |Departamento: { mv_departamento }|.\n    WRITE: / |Equipa: { lines( mt_subordinados ) } pessoas|.\n  ENDMETHOD.\n\n  METHOD adicionar_subordinado.\n    APPEND io_func TO mt_subordinados.\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== SUBCLASSE: ESTAGI\u00c1RIO ==========\nCLASS lcl_estagiario DEFINITION INHERITING FROM lcl_funcionario.\n  PUBLIC SECTION.\n    METHODS:\n      constructor IMPORTING iv_nome TYPE string\n                            iv_id TYPE i\n                            iv_universidade TYPE string,\n      calcular_salario REDEFINITION,\n      apresentar REDEFINITION.\n\n  PRIVATE SECTION.\n    DATA: mv_universidade TYPE string.\n    CONSTANTS: mc_salario_fixo TYPE p DECIMALS 2 VALUE '800.00'.\nENDCLASS.\n\nCLASS lcl_estagiario IMPLEMENTATION.\n  METHOD constructor.\n    super-&gt;constructor(\n      iv_nome = iv_nome\n      iv_id = iv_id\n    ).\n    mv_universidade = iv_universidade.\n  ENDMETHOD.\n\n  METHOD calcular_salario.\n    rv_salario = mc_salario_fixo.  \" Sal\u00e1rio fixo\n  ENDMETHOD.\n\n  METHOD apresentar.\n    super-&gt;apresentar( ).\n    WRITE: / |Universidade: { mv_universidade }|.\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== PROGRAMA PRINCIPAL ==========\nSTART-OF-SELECTION.\n\n  \" Criar funcion\u00e1rios\n  DATA(lo_prog1) = NEW lcl_programador(\n    iv_nome = 'Jo\u00e3o Silva'\n    iv_id = 1\n    iv_linguagem = 'ABAP'\n    iv_salario_base = '2500.00'\n  ).\n\n  DATA(lo_prog2) = NEW lcl_programador(\n    iv_nome = 'Maria Santos'\n    iv_id = 2\n    iv_linguagem = 'Java'\n    iv_salario_base = '2800.00'\n  ).\n\n  DATA(lo_gestor) = NEW lcl_gestor(\n    iv_nome = 'Carlos Mendes'\n    iv_id = 3\n    iv_departamento = 'TI'\n    iv_salario_base = '4000.00'\n  ).\n\n  DATA(lo_estagiario) = NEW lcl_estagiario(\n    iv_nome = 'Ana Costa'\n    iv_id = 4\n    iv_universidade = 'Universidade de Lisboa'\n  ).\n\n  \" Gestor adiciona subordinados\n  lo_gestor-&gt;adicionar_subordinado( lo_prog1 ).\n  lo_gestor-&gt;adicionar_subordinado( lo_prog2 ).\n  lo_gestor-&gt;adicionar_subordinado( lo_estagiario ).\n\n  \" Apresentar todos\n  WRITE: / '========== PROGRAMADOR 1 =========='.\n  lo_prog1-&gt;apresentar( ).\n  SKIP.\n\n  WRITE: / '========== PROGRAMADOR 2 =========='.\n  lo_prog2-&gt;apresentar( ).\n  SKIP.\n\n  WRITE: / '========== GESTOR =========='.\n  lo_gestor-&gt;apresentar( ).\n  SKIP.\n\n  WRITE: / '========== ESTAGI\u00c1RIO =========='.\n  lo_estagiario-&gt;apresentar( ).\n\n  \" Polimorfismo: lista de funcion\u00e1rios\n  SKIP 2.\n  WRITE: / '========== TODOS OS FUNCION\u00c1RIOS =========='.\n  DATA: lt_todos TYPE TABLE OF REF TO lcl_funcionario.\n\n  APPEND lo_prog1 TO lt_todos.\n  APPEND lo_prog2 TO lt_todos.\n  APPEND lo_gestor TO lt_todos.\n  APPEND lo_estagiario TO lt_todos.\n\n  DATA(lv_total_salarios) = CONV p( 0 DECIMALS 2 ).\n\n  LOOP AT lt_todos INTO DATA(lo_func).\n    WRITE: / lo_func-&gt;get_info( ), '-', lo_func-&gt;calcular_salario( ), '\u20ac'.\n    lv_total_salarios = lv_total_salarios + lo_func-&gt;calcular_salario( ).\n  ENDLOOP.\n\n  SKIP.\n  WRITE: / |Total de sal\u00e1rios: { lv_total_salarios }\u20ac|.\n</code></pre>","tags":["ABAP","OO","Heran\u00e7a","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/5_heranca/#boas-praticas","title":"\ud83c\udfaf Boas Pr\u00e1ticas","text":"","tags":["ABAP","OO","Heran\u00e7a","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/5_heranca/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Usar PROTECTED para dados que subclasses precisam\nPROTECTED SECTION.\n  DATA: mv_dados_compartilhados TYPE string.\n\n\" 2. Chamar super-&gt;constructor em subclasses\nMETHOD constructor.\n  super-&gt;constructor( iv_param ).\n  \" Inicializa\u00e7\u00e3o pr\u00f3pria\nENDMETHOD.\n\n\" 3. Classes abstratas para conceitos gen\u00e9ricos\nCLASS lcl_veiculo DEFINITION ABSTRACT.\n  METHODS calcular_consumo ABSTRACT.\nENDCLASS.\n\n\" 4. FINAL para evitar heran\u00e7a indesejada\nCLASS lcl_utilitario DEFINITION FINAL.\nENDCLASS.\n</code></pre>","tags":["ABAP","OO","Heran\u00e7a","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/5_heranca/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Heran\u00e7a muito profunda (mais de 3-4 n\u00edveis)\n\" Classe -&gt; SubClasse -&gt; SubSubClasse -&gt; SubSubSubClasse  \" \u274c\n\n\" 2. Tornar tudo PRIVATE (dificulta heran\u00e7a)\nPRIVATE SECTION.\n  DATA: mv_tudo_privado TYPE i.  \" \u274c Use PROTECTED\n\n\" 3. Heran\u00e7a apenas para reutilizar c\u00f3digo\n\" Use composi\u00e7\u00e3o em vez de heran\u00e7a quando apropriado\n\n\" 4. Redefinir sem chamar super quando necess\u00e1rio\nMETHOD metodo REDEFINITION.\n  \" Ignora l\u00f3gica importante da superclasse  \" \u274c\n  \" super-&gt;metodo( ).  \" \u2705 Chame quando faz sentido\nENDMETHOD.\n</code></pre>","tags":["ABAP","OO","Heran\u00e7a","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/5_heranca/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>Polimorfismo - Casting e tratamento polim\u00f3rfico</li> <li>Interfaces - Alternativa \u00e0 heran\u00e7a m\u00faltipla</li> <li>Factory Pattern - Criar objetos atrav\u00e9s de heran\u00e7a</li> </ul> <p>Tags: <code>#OO</code> <code>#Heran\u00e7a</code> <code>#INHERITING</code> <code>#ABSTRACT</code> <code>#FINAL</code> <code>#ABAP</code></p>","tags":["ABAP","OO","Heran\u00e7a","Polimorfismo","Programa\u00e7\u00e3o"]},{"location":"objetos/6_polimorfismo/","title":"Polimorfismo em ABAP","text":"","tags":["ABAP","OO","Polimorfismo","Casting","Programa\u00e7\u00e3o"]},{"location":"objetos/6_polimorfismo/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Polimorfismo permite tratar objetos de diferentes classes atrav\u00e9s da mesma interface ou superclasse, possibilitando que um \u00fanico c\u00f3digo funcione com m\u00faltiplos tipos de objetos.</p>","tags":["ABAP","OO","Polimorfismo","Casting","Programa\u00e7\u00e3o"]},{"location":"objetos/6_polimorfismo/#tipos-de-polimorfismo","title":"\ud83c\udfaf Tipos de Polimorfismo","text":"<ol> <li>Polimorfismo por Heran\u00e7a: Usar refer\u00eancias da superclasse</li> <li>Polimorfismo por Interface: Usar refer\u00eancias de interface</li> <li>Method Overriding: Redefinir m\u00e9todos em subclasses</li> </ol>","tags":["ABAP","OO","Polimorfismo","Casting","Programa\u00e7\u00e3o"]},{"location":"objetos/6_polimorfismo/#polimorfismo-com-heranca","title":"\ud83d\udd39 Polimorfismo com Heran\u00e7a","text":"<pre><code>CLASS lcl_animal DEFINITION.\n  PUBLIC SECTION.\n    METHODS: fazer_som.\nENDCLASS.\n\nCLASS lcl_animal IMPLEMENTATION.\n  METHOD fazer_som.\n    WRITE: / 'Som gen\u00e9rico'.\n  ENDMETHOD.\nENDCLASS.\n\nCLASS lcl_cao DEFINITION INHERITING FROM lcl_animal.\n  PUBLIC SECTION.\n    METHODS: fazer_som REDEFINITION.\nENDCLASS.\n\nCLASS lcl_cao IMPLEMENTATION.\n  METHOD fazer_som.\n    WRITE: / 'Au au!'.\n  ENDMETHOD.\nENDCLASS.\n\nCLASS lcl_gato DEFINITION INHERITING FROM lcl_animal.\n  PUBLIC SECTION.\n    METHODS: fazer_som REDEFINITION.\nENDCLASS.\n\nCLASS lcl_gato IMPLEMENTATION.\n  METHOD fazer_som.\n    WRITE: / 'Miau!'.\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== USO POLIM\u00d3RFICO ==========\nSTART-OF-SELECTION.\n\n  \" Tabela de refer\u00eancias \u00e0 superclasse\n  DATA: lt_animais TYPE TABLE OF REF TO lcl_animal.\n\n  \" Adicionar diferentes tipos\n  APPEND NEW lcl_cao( ) TO lt_animais.\n  APPEND NEW lcl_gato( ) TO lt_animais.\n  APPEND NEW lcl_animal( ) TO lt_animais.\n\n  \" Tratar todos uniformemente\n  LOOP AT lt_animais INTO DATA(lo_animal).\n    lo_animal-&gt;fazer_som( ).  \" Chamada polim\u00f3rfica\n  ENDLOOP.\n\n  \" Sa\u00edda:\n  \" Au au!\n  \" Miau!\n  \" Som gen\u00e9rico\n</code></pre>","tags":["ABAP","OO","Polimorfismo","Casting","Programa\u00e7\u00e3o"]},{"location":"objetos/6_polimorfismo/#upcasting-widening-cast","title":"\ud83d\udd39 Upcasting (Widening Cast)","text":"<p>Converter refer\u00eancia de subclasse para superclasse (sempre seguro).</p> <pre><code>DATA: lo_cao TYPE REF TO lcl_cao,\n      lo_animal TYPE REF TO lcl_animal.\n\nlo_cao = NEW lcl_cao( ).\n\n\" Upcasting - sempre funciona\nlo_animal = lo_cao.  \" \u2705 Autom\u00e1tico\nlo_animal-&gt;fazer_som( ).  \" Chama vers\u00e3o do c\u00e3o\n\n\" Ou explicitamente\nlo_animal = CAST lcl_animal( lo_cao ).\n</code></pre>","tags":["ABAP","OO","Polimorfismo","Casting","Programa\u00e7\u00e3o"]},{"location":"objetos/6_polimorfismo/#downcasting-narrowing-cast","title":"\ud83d\udd39 Downcasting (Narrowing Cast)","text":"<p>Converter refer\u00eancia de superclasse para subclasse (requer verifica\u00e7\u00e3o).</p> <pre><code>DATA: lo_animal TYPE REF TO lcl_animal,\n      lo_cao TYPE REF TO lcl_cao.\n\nlo_animal = NEW lcl_cao( ).\n\n\" Downcasting - precisa de CAST e pode falhar\nTRY.\n    lo_cao = CAST lcl_cao( lo_animal ).  \" \u2705 OK\n    WRITE: / 'Downcasting bem-sucedido'.\n  CATCH cx_sy_move_cast_error.\n    WRITE: / 'Erro: n\u00e3o \u00e9 um c\u00e3o'.\nENDTRY.\n\n\" Ou usar ?= (sintaxe antiga)\nTRY.\n    lo_cao ?= lo_animal.\n  CATCH cx_sy_move_cast_error.\n    WRITE: / 'Casting falhou'.\nENDTRY.\n</code></pre>","tags":["ABAP","OO","Polimorfismo","Casting","Programa\u00e7\u00e3o"]},{"location":"objetos/6_polimorfismo/#verificar-tipo-antes-de-cast","title":"\ud83d\udd39 Verificar Tipo Antes de Cast","text":"<pre><code>DATA: lo_animal TYPE REF TO lcl_animal.\n\nlo_animal = NEW lcl_cao( ).\n\n\" Verificar tipo\nIF lo_animal IS INSTANCE OF lcl_cao.\n  DATA(lo_cao) = CAST lcl_cao( lo_animal ).\n  WRITE: / '\u00c9 um c\u00e3o!'.\nELSEIF lo_animal IS INSTANCE OF lcl_gato.\n  DATA(lo_gato) = CAST lcl_gato( lo_animal ).\n  WRITE: / '\u00c9 um gato!'.\nELSE.\n  WRITE: / 'Animal gen\u00e9rico'.\nENDIF.\n</code></pre>","tags":["ABAP","OO","Polimorfismo","Casting","Programa\u00e7\u00e3o"]},{"location":"objetos/6_polimorfismo/#polimorfismo-com-interfaces","title":"\ud83d\udd39 Polimorfismo com Interfaces","text":"<pre><code>INTERFACE lif_voador.\n  METHODS: voar.\nENDINTERFACE.\n\nCLASS lcl_passaro DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_voador.\n    DATA: mv_nome TYPE string.\nENDCLASS.\n\nCLASS lcl_passaro IMPLEMENTATION.\n  METHOD lif_voador~voar.\n    WRITE: / |{ mv_nome } est\u00e1 a voar!|.\n  ENDMETHOD.\nENDCLASS.\n\nCLASS lcl_aviao DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_voador.\n    DATA: mv_modelo TYPE string.\nENDCLASS.\n\nCLASS lcl_aviao IMPLEMENTATION.\n  METHOD lif_voador~voar.\n    WRITE: / |Avi\u00e3o { mv_modelo } descolou!|.\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== USO POLIM\u00d3RFICO ==========\nSTART-OF-SELECTION.\n\n  DATA: lt_voadores TYPE TABLE OF REF TO lif_voador.\n\n  DATA(lo_passaro) = NEW lcl_passaro( ).\n  lo_passaro-&gt;mv_nome = '\u00c1guia'.\n\n  DATA(lo_aviao) = NEW lcl_aviao( ).\n  lo_aviao-&gt;mv_modelo = 'Boeing 747'.\n\n  APPEND lo_passaro TO lt_voadores.\n  APPEND lo_aviao TO lt_voadores.\n\n  LOOP AT lt_voadores INTO DATA(lo_voador).\n    lo_voador-&gt;voar( ).\n  ENDLOOP.\n</code></pre>","tags":["ABAP","OO","Polimorfismo","Casting","Programa\u00e7\u00e3o"]},{"location":"objetos/6_polimorfismo/#case-type-of","title":"\ud83d\udd39 CASE TYPE OF","text":"<p>Processar diferentes tipos de forma espec\u00edfica.</p> <pre><code>METHOD processar_animal.\n  IMPORTING io_animal TYPE REF TO lcl_animal.\n\n  CASE TYPE OF io_animal.\n    WHEN TYPE lcl_cao.\n      DATA(lo_cao) = CAST lcl_cao( io_animal ).\n      WRITE: / 'Processando c\u00e3o...'.\n      lo_cao-&gt;fazer_som( ).\n\n    WHEN TYPE lcl_gato.\n      DATA(lo_gato) = CAST lcl_gato( io_animal ).\n      WRITE: / 'Processando gato...'.\n      lo_gato-&gt;fazer_som( ).\n\n    WHEN OTHERS.\n      WRITE: / 'Animal desconhecido'.\n      io_animal-&gt;fazer_som( ).\n  ENDCASE.\nENDMETHOD.\n</code></pre>","tags":["ABAP","OO","Polimorfismo","Casting","Programa\u00e7\u00e3o"]},{"location":"objetos/6_polimorfismo/#exemplo-completo-sistema-de-pagamentos","title":"\ud83d\udca1 Exemplo Completo: Sistema de Pagamentos","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_OO_POLIMORFISMO_PAGAMENTO\n*&amp;---------------------------------------------------------------------*\nREPORT z_oo_polimorfismo_pagamento.\n\n\" ========== INTERFACE ==========\nINTERFACE lif_meio_pagamento.\n  METHODS:\n    processar\n      IMPORTING iv_valor TYPE p DECIMALS 2\n      RETURNING VALUE(rv_sucesso) TYPE abap_bool,\n    obter_taxa\n      RETURNING VALUE(rv_taxa) TYPE p DECIMALS 2,\n    obter_descricao\n      RETURNING VALUE(rv_desc) TYPE string.\nENDINTERFACE.\n\n\" ========== IMPLEMENTA\u00c7\u00c3O: CART\u00c3O ==========\nCLASS lcl_cartao DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_meio_pagamento.\n\n    METHODS:\n      constructor IMPORTING iv_numero TYPE string\n                            iv_tipo TYPE string.  \" 'CREDITO' ou 'DEBITO'\n\n  PRIVATE SECTION.\n    DATA: mv_numero TYPE string,\n          mv_tipo TYPE string.\nENDCLASS.\n\nCLASS lcl_cartao IMPLEMENTATION.\n  METHOD constructor.\n    mv_numero = iv_numero.\n    mv_tipo = iv_tipo.\n  ENDMETHOD.\n\n  METHOD lif_meio_pagamento~processar.\n    DATA(lv_taxa) = obter_taxa( ).\n    DATA(lv_total) = iv_valor + ( iv_valor * lv_taxa / 100 ).\n\n    WRITE: / |\ud83d\udcb3 Cart\u00e3o { mv_tipo } (****{ substring( val = mv_numero off = 12 len = 4 ) })|.\n    WRITE: / |   Valor: { iv_valor }\u20ac + Taxa ({ lv_taxa }%): { lv_total }\u20ac|.\n    rv_sucesso = abap_true.\n  ENDMETHOD.\n\n  METHOD lif_meio_pagamento~obter_taxa.\n    rv_taxa = COND #( WHEN mv_tipo = 'CREDITO' THEN '2.5'\n                      WHEN mv_tipo = 'DEBITO' THEN '1.0'\n                      ELSE '0.0' ).\n  ENDMETHOD.\n\n  METHOD lif_meio_pagamento~obter_descricao.\n    rv_desc = |Cart\u00e3o { mv_tipo }|.\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== IMPLEMENTA\u00c7\u00c3O: TRANSFER\u00caNCIA ==========\nCLASS lcl_transferencia DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_meio_pagamento.\n\n    METHODS:\n      constructor IMPORTING iv_iban TYPE string.\n\n  PRIVATE SECTION.\n    DATA: mv_iban TYPE string.\nENDCLASS.\n\nCLASS lcl_transferencia IMPLEMENTATION.\n  METHOD constructor.\n    mv_iban = iv_iban.\n  ENDMETHOD.\n\n  METHOD lif_meio_pagamento~processar.\n    WRITE: / |\ud83c\udfe6 Transfer\u00eancia banc\u00e1ria para { mv_iban }|.\n    WRITE: / |   Valor: { iv_valor }\u20ac (sem taxas)|.\n    rv_sucesso = abap_true.\n  ENDMETHOD.\n\n  METHOD lif_meio_pagamento~obter_taxa.\n    rv_taxa = '0.0'.  \" Sem taxa\n  ENDMETHOD.\n\n  METHOD lif_meio_pagamento~obter_descricao.\n    rv_desc = 'Transfer\u00eancia Banc\u00e1ria'.\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== IMPLEMENTA\u00c7\u00c3O: DINHEIRO ==========\nCLASS lcl_dinheiro DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_meio_pagamento.\nENDCLASS.\n\nCLASS lcl_dinheiro IMPLEMENTATION.\n  METHOD lif_meio_pagamento~processar.\n    WRITE: / |\ud83d\udcb5 Pagamento em dinheiro|.\n    WRITE: / |   Valor: { iv_valor }\u20ac|.\n    rv_sucesso = abap_true.\n  ENDMETHOD.\n\n  METHOD lif_meio_pagamento~obter_taxa.\n    rv_taxa = '0.0'.\n  ENDMETHOD.\n\n  METHOD lif_meio_pagamento~obter_descricao.\n    rv_desc = 'Dinheiro'.\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== IMPLEMENTA\u00c7\u00c3O: MBWAY ==========\nCLASS lcl_mbway DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_meio_pagamento.\n\n    METHODS:\n      constructor IMPORTING iv_telemovel TYPE string.\n\n  PRIVATE SECTION.\n    DATA: mv_telemovel TYPE string.\nENDCLASS.\n\nCLASS lcl_mbway IMPLEMENTATION.\n  METHOD constructor.\n    mv_telemovel = iv_telemovel.\n  ENDMETHOD.\n\n  METHOD lif_meio_pagamento~processar.\n    WRITE: / |\ud83d\udcf1 MB WAY para { mv_telemovel }|.\n    WRITE: / |   Valor: { iv_valor }\u20ac (taxa: 0.5%)|.\n    rv_sucesso = abap_true.\n  ENDMETHOD.\n\n  METHOD lif_meio_pagamento~obter_taxa.\n    rv_taxa = '0.5'.\n  ENDMETHOD.\n\n  METHOD lif_meio_pagamento~obter_descricao.\n    rv_desc = 'MB WAY'.\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== PROCESSADOR DE PAGAMENTOS ==========\nCLASS lcl_processador_pagamentos DEFINITION.\n  PUBLIC SECTION.\n    METHODS:\n      processar_compra\n        IMPORTING iv_valor TYPE p DECIMALS 2\n                  it_meios TYPE TABLE.\nENDCLASS.\n\nCLASS lcl_processador_pagamentos IMPLEMENTATION.\n  METHOD processar_compra.\n    DATA: lv_total_pago TYPE p DECIMALS 2 VALUE 0,\n          lv_valor_falta TYPE p DECIMALS 2.\n\n    WRITE: / |\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557|.\n    WRITE: / |\u2551  PROCESSAMENTO DE PAGAMENTO            \u2551|.\n    WRITE: / |\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d|.\n    WRITE: / |Valor da compra: { iv_valor }\u20ac|.\n    SKIP.\n\n    LOOP AT it_meios INTO DATA(lo_meio).\n      CHECK lo_meio IS BOUND.\n\n      lv_valor_falta = iv_valor - lv_total_pago.\n\n      IF lv_valor_falta &lt;= 0.\n        EXIT.\n      ENDIF.\n\n      WRITE: / |\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500|.\n\n      \" Polimorfismo em a\u00e7\u00e3o!\n      IF lo_meio-&gt;processar( lv_valor_falta ) = abap_true.\n        DATA(lv_taxa) = lo_meio-&gt;obter_taxa( ).\n        DATA(lv_com_taxa) = lv_valor_falta + ( lv_valor_falta * lv_taxa / 100 ).\n        lv_total_pago = lv_total_pago + lv_valor_falta.\n        WRITE: / |\u2705 Pagamento confirmado|.\n      ELSE.\n        WRITE: / |\u274c Pagamento falhou|.\n      ENDIF.\n\n      SKIP.\n    ENDLOOP.\n\n    WRITE: / |\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550|.\n    IF lv_total_pago &gt;= iv_valor.\n      WRITE: / |\u2705 PAGAMENTO COMPLETO!|.\n    ELSE.\n      WRITE: / |\u26a0\ufe0f  Falta pagar: { iv_valor - lv_total_pago }\u20ac|.\n    ENDIF.\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== PROGRAMA PRINCIPAL ==========\nSTART-OF-SELECTION.\n\n  \" Criar diferentes meios de pagamento\n  DATA: lt_meios TYPE TABLE OF REF TO lif_meio_pagamento.\n\n  \" Cen\u00e1rio 1: Pagamento com cart\u00e3o de cr\u00e9dito\n  WRITE: / |\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550 CEN\u00c1RIO 1: Cart\u00e3o de Cr\u00e9dito \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550|.\n  SKIP.\n\n  CLEAR lt_meios.\n  APPEND NEW lcl_cartao(\n    iv_numero = '1234567890123456'\n    iv_tipo = 'CREDITO'\n  ) TO lt_meios.\n\n  DATA(lo_proc) = NEW lcl_processador_pagamentos( ).\n  lo_proc-&gt;processar_compra(\n    iv_valor = '100.00'\n    it_meios = lt_meios\n  ).\n\n  SKIP 2.\n\n  \" Cen\u00e1rio 2: Pagamento misto\n  WRITE: / |\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550 CEN\u00c1RIO 2: Pagamento Misto \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550|.\n  SKIP.\n\n  CLEAR lt_meios.\n  APPEND NEW lcl_dinheiro( ) TO lt_meios.\n  APPEND NEW lcl_mbway( iv_telemovel = '912345678' ) TO lt_meios.\n  APPEND NEW lcl_transferencia( iv_iban = 'PT50000000000000000000000' ) TO lt_meios.\n\n  lo_proc-&gt;processar_compra(\n    iv_valor = '250.00'\n    it_meios = lt_meios\n  ).\n\n  SKIP 2.\n\n  \" Cen\u00e1rio 3: Demonstrar CASE TYPE OF\n  WRITE: / |\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550 CEN\u00c1RIO 3: Identificar Tipos \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550|.\n  SKIP.\n\n  DATA(lo_meio_qualquer) = CAST lif_meio_pagamento( NEW lcl_cartao(\n    iv_numero = '9876543210987654'\n    iv_tipo = 'DEBITO'\n  ) ).\n\n  \" Downcasting com verifica\u00e7\u00e3o\n  DATA lo_obj TYPE REF TO object.\n  lo_obj = lo_meio_qualquer.\n\n  CASE TYPE OF lo_obj.\n    WHEN TYPE lcl_cartao.\n      DATA(lo_cartao) = CAST lcl_cartao( lo_obj ).\n      WRITE: / |Tipo identificado: Cart\u00e3o { lo_cartao-&gt;mv_tipo }|.\n\n    WHEN TYPE lcl_transferencia.\n      WRITE: / 'Tipo identificado: Transfer\u00eancia'.\n\n    WHEN TYPE lcl_mbway.\n      WRITE: / 'Tipo identificado: MB WAY'.\n\n    WHEN TYPE lcl_dinheiro.\n      WRITE: / 'Tipo identificado: Dinheiro'.\n\n    WHEN OTHERS.\n      WRITE: / 'Tipo desconhecido'.\n  ENDCASE.\n</code></pre>","tags":["ABAP","OO","Polimorfismo","Casting","Programa\u00e7\u00e3o"]},{"location":"objetos/6_polimorfismo/#quando-usar-polimorfismo","title":"\ud83c\udfaf Quando Usar Polimorfismo","text":"","tags":["ABAP","OO","Polimorfismo","Casting","Programa\u00e7\u00e3o"]},{"location":"objetos/6_polimorfismo/#use-quando","title":"\u2705 Use Quando:","text":"<ul> <li>Precisar tratar objetos diferentes de forma uniforme</li> <li>Implementar estrat\u00e9gias diferentes para o mesmo comportamento</li> <li>Criar c\u00f3digo extens\u00edvel sem modificar c\u00f3digo existente</li> <li>Implementar padr\u00f5es como Strategy, Factory, Decorator</li> </ul>","tags":["ABAP","OO","Polimorfismo","Casting","Programa\u00e7\u00e3o"]},{"location":"objetos/6_polimorfismo/#evite-quando","title":"\u274c Evite Quando:","text":"<ul> <li>As classes n\u00e3o t\u00eam rela\u00e7\u00e3o conceitual</li> <li>Heran\u00e7a \u00e9 for\u00e7ada apenas para reutilizar c\u00f3digo</li> <li>Polimorfismo torna o c\u00f3digo mais complexo sem benef\u00edcios</li> </ul>","tags":["ABAP","OO","Polimorfismo","Casting","Programa\u00e7\u00e3o"]},{"location":"objetos/6_polimorfismo/#diferencas-upcasting-vs-downcasting","title":"\ud83d\udd39 Diferen\u00e7as: Upcasting vs Downcasting","text":"Aspecto Upcasting Downcasting Seguran\u00e7a Sempre seguro Pode falhar Sintaxe Autom\u00e1tico Requer CAST Dire\u00e7\u00e3o Subclasse \u2192 Superclasse Superclasse \u2192 Subclasse Quando Polimorfismo Acesso a m\u00e9todos espec\u00edficos Exemplo <code>lo_animal = lo_cao</code> <code>lo_cao = CAST lcl_cao( lo_animal )</code>","tags":["ABAP","OO","Polimorfismo","Casting","Programa\u00e7\u00e3o"]},{"location":"objetos/6_polimorfismo/#boas-praticas","title":"\ud83d\udca1 Boas Pr\u00e1ticas","text":"","tags":["ABAP","OO","Polimorfismo","Casting","Programa\u00e7\u00e3o"]},{"location":"objetos/6_polimorfismo/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Verificar tipo antes de downcast\nIF lo_obj IS INSTANCE OF lcl_tipo_especifico.\n  DATA(lo_especifico) = CAST lcl_tipo_especifico( lo_obj ).\nENDIF.\n\n\" 2. Usar TRY-CATCH para downcasting\nTRY.\n    DATA(lo_cast) = CAST lcl_classe( lo_objeto ).\n  CATCH cx_sy_move_cast_error.\n    \" Tratar erro\nENDTRY.\n\n\" 3. Preferir interfaces a heran\u00e7a para polimorfismo\nDATA: lt_processadores TYPE TABLE OF REF TO lif_processador.\n\n\" 4. Usar refer\u00eancias gen\u00e9ricas quando apropriado\nDATA: lt_objetos TYPE TABLE OF REF TO object.\n</code></pre>","tags":["ABAP","OO","Polimorfismo","Casting","Programa\u00e7\u00e3o"]},{"location":"objetos/6_polimorfismo/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Downcasting sem verifica\u00e7\u00e3o\nDATA(lo_cao) = CAST lcl_cao( lo_animal ).  \" \u274c Pode falhar!\n\n\" 2. CASE TYPE OF muito extenso\nCASE TYPE OF lo_obj.\n  WHEN TYPE tipo1.\n  WHEN TYPE tipo2.\n  \" ... 50 tipos  \" \u274c Redesenhar solu\u00e7\u00e3o\nENDCASE.\n\n\" 3. For\u00e7ar polimorfismo onde n\u00e3o faz sentido\n\" Nem tudo precisa ser polim\u00f3rfico!\n\n\" 4. Usar heran\u00e7a profunda para polimorfismo\n\" Classe -&gt; Sub1 -&gt; Sub2 -&gt; Sub3 -&gt; Sub4  \" \u274c\n</code></pre>","tags":["ABAP","OO","Polimorfismo","Casting","Programa\u00e7\u00e3o"]},{"location":"objetos/6_polimorfismo/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>Factory Pattern - Criar objetos polim\u00f3rficos</li> <li>Interfaces - Base para polimorfismo</li> <li>Heran\u00e7a - Hierarquias de classes</li> </ul> <p>Tags: <code>#OO</code> <code>#Polimorfismo</code> <code>#Casting</code> <code>#Interfaces</code> <code>#Heran\u00e7a</code> <code>#ABAP</code></p>","tags":["ABAP","OO","Polimorfismo","Casting","Programa\u00e7\u00e3o"]},{"location":"objetos/7_factory_pattern/","title":"Factory Pattern (Padr\u00e3o F\u00e1brica)","text":"","tags":["ABAP","OO","Design Patterns","Factory","Programa\u00e7\u00e3o"]},{"location":"objetos/7_factory_pattern/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>O Factory Pattern \u00e9 um padr\u00e3o de cria\u00e7\u00e3o que fornece uma interface para criar objetos sem especificar suas classes concretas. Centraliza a l\u00f3gica de cria\u00e7\u00e3o de objetos, tornando o c\u00f3digo mais flex\u00edvel e f\u00e1cil de manter.</p>","tags":["ABAP","OO","Design Patterns","Factory","Programa\u00e7\u00e3o"]},{"location":"objetos/7_factory_pattern/#quando-usar","title":"\ud83c\udfaf Quando Usar","text":"<ul> <li>Cria\u00e7\u00e3o de objetos \u00e9 complexa</li> <li>Tipo de objeto depende de condi\u00e7\u00f5es em runtime</li> <li>Deseja desacoplar c\u00f3digo cliente da implementa\u00e7\u00e3o</li> <li>Precisa de l\u00f3gica centralizada de cria\u00e7\u00e3o</li> <li>Criar fam\u00edlias de objetos relacionados</li> </ul>","tags":["ABAP","OO","Design Patterns","Factory","Programa\u00e7\u00e3o"]},{"location":"objetos/7_factory_pattern/#simple-factory-fabrica-simples","title":"\ud83d\udd39 Simple Factory (F\u00e1brica Simples)","text":"<pre><code>\" ========== INTERFACE ==========\nINTERFACE lif_notificacao.\n  METHODS: enviar IMPORTING iv_mensagem TYPE string.\nENDINTERFACE.\n\n\" ========== IMPLEMENTA\u00c7\u00d5ES ==========\nCLASS lcl_email DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_notificacao.\nENDCLASS.\n\nCLASS lcl_email IMPLEMENTATION.\n  METHOD lif_notificacao~enviar.\n    WRITE: / |\ud83d\udce7 Email: { iv_mensagem }|.\n  ENDMETHOD.\nENDCLASS.\n\nCLASS lcl_sms DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_notificacao.\nENDCLASS.\n\nCLASS lcl_sms IMPLEMENTATION.\n  METHOD lif_notificacao~enviar.\n    WRITE: / |\ud83d\udcf1 SMS: { iv_mensagem }|.\n  ENDMETHOD.\nENDCLASS.\n\nCLASS lcl_push DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_notificacao.\nENDCLASS.\n\nCLASS lcl_push IMPLEMENTATION.\n  METHOD lif_notificacao~enviar.\n    WRITE: / |\ud83d\udd14 Push: { iv_mensagem }|.\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== FACTORY ==========\nCLASS lcl_notificacao_factory DEFINITION.\n  PUBLIC SECTION.\n    CLASS-METHODS:\n      criar\n        IMPORTING iv_tipo TYPE string\n        RETURNING VALUE(ro_notificacao) TYPE REF TO lif_notificacao\n        RAISING cx_parameter_invalid.\nENDCLASS.\n\nCLASS lcl_notificacao_factory IMPLEMENTATION.\n  METHOD criar.\n    CASE iv_tipo.\n      WHEN 'EMAIL'.\n        ro_notificacao = NEW lcl_email( ).\n      WHEN 'SMS'.\n        ro_notificacao = NEW lcl_sms( ).\n      WHEN 'PUSH'.\n        ro_notificacao = NEW lcl_push( ).\n      WHEN OTHERS.\n        RAISE EXCEPTION TYPE cx_parameter_invalid.\n    ENDCASE.\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== USO ==========\nSTART-OF-SELECTION.\n\n  TRY.\n      DATA(lo_notif1) = lcl_notificacao_factory=&gt;criar( 'EMAIL' ).\n      lo_notif1-&gt;enviar( 'Bem-vindo!' ).\n\n      DATA(lo_notif2) = lcl_notificacao_factory=&gt;criar( 'SMS' ).\n      lo_notif2-&gt;enviar( 'C\u00f3digo: 1234' ).\n\n      DATA(lo_notif3) = lcl_notificacao_factory=&gt;criar( 'PUSH' ).\n      lo_notif3-&gt;enviar( 'Nova mensagem' ).\n\n    CATCH cx_parameter_invalid.\n      WRITE: / 'Tipo de notifica\u00e7\u00e3o inv\u00e1lido'.\n  ENDTRY.\n</code></pre>","tags":["ABAP","OO","Design Patterns","Factory","Programa\u00e7\u00e3o"]},{"location":"objetos/7_factory_pattern/#factory-method-metodo-fabrica","title":"\ud83d\udd39 Factory Method (M\u00e9todo F\u00e1brica)","text":"<pre><code>\" ========== PRODUTO ==========\nINTERFACE lif_documento.\n  METHODS:\n    abrir,\n    salvar,\n    fechar.\nENDINTERFACE.\n\nCLASS lcl_documento_pdf DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_documento.\nENDCLASS.\n\nCLASS lcl_documento_pdf IMPLEMENTATION.\n  METHOD lif_documento~abrir.\n    WRITE: / '\ud83d\udcc4 Abrindo PDF...'.\n  ENDMETHOD.\n\n  METHOD lif_documento~salvar.\n    WRITE: / '\ud83d\udcbe Salvando PDF...'.\n  ENDMETHOD.\n\n  METHOD lif_documento~fechar.\n    WRITE: / '\u274c Fechando PDF...'.\n  ENDMETHOD.\nENDCLASS.\n\nCLASS lcl_documento_word DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_documento.\nENDCLASS.\n\nCLASS lcl_documento_word IMPLEMENTATION.\n  METHOD lif_documento~abrir.\n    WRITE: / '\ud83d\udcdd Abrindo Word...'.\n  ENDMETHOD.\n\n  METHOD lif_documento~salvar.\n    WRITE: / '\ud83d\udcbe Salvando Word...'.\n  ENDMETHOD.\n\n  METHOD lif_documento~fechar.\n    WRITE: / '\u274c Fechando Word...'.\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== CREATOR (ABSTRATO) ==========\nCLASS lcl_aplicacao DEFINITION ABSTRACT.\n  PUBLIC SECTION.\n    METHODS:\n      criar_documento ABSTRACT\n        RETURNING VALUE(ro_doc) TYPE REF TO lif_documento,\n      novo_documento.\nENDCLASS.\n\nCLASS lcl_aplicacao IMPLEMENTATION.\n  METHOD novo_documento.\n    DATA(lo_doc) = criar_documento( ).\n    lo_doc-&gt;abrir( ).\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== CONCRETE CREATORS ==========\nCLASS lcl_app_pdf DEFINITION INHERITING FROM lcl_aplicacao.\n  PUBLIC SECTION.\n    METHODS: criar_documento REDEFINITION.\nENDCLASS.\n\nCLASS lcl_app_pdf IMPLEMENTATION.\n  METHOD criar_documento.\n    ro_doc = NEW lcl_documento_pdf( ).\n  ENDMETHOD.\nENDCLASS.\n\nCLASS lcl_app_word DEFINITION INHERITING FROM lcl_aplicacao.\n  PUBLIC SECTION.\n    METHODS: criar_documento REDEFINITION.\nENDCLASS.\n\nCLASS lcl_app_word IMPLEMENTATION.\n  METHOD criar_documento.\n    ro_doc = NEW lcl_documento_word( ).\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== USO ==========\nSTART-OF-SELECTION.\n\n  DATA(lo_app_pdf) = NEW lcl_app_pdf( ).\n  lo_app_pdf-&gt;novo_documento( ).\n\n  SKIP.\n\n  DATA(lo_app_word) = NEW lcl_app_word( ).\n  lo_app_word-&gt;novo_documento( ).\n</code></pre>","tags":["ABAP","OO","Design Patterns","Factory","Programa\u00e7\u00e3o"]},{"location":"objetos/7_factory_pattern/#abstract-factory-fabrica-abstrata","title":"\ud83d\udd39 Abstract Factory (F\u00e1brica Abstrata)","text":"<p>Criar fam\u00edlias de objetos relacionados.</p> <pre><code>\" ========== PRODUTOS ==========\nINTERFACE lif_botao.\n  METHODS: renderizar.\nENDINTERFACE.\n\nINTERFACE lif_checkbox.\n  METHODS: renderizar.\nENDINTERFACE.\n\n\" ========== PRODUTOS WINDOWS ==========\nCLASS lcl_botao_windows DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_botao.\nENDCLASS.\n\nCLASS lcl_botao_windows IMPLEMENTATION.\n  METHOD lif_botao~renderizar.\n    WRITE: / '\ud83d\uddb1\ufe0f  [Bot\u00e3o Windows]'.\n  ENDMETHOD.\nENDCLASS.\n\nCLASS lcl_checkbox_windows DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_checkbox.\nENDCLASS.\n\nCLASS lcl_checkbox_windows IMPLEMENTATION.\n  METHOD lif_checkbox~renderizar.\n    WRITE: / '\u2611\ufe0f  Checkbox Windows'.\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== PRODUTOS MAC ==========\nCLASS lcl_botao_mac DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_botao.\nENDCLASS.\n\nCLASS lcl_botao_mac IMPLEMENTATION.\n  METHOD lif_botao~renderizar.\n    WRITE: / '\ud83d\uddb1\ufe0f  [Bot\u00e3o Mac]'.\n  ENDMETHOD.\nENDCLASS.\n\nCLASS lcl_checkbox_mac DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_checkbox.\nENDCLASS.\n\nCLASS lcl_checkbox_mac IMPLEMENTATION.\n  METHOD lif_checkbox~renderizar.\n    WRITE: / '\u2611\ufe0f  Checkbox Mac'.\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== ABSTRACT FACTORY ==========\nINTERFACE lif_ui_factory.\n  METHODS:\n    criar_botao RETURNING VALUE(ro_botao) TYPE REF TO lif_botao,\n    criar_checkbox RETURNING VALUE(ro_checkbox) TYPE REF TO lif_checkbox.\nENDINTERFACE.\n\n\" ========== CONCRETE FACTORIES ==========\nCLASS lcl_windows_factory DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_ui_factory.\nENDCLASS.\n\nCLASS lcl_windows_factory IMPLEMENTATION.\n  METHOD lif_ui_factory~criar_botao.\n    ro_botao = NEW lcl_botao_windows( ).\n  ENDMETHOD.\n\n  METHOD lif_ui_factory~criar_checkbox.\n    ro_checkbox = NEW lcl_checkbox_windows( ).\n  ENDMETHOD.\nENDCLASS.\n\nCLASS lcl_mac_factory DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_ui_factory.\nENDCLASS.\n\nCLASS lcl_mac_factory IMPLEMENTATION.\n  METHOD lif_ui_factory~criar_botao.\n    ro_botao = NEW lcl_botao_mac( ).\n  ENDMETHOD.\n\n  METHOD lif_ui_factory~criar_checkbox.\n    ro_checkbox = NEW lcl_checkbox_mac( ).\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== CLIENTE ==========\nCLASS lcl_aplicacao_ui DEFINITION.\n  PUBLIC SECTION.\n    METHODS:\n      constructor IMPORTING io_factory TYPE REF TO lif_ui_factory,\n      renderizar_interface.\n\n  PRIVATE SECTION.\n    DATA: mo_factory TYPE REF TO lif_ui_factory.\nENDCLASS.\n\nCLASS lcl_aplicacao_ui IMPLEMENTATION.\n  METHOD constructor.\n    mo_factory = io_factory.\n  ENDMETHOD.\n\n  METHOD renderizar_interface.\n    DATA(lo_botao) = mo_factory-&gt;criar_botao( ).\n    DATA(lo_check) = mo_factory-&gt;criar_checkbox( ).\n\n    lo_botao-&gt;renderizar( ).\n    lo_check-&gt;renderizar( ).\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== USO ==========\nSTART-OF-SELECTION.\n\n  WRITE: / '=== Interface Windows ==='.\n  DATA(lo_app_win) = NEW lcl_aplicacao_ui( NEW lcl_windows_factory( ) ).\n  lo_app_win-&gt;renderizar_interface( ).\n\n  SKIP.\n\n  WRITE: / '=== Interface Mac ==='.\n  DATA(lo_app_mac) = NEW lcl_aplicacao_ui( NEW lcl_mac_factory( ) ).\n  lo_app_mac-&gt;renderizar_interface( ).\n</code></pre>","tags":["ABAP","OO","Design Patterns","Factory","Programa\u00e7\u00e3o"]},{"location":"objetos/7_factory_pattern/#exemplo-completo-sistema-de-exportacao","title":"\ud83d\udca1 Exemplo Completo: Sistema de Exporta\u00e7\u00e3o","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_OO_FACTORY_EXPORTACAO\n*&amp;---------------------------------------------------------------------*\nREPORT z_oo_factory_exportacao.\n\n\" ========== INTERFACE DO EXPORTADOR ==========\nINTERFACE lif_exportador.\n  METHODS:\n    exportar\n      IMPORTING it_dados TYPE STANDARD TABLE\n      RETURNING VALUE(rv_resultado) TYPE string,\n    validar_dados\n      IMPORTING it_dados TYPE STANDARD TABLE\n      RETURNING VALUE(rv_valido) TYPE abap_bool,\n    obter_extensao\n      RETURNING VALUE(rv_ext) TYPE string.\nENDINTERFACE.\n\n\" ========== EXPORTADOR CSV ==========\nCLASS lcl_exportador_csv DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_exportador.\nENDCLASS.\n\nCLASS lcl_exportador_csv IMPLEMENTATION.\n  METHOD lif_exportador~exportar.\n    CHECK validar_dados( it_dados ) = abap_true.\n\n    rv_resultado = 'Nome,Idade,Email' &amp;&amp; cl_abap_char_utilities=&gt;newline.\n\n    LOOP AT it_dados INTO DATA(ls_linha).\n      rv_resultado = rv_resultado &amp;&amp; |Dados CSV linha { sy-tabix }| \n                     &amp;&amp; cl_abap_char_utilities=&gt;newline.\n    ENDLOOP.\n\n    WRITE: / |\u2705 Exportado { lines( it_dados ) } linhas para CSV|.\n  ENDMETHOD.\n\n  METHOD lif_exportador~validar_dados.\n    rv_valido = COND #( WHEN it_dados IS NOT INITIAL THEN abap_true\n                        ELSE abap_false ).\n  ENDMETHOD.\n\n  METHOD lif_exportador~obter_extensao.\n    rv_ext = 'csv'.\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== EXPORTADOR JSON ==========\nCLASS lcl_exportador_json DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_exportador.\nENDCLASS.\n\nCLASS lcl_exportador_json IMPLEMENTATION.\n  METHOD lif_exportador~exportar.\n    CHECK validar_dados( it_dados ) = abap_true.\n\n    rv_resultado = '[' &amp;&amp; cl_abap_char_utilities=&gt;newline.\n\n    LOOP AT it_dados INTO DATA(ls_linha).\n      rv_resultado = rv_resultado &amp;&amp; \n                     |  {{ \"linha\": { sy-tabix } }}| &amp;&amp;\n                     cl_abap_char_utilities=&gt;newline.\n    ENDLOOP.\n\n    rv_resultado = rv_resultado &amp;&amp; ']'.\n\n    WRITE: / |\u2705 Exportado { lines( it_dados ) } objetos para JSON|.\n  ENDMETHOD.\n\n  METHOD lif_exportador~validar_dados.\n    rv_valido = COND #( WHEN it_dados IS NOT INITIAL THEN abap_true\n                        ELSE abap_false ).\n  ENDMETHOD.\n\n  METHOD lif_exportador~obter_extensao.\n    rv_ext = 'json'.\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== EXPORTADOR XML ==========\nCLASS lcl_exportador_xml DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_exportador.\nENDCLASS.\n\nCLASS lcl_exportador_xml IMPLEMENTATION.\n  METHOD lif_exportador~exportar.\n    CHECK validar_dados( it_dados ) = abap_true.\n\n    rv_resultado = '&lt;?xml version=\"1.0\"?&gt;' &amp;&amp; cl_abap_char_utilities=&gt;newline.\n    rv_resultado = rv_resultado &amp;&amp; '&lt;dados&gt;' &amp;&amp; cl_abap_char_utilities=&gt;newline.\n\n    LOOP AT it_dados INTO DATA(ls_linha).\n      rv_resultado = rv_resultado &amp;&amp; \n                     |  &lt;linha id=\"{ sy-tabix }\" /&gt;| &amp;&amp;\n                     cl_abap_char_utilities=&gt;newline.\n    ENDLOOP.\n\n    rv_resultado = rv_resultado &amp;&amp; '&lt;/dados&gt;'.\n\n    WRITE: / |\u2705 Exportado { lines( it_dados ) } elementos para XML|.\n  ENDMETHOD.\n\n  METHOD lif_exportador~validar_dados.\n    rv_valido = COND #( WHEN it_dados IS NOT INITIAL THEN abap_true\n                        ELSE abap_false ).\n  ENDMETHOD.\n\n  METHOD lif_exportador~obter_extensao.\n    rv_ext = 'xml'.\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== EXPORTADOR EXCEL ==========\nCLASS lcl_exportador_excel DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES lif_exportador.\nENDCLASS.\n\nCLASS lcl_exportador_excel IMPLEMENTATION.\n  METHOD lif_exportador~exportar.\n    CHECK validar_dados( it_dados ) = abap_true.\n\n    rv_resultado = |Excel Workbook com { lines( it_dados ) } linhas|.\n\n    WRITE: / |\u2705 Exportado { lines( it_dados ) } linhas para Excel|.\n  ENDMETHOD.\n\n  METHOD lif_exportador~validar_dados.\n    rv_valido = COND #( WHEN it_dados IS NOT INITIAL THEN abap_true\n                        ELSE abap_false ).\n  ENDMETHOD.\n\n  METHOD lif_exportador~obter_extensao.\n    rv_ext = 'xlsx'.\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== FACTORY ==========\nCLASS lcl_exportador_factory DEFINITION.\n  PUBLIC SECTION.\n    CLASS-METHODS:\n      criar\n        IMPORTING iv_formato TYPE string\n        RETURNING VALUE(ro_exportador) TYPE REF TO lif_exportador\n        RAISING cx_parameter_invalid,\n      formatos_disponiveis\n        RETURNING VALUE(rt_formatos) TYPE string_table.\nENDCLASS.\n\nCLASS lcl_exportador_factory IMPLEMENTATION.\n  METHOD criar.\n    CASE to_upper( iv_formato ).\n      WHEN 'CSV'.\n        ro_exportador = NEW lcl_exportador_csv( ).\n\n      WHEN 'JSON'.\n        ro_exportador = NEW lcl_exportador_json( ).\n\n      WHEN 'XML'.\n        ro_exportador = NEW lcl_exportador_xml( ).\n\n      WHEN 'EXCEL' OR 'XLSX'.\n        ro_exportador = NEW lcl_exportador_excel( ).\n\n      WHEN OTHERS.\n        RAISE EXCEPTION TYPE cx_parameter_invalid.\n    ENDCASE.\n  ENDMETHOD.\n\n  METHOD formatos_disponiveis.\n    rt_formatos = VALUE #(\n      ( |CSV| )\n      ( |JSON| )\n      ( |XML| )\n      ( |EXCEL| )\n    ).\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== SERVI\u00c7O DE EXPORTA\u00c7\u00c3O ==========\nCLASS lcl_servico_exportacao DEFINITION.\n  PUBLIC SECTION.\n    METHODS:\n      exportar_dados\n        IMPORTING it_dados TYPE STANDARD TABLE\n                  iv_formato TYPE string.\nENDCLASS.\n\nCLASS lcl_servico_exportacao IMPLEMENTATION.\n  METHOD exportar_dados.\n    TRY.\n        \" Factory cria o exportador apropriado\n        DATA(lo_exportador) = lcl_exportador_factory=&gt;criar( iv_formato ).\n\n        \" Usar o exportador\n        DATA(lv_resultado) = lo_exportador-&gt;exportar( it_dados ).\n        DATA(lv_extensao) = lo_exportador-&gt;obter_extensao( ).\n\n        WRITE: / |Arquivo: dados.{ lv_extensao }|.\n\n      CATCH cx_parameter_invalid.\n        WRITE: / |\u274c Formato inv\u00e1lido: { iv_formato }|.\n        WRITE: / 'Formatos dispon\u00edveis:'.\n        LOOP AT lcl_exportador_factory=&gt;formatos_disponiveis( ) INTO DATA(lv_fmt).\n          WRITE: / |  - { lv_fmt }|.\n        ENDLOOP.\n    ENDTRY.\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== PROGRAMA PRINCIPAL ==========\nSTART-OF-SELECTION.\n\n  \" Dados de exemplo\n  DATA: lt_dados TYPE TABLE OF string.\n  lt_dados = VALUE #( ( |Linha 1| ) ( |Linha 2| ) ( |Linha 3| ) ).\n\n  DATA(lo_servico) = NEW lcl_servico_exportacao( ).\n\n  \" Exportar para diferentes formatos\n  WRITE: / '\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557'.\n  WRITE: / '\u2551  SISTEMA DE EXPORTA\u00c7\u00c3O            \u2551'.\n  WRITE: / '\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d'.\n  SKIP.\n\n  WRITE: / '\u2500\u2500\u2500 Exportar para CSV \u2500\u2500\u2500'.\n  lo_servico-&gt;exportar_dados(\n    it_dados = lt_dados\n    iv_formato = 'CSV'\n  ).\n  SKIP.\n\n  WRITE: / '\u2500\u2500\u2500 Exportar para JSON \u2500\u2500\u2500'.\n  lo_servico-&gt;exportar_dados(\n    it_dados = lt_dados\n    iv_formato = 'JSON'\n  ).\n  SKIP.\n\n  WRITE: / '\u2500\u2500\u2500 Exportar para XML \u2500\u2500\u2500'.\n  lo_servico-&gt;exportar_dados(\n    it_dados = lt_dados\n    iv_formato = 'XML'\n  ).\n  SKIP.\n\n  WRITE: / '\u2500\u2500\u2500 Exportar para Excel \u2500\u2500\u2500'.\n  lo_servico-&gt;exportar_dados(\n    it_dados = lt_dados\n    iv_formato = 'EXCEL'\n  ).\n  SKIP.\n\n  WRITE: / '\u2500\u2500\u2500 Formato Inv\u00e1lido \u2500\u2500\u2500'.\n  lo_servico-&gt;exportar_dados(\n    it_dados = lt_dados\n    iv_formato = 'PDF'\n  ).\n</code></pre>","tags":["ABAP","OO","Design Patterns","Factory","Programa\u00e7\u00e3o"]},{"location":"objetos/7_factory_pattern/#vantagens-do-factory-pattern","title":"\ud83c\udfaf Vantagens do Factory Pattern","text":"Vantagem Descri\u00e7\u00e3o Desacoplamento Cliente n\u00e3o conhece classes concretas Centraliza\u00e7\u00e3o L\u00f3gica de cria\u00e7\u00e3o num \u00fanico lugar Flexibilidade F\u00e1cil adicionar novos tipos Manuten\u00e7\u00e3o Mudan\u00e7as isoladas na factory Testabilidade F\u00e1cil mockar objetos","tags":["ABAP","OO","Design Patterns","Factory","Programa\u00e7\u00e3o"]},{"location":"objetos/7_factory_pattern/#variacoes-do-padrao","title":"\ud83d\udd39 Varia\u00e7\u00f5es do Padr\u00e3o","text":"","tags":["ABAP","OO","Design Patterns","Factory","Programa\u00e7\u00e3o"]},{"location":"objetos/7_factory_pattern/#1-static-factory-method","title":"1. Static Factory Method","text":"<pre><code>CLASS lcl_pessoa DEFINITION.\n  PUBLIC SECTION.\n    CLASS-METHODS:\n      criar_adulto RETURNING VALUE(ro_pessoa) TYPE REF TO lcl_pessoa,\n      criar_crianca RETURNING VALUE(ro_pessoa) TYPE REF TO lcl_pessoa.\nENDCLASS.\n</code></pre>","tags":["ABAP","OO","Design Patterns","Factory","Programa\u00e7\u00e3o"]},{"location":"objetos/7_factory_pattern/#2-factory-com-parametros","title":"2. Factory com Par\u00e2metros","text":"<pre><code>CLASS lcl_factory DEFINITION.\n  PUBLIC SECTION.\n    CLASS-METHODS:\n      criar\n        IMPORTING iv_tipo TYPE string\n                  iv_config TYPE any OPTIONAL\n        RETURNING VALUE(ro_obj) TYPE REF TO lif_interface.\nENDCLASS.\n</code></pre>","tags":["ABAP","OO","Design Patterns","Factory","Programa\u00e7\u00e3o"]},{"location":"objetos/7_factory_pattern/#3-factory-com-registro","title":"3. Factory com Registro","text":"<pre><code>CLASS lcl_factory DEFINITION.\n  PUBLIC SECTION.\n    CLASS-METHODS:\n      registrar IMPORTING iv_tipo TYPE string\n                          io_criador TYPE REF TO object,\n      criar IMPORTING iv_tipo TYPE string\n            RETURNING VALUE(ro_obj) TYPE REF TO object.\n\n  PRIVATE SECTION.\n    CLASS-DATA: st_registro TYPE HASHED TABLE OF ... WITH UNIQUE KEY tipo.\nENDCLASS.\n</code></pre>","tags":["ABAP","OO","Design Patterns","Factory","Programa\u00e7\u00e3o"]},{"location":"objetos/7_factory_pattern/#boas-praticas","title":"\ud83d\udca1 Boas Pr\u00e1ticas","text":"","tags":["ABAP","OO","Design Patterns","Factory","Programa\u00e7\u00e3o"]},{"location":"objetos/7_factory_pattern/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Retornar interfaces, n\u00e3o classes concretas\nCLASS-METHODS criar RETURNING VALUE(ro_obj) TYPE REF TO lif_interface.\n\n\" 2. Lan\u00e7ar exce\u00e7\u00f5es para tipos inv\u00e1lidos\nRAISE EXCEPTION TYPE cx_parameter_invalid.\n\n\" 3. Usar m\u00e9todos est\u00e1ticos para factories simples\nCLASS-METHODS criar_pdf RETURNING VALUE(ro_doc) TYPE REF TO lif_documento.\n\n\" 4. Validar par\u00e2metros\nIF iv_tipo IS INITIAL.\n  RAISE EXCEPTION TYPE cx_parameter_invalid.\nENDIF.\n</code></pre>","tags":["ABAP","OO","Design Patterns","Factory","Programa\u00e7\u00e3o"]},{"location":"objetos/7_factory_pattern/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Factory que retorna tipos concretos\nCLASS-METHODS criar RETURNING VALUE(ro_obj) TYPE REF TO lcl_classe_concreta.  \" \u274c\n\n\" 2. Factory sem tratamento de erros\nCASE iv_tipo.\n  WHEN 'A'. ro_obj = NEW lcl_a( ).\n  \" E se n\u00e3o for 'A'?  \" \u274c\nENDCASE.\n\n\" 3. L\u00f3gica de neg\u00f3cio na factory\n\" Factory deve APENAS criar objetos\n\n\" 4. Factory muito complexa\n\" Se ficou complexa demais, refatore\n</code></pre>","tags":["ABAP","OO","Design Patterns","Factory","Programa\u00e7\u00e3o"]},{"location":"objetos/7_factory_pattern/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>Singleton Pattern - Garantir inst\u00e2ncia \u00fanica</li> <li>Polimorfismo - Trabalhar com objetos criados</li> <li>Interfaces - Base para factories</li> </ul> <p>Tags: <code>#OO</code> <code>#DesignPatterns</code> <code>#Factory</code> <code>#CreationalPatterns</code> <code>#ABAP</code></p>","tags":["ABAP","OO","Design Patterns","Factory","Programa\u00e7\u00e3o"]},{"location":"objetos/8_singleton/","title":"Singleton Pattern (Padr\u00e3o Singleton)","text":"","tags":["ABAP","OO","Design Patterns","Singleton","Programa\u00e7\u00e3o"]},{"location":"objetos/8_singleton/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>O Singleton Pattern garante que uma classe tenha apenas uma inst\u00e2ncia e fornece um ponto de acesso global a essa inst\u00e2ncia. \u00c9 \u00fatil quando exatamente um objeto \u00e9 necess\u00e1rio para coordenar a\u00e7\u00f5es em todo o sistema.</p>","tags":["ABAP","OO","Design Patterns","Singleton","Programa\u00e7\u00e3o"]},{"location":"objetos/8_singleton/#quando-usar","title":"\ud83c\udfaf Quando Usar","text":"<ul> <li>Configura\u00e7\u00f5es globais do sistema</li> <li>Pool de conex\u00f5es de base de dados</li> <li>Logger centralizado</li> <li>Cache compartilhado</li> <li>Gestor de recursos \u00fanicos</li> <li>F\u00e1bricas de objetos</li> </ul>","tags":["ABAP","OO","Design Patterns","Singleton","Programa\u00e7\u00e3o"]},{"location":"objetos/8_singleton/#implementacao-basica","title":"\ud83d\udd39 Implementa\u00e7\u00e3o B\u00e1sica","text":"<pre><code>CLASS lcl_singleton DEFINITION CREATE PRIVATE.\n  PUBLIC SECTION.\n    CLASS-METHODS:\n      get_instance\n        RETURNING VALUE(ro_instance) TYPE REF TO lcl_singleton.\n\n    METHODS:\n      fazer_algo.\n\n  PRIVATE SECTION.\n    CLASS-DATA: so_instance TYPE REF TO lcl_singleton.\n\n    METHODS: constructor.\nENDCLASS.\n\nCLASS lcl_singleton IMPLEMENTATION.\n  METHOD get_instance.\n    \" Criar inst\u00e2ncia apenas se n\u00e3o existir\n    IF so_instance IS NOT BOUND.\n      CREATE OBJECT so_instance.\n    ENDIF.\n\n    ro_instance = so_instance.\n  ENDMETHOD.\n\n  METHOD constructor.\n    WRITE: / 'Singleton criado pela primeira vez'.\n  ENDMETHOD.\n\n  METHOD fazer_algo.\n    WRITE: / 'Executando a\u00e7\u00e3o do singleton'.\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== USO ==========\nSTART-OF-SELECTION.\n\n  \" Obter inst\u00e2ncia\n  DATA(lo_obj1) = lcl_singleton=&gt;get_instance( ).\n  lo_obj1-&gt;fazer_algo( ).\n\n  \" Obter novamente - mesma inst\u00e2ncia!\n  DATA(lo_obj2) = lcl_singleton=&gt;get_instance( ).\n  lo_obj2-&gt;fazer_algo( ).\n\n  \" Verificar que s\u00e3o a mesma inst\u00e2ncia\n  IF lo_obj1 = lo_obj2.\n    WRITE: / '\u2705 Mesma inst\u00e2ncia confirmada'.\n  ENDIF.\n\n  \" \u274c ERRO: n\u00e3o se pode criar diretamente\n  \" DATA(lo_obj3) = NEW lcl_singleton( ).  \" Erro de compila\u00e7\u00e3o!\n</code></pre>","tags":["ABAP","OO","Design Patterns","Singleton","Programa\u00e7\u00e3o"]},{"location":"objetos/8_singleton/#singleton-para-configuracao","title":"\ud83d\udd39 Singleton para Configura\u00e7\u00e3o","text":"<pre><code>CLASS lcl_configuracao DEFINITION CREATE PRIVATE.\n  PUBLIC SECTION.\n    CLASS-METHODS:\n      get_instance\n        RETURNING VALUE(ro_instance) TYPE REF TO lcl_configuracao.\n\n    METHODS:\n      set_parametro\n        IMPORTING iv_chave TYPE string\n                  iv_valor TYPE string,\n      get_parametro\n        IMPORTING iv_chave TYPE string\n        RETURNING VALUE(rv_valor) TYPE string,\n      listar_parametros.\n\n  PRIVATE SECTION.\n    CLASS-DATA: so_instance TYPE REF TO lcl_configuracao.\n\n    TYPES: BEGIN OF ty_parametro,\n             chave TYPE string,\n             valor TYPE string,\n           END OF ty_parametro.\n\n    DATA: mt_parametros TYPE HASHED TABLE OF ty_parametro\n                        WITH UNIQUE KEY chave.\n\n    METHODS:\n      constructor,\n      carregar_config_default.\nENDCLASS.\n\nCLASS lcl_configuracao IMPLEMENTATION.\n  METHOD get_instance.\n    IF so_instance IS NOT BOUND.\n      CREATE OBJECT so_instance.\n    ENDIF.\n    ro_instance = so_instance.\n  ENDMETHOD.\n\n  METHOD constructor.\n    WRITE: / '\u2699\ufe0f  Inicializando configura\u00e7\u00f5es...'.\n    carregar_config_default( ).\n  ENDMETHOD.\n\n  METHOD carregar_config_default.\n    set_parametro( iv_chave = 'AMBIENTE' iv_valor = 'PRODU\u00c7\u00c3O' ).\n    set_parametro( iv_chave = 'DEBUG' iv_valor = 'FALSE' ).\n    set_parametro( iv_chave = 'TIMEOUT' iv_valor = '30' ).\n    set_parametro( iv_chave = 'MAX_REGISTROS' iv_valor = '1000' ).\n  ENDMETHOD.\n\n  METHOD set_parametro.\n    INSERT VALUE #( chave = iv_chave valor = iv_valor ) \n           INTO TABLE mt_parametros.\n\n    IF sy-subrc &lt;&gt; 0.\n      MODIFY TABLE mt_parametros FROM VALUE #( chave = iv_chave valor = iv_valor ).\n    ENDIF.\n  ENDMETHOD.\n\n  METHOD get_parametro.\n    READ TABLE mt_parametros \n         WITH TABLE KEY chave = iv_chave\n         INTO DATA(ls_param).\n\n    IF sy-subrc = 0.\n      rv_valor = ls_param-valor.\n    ELSE.\n      rv_valor = ''.\n    ENDIF.\n  ENDMETHOD.\n\n  METHOD listar_parametros.\n    WRITE: / '\u2550\u2550\u2550 CONFIGURA\u00c7\u00d5ES \u2550\u2550\u2550'.\n    LOOP AT mt_parametros INTO DATA(ls_param).\n      WRITE: / |{ ls_param-chave WIDTH = 15 }: { ls_param-valor }|.\n    ENDLOOP.\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== USO ==========\nSTART-OF-SELECTION.\n\n  \" Usar configura\u00e7\u00e3o em diferentes partes do c\u00f3digo\n  DATA(lo_config) = lcl_configuracao=&gt;get_instance( ).\n\n  lo_config-&gt;listar_parametros( ).\n  SKIP.\n\n  \" Alterar configura\u00e7\u00e3o\n  lo_config-&gt;set_parametro( iv_chave = 'DEBUG' iv_valor = 'TRUE' ).\n\n  \" Em outro lugar do c\u00f3digo, mesma inst\u00e2ncia\n  DATA(lo_config2) = lcl_configuracao=&gt;get_instance( ).\n  DATA(lv_debug) = lo_config2-&gt;get_parametro( 'DEBUG' ).\n\n  WRITE: / |Debug est\u00e1: { lv_debug }|.  \" TRUE\n</code></pre>","tags":["ABAP","OO","Design Patterns","Singleton","Programa\u00e7\u00e3o"]},{"location":"objetos/8_singleton/#singleton-para-logger","title":"\ud83d\udd39 Singleton para Logger","text":"<pre><code>CLASS lcl_logger DEFINITION CREATE PRIVATE.\n  PUBLIC SECTION.\n    CLASS-METHODS:\n      get_instance\n        RETURNING VALUE(ro_instance) TYPE REF TO lcl_logger.\n\n    METHODS:\n      log_info\n        IMPORTING iv_mensagem TYPE string,\n      log_warning\n        IMPORTING iv_mensagem TYPE string,\n      log_error\n        IMPORTING iv_mensagem TYPE string,\n      mostrar_logs,\n      limpar_logs.\n\n  PRIVATE SECTION.\n    CLASS-DATA: so_instance TYPE REF TO lcl_logger.\n\n    TYPES: BEGIN OF ty_log,\n             timestamp TYPE timestampl,\n             nivel TYPE string,\n             mensagem TYPE string,\n           END OF ty_log.\n\n    DATA: mt_logs TYPE TABLE OF ty_log.\n\n    METHODS:\n      adicionar_log\n        IMPORTING iv_nivel TYPE string\n                  iv_mensagem TYPE string.\nENDCLASS.\n\nCLASS lcl_logger IMPLEMENTATION.\n  METHOD get_instance.\n    IF so_instance IS NOT BOUND.\n      CREATE OBJECT so_instance.\n    ENDIF.\n    ro_instance = so_instance.\n  ENDMETHOD.\n\n  METHOD log_info.\n    adicionar_log( iv_nivel = 'INFO' iv_mensagem = iv_mensagem ).\n  ENDMETHOD.\n\n  METHOD log_warning.\n    adicionar_log( iv_nivel = 'WARNING' iv_mensagem = iv_mensagem ).\n  ENDMETHOD.\n\n  METHOD log_error.\n    adicionar_log( iv_nivel = 'ERROR' iv_mensagem = iv_mensagem ).\n  ENDMETHOD.\n\n  METHOD adicionar_log.\n    GET TIME STAMP FIELD DATA(lv_timestamp).\n\n    APPEND VALUE #(\n      timestamp = lv_timestamp\n      nivel = iv_nivel\n      mensagem = iv_mensagem\n    ) TO mt_logs.\n\n    \" Imprimir imediatamente (opcional)\n    DATA(lv_icone) = SWITCH string( iv_nivel\n      WHEN 'INFO' THEN '\u2139\ufe0f'\n      WHEN 'WARNING' THEN '\u26a0\ufe0f'\n      WHEN 'ERROR' THEN '\u274c'\n      ELSE '\ud83d\udcdd'\n    ).\n\n    WRITE: / |{ lv_icone } [{ iv_nivel WIDTH = 7 }] { iv_mensagem }|.\n  ENDMETHOD.\n\n  METHOD mostrar_logs.\n    WRITE: / '\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557'.\n    WRITE: / '\u2551           HIST\u00d3RICO DE LOGS            \u2551'.\n    WRITE: / '\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d'.\n\n    LOOP AT mt_logs INTO DATA(ls_log).\n      WRITE: / |{ sy-tabix }. [{ ls_log-nivel }] { ls_log-mensagem }|.\n    ENDLOOP.\n\n    WRITE: / |Total de logs: { lines( mt_logs ) }|.\n  ENDMETHOD.\n\n  METHOD limpar_logs.\n    CLEAR mt_logs.\n    WRITE: / '\ud83d\uddd1\ufe0f  Logs limpos'.\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== USO ==========\nSTART-OF-SELECTION.\n\n  \" Usar logger em diferentes partes\n  DATA(lo_log) = lcl_logger=&gt;get_instance( ).\n\n  lo_log-&gt;log_info( 'Aplica\u00e7\u00e3o iniciada' ).\n  lo_log-&gt;log_info( 'Conectando \u00e0 base de dados...' ).\n  lo_log-&gt;log_warning( 'Cache n\u00e3o encontrado, criando novo' ).\n  lo_log-&gt;log_error( 'Falha ao conectar ao servidor externo' ).\n  lo_log-&gt;log_info( 'Aplica\u00e7\u00e3o finalizada' ).\n\n  SKIP.\n  lo_log-&gt;mostrar_logs( ).\n</code></pre>","tags":["ABAP","OO","Design Patterns","Singleton","Programa\u00e7\u00e3o"]},{"location":"objetos/8_singleton/#singleton-thread-safe-class-constructor","title":"\ud83d\udd39 Singleton Thread-Safe (Class Constructor)","text":"<pre><code>CLASS lcl_singleton_seguro DEFINITION CREATE PRIVATE.\n  PUBLIC SECTION.\n    CLASS-METHODS:\n      class_constructor,\n      get_instance\n        RETURNING VALUE(ro_instance) TYPE REF TO lcl_singleton_seguro.\n\n    METHODS:\n      processar.\n\n  PRIVATE SECTION.\n    CLASS-DATA: so_instance TYPE REF TO lcl_singleton_seguro.\nENDCLASS.\n\nCLASS lcl_singleton_seguro IMPLEMENTATION.\n  METHOD class_constructor.\n    \" Executado automaticamente na primeira utiliza\u00e7\u00e3o da classe\n    \" Thread-safe por natureza em ABAP\n    CREATE OBJECT so_instance.\n    WRITE: / '\ud83d\udd12 Singleton criado de forma thread-safe'.\n  ENDMETHOD.\n\n  METHOD get_instance.\n    ro_instance = so_instance.\n  ENDMETHOD.\n\n  METHOD processar.\n    WRITE: / 'Processando...'.\n  ENDMETHOD.\nENDCLASS.\n</code></pre>","tags":["ABAP","OO","Design Patterns","Singleton","Programa\u00e7\u00e3o"]},{"location":"objetos/8_singleton/#exemplo-completo-cache-singleton","title":"\ud83d\udca1 Exemplo Completo: Cache Singleton","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_OO_SINGLETON_CACHE\n*&amp;---------------------------------------------------------------------*\nREPORT z_oo_singleton_cache.\n\n\" ========== CACHE SINGLETON ==========\nCLASS lcl_cache DEFINITION CREATE PRIVATE.\n  PUBLIC SECTION.\n    CLASS-METHODS:\n      get_instance\n        RETURNING VALUE(ro_instance) TYPE REF TO lcl_cache.\n\n    METHODS:\n      put\n        IMPORTING iv_chave TYPE string\n                  iv_valor TYPE any,\n      get\n        IMPORTING iv_chave TYPE string\n        RETURNING VALUE(rv_valor) TYPE string,\n      existe\n        IMPORTING iv_chave TYPE string\n        RETURNING VALUE(rv_existe) TYPE abap_bool,\n      remover\n        IMPORTING iv_chave TYPE string,\n      limpar,\n      estatisticas.\n\n  PRIVATE SECTION.\n    CLASS-DATA: so_instance TYPE REF TO lcl_cache.\n\n    TYPES: BEGIN OF ty_entrada_cache,\n             chave TYPE string,\n             valor TYPE string,\n             timestamp TYPE timestampl,\n             acessos TYPE i,\n           END OF ty_entrada_cache.\n\n    DATA: mt_cache TYPE HASHED TABLE OF ty_entrada_cache\n                   WITH UNIQUE KEY chave.\n\n    METHODS:\n      constructor.\nENDCLASS.\n\nCLASS lcl_cache IMPLEMENTATION.\n  METHOD get_instance.\n    IF so_instance IS NOT BOUND.\n      CREATE OBJECT so_instance.\n    ENDIF.\n    ro_instance = so_instance.\n  ENDMETHOD.\n\n  METHOD constructor.\n    WRITE: / '\ud83d\udcbe Cache inicializado'.\n  ENDMETHOD.\n\n  METHOD put.\n    GET TIME STAMP FIELD DATA(lv_timestamp).\n\n    DATA(ls_entrada) = VALUE ty_entrada_cache(\n      chave = iv_chave\n      valor = CONV string( iv_valor )\n      timestamp = lv_timestamp\n      acessos = 0\n    ).\n\n    INSERT ls_entrada INTO TABLE mt_cache.\n\n    IF sy-subrc &lt;&gt; 0.\n      MODIFY TABLE mt_cache FROM ls_entrada.\n      WRITE: / |\ud83d\udcdd Cache atualizado: { iv_chave }|.\n    ELSE.\n      WRITE: / |\u2795 Cache adicionado: { iv_chave }|.\n    ENDIF.\n  ENDMETHOD.\n\n  METHOD get.\n    READ TABLE mt_cache \n         WITH TABLE KEY chave = iv_chave\n         ASSIGNING FIELD-SYMBOL(&lt;ls_cache&gt;).\n\n    IF sy-subrc = 0.\n      rv_valor = &lt;ls_cache&gt;-valor.\n      &lt;ls_cache&gt;-acessos = &lt;ls_cache&gt;-acessos + 1.\n      WRITE: / |\u2705 Cache hit: { iv_chave }|.\n    ELSE.\n      WRITE: / |\u274c Cache miss: { iv_chave }|.\n      rv_valor = ''.\n    ENDIF.\n  ENDMETHOD.\n\n  METHOD existe.\n    READ TABLE mt_cache \n         WITH TABLE KEY chave = iv_chave\n         TRANSPORTING NO FIELDS.\n\n    rv_existe = COND #( WHEN sy-subrc = 0 THEN abap_true\n                        ELSE abap_false ).\n  ENDMETHOD.\n\n  METHOD remover.\n    DELETE TABLE mt_cache WITH TABLE KEY chave = iv_chave.\n\n    IF sy-subrc = 0.\n      WRITE: / |\ud83d\uddd1\ufe0f  Removido do cache: { iv_chave }|.\n    ENDIF.\n  ENDMETHOD.\n\n  METHOD limpar.\n    DATA(lv_count) = lines( mt_cache ).\n    CLEAR mt_cache.\n    WRITE: / |\ud83e\uddf9 Cache limpo ({ lv_count } entradas removidas)|.\n  ENDMETHOD.\n\n  METHOD estatisticas.\n    WRITE: / '\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557'.\n    WRITE: / '\u2551      ESTAT\u00cdSTICAS DO CACHE             \u2551'.\n    WRITE: / '\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d'.\n    WRITE: / |Total de entradas: { lines( mt_cache ) }|.\n    SKIP.\n\n    IF mt_cache IS NOT INITIAL.\n      WRITE: / 'Chave', 25 'Acessos', 40 'Timestamp'.\n      WRITE: / '\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500'.\n\n      LOOP AT mt_cache INTO DATA(ls_cache).\n        WRITE: / ls_cache-chave, 25 ls_cache-acessos, 40 ls_cache-timestamp.\n      ENDLOOP.\n    ELSE.\n      WRITE: / '(vazio)'.\n    ENDIF.\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== SERVI\u00c7O QUE USA CACHE ==========\nCLASS lcl_servico_dados DEFINITION.\n  PUBLIC SECTION.\n    METHODS:\n      obter_usuario\n        IMPORTING iv_id TYPE string\n        RETURNING VALUE(rv_nome) TYPE string,\n      obter_produto\n        IMPORTING iv_id TYPE string\n        RETURNING VALUE(rv_desc) TYPE string.\n\n  PRIVATE SECTION.\n    DATA: mo_cache TYPE REF TO lcl_cache.\n\n    METHODS:\n      buscar_usuario_bd\n        IMPORTING iv_id TYPE string\n        RETURNING VALUE(rv_nome) TYPE string,\n      buscar_produto_bd\n        IMPORTING iv_id TYPE string\n        RETURNING VALUE(rv_desc) TYPE string.\nENDCLASS.\n\nCLASS lcl_servico_dados IMPLEMENTATION.\n  METHOD obter_usuario.\n    \" Usar cache singleton\n    mo_cache = lcl_cache=&gt;get_instance( ).\n\n    DATA(lv_chave) = |USER_{ iv_id }|.\n\n    \" Verificar se est\u00e1 em cache\n    IF mo_cache-&gt;existe( lv_chave ) = abap_true.\n      rv_nome = mo_cache-&gt;get( lv_chave ).\n    ELSE.\n      \" Buscar na BD (simulado)\n      rv_nome = buscar_usuario_bd( iv_id ).\n\n      \" Guardar em cache\n      mo_cache-&gt;put( iv_chave = lv_chave iv_valor = rv_nome ).\n    ENDIF.\n  ENDMETHOD.\n\n  METHOD buscar_usuario_bd.\n    WRITE: / |\ud83d\udd0d Buscando usu\u00e1rio { iv_id } na BD...|.\n    rv_nome = |Usu\u00e1rio_{ iv_id }|.\n  ENDMETHOD.\n\n  METHOD obter_produto.\n    mo_cache = lcl_cache=&gt;get_instance( ).\n\n    DATA(lv_chave) = |PROD_{ iv_id }|.\n\n    IF mo_cache-&gt;existe( lv_chave ) = abap_true.\n      rv_desc = mo_cache-&gt;get( lv_chave ).\n    ELSE.\n      rv_desc = buscar_produto_bd( iv_id ).\n      mo_cache-&gt;put( iv_chave = lv_chave iv_valor = rv_desc ).\n    ENDIF.\n  ENDMETHOD.\n\n  METHOD buscar_produto_bd.\n    WRITE: / |\ud83d\udd0d Buscando produto { iv_id } na BD...|.\n    rv_desc = |Produto_{ iv_id }|.\n  ENDMETHOD.\nENDCLASS.\n\n\" ========== PROGRAMA PRINCIPAL ==========\nSTART-OF-SELECTION.\n\n  WRITE: / '\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550'.\n  WRITE: / '      DEMONSTRA\u00c7\u00c3O: CACHE SINGLETON'.\n  WRITE: / '\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550'.\n  SKIP.\n\n  DATA(lo_servico) = NEW lcl_servico_dados( ).\n\n  \" Primeira busca - vai \u00e0 BD\n  WRITE: / '\u2500\u2500\u2500 Primeira busca de usu\u00e1rio 001 \u2500\u2500\u2500'.\n  DATA(lv_user) = lo_servico-&gt;obter_usuario( '001' ).\n  WRITE: / |Resultado: { lv_user }|.\n  SKIP.\n\n  \" Segunda busca - vem do cache\n  WRITE: / '\u2500\u2500\u2500 Segunda busca de usu\u00e1rio 001 \u2500\u2500\u2500'.\n  lv_user = lo_servico-&gt;obter_usuario( '001' ).\n  WRITE: / |Resultado: { lv_user }|.\n  SKIP.\n\n  \" Buscar produto\n  WRITE: / '\u2500\u2500\u2500 Buscar produto 100 \u2500\u2500\u2500'.\n  DATA(lv_prod) = lo_servico-&gt;obter_produto( '100' ).\n  WRITE: / |Resultado: { lv_prod }|.\n  SKIP.\n\n  \" Buscar mesmo produto novamente\n  WRITE: / '\u2500\u2500\u2500 Buscar produto 100 novamente \u2500\u2500\u2500'.\n  lv_prod = lo_servico-&gt;obter_produto( '100' ).\n  WRITE: / |Resultado: { lv_prod }|.\n  SKIP.\n\n  \" Mostrar estat\u00edsticas\n  DATA(lo_cache) = lcl_cache=&gt;get_instance( ).\n  lo_cache-&gt;estatisticas( ).\n  SKIP.\n\n  \" Limpar cache\n  WRITE: / '\u2500\u2500\u2500 Limpar cache \u2500\u2500\u2500'.\n  lo_cache-&gt;limpar( ).\n  SKIP.\n\n  \" Buscar novamente ap\u00f3s limpar\n  WRITE: / '\u2500\u2500\u2500 Buscar usu\u00e1rio 001 ap\u00f3s limpar cache \u2500\u2500\u2500'.\n  lv_user = lo_servico-&gt;obter_usuario( '001' ).\n  WRITE: / |Resultado: { lv_user }|.\n</code></pre>","tags":["ABAP","OO","Design Patterns","Singleton","Programa\u00e7\u00e3o"]},{"location":"objetos/8_singleton/#vantagens-e-desvantagens","title":"\ud83c\udfaf Vantagens e Desvantagens","text":"","tags":["ABAP","OO","Design Patterns","Singleton","Programa\u00e7\u00e3o"]},{"location":"objetos/8_singleton/#vantagens","title":"\u2705 Vantagens","text":"<ul> <li>Acesso controlado \u00e0 \u00fanica inst\u00e2ncia</li> <li>Ponto de acesso global</li> <li>Economia de mem\u00f3ria</li> <li>Inicializa\u00e7\u00e3o tardia (lazy initialization)</li> <li>Estado partilhado consistente</li> </ul>","tags":["ABAP","OO","Design Patterns","Singleton","Programa\u00e7\u00e3o"]},{"location":"objetos/8_singleton/#desvantagens","title":"\u274c Desvantagens","text":"<ul> <li>Dificulta testes unit\u00e1rios</li> <li>Viola Single Responsibility Principle</li> <li>Pode esconder depend\u00eancias</li> <li>Problemas com concorr\u00eancia (em outras linguagens)</li> <li>Estado global pode causar acoplamento</li> </ul>","tags":["ABAP","OO","Design Patterns","Singleton","Programa\u00e7\u00e3o"]},{"location":"objetos/8_singleton/#boas-praticas","title":"\ud83d\udca1 Boas Pr\u00e1ticas","text":"","tags":["ABAP","OO","Design Patterns","Singleton","Programa\u00e7\u00e3o"]},{"location":"objetos/8_singleton/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Usar CREATE PRIVATE\nCLASS lcl_singleton DEFINITION CREATE PRIVATE.\n\n\" 2. Verificar se inst\u00e2ncia existe\nIF so_instance IS NOT BOUND.\n  CREATE OBJECT so_instance.\nENDIF.\n\n\" 3. Usar class_constructor para thread-safety\nCLASS-METHODS class_constructor.\n\n\" 4. Documentar que \u00e9 singleton\n\" Singleton pattern - \u00fanica inst\u00e2ncia global\n</code></pre>","tags":["ABAP","OO","Design Patterns","Singleton","Programa\u00e7\u00e3o"]},{"location":"objetos/8_singleton/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Singleton para tudo\n\" Use apenas quando realmente necess\u00e1rio!\n\n\" 2. Estado mut\u00e1vel excessivo\n\" Mantenha estado m\u00ednimo e controlado\n\n\" 3. L\u00f3gica de neg\u00f3cio no singleton\n\" Singleton deve ser infraestrutura, n\u00e3o neg\u00f3cio\n\n\" 4. Depend\u00eancias circulares\n\" Singleton A -&gt; Singleton B -&gt; Singleton A  \" \u274c\n</code></pre>","tags":["ABAP","OO","Design Patterns","Singleton","Programa\u00e7\u00e3o"]},{"location":"objetos/8_singleton/#alternativas-ao-singleton","title":"\ud83d\udd17 Alternativas ao Singleton","text":"<ol> <li>Dependency Injection: Passar depend\u00eancias explicitamente</li> <li>Service Locator: Registro central de servi\u00e7os</li> <li>Static Class: Se n\u00e3o precisa de estado</li> <li>Factory: Para criar inst\u00e2ncias controladas</li> </ol>","tags":["ABAP","OO","Design Patterns","Singleton","Programa\u00e7\u00e3o"]},{"location":"objetos/8_singleton/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>Factory Pattern - Criar objetos de forma controlada</li> <li>Interfaces - Contratos para singletons</li> <li>Performance - Cache e otimiza\u00e7\u00f5es</li> </ul> <p>Tags: <code>#OO</code> <code>#DesignPatterns</code> <code>#Singleton</code> <code>#CreationalPatterns</code> <code>#Cache</code> <code>#ABAP</code></p>","tags":["ABAP","OO","Design Patterns","Singleton","Programa\u00e7\u00e3o"]},{"location":"performance/","title":"\u26a1 Performance e Boas Pr\u00e1ticas","text":"<p>Guia completo para escrever c\u00f3digo ABAP eficiente e otimizado.</p>","tags":["ABAP","Performance","Otimiza\u00e7\u00e3o","Boas Pr\u00e1ticas"]},{"location":"performance/#o-que-vais-aprender","title":"\ud83d\udcd6 O que vais aprender","text":"<ul> <li>Identificar e eliminar gargalos de performance</li> <li>Otimizar consultas SQL (SELECTs)</li> <li>Usar <code>FOR ALL ENTRIES</code> corretamente</li> <li>Trabalhar eficientemente com tabelas internas</li> <li>Evitar armadilhas comuns (SELECT em LOOP, etc.)</li> <li>Entender e usar \u00edndices de base de dados</li> <li>Analisar performance com SAT (Runtime Analysis)</li> <li>Configurar e usar buffering de tabelas</li> <li>Escolher tipos corretos de tabelas internas</li> </ul>","tags":["ABAP","Performance","Otimiza\u00e7\u00e3o","Boas Pr\u00e1ticas"]},{"location":"performance/#regras-de-ouro","title":"\ud83c\udfaf Regras de Ouro","text":"","tags":["ABAP","Performance","Otimiza\u00e7\u00e3o","Boas Pr\u00e1ticas"]},{"location":"performance/#fazer","title":"\u2705 Fazer","text":"<ol> <li>Minimizar acessos \u00e0 BD: Agregar dados numa \u00fanica query</li> <li>Usar campos indexados: WHERE com campos que t\u00eam \u00edndices</li> <li>Limitar resultados: <code>UP TO n ROWS</code> quando poss\u00edvel</li> <li>Especificar campos: Evitar <code>SELECT *</code></li> <li>Usar <code>FOR ALL ENTRIES</code>: Para substituir SELECTs em LOOP</li> <li>Escolher tipo correto: STANDARD vs SORTED vs HASHED</li> </ol>","tags":["ABAP","Performance","Otimiza\u00e7\u00e3o","Boas Pr\u00e1ticas"]},{"location":"performance/#evitar","title":"\u274c Evitar","text":"<ol> <li>SELECT dentro de LOOP: Causa m\u00faltiplos acessos \u00e0 BD \u26a0\ufe0f</li> <li>FOR ALL ENTRIES sem valida\u00e7\u00e3o: Pode retornar tudo! \ud83d\ude31</li> <li>APPEND em LOOPs grandes: Usar <code>VALUE #()</code> ou <code>INSERT LINES OF</code></li> <li>NESTED LOOPs: Considerar tabelas HASHED</li> <li>Modificar tabela durante LOOP: Comportamento inesperado</li> <li>SELECT *: Desperd\u00edcio de recursos</li> </ol>","tags":["ABAP","Performance","Otimiza\u00e7\u00e3o","Boas Pr\u00e1ticas"]},{"location":"performance/#topicos-principais","title":"\ud83d\udd11 T\u00f3picos Principais","text":"","tags":["ABAP","Performance","Otimiza\u00e7\u00e3o","Boas Pr\u00e1ticas"]},{"location":"performance/#1-for-all-entries","title":"1\ufe0f\u20e3 FOR ALL ENTRIES","text":"<p>T\u00e9cnica essencial para evitar SELECT em LOOP e melhorar drasticamente a performance.</p> <p>Exemplo r\u00e1pido: <pre><code>\" \u274c ERRADO: 1000 queries\nLOOP AT lt_orders INTO DATA(ls_order).\n  SELECT * FROM vbap WHERE vbeln = ls_order-vbeln...\nENDLOOP.\n\n\" \u2705 CORRETO: 2 queries\nIF lt_orders IS NOT INITIAL.\n  SELECT * FROM vbap\n    FOR ALL ENTRIES IN @lt_orders\n    WHERE vbeln = @lt_orders-vbeln...\nENDIF.\n</code></pre></p> <p>Ler mais sobre FOR ALL ENTRIES \u00bb</p>","tags":["ABAP","Performance","Otimiza\u00e7\u00e3o","Boas Pr\u00e1ticas"]},{"location":"performance/#2-indices-de-base-de-dados","title":"2\ufe0f\u20e3 \u00cdndices de Base de Dados","text":"<p>Como usar \u00edndices para acelerar queries SQL at\u00e9 1000x.</p> <p>Pontos-chave: - Usar campos indexados no WHERE - Verificar \u00edndices existentes (SE11) - Criar \u00edndices secund\u00e1rios quando necess\u00e1rio - Medir impacto com ST05</p> <p>Ler mais sobre \u00cdndices \u00bb</p>","tags":["ABAP","Performance","Otimiza\u00e7\u00e3o","Boas Pr\u00e1ticas"]},{"location":"performance/#3-runtime-analysis-sat","title":"3\ufe0f\u20e3 Runtime Analysis (SAT)","text":"<p>Ferramenta para analisar performance em detalhe e identificar hotspots.</p> <p>O que mede: - Tempo de execu\u00e7\u00e3o por m\u00e9todo - N\u00famero de queries \u00e0 BD - Tempo SQL vs processamento ABAP - Consumo de mem\u00f3ria</p> <p>Ler mais sobre SAT \u00bb</p>","tags":["ABAP","Performance","Otimiza\u00e7\u00e3o","Boas Pr\u00e1ticas"]},{"location":"performance/#4-table-buffering","title":"4\ufe0f\u20e3 Table Buffering","text":"<p>Usar cache em mem\u00f3ria para dados que n\u00e3o mudam frequentemente.</p> <p>Tipos de buffering: - Full buffering (tabelas pequenas) - Generic buffering (por grupos) - Single record buffering (por chave)</p> <p>Ganho: At\u00e9 100x mais r\u00e1pido para dados bufferizados!</p> <p>Ler mais sobre Buffering \u00bb</p>","tags":["ABAP","Performance","Otimiza\u00e7\u00e3o","Boas Pr\u00e1ticas"]},{"location":"performance/#5-tabelas-internas-eficientes","title":"5\ufe0f\u20e3 Tabelas Internas Eficientes","text":"<p>Escolher o tipo correto de tabela interna pode melhorar performance em 100x.</p> <p>Compara\u00e7\u00e3o: | Tipo | READ (100k registos) | Quando Usar | |------|---------------------|-------------| | STANDARD | 50ms | LOOPs sequenciais | | SORTED | 0.5ms | Dados ordenados, READs moderados | | HASHED | 0.05ms | Muitos READs por chave |</p> <p>Ler mais sobre Tabelas Internas \u00bb</p>","tags":["ABAP","Performance","Otimiza\u00e7\u00e3o","Boas Pr\u00e1ticas"]},{"location":"performance/#6-armadilhas-comuns","title":"6\ufe0f\u20e3 Armadilhas Comuns","text":"<p>Os 10 erros mais comuns que destroem performance.</p> <p>Top 3: 1. \u274c SELECT em LOOP 2. \u274c SELECT * (todos os campos) 3. \u274c FOR ALL ENTRIES sem valida\u00e7\u00e3o</p> <p>Ler mais sobre Armadilhas \u00bb</p>","tags":["ABAP","Performance","Otimiza\u00e7\u00e3o","Boas Pr\u00e1ticas"]},{"location":"performance/#comparacao-antes-e-depois-da-otimizacao","title":"\ud83d\udcca Compara\u00e7\u00e3o: Antes e Depois da Otimiza\u00e7\u00e3o","text":"","tags":["ABAP","Performance","Otimiza\u00e7\u00e3o","Boas Pr\u00e1ticas"]},{"location":"performance/#cenario-real-relatorio-de-vendas","title":"Cen\u00e1rio Real: Relat\u00f3rio de Vendas","text":"<pre><code>\" \u274c ANTES: 15 minutos\nLOOP AT lt_orders INTO DATA(ls_order).          \" 10.000 orders\n  SELECT * FROM vbap WHERE vbeln = ls_order-vbeln...  \" 10.000 SELECTs\n  LOOP AT lt_items INTO DATA(ls_item).\n    SELECT SINGLE * FROM mara WHERE matnr = ls_item-matnr...  \" 50.000 SELECTs\n  ENDLOOP.\nENDLOOP.\n\n\" \u2705 DEPOIS: 30 segundos\nSELECT * FROM vbak INTO TABLE @DATA(lt_orders)...\nIF lt_orders IS NOT INITIAL.\n  SELECT * FROM vbap FOR ALL ENTRIES IN @lt_orders...  \" 1 SELECT\nENDIF.\n\n\" Criar HASHED table para materiais\nDATA lt_materials TYPE HASHED TABLE OF mara WITH UNIQUE KEY matnr.\nSELECT * FROM mara INTO TABLE @lt_materials FOR ALL ENTRIES...\n\n\" Usar lookups r\u00e1pidos\nLOOP AT lt_items INTO DATA(ls_item).\n  READ TABLE lt_materials WITH TABLE KEY matnr = ls_item-matnr...\nENDLOOP.\n\n\" Resultado: 30x mais r\u00e1pido! \ud83d\ude80\n</code></pre>","tags":["ABAP","Performance","Otimiza\u00e7\u00e3o","Boas Pr\u00e1ticas"]},{"location":"performance/#ferramentas-de-analise","title":"\ud83e\uddea Ferramentas de An\u00e1lise","text":"","tags":["ABAP","Performance","Otimiza\u00e7\u00e3o","Boas Pr\u00e1ticas"]},{"location":"performance/#transacoes-essenciais","title":"Transa\u00e7\u00f5es Essenciais","text":"Transa\u00e7\u00e3o Prop\u00f3sito Quando Usar SAT Runtime Analysis Medir tempo de execu\u00e7\u00e3o detalhado ST05 SQL Trace Ver queries SQL executadas ST02 Buffer Statistics Monitorizar buffers ST10 Table Call Stats Ver acessos a tabelas ST22 ABAP Dumps Analisar erros runtime SE11 Data Dictionary Ver \u00edndices de tabelas <ul> <li>Monitorizar todas as opera\u00e7\u00f5es SQL</li> <li>Identificar SELECTs lentos</li> <li>Ver planos de execu\u00e7\u00e3o</li> </ul>","tags":["ABAP","Performance","Otimiza\u00e7\u00e3o","Boas Pr\u00e1ticas"]},{"location":"performance/#exercicios-praticos","title":"\ud83d\udcda Exerc\u00edcios Pr\u00e1ticos","text":"<p>Temos 10 exerc\u00edcios progressivos em <code>ex01.md</code> a <code>ex10.md</code>:</p> <ul> <li>ex01: Otimizar SELECT dentro de LOOP</li> <li>ex02: Usar FOR ALL ENTRIES corretamente</li> <li>ex03: Trabalhar com tabelas HASHED</li> <li>ex04: Evitar NESTED LOOPs</li> <li>ex05: Buffering de tabelas</li> <li>ex06-ex10: Casos pr\u00e1ticos de otimiza\u00e7\u00e3o</li> </ul>","tags":["ABAP","Performance","Otimiza\u00e7\u00e3o","Boas Pr\u00e1ticas"]},{"location":"performance/#exemplo-completo-antes-e-depois","title":"\ud83d\udca1 Exemplo Completo: Antes e Depois","text":"","tags":["ABAP","Performance","Otimiza\u00e7\u00e3o","Boas Pr\u00e1ticas"]},{"location":"performance/#antes-lento","title":"\ud83d\udc0c Antes (Lento)","text":"<pre><code>REPORT z_performance_bad.\n\nDATA: lt_orders TYPE TABLE OF vbak,\n      lt_items  TYPE TABLE OF vbap.\n\nSELECT * FROM vbak INTO TABLE lt_orders UP TO 1000 ROWS.\n\nLOOP AT lt_orders INTO DATA(ls_order).\n  \" \u274c SELECT dentro de LOOP - 1000 queries!\n  SELECT * FROM vbap\n    INTO TABLE @DATA(lt_temp)\n    WHERE vbeln = @ls_order-vbeln.\n  APPEND LINES OF lt_temp TO lt_items.\nENDLOOP.\n</code></pre> <p>Performance: ~5-10 segundos para 1000 encomendas</p>","tags":["ABAP","Performance","Otimiza\u00e7\u00e3o","Boas Pr\u00e1ticas"]},{"location":"performance/#depois-rapido","title":"\ud83d\ude80 Depois (R\u00e1pido)","text":"<pre><code>REPORT z_performance_good.\n\nDATA: lt_orders TYPE TABLE OF vbak,\n      lt_items  TYPE TABLE OF vbap.\n\nSELECT * FROM vbak INTO TABLE lt_orders UP TO 1000 ROWS.\n\n\" \u2705 Uma \u00fanica query com FOR ALL ENTRIES\nIF lt_orders IS NOT INITIAL.\n  SELECT * FROM vbap\n    INTO TABLE lt_items\n    FOR ALL ENTRIES IN @lt_orders\n    WHERE vbeln = @lt_orders-vbeln.\nENDIF.\n</code></pre> <p>Performance: ~0.5 segundos para 1000 encomendas Melhoria: 10-20x mais r\u00e1pido! \ud83c\udfaf</p>","tags":["ABAP","Performance","Otimiza\u00e7\u00e3o","Boas Pr\u00e1ticas"]},{"location":"performance/#tabelas-internas-standard-vs-sorted-vs-hashed","title":"\ud83d\udd0d Tabelas Internas: Standard vs. Sorted vs. Hashed","text":"Tipo Acesso Uso ideal <code>STANDARD TABLE</code> Sequencial (lento) Pequenas tabelas, sem buscas <code>SORTED TABLE</code> Bin\u00e1rio (m\u00e9dio) Acesso ordenado, buscas m\u00e9dias <code>HASHED TABLE</code> Hash (r\u00e1pido) Buscas frequentes com chave <p>Exemplo com HASHED: <pre><code>DATA lt_materials TYPE HASHED TABLE OF mara \n  WITH UNIQUE KEY matnr.\n\nREAD TABLE lt_materials WITH KEY matnr = 'MAT001' \n  INTO DATA(ls_mat).\n\" O(1) - acesso instant\u00e2neo! \n</code></pre></p>","tags":["ABAP","Performance","Otimiza\u00e7\u00e3o","Boas Pr\u00e1ticas"]},{"location":"performance/#proximos-passos","title":"\ud83d\ude80 Pr\u00f3ximos Passos","text":"<ol> <li>Comece por FOR ALL ENTRIES para otimizar joins</li> <li>Aprenda sobre \u00cdndices para queries mais r\u00e1pidas</li> <li>Use SAT para analisar seus programas</li> <li>Implemente Buffering quando apropriado</li> <li>Otimize Tabelas Internas para melhor performance</li> <li>Evite Armadilhas Comuns de performance</li> </ol>","tags":["ABAP","Performance","Otimiza\u00e7\u00e3o","Boas Pr\u00e1ticas"]},{"location":"performance/1_for_all_entries/","title":"FOR ALL ENTRIES - Guia Completo","text":"<p><code>FOR ALL ENTRIES</code> \u00e9 uma t\u00e9cnica para evitar SELECT dentro de LOOP, melhorando drasticamente a performance.</p>","tags":["ABAP","Performance","FOR ALL ENTRIES","SQL"]},{"location":"performance/1_for_all_entries/#problema-select-em-loop","title":"\ud83d\udd39 Problema: SELECT em LOOP","text":"","tags":["ABAP","Performance","FOR ALL ENTRIES","SQL"]},{"location":"performance/1_for_all_entries/#codigo-ineficiente","title":"\u274c C\u00f3digo Ineficiente","text":"<pre><code>\" Problema: 1000 ordens = 1000 queries \u00e0 BD! \ud83d\ude31\nSELECT * FROM vbak INTO TABLE @DATA(lt_orders) UP TO 1000 ROWS.\n\nDATA lt_items TYPE TABLE OF vbap.\n\nLOOP AT lt_orders INTO DATA(ls_order).\n  \" Cada itera\u00e7\u00e3o faz uma query separada\n  SELECT * FROM vbap\n    INTO TABLE @DATA(lt_temp)\n    WHERE vbeln = @ls_order-vbeln.\n\n  APPEND LINES OF lt_temp TO lt_items.\nENDLOOP.\n\n\" Total: 1001 acessos \u00e0 base de dados! \ud83d\ude31\n</code></pre> <p>Problema: Se tiver 1000 encomendas, faz 1000 SELECTs \u00e0 base de dados. Muito lento!</p>","tags":["ABAP","Performance","FOR ALL ENTRIES","SQL"]},{"location":"performance/1_for_all_entries/#solucao-for-all-entries","title":"\ud83d\udd39 Solu\u00e7\u00e3o: FOR ALL ENTRIES","text":"","tags":["ABAP","Performance","FOR ALL ENTRIES","SQL"]},{"location":"performance/1_for_all_entries/#codigo-otimizado","title":"\u2705 C\u00f3digo Otimizado","text":"<pre><code>\" Solu\u00e7\u00e3o: Apenas 2 queries \u00e0 BD! \u2705\nSELECT * FROM vbak INTO TABLE @DATA(lt_orders) UP TO 1000 ROWS.\n\nDATA lt_items TYPE TABLE OF vbap.\n\n\" \u2705 Valida\u00e7\u00e3o obrigat\u00f3ria\nIF lt_orders IS NOT INITIAL.\n  SELECT * FROM vbap\n    INTO TABLE @lt_items\n    FOR ALL ENTRIES IN @lt_orders\n    WHERE vbeln = @lt_orders-vbeln.\nENDIF.\n\n\" Total: 2 acessos \u00e0 base de dados! \u2705\n</code></pre> <p>Vantagem: Apenas 2 queries independentemente do n\u00famero de encomendas!</p>","tags":["ABAP","Performance","FOR ALL ENTRIES","SQL"]},{"location":"performance/1_for_all_entries/#como-funciona","title":"\ud83d\udd39 Como Funciona","text":"<p>O <code>FOR ALL ENTRIES</code> converte internamente para algo como:</p> <pre><code>SELECT * FROM vbap\nWHERE vbeln IN ('0000001', '0000002', '0000003', ..., '0001000')\n</code></pre> <p>O SAP agrupa os valores e faz a query de forma otimizada.</p>","tags":["ABAP","Performance","FOR ALL ENTRIES","SQL"]},{"location":"performance/1_for_all_entries/#regra-de-ouro","title":"\u26a0\ufe0f REGRA DE OURO","text":"<p>SEMPRE VALIDAR</p> <p>NUNCA use FOR ALL ENTRIES sem validar se a tabela interna est\u00e1 vazia!</p>","tags":["ABAP","Performance","FOR ALL ENTRIES","SQL"]},{"location":"performance/1_for_all_entries/#errado-sem-validacao","title":"\u274c ERRADO (sem valida\u00e7\u00e3o)","text":"<pre><code>DATA lt_orders TYPE TABLE OF vbak.\n\" lt_orders est\u00e1 vazia!\n\n\" PERIGO: Retorna TODOS os registos da tabela! \ud83d\ude31\nSELECT * FROM vbap\n  INTO TABLE @DATA(lt_items)\n  FOR ALL ENTRIES IN @lt_orders\n  WHERE vbeln = @lt_orders-vbeln.\n\n\" Resultado: milh\u00f5es de registos! Sistema pode crashar!\n</code></pre>","tags":["ABAP","Performance","FOR ALL ENTRIES","SQL"]},{"location":"performance/1_for_all_entries/#correto-com-validacao","title":"\u2705 CORRETO (com valida\u00e7\u00e3o)","text":"<pre><code>DATA lt_orders TYPE TABLE OF vbak.\n\n\" \u2705 Sempre validar\nIF lt_orders IS NOT INITIAL.\n  SELECT * FROM vbap\n    INTO TABLE @DATA(lt_items)\n    FOR ALL ENTRIES IN @lt_orders\n    WHERE vbeln = @lt_orders-vbeln.\nENDIF.\n</code></pre>","tags":["ABAP","Performance","FOR ALL ENTRIES","SQL"]},{"location":"performance/1_for_all_entries/#exemplos-praticos","title":"\ud83d\udd39 Exemplos Pr\u00e1ticos","text":"","tags":["ABAP","Performance","FOR ALL ENTRIES","SQL"]},{"location":"performance/1_for_all_entries/#exemplo-1-encomendas-e-itens","title":"Exemplo 1: Encomendas e Itens","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_FAE_ORDERS_ITEMS\n*&amp;---------------------------------------------------------------------*\nREPORT z_fae_orders_items.\n\nDATA: lt_orders TYPE TABLE OF vbak,\n      lt_items  TYPE TABLE OF vbap.\n\nSTART-OF-SELECTION.\n\n  \" 1. Buscar encomendas\n  SELECT * FROM vbak\n    INTO TABLE @lt_orders\n    WHERE erdat &gt;= '20240101'\n    UP TO 100 ROWS.\n\n  \" 2. Validar antes de FOR ALL ENTRIES\n  IF lt_orders IS NOT INITIAL.\n\n    \" 3. Buscar itens das encomendas\n    SELECT * FROM vbap\n      INTO TABLE @lt_items\n      FOR ALL ENTRIES IN @lt_orders\n      WHERE vbeln = @lt_orders-vbeln.\n\n    WRITE: / |Encomendas: { lines( lt_orders ) }|.\n    WRITE: / |Itens: { lines( lt_items ) }|.\n  ELSE.\n    WRITE: / 'Nenhuma encomenda encontrada.'.\n  ENDIF.\n</code></pre>","tags":["ABAP","Performance","FOR ALL ENTRIES","SQL"]},{"location":"performance/1_for_all_entries/#exemplo-2-clientes-e-encomendas","title":"Exemplo 2: Clientes e Encomendas","text":"<pre><code>\" Buscar clientes portugueses\nSELECT * FROM kna1\n  INTO TABLE @DATA(lt_customers)\n  WHERE land1 = 'PT'\n  UP TO 50 ROWS.\n\n\" Buscar encomendas desses clientes\nIF lt_customers IS NOT INITIAL.\n  SELECT * FROM vbak\n    INTO TABLE @DATA(lt_orders)\n    FOR ALL ENTRIES IN @lt_customers\n    WHERE kunnr = @lt_customers-kunnr.\nENDIF.\n</code></pre>","tags":["ABAP","Performance","FOR ALL ENTRIES","SQL"]},{"location":"performance/1_for_all_entries/#exemplo-3-multiplos-campos","title":"Exemplo 3: M\u00faltiplos Campos","text":"<pre><code>\" Pode usar m\u00faltiplos campos na condi\u00e7\u00e3o\nDATA: BEGIN OF ls_key,\n        carrid TYPE s_carr_id,\n        connid TYPE s_conn_id,\n      END OF ls_key.\n\nDATA lt_keys LIKE TABLE OF ls_key.\n\n\" Popular tabela de chaves\nlt_keys = VALUE #(\n  ( carrid = 'LH' connid = '0400' )\n  ( carrid = 'LH' connid = '0402' )\n  ( carrid = 'AA' connid = '0017' )\n).\n\n\" FOR ALL ENTRIES com m\u00faltiplos campos\nIF lt_keys IS NOT INITIAL.\n  SELECT * FROM sflight\n    INTO TABLE @DATA(lt_flights)\n    FOR ALL ENTRIES IN @lt_keys\n    WHERE carrid = @lt_keys-carrid\n      AND connid = @lt_keys-connid.\nENDIF.\n</code></pre>","tags":["ABAP","Performance","FOR ALL ENTRIES","SQL"]},{"location":"performance/1_for_all_entries/#limitacoes-e-cuidados","title":"\ud83d\udd39 Limita\u00e7\u00f5es e Cuidados","text":"","tags":["ABAP","Performance","FOR ALL ENTRIES","SQL"]},{"location":"performance/1_for_all_entries/#1-duplicados","title":"1. Duplicados","text":"<p>FOR ALL ENTRIES remove duplicados automaticamente.</p> <pre><code>DATA lt_ids TYPE TABLE OF vbak-vbeln.\n\nlt_ids = VALUE #( ( '0000001' ) ( '0000001' ) ( '0000002' ) ).\n\n\" Mesmo com 2x '0000001', o SELECT faz:\n\" WHERE vbeln IN ('0000001', '0000002')\nIF lt_ids IS NOT INITIAL.\n  SELECT * FROM vbap\n    INTO TABLE @DATA(lt_items)\n    FOR ALL ENTRIES IN @lt_ids\n    WHERE vbeln = @lt_ids.\nENDIF.\n</code></pre>","tags":["ABAP","Performance","FOR ALL ENTRIES","SQL"]},{"location":"performance/1_for_all_entries/#2-limite-de-registos","title":"2. Limite de Registos","text":"<p>Se a tabela interna for muito grande (&gt; 10.000), pode haver problemas de performance.</p> <p>Solu\u00e7\u00e3o: Processar em lotes (chunks).</p> <pre><code>DATA: lv_lines TYPE i,\n      lv_start TYPE i VALUE 1,\n      lv_end   TYPE i,\n      lt_chunk TYPE TABLE OF vbak.\n\nCONSTANTS lc_chunk_size TYPE i VALUE 1000.\n\nlv_lines = lines( lt_all_orders ).\n\nWHILE lv_start &lt;= lv_lines.\n  lv_end = lv_start + lc_chunk_size - 1.\n\n  \" Processar chunk\n  CLEAR lt_chunk.\n  lt_chunk = lt_all_orders[ lv_start TO lv_end ].\n\n  IF lt_chunk IS NOT INITIAL.\n    SELECT * FROM vbap\n      INTO TABLE @DATA(lt_items_temp)\n      FOR ALL ENTRIES IN @lt_chunk\n      WHERE vbeln = @lt_chunk-vbeln.\n\n    APPEND LINES OF lt_items_temp TO lt_all_items.\n  ENDIF.\n\n  lv_start = lv_start + lc_chunk_size.\nENDWHILE.\n</code></pre>","tags":["ABAP","Performance","FOR ALL ENTRIES","SQL"]},{"location":"performance/1_for_all_entries/#3-campos-vazios","title":"3. Campos Vazios","text":"<p>Cuidado com campos vazios na tabela interna:</p> <pre><code>DATA: BEGIN OF ls_data,\n        kunnr TYPE kunnr,\n        land1 TYPE land1,\n      END OF ls_data.\n\nDATA lt_data LIKE TABLE OF ls_data.\n\n\" Se land1 estiver vazio em alguns registos...\nlt_data = VALUE #(\n  ( kunnr = '0001' land1 = 'PT' )\n  ( kunnr = '0002' land1 = '' )    \" Vazio!\n).\n\n\" Pode retornar registos indesejados\nIF lt_data IS NOT INITIAL.\n  SELECT * FROM kna1\n    INTO TABLE @DATA(lt_customers)\n    FOR ALL ENTRIES IN @lt_data\n    WHERE land1 = @lt_data-land1.  \" Inclui vazios!\nENDIF.\n</code></pre> <p>Solu\u00e7\u00e3o: Filtrar antes do FOR ALL ENTRIES.</p> <pre><code>DELETE lt_data WHERE land1 IS INITIAL.\n\nIF lt_data IS NOT INITIAL.\n  SELECT * FROM kna1...\nENDIF.\n</code></pre>","tags":["ABAP","Performance","FOR ALL ENTRIES","SQL"]},{"location":"performance/1_for_all_entries/#alternativa-inner-join","title":"\ud83d\udd39 Alternativa: INNER JOIN","text":"<p>Nem sempre FOR ALL ENTRIES \u00e9 a melhor op\u00e7\u00e3o. Se as tabelas est\u00e3o relacionadas, use INNER JOIN:</p> <pre><code>\" \u274c FOR ALL ENTRIES desnecess\u00e1rio\nSELECT * FROM vbak INTO TABLE @DATA(lt_orders).\nIF lt_orders IS NOT INITIAL.\n  SELECT * FROM vbap\n    INTO TABLE @DATA(lt_items)\n    FOR ALL ENTRIES IN @lt_orders\n    WHERE vbeln = @lt_orders-vbeln.\nENDIF.\n\n\" \u2705 MELHOR: INNER JOIN\nSELECT h~vbeln,\n       h~kunnr,\n       i~posnr,\n       i~matnr\n  FROM vbak AS h\n  INNER JOIN vbap AS i ON h~vbeln = i~vbeln\n  INTO TABLE @DATA(lt_result).\n</code></pre>","tags":["ABAP","Performance","FOR ALL ENTRIES","SQL"]},{"location":"performance/1_for_all_entries/#quando-usar","title":"\ud83d\udcca Quando Usar","text":"Situa\u00e7\u00e3o Solu\u00e7\u00e3o Recomendada Tabelas relacionadas (FK) INNER JOIN Tabelas sem rela\u00e7\u00e3o direta FOR ALL ENTRIES L\u00f3gica complexa entre queries FOR ALL ENTRIES Dados j\u00e1 em mem\u00f3ria FOR ALL ENTRIES SELECT em LOOP SEMPRE EVITAR!","tags":["ABAP","Performance","FOR ALL ENTRIES","SQL"]},{"location":"performance/1_for_all_entries/#checklist","title":"\ud83d\udca1 Checklist","text":"<p>Antes de usar FOR ALL ENTRIES:</p> <ul> <li>[ ] Verificar se tabela interna <code>IS NOT INITIAL</code></li> <li>[ ] Considerar INNER JOIN como alternativa</li> <li>[ ] Se tabela grande (&gt;10k), usar processamento em chunks</li> <li>[ ] Filtrar campos vazios se necess\u00e1rio</li> <li>[ ] Testar com diferentes volumes de dados</li> </ul>","tags":["ABAP","Performance","FOR ALL ENTRIES","SQL"]},{"location":"performance/1_for_all_entries/#proximo-passo","title":"\ud83d\ude80 Pr\u00f3ximo Passo","text":"<p>Aprenda sobre \u00cdndices de Base de Dados para otimizar ainda mais as queries.</p>","tags":["ABAP","Performance","FOR ALL ENTRIES","SQL"]},{"location":"performance/2_indices/","title":"\u00cdndices de Base de Dados","text":"<p>Os \u00edndices s\u00e3o estruturas que aceleram consultas SQL, mas devem ser usados com cuidado.</p>","tags":["ABAP","Performance","Database","\u00cdndices"]},{"location":"performance/2_indices/#o-que-e-um-indice","title":"\ud83d\udd39 O que \u00e9 um \u00cdndice?","text":"<p>Um \u00edndice \u00e9 como um \u00edndice de livro - permite encontrar dados rapidamente sem ler tudo.</p> <p>Analogia: - Sem \u00edndice: Ler todas as 1000 p\u00e1ginas para encontrar \"ABAP\" - Com \u00edndice: Ir direto \u00e0 p\u00e1gina 234</p>","tags":["ABAP","Performance","Database","\u00cdndices"]},{"location":"performance/2_indices/#tipos-de-indices-no-sap","title":"\ud83d\udd39 Tipos de \u00cdndices no SAP","text":"","tags":["ABAP","Performance","Database","\u00cdndices"]},{"location":"performance/2_indices/#1-indice-primario-primary-index","title":"1. \u00cdndice Prim\u00e1rio (Primary Index)","text":"<p>Criado automaticamente na chave prim\u00e1ria da tabela.</p> <pre><code>\" Tabela SCARR tem chave prim\u00e1ria: CARRID\n\" SELECT usando \u00edndice prim\u00e1rio (R\u00c1PIDO \u2705)\nSELECT SINGLE * FROM scarr\n  INTO @DATA(ls_carrier)\n  WHERE carrid = 'LH'.  \" Usa \u00edndice prim\u00e1rio\n</code></pre>","tags":["ABAP","Performance","Database","\u00cdndices"]},{"location":"performance/2_indices/#2-indice-secundario-secondary-index","title":"2. \u00cdndice Secund\u00e1rio (Secondary Index)","text":"<p>Criado manualmente em campos frequentemente usados em WHERE.</p> <pre><code>\" Se existir \u00edndice secund\u00e1rio em ERDAT\n\" SELECT usando \u00edndice secund\u00e1rio (R\u00c1PIDO \u2705)\nSELECT * FROM vbak\n  INTO TABLE @DATA(lt_orders)\n  WHERE erdat = '20250101'.  \" Usa \u00edndice em ERDAT\n</code></pre>","tags":["ABAP","Performance","Database","\u00cdndices"]},{"location":"performance/2_indices/#como-verificar-indices","title":"\ud83d\udd39 Como Verificar \u00cdndices","text":"","tags":["ABAP","Performance","Database","\u00cdndices"]},{"location":"performance/2_indices/#se11-dicionario-abap","title":"SE11 - Dicion\u00e1rio ABAP","text":"<ol> <li>Transa\u00e7\u00e3o SE11</li> <li>Inserir nome da tabela (ex: <code>VBAK</code>)</li> <li>Clicar em Display</li> <li>Ver aba Indexes</li> </ol>","tags":["ABAP","Performance","Database","\u00cdndices"]},{"location":"performance/2_indices/#se16-visualizacao-de-dados","title":"SE16 - Visualiza\u00e7\u00e3o de Dados","text":"<p>Ao executar SELECT, ver campo \"Index used\" na parte inferior.</p>","tags":["ABAP","Performance","Database","\u00cdndices"]},{"location":"performance/2_indices/#boas-praticas","title":"\ud83d\udd39 Boas Pr\u00e1ticas","text":"","tags":["ABAP","Performance","Database","\u00cdndices"]},{"location":"performance/2_indices/#usar-campos-indexados-no-where","title":"\u2705 Usar Campos Indexados no WHERE","text":"<pre><code>\" \u2705 BOM - usa \u00edndice prim\u00e1rio\nSELECT * FROM vbak\n  INTO TABLE @DATA(lt_orders)\n  WHERE vbeln = '0000001234'.\n\n\" \u2705 BOM - usa \u00edndice secund\u00e1rio (se existir em ERDAT)\nSELECT * FROM vbak\n  INTO TABLE @lt_orders\n  WHERE erdat &gt;= '20250101'.\n\n\" \u274c MAU - campo n\u00e3o indexado\nSELECT * FROM vbak\n  INTO TABLE @lt_orders\n  WHERE bstnk = 'PO12345'.  \" Full table scan!\n</code></pre>","tags":["ABAP","Performance","Database","\u00cdndices"]},{"location":"performance/2_indices/#ordem-correta-dos-campos","title":"\u2705 Ordem Correta dos Campos","text":"<p>Para \u00edndices compostos, usar campos na ordem do \u00edndice:</p> <pre><code>\" \u00cdndice composto: MANDT + ERDAT + AUART\n\" \u2705 BOM - segue ordem do \u00edndice\nSELECT * FROM vbak\n  WHERE mandt = sy-mandt\n    AND erdat = '20250101'\n    AND auart = 'OR'.\n\n\" \u274c MENOS EFICIENTE - ordem incorreta\nSELECT * FROM vbak\n  WHERE auart = 'OR'      \" Campo 3 do \u00edndice\n    AND erdat = '20250101'  \" Campo 2\n    AND mandt = sy-mandt.   \" Campo 1\n</code></pre>","tags":["ABAP","Performance","Database","\u00cdndices"]},{"location":"performance/2_indices/#quando-criar-indices","title":"\ud83d\udd39 Quando Criar \u00cdndices","text":"","tags":["ABAP","Performance","Database","\u00cdndices"]},{"location":"performance/2_indices/#criar-indice-quando","title":"\u2705 Criar \u00cdndice Quando:","text":"<ol> <li>Campo usado frequentemente em WHERE</li> <li>Tabela grande (&gt; 10.000 registos)</li> <li>Performance ruim confirmada (via ST05)</li> <li>Seletividade alta (campo tem muitos valores \u00fanicos)</li> </ol>","tags":["ABAP","Performance","Database","\u00cdndices"]},{"location":"performance/2_indices/#nao-criar-indice-quando","title":"\u274c N\u00c3O Criar \u00cdndice Quando:","text":"<ol> <li>Tabela pequena (&lt; 1.000 registos)</li> <li>Campo raramente usado</li> <li>Campo com poucos valores (ex: STATUS com 3 valores)</li> <li>Tabela com muitos INSERTs/UPDATEs (\u00edndices atrasam escrita)</li> </ol>","tags":["ABAP","Performance","Database","\u00cdndices"]},{"location":"performance/2_indices/#exemplo-analise-de-performance","title":"\ud83d\udd39 Exemplo: An\u00e1lise de Performance","text":"","tags":["ABAP","Performance","Database","\u00cdndices"]},{"location":"performance/2_indices/#cenario","title":"Cen\u00e1rio","text":"<p>Tabela <code>ZTRANSACTIONS</code> com 1.000.000 registos.</p> <pre><code>\" \u274c LENTO - sem \u00edndice em CUSTOMER_ID\nSELECT * FROM ztransactions\n  INTO TABLE @DATA(lt_trans)\n  WHERE customer_id = '12345'.\n\n\" Tempo: 15 segundos \ud83d\ude31 (full table scan)\n</code></pre>","tags":["ABAP","Performance","Database","\u00cdndices"]},{"location":"performance/2_indices/#solucao-criar-indice","title":"Solu\u00e7\u00e3o: Criar \u00cdndice","text":"<p>SE11 \u2192 ZTRANSACTIONS \u2192 Indexes \u2192 Create</p> <pre><code>Index Name: Z01\nFields: CUSTOMER_ID, TRANS_DATE\n</code></pre> <pre><code>\" \u2705 R\u00c1PIDO - com \u00edndice\nSELECT * FROM ztransactions\n  INTO TABLE @DATA(lt_trans)\n  WHERE customer_id = '12345'\n    AND trans_date &gt;= '20250101'.\n\n\" Tempo: 0.2 segundos \u2705 (usando \u00edndice Z01)\n</code></pre>","tags":["ABAP","Performance","Database","\u00cdndices"]},{"location":"performance/2_indices/#monitorizar-uso-de-indices","title":"\ud83d\udd39 Monitorizar Uso de \u00cdndices","text":"","tags":["ABAP","Performance","Database","\u00cdndices"]},{"location":"performance/2_indices/#st05-sql-trace","title":"ST05 - SQL Trace","text":"<ol> <li>Executar ST05</li> <li>Ativar trace SQL</li> <li>Executar programa</li> <li>Desativar trace</li> <li>Analisar resultados</li> </ol> <p>Ver: - Qual \u00edndice foi usado - Tempo de execu\u00e7\u00e3o - N\u00famero de registos lidos</p>","tags":["ABAP","Performance","Database","\u00cdndices"]},{"location":"performance/2_indices/#exemplo-de-analise","title":"Exemplo de An\u00e1lise","text":"<pre><code>Table: VBAK\nAccessed: 1.000.000 rows\nIndex used: None (Table Scan) \u274c\nDuration: 12.3 seconds\n\nRecommendation: Create index on ERDAT\n</code></pre> <p>Ap\u00f3s criar \u00edndice:</p> <pre><code>Table: VBAK\nAccessed: 150 rows\nIndex used: Z01 (ERDAT) \u2705\nDuration: 0.05 seconds\n</code></pre>","tags":["ABAP","Performance","Database","\u00cdndices"]},{"location":"performance/2_indices/#indices-em-tabelas-standard-sap","title":"\ud83d\udd39 \u00cdndices em Tabelas Standard SAP","text":"<p>Cuidado</p> <p>NUNCA modifique tabelas standard SAP! Use \u00edndices secund\u00e1rios.</p>","tags":["ABAP","Performance","Database","\u00cdndices"]},{"location":"performance/2_indices/#ver-indices-existentes","title":"Ver \u00cdndices Existentes","text":"<pre><code>\" Tabela VBAK tem v\u00e1rios \u00edndices secund\u00e1rios\n\" Ver em SE11 \u2192 VBAK \u2192 Indexes\n</code></pre> <p>\u00cdndices comuns em VBAK: - <code>0</code> - Prim\u00e1rio (VBELN) - <code>1</code> - ERDAT, ERZET - <code>2</code> - AUART, ERDAT - <code>3</code> - KUNNR</p>","tags":["ABAP","Performance","Database","\u00cdndices"]},{"location":"performance/2_indices/#database-hints-avancado","title":"\ud83d\udd39 Database Hints (Avan\u00e7ado)","text":"<p>For\u00e7ar uso de \u00edndice espec\u00edfico:</p> <pre><code>\" For\u00e7ar uso do \u00edndice Z01\nSELECT * FROM ztransactions\n  INTO TABLE @DATA(lt_trans)\n  %_HINTS ORACLE 'INDEX(\"ZTRANSACTIONS\" \"Z01\")'\n  WHERE customer_id = '12345'.\n</code></pre> <p>Aten\u00e7\u00e3o</p> <p>S\u00f3 use hints se souber o que est\u00e1 a fazer. Pode piorar performance!</p>","tags":["ABAP","Performance","Database","\u00cdndices"]},{"location":"performance/2_indices/#indices-e-for-all-entries","title":"\ud83d\udd39 \u00cdndices e FOR ALL ENTRIES","text":"<p>FOR ALL ENTRIES n\u00e3o usa \u00edndices da mesma forma:</p> <pre><code>DATA lt_customers TYPE TABLE OF kna1-kunnr.\n\n\" Popular com 1000 clientes\nlt_customers = VALUE #( ( '0001' ) ( '0002' ) ... ( '1000' ) ).\n\n\" Converte internamente para:\n\" WHERE kunnr IN ('0001', '0002', ..., '1000')\nIF lt_customers IS NOT INITIAL.\n  SELECT * FROM vbak\n    INTO TABLE @DATA(lt_orders)\n    FOR ALL ENTRIES IN @lt_customers\n    WHERE kunnr = @lt_customers-kunnr.\nENDIF.\n</code></pre> <p>Mesmo com \u00edndice em KUNNR, pode ser lento se lista for muito grande (&gt;5000).</p>","tags":["ABAP","Performance","Database","\u00cdndices"]},{"location":"performance/2_indices/#exemplo-completo","title":"\ud83d\udd39 Exemplo Completo","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_INDEX_DEMO\n*&amp;---------------------------------------------------------------------*\nREPORT z_index_demo.\n\nPARAMETERS: p_kunnr TYPE kunnr OBLIGATORY.\n\nDATA: lt_orders TYPE TABLE OF vbak,\n      lv_start  TYPE timestampl,\n      lv_end    TYPE timestampl,\n      lv_diff   TYPE int8.\n\nSTART-OF-SELECTION.\n\n  \" Capturar tempo inicial\n  GET TIME STAMP FIELD lv_start.\n\n  \" \u2705 Query otimizada (usa \u00edndice em KUNNR - \u00edndice 3)\n  SELECT * FROM vbak\n    INTO TABLE @lt_orders\n    WHERE kunnr = @p_kunnr\n      AND erdat &gt;= '20240101'\n    UP TO 1000 ROWS.\n\n  \" Capturar tempo final\n  GET TIME STAMP FIELD lv_end.\n\n  \" Calcular diferen\u00e7a em milissegundos\n  lv_diff = cl_abap_tstmp=&gt;subtract(\n    tstmp1 = lv_end\n    tstmp2 = lv_start\n  ).\n\n  \" Mostrar resultados\n  WRITE: / |Registos encontrados: { lines( lt_orders ) }|.\n  WRITE: / |Tempo de execu\u00e7\u00e3o: { lv_diff } microssegundos|.\n\n  IF lv_diff &gt; 1000000.  \" &gt; 1 segundo\n    WRITE: / '\u26a0\ufe0f Performance ruim! Considerar otimiza\u00e7\u00e3o.'.\n  ELSE.\n    WRITE: / '\u2705 Performance boa!'.\n  ENDIF.\n</code></pre>","tags":["ABAP","Performance","Database","\u00cdndices"]},{"location":"performance/2_indices/#checklist-de-otimizacao","title":"\ud83d\udca1 Checklist de Otimiza\u00e7\u00e3o","text":"<ul> <li>[ ] Verificar \u00edndices existentes (SE11)</li> <li>[ ] Usar campos indexados no WHERE</li> <li>[ ] Seguir ordem dos campos do \u00edndice</li> <li>[ ] Testar com ST05 (SQL Trace)</li> <li>[ ] Considerar criar \u00edndice secund\u00e1rio se necess\u00e1rio</li> <li>[ ] Validar seletividade do \u00edndice</li> <li>[ ] Medir tempo antes e depois</li> </ul>","tags":["ABAP","Performance","Database","\u00cdndices"]},{"location":"performance/2_indices/#proximo-passo","title":"\ud83d\ude80 Pr\u00f3ximo Passo","text":"<p>Aprenda a usar Runtime Analysis (SAT) para an\u00e1lise profunda de performance.</p>","tags":["ABAP","Performance","Database","\u00cdndices"]},{"location":"performance/3_runtime_analysis/","title":"Runtime Analysis (SAT)","text":"<p>A transa\u00e7\u00e3o SAT (antigamente SE30) permite analisar performance de programas ABAP em detalhe.</p>","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#o-que-e-o-sat","title":"\ud83d\udd39 O que \u00e9 o SAT?","text":"<p>O SAT (Runtime Analysis Tools) mede: - Tempo de execu\u00e7\u00e3o de cada m\u00e9todo/fun\u00e7\u00e3o - N\u00famero de chamadas a base de dados - Tempo gasto em SQL vs processamento ABAP - Hotspots (pontos mais lentos do c\u00f3digo)</p>","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#como-usar","title":"\ud83d\udd39 Como Usar","text":"","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#passo-1-executar-sat","title":"Passo 1: Executar SAT","text":"<ol> <li>Transa\u00e7\u00e3o SAT</li> <li>Inserir nome do programa/transa\u00e7\u00e3o</li> <li>Clicar em Execute (F8)</li> <li>Programa executa e dados s\u00e3o capturados</li> <li>Ver an\u00e1lise autom\u00e1tica</li> </ol>","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#passo-2-analisar-resultados","title":"Passo 2: Analisar Resultados","text":"<p>O SAT mostra: - Hit List: M\u00e9todos mais lentos - Call Hierarchy: Hierarquia de chamadas - Database Accesses: Queries SQL executadas - Memory Usage: Consumo de mem\u00f3ria</p>","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#exemplo-pratico","title":"\ud83d\udd39 Exemplo Pr\u00e1tico","text":"","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#programa-com-problema-de-performance","title":"Programa com Problema de Performance","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_SLOW_PROGRAM\n*&amp;---------------------------------------------------------------------*\nREPORT z_slow_program.\n\nDATA: lt_orders TYPE TABLE OF vbak,\n      lt_items  TYPE TABLE OF vbap.\n\nSTART-OF-SELECTION.\n\n  \" 1. Buscar ordens\n  SELECT * FROM vbak\n    INTO TABLE lt_orders\n    WHERE erdat &gt;= '20240101'.\n\n  \" \u274c PROBLEMA: SELECT em LOOP\n  LOOP AT lt_orders INTO DATA(ls_order).\n    SELECT * FROM vbap\n      INTO TABLE DATA(lt_temp)\n      WHERE vbeln = ls_order-vbeln.\n\n    APPEND LINES OF lt_temp TO lt_items.\n  ENDLOOP.\n\n  WRITE: / |Ordens: { lines( lt_orders ) }|.\n  WRITE: / |Itens: { lines( lt_items ) }|.\n</code></pre>","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#executar-no-sat","title":"Executar no SAT","text":"<ol> <li>SAT \u2192 Inserir <code>Z_SLOW_PROGRAM</code></li> <li>Execute</li> <li>Programa roda e dados s\u00e3o capturados</li> </ol>","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#resultados-do-sat","title":"Resultados do SAT","text":"<pre><code>\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\nRuntime Analysis - Z_SLOW_PROGRAM\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\nTotal Runtime: 15.234 seconds\n\nHit List (Top Consumers):\n\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\nRank | Time (s) | %    | Calls | Method/Function\n\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\n1    | 14.500   | 95%  | 1,000 | SELECT FROM VBAP\n2    | 0.500    | 3%   | 1     | SELECT FROM VBAK\n3    | 0.234    | 2%   | 1,000 | LOOP AT LT_ORDERS\n\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\n\nDatabase Accesses: 1,001 queries\n  - VBAK: 1 query (0.5s)\n  - VBAP: 1,000 queries (14.5s) \u274c PROBLEMA!\n\nRecommendation:\n\u26a0\ufe0f AVOID SELECT IN LOOP - Use FOR ALL ENTRIES or JOIN\n</code></pre>","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#interpretar-resultados","title":"\ud83d\udd39 Interpretar Resultados","text":"","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#1-hit-list","title":"1. Hit List","text":"<p>Mostra onde o tempo \u00e9 gasto:</p> <pre><code>95% do tempo em SELECT de VBAP \u2192 PROBLEMA!\n</code></pre>","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#2-database-accesses","title":"2. Database Accesses","text":"<pre><code>1,000 SELECTs na mesma tabela \u2192 SELECT em LOOP \u274c\n</code></pre>","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#3-call-hierarchy","title":"3. Call Hierarchy","text":"<p>Visualizar hierarquia de chamadas:</p> <pre><code>Z_SLOW_PROGRAM\n  \u2514\u2500 START-OF-SELECTION\n      \u251c\u2500 SELECT FROM VBAK (0.5s)\n      \u2514\u2500 LOOP AT LT_ORDERS\n          \u2514\u2500 SELECT FROM VBAP (14.5s) \u274c HOTSPOT!\n</code></pre>","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#programa-otimizado","title":"\ud83d\udd39 Programa Otimizado","text":"<p>Ap\u00f3s identificar o problema, corrigir:</p> <pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_FAST_PROGRAM\n*&amp;---------------------------------------------------------------------*\nREPORT z_fast_program.\n\nDATA: lt_orders TYPE TABLE OF vbak,\n      lt_items  TYPE TABLE OF vbap.\n\nSTART-OF-SELECTION.\n\n  \" 1. Buscar ordens\n  SELECT * FROM vbak\n    INTO TABLE lt_orders\n    WHERE erdat &gt;= '20240101'.\n\n  \" \u2705 SOLU\u00c7\u00c3O: FOR ALL ENTRIES\n  IF lt_orders IS NOT INITIAL.\n    SELECT * FROM vbap\n      INTO TABLE lt_items\n      FOR ALL ENTRIES IN lt_orders\n      WHERE vbeln = lt_orders-vbeln.\n  ENDIF.\n\n  WRITE: / |Ordens: { lines( lt_orders ) }|.\n  WRITE: / |Itens: { lines( lt_items ) }|.\n</code></pre>","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#executar-no-sat-novamente","title":"Executar no SAT Novamente","text":"<pre><code>\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\nRuntime Analysis - Z_FAST_PROGRAM\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\nTotal Runtime: 0.812 seconds \u2705 (era 15.234s)\n\nHit List:\n\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\nRank | Time (s) | %    | Calls | Method/Function\n\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\n1    | 0.500    | 62%  | 1     | SELECT FROM VBAK\n2    | 0.300    | 37%  | 1     | SELECT FROM VBAP \u2705\n3    | 0.012    | 1%   | -     | Other processing\n\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\n\nDatabase Accesses: 2 queries \u2705 (era 1,001)\n  - VBAK: 1 query (0.5s)\n  - VBAP: 1 query (0.3s) \u2705\n\nPerformance: EXCELLENT \u2705\nImprovement: 18.7x faster! \ud83d\ude80\n</code></pre>","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#funcionalidades-avancadas","title":"\ud83d\udd39 Funcionalidades Avan\u00e7adas","text":"","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#1-filtros","title":"1. Filtros","text":"<p>Filtrar an\u00e1lise por: - Package: Apenas c\u00f3digo custom - Program: Espec\u00edfico programa - Time threshold: S\u00f3 mostrar &gt; X ms</p>","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#2-comparacao","title":"2. Compara\u00e7\u00e3o","text":"<p>Comparar 2 execu\u00e7\u00f5es: 1. Antes da otimiza\u00e7\u00e3o 2. Depois da otimiza\u00e7\u00e3o</p> <pre><code>Before: 15.234s\nAfter:  0.812s\nGain:   94.7% \u2705\n</code></pre>","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#3-exportar-resultados","title":"3. Exportar Resultados","text":"<p>Salvar an\u00e1lise para documenta\u00e7\u00e3o: - Download: Excel, XML - Share: Enviar para colega</p>","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#tipos-de-analise","title":"\ud83d\udd39 Tipos de An\u00e1lise","text":"","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#performance-trace","title":"Performance Trace","text":"<p>Medir tempo de execu\u00e7\u00e3o geral.</p> <pre><code>SAT \u2192 Execution \u2192 Performance Trace\n</code></pre>","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#memory-trace","title":"Memory Trace","text":"<p>Analisar consumo de mem\u00f3ria.</p> <pre><code>SAT \u2192 Execution \u2192 Memory Trace\n</code></pre>","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#sql-trace","title":"SQL Trace","text":"<p>Focar apenas em queries SQL (similar a ST05).</p> <pre><code>SAT \u2192 Execution \u2192 SQL Trace\n</code></pre>","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#exemplo-otimizar-relatorio","title":"\ud83d\udd39 Exemplo: Otimizar Relat\u00f3rio","text":"","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#cenario-real","title":"Cen\u00e1rio Real","text":"<p>Relat\u00f3rio demora 30 minutos para executar.</p>","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#passo-1-sat","title":"Passo 1: SAT","text":"<p>Executar SAT no relat\u00f3rio:</p> <pre><code>Top Consumers:\n1. SELECT FROM BKPF (18 min) \u274c\n2. LOOP com c\u00e1lculos (8 min)\n3. SELECT FROM BSEG (4 min)\n</code></pre>","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#passo-2-analise","title":"Passo 2: An\u00e1lise","text":"<p>Problema 1: SELECT sem WHERE efetivo <pre><code>\" \u274c L\u00ea milh\u00f5es de registos\nSELECT * FROM bkpf\n  INTO TABLE lt_bkpf\n  WHERE bukrs = '1000'.  \" N\u00e3o selectivo!\n</code></pre></p> <p>Solu\u00e7\u00e3o: Adicionar filtros <pre><code>\" \u2705 Filtro mais selectivo\nSELECT * FROM bkpf\n  INTO TABLE lt_bkpf\n  WHERE bukrs = '1000'\n    AND gjahr = '2025'       \" Ano\n    AND monat IN ('01', '02', '03')  \" Trimestre\n    AND budat &gt;= '20250101'.  \" Data\n</code></pre></p> <p>Problema 2: C\u00e1lculos em LOOP sem necessidade <pre><code>\" \u274c C\u00e1lculo repetido\nLOOP AT lt_data INTO DATA(ls_data).\n  ls_data-total = ls_data-qty * ls_data-price * ls_data-tax.\n  MODIFY lt_data FROM ls_data.\nENDLOOP.\n</code></pre></p> <p>Solu\u00e7\u00e3o: Calcular s\u00f3 quando necess\u00e1rio <pre><code>\" \u2705 Calcular sob demanda ou usar SELECT com express\u00f5es\nSELECT menge,\n       preis,\n       steuer,\n       menge * preis * steuer AS total\n  FROM ztabela...\n</code></pre></p>","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#resultado","title":"Resultado","text":"<pre><code>Before: 30 minutes\nAfter:  2 minutes\nGain:   93% \u2705\n</code></pre>","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#metricas-importantes","title":"\ud83d\udd39 M\u00e9tricas Importantes","text":"","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#tempo-de-execucao","title":"Tempo de Execu\u00e7\u00e3o","text":"<pre><code>&lt; 1 segundo:    \u2705 Excelente\n1-5 segundos:   \u2705 Bom\n5-30 segundos:  \u26a0\ufe0f Aceit\u00e1vel\n&gt; 30 segundos:  \u274c Otimizar!\n</code></pre>","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#database-calls","title":"Database Calls","text":"<pre><code>&lt; 10 queries:   \u2705 Excelente\n10-50 queries:  \u2705 Bom\n50-100 queries: \u26a0\ufe0f Revisar\n&gt; 100 queries:  \u274c Problema grave!\n</code></pre>","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#db-time-vs-abap-time","title":"DB Time vs ABAP Time","text":"<pre><code>DB Time &gt; 80%:  \u274c Otimizar SQL\nABAP Time &gt; 80%: \u274c Otimizar c\u00f3digo\n50/50:          \u2705 Balanceado\n</code></pre>","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#checklist-sat","title":"\ud83d\udd39 Checklist SAT","text":"<p>Antes de liberar c\u00f3digo em produ\u00e7\u00e3o:</p> <ul> <li>[ ] Executar SAT com volume realista de dados</li> <li>[ ] Verificar Hit List (nada &gt; 50% do tempo)</li> <li>[ ] Contar database calls (&lt; 50)</li> <li>[ ] Verificar se h\u00e1 SELECT em LOOP</li> <li>[ ] Medir tempo total (&lt; 5s para jobs online)</li> <li>[ ] Comparar com vers\u00e3o anterior (se aplic\u00e1vel)</li> <li>[ ] Documentar melhorias</li> </ul>","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#dicas","title":"\ud83d\udca1 Dicas","text":"\u2705 Fazer \u274c Evitar Executar SAT antes de liberar Assumir que \"parece r\u00e1pido\" Testar com volume real Testar s\u00f3 com 10 registos Focar nos top 3 consumidores Tentar otimizar tudo Documentar melhorias N\u00e3o medir ganhos Usar filtros para isolar c\u00f3digo Analisar c\u00f3digo SAP standard","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/3_runtime_analysis/#proximo-passo","title":"\ud83d\ude80 Pr\u00f3ximo Passo","text":"<p>Aprenda sobre Table Buffering para melhorar ainda mais a performance.</p>","tags":["ABAP","Performance","SAT","Runtime Analysis","Profiling"]},{"location":"performance/4_buffering/","title":"Table Buffering (Buffer de Tabelas)","text":"<p>O buffering armazena dados em mem\u00f3ria para evitar acessos repetidos \u00e0 base de dados.</p>","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#o-que-e-buffering","title":"\ud83d\udd39 O que \u00e9 Buffering?","text":"<p>Quando uma tabela est\u00e1 bufferizada, os dados s\u00e3o guardados em mem\u00f3ria (cache) do servidor de aplica\u00e7\u00e3o.</p> <p>Vantagens: - \u2705 Acesso muito mais r\u00e1pido (mem\u00f3ria vs disco) - \u2705 Reduz carga na base de dados - \u2705 Melhora performance para tabelas de configura\u00e7\u00e3o</p> <p>Desvantagens: - \u274c Dados podem ficar desatualizados - \u274c Consome mem\u00f3ria do servidor - \u274c N\u00e3o adequado para dados que mudam frequentemente</p>","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#tipos-de-buffering","title":"\ud83d\udd39 Tipos de Buffering","text":"","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#1-single-record-buffering","title":"1. Single Record Buffering","text":"<p>Buffer por registo individual (por chave prim\u00e1ria).</p> <p>Quando usar: - Tabelas grandes - Acesso sempre por chave completa - S\u00f3 alguns registos s\u00e3o acedidos frequentemente</p> <p>Exemplo: Tabela de materiais (MARA)</p> <pre><code>\" Primeiro acesso: vai \u00e0 BD\nSELECT SINGLE * FROM mara\n  INTO @DATA(ls_mara)\n  WHERE matnr = '000000000000001234'.\n\n\" Segundo acesso: vem do buffer \u2705\nSELECT SINGLE * FROM mara\n  INTO @ls_mara\n  WHERE matnr = '000000000000001234'.  \" Muito r\u00e1pido!\n</code></pre>","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#2-generic-buffering","title":"2. Generic Buffering","text":"<p>Buffer por \u00e1rea de chave (primeiros campos da chave).</p> <p>Quando usar: - Acesso por parte da chave - Grupos l\u00f3gicos de dados (ex: todos registos de um cliente)</p> <p>Exemplo: Tabela de textos por idioma</p> <pre><code>\" Buffer todos os textos de idioma 'PT'\nSELECT * FROM t001t\n  INTO TABLE @DATA(lt_textos)\n  WHERE spras = 'PT'.  \" Todos registos PT v\u00eam do buffer\n</code></pre>","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#3-full-buffering","title":"3. Full Buffering","text":"<p>Toda a tabela fica em mem\u00f3ria.</p> <p>Quando usar: - Tabelas pequenas (&lt; 10.000 registos) - Dados raramente alterados - Tabelas de configura\u00e7\u00e3o/customizing</p> <p>Exemplos: - T001 (Empresas) - T005 (Pa\u00edses) - T005T (Textos de pa\u00edses)</p> <pre><code>\" Toda a tabela T005T est\u00e1 em mem\u00f3ria\nSELECT * FROM t005t\n  INTO TABLE @DATA(lt_paises)\n  WHERE spras = sy-langu.  \" Muito r\u00e1pido! \u2705\n</code></pre>","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#configurar-buffering","title":"\ud83d\udd39 Configurar Buffering","text":"","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#se11-dicionario-abap","title":"SE11 - Dicion\u00e1rio ABAP","text":"<ol> <li>Transa\u00e7\u00e3o SE11</li> <li>Inserir nome da tabela</li> <li>Technical Settings (bot\u00e3o)</li> <li>Campo Buffering:</li> <li><code>Not buffered</code> (sem buffer)</li> <li><code>Single records</code> (por registo)</li> <li><code>Generic areas</code> (por \u00e1rea)</li> <li><code>Fully buffered</code> (completo)</li> </ol> <p>Aten\u00e7\u00e3o</p> <p>S\u00f3 pode configurar buffering em tabelas pr\u00f3prias (Z, Y). Tabelas SAP standard j\u00e1 v\u00eam configuradas.</p>","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#como-funciona-o-buffer","title":"\ud83d\udd39 Como Funciona o Buffer","text":"","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#ciclo-de-vida","title":"Ciclo de Vida","text":"<pre><code>1. Primeira consulta \u2192 BD (slow)\n   \u2193\n2. Dados copiados para BUFFER\n   \u2193\n3. Pr\u00f3ximas consultas \u2192 BUFFER (fast!) \u2705\n   \u2193\n4. Ap\u00f3s X tempo ou altera\u00e7\u00e3o \u2192 INVALIDAR buffer\n   \u2193\n5. Voltar ao passo 1\n</code></pre>","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#tempo-de-expiracao","title":"Tempo de Expira\u00e7\u00e3o","text":"<p>Buffer expira ap\u00f3s: - Altera\u00e7\u00e3o de dados (INSERT/UPDATE/DELETE) - Tempo m\u00e1ximo (configur\u00e1vel) - Rein\u00edcio do servidor de aplica\u00e7\u00e3o</p>","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#bypass-do-buffer","title":"\ud83d\udd39 Bypass do Buffer","text":"<p>\u00c0s vezes queremos for\u00e7ar leitura da BD (ignorar buffer):</p> <pre><code>\" \u274c Usa buffer (pode estar desatualizado)\nSELECT SINGLE * FROM t001\n  INTO @DATA(ls_company)\n  WHERE bukrs = '1000'.\n\n\" \u2705 Bypass buffer (sempre atualizado)\nSELECT SINGLE * FROM t001 BYPASSING BUFFER\n  INTO @ls_company\n  WHERE bukrs = '1000'.\n</code></pre> <p>Quando usar BYPASSING BUFFER: - Dados cr\u00edticos que mudam frequentemente - Ap\u00f3s UPDATE/INSERT imediato - Valida\u00e7\u00f5es financeiras</p>","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#exemplo-pratico","title":"\ud83d\udd39 Exemplo Pr\u00e1tico","text":"","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#tabela-de-configuracao-custom","title":"Tabela de Configura\u00e7\u00e3o Custom","text":"<pre><code>\" Tabela: ZCONFIG (fully buffered)\n\" Campos: CONFIG_KEY, CONFIG_VALUE\n</code></pre> <p>Configurar buffering: 1. SE11 \u2192 ZCONFIG 2. Technical Settings 3. Buffering: Fully buffered 4. Save &amp; Activate</p>","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#usar-a-tabela","title":"Usar a Tabela","text":"<pre><code>\" Primeira execu\u00e7\u00e3o: vai \u00e0 BD\nSELECT SINGLE config_value FROM zconfig\n  INTO @DATA(lv_value)\n  WHERE config_key = 'MAX_ITEMS'.\n\n\" Execu\u00e7\u00f5es seguintes: buffer \u2705 (microsegundos!)\nSELECT SINGLE config_value FROM zconfig\n  INTO @lv_value\n  WHERE config_key = 'TAX_RATE'.\n\nSELECT SINGLE config_value FROM zconfig\n  INTO @lv_value\n  WHERE config_key = 'TIMEOUT'.\n</code></pre> <p>Performance: - Sem buffer: 5ms por query - Com buffer: 0.05ms por query - Ganho: 100x mais r\u00e1pido! \ud83d\ude80</p>","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#monitorizar-buffer","title":"\ud83d\udd39 Monitorizar Buffer","text":"","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#st02-tune-summary","title":"ST02 - Tune Summary","text":"<ol> <li>Transa\u00e7\u00e3o ST02</li> <li>Ver estat\u00edsticas de buffer:</li> <li>Hit ratio: % de acessos que vieram do buffer</li> <li>Swaps: Quantas vezes buffer foi limpo</li> <li>Size: Tamanho do buffer</li> </ol> <p>Hit Ratio Ideal: <pre><code>&gt; 98%: \u2705 Excelente\n90-98%: \u2705 Bom\n&lt; 90%: \u26a0\ufe0f Revisar configura\u00e7\u00e3o\n</code></pre></p>","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#st10-table-call-statistics","title":"ST10 - Table Call Statistics","text":"<p>Ver quais tabelas s\u00e3o mais acedidas e se est\u00e3o bufferizadas.</p> <pre><code>Tabela    | Acessos | Buffered | Hit Ratio\n\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\nT001      | 50,000  | Yes      | 99.8% \u2705\nZCONFIG   | 10,000  | Yes      | 100%  \u2705\nVBAK      | 5,000   | No       | 0%    \u274c\nT005T     | 2,000   | Yes      | 99.5% \u2705\n</code></pre>","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#invalidar-buffer-manualmente","title":"\ud83d\udd39 Invalidar Buffer Manualmente","text":"","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#tab-reset-buffer","title":"$TAB - Reset Buffer","text":"<p>Quando alterar dados manualmente (SE16), o buffer n\u00e3o \u00e9 invalidado automaticamente.</p> <p>Solu\u00e7\u00e3o: 1. Transa\u00e7\u00e3o $TAB 2. Inserir nome da tabela 3. Delete (invalidar buffer)</p> <p>Ou via c\u00f3digo: <pre><code>\" Invalidar buffer de uma tabela\nCALL FUNCTION 'DB_DELETE_TABLE_BUFFER'\n  EXPORTING\n    tab_name = 'ZCONFIG'.\n</code></pre></p>","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#quando-nao-usar-buffering","title":"\ud83d\udd39 Quando N\u00c3O Usar Buffering","text":"","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#tabelas-transacionais","title":"\u274c Tabelas Transacionais","text":"<pre><code>\" N\u00c3O bufferizar:\n- VBAK (Ordens de venda) \u2192 mudam constantemente\n- BSEG (Itens contabil\u00edsticos) \u2192 volume enorme\n- ZTRANSACTIONS (Transa\u00e7\u00f5es) \u2192 dados em tempo real\n</code></pre>","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#tabelas-grandes","title":"\u274c Tabelas Grandes","text":"<pre><code>\" Tabela com 10 milh\u00f5es de registos\n\" Full buffering \u2192 consome MUITA mem\u00f3ria! \u274c\n</code></pre>","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#dados-em-tempo-real","title":"\u274c Dados em Tempo Real","text":"<pre><code>\" Stock em tempo real\n\" Pre\u00e7os de bolsa\n\" Saldos banc\u00e1rios\n\u2192 Sempre ler da BD!\n</code></pre>","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#exemplo-tabela-de-paises","title":"\ud83d\udd39 Exemplo: Tabela de Pa\u00edses","text":"","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#sem-buffering-t005-paises","title":"Sem Buffering (T005 - Pa\u00edses)","text":"<pre><code>\" Executar 1000x\nDO 1000 TIMES.\n  SELECT SINGLE landx FROM t005t\n    INTO @DATA(lv_pais)\n    WHERE spras = 'PT'\n      AND land1 = 'PT'.\nENDDO.\n\n\" Tempo: 5000ms (5 segundos) \u274c\n</code></pre>","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#com-buffering-t005t-e-fully-buffered","title":"Com Buffering (T005T \u00e9 fully buffered)","text":"<pre><code>\" Executar 1000x\nDO 1000 TIMES.\n  SELECT SINGLE landx FROM t005t\n    INTO @DATA(lv_pais)\n    WHERE spras = 'PT'\n      AND land1 = 'PT'.\nENDDO.\n\n\" Tempo: 50ms (0.05 segundos) \u2705\n\" Ganho: 100x mais r\u00e1pido! \ud83d\ude80\n</code></pre>","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#boas-praticas","title":"\ud83d\udd39 Boas Pr\u00e1ticas","text":"\u2705 Fazer \u274c Evitar Bufferizar tabelas de config pequenas Bufferizar tabelas gigantes Usar full buffering para &lt; 10k registos Bufferizar dados transacionais Monitorizar hit ratio (ST02) Nunca verificar performance BYPASSING BUFFER para dados cr\u00edticos Assumir que buffer est\u00e1 atualizado Invalidar ap\u00f3s updates manuais Deixar buffer desatualizado","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#exemplo-completo","title":"\ud83d\udd39 Exemplo Completo","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_BUFFER_DEMO\n*&amp;---------------------------------------------------------------------*\nREPORT z_buffer_demo.\n\n\" Tabela de configura\u00e7\u00e3o (fully buffered)\nTYPES: BEGIN OF ty_config,\n         key   TYPE char20,\n         value TYPE char100,\n       END OF ty_config.\n\nDATA: lv_start TYPE timestampl,\n      lv_end   TYPE timestampl,\n      lv_diff  TYPE int8.\n\nSTART-OF-SELECTION.\n\n  \" ===== TESTE 1: COM BUFFER =====\n  WRITE: / 'Teste 1: Com Buffer (T005T)'.\n  GET TIME STAMP FIELD lv_start.\n\n  DO 100 TIMES.\n    SELECT SINGLE landx FROM t005t\n      INTO @DATA(lv_pais)\n      WHERE spras = 'PT' AND land1 = 'PT'.\n  ENDDO.\n\n  GET TIME STAMP FIELD lv_end.\n  lv_diff = cl_abap_tstmp=&gt;subtract( tstmp1 = lv_end tstmp2 = lv_start ).\n  WRITE: / |Tempo: { lv_diff } microssegundos|.\n\n  SKIP.\n\n  \" ===== TESTE 2: BYPASS BUFFER =====\n  WRITE: / 'Teste 2: Bypass Buffer'.\n  GET TIME STAMP FIELD lv_start.\n\n  DO 100 TIMES.\n    SELECT SINGLE landx FROM t005t BYPASSING BUFFER\n      INTO @lv_pais\n      WHERE spras = 'PT' AND land1 = 'PT'.\n  ENDDO.\n\n  GET TIME STAMP FIELD lv_end.\n  lv_diff = cl_abap_tstmp=&gt;subtract( tstmp1 = lv_end tstmp2 = lv_start ).\n  WRITE: / |Tempo: { lv_diff } microssegundos|.\n\n  SKIP.\n  WRITE: / '\u2705 Note a diferen\u00e7a de performance!'.\n</code></pre>","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#resumo","title":"\ud83d\udca1 Resumo","text":"<ul> <li>Full Buffering: Tabelas pequenas e est\u00e1ticas</li> <li>Generic Buffering: Acesso por grupos</li> <li>Single Record: Tabelas grandes, acesso por chave</li> <li>No Buffering: Dados transacionais e em tempo real</li> <li>Monitorizar: ST02 e ST10</li> <li>BYPASSING BUFFER: Para dados cr\u00edticos</li> </ul>","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/4_buffering/#proximo-passo","title":"\ud83d\ude80 Pr\u00f3ximo Passo","text":"<p>Aprenda sobre Tabelas Internas Eficientes para otimizar o processamento em mem\u00f3ria.</p>","tags":["ABAP","Performance","Buffering","Cache","Database"]},{"location":"performance/5_tabelas_internas/","title":"Tabelas Internas Eficientes","text":"<p>Escolher o tipo correto de tabela interna pode melhorar drasticamente a performance.</p>","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/5_tabelas_internas/#tipos-de-tabelas-internas","title":"\ud83d\udd39 Tipos de Tabelas Internas","text":"","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/5_tabelas_internas/#1-standard-table","title":"1. STANDARD TABLE","text":"<p>Acesso sequencial (como um array normal).</p> <pre><code>DATA lt_customers TYPE STANDARD TABLE OF kna1.\n</code></pre> <p>Caracter\u00edsticas: - \u2705 APPEND \u00e9 r\u00e1pido (adicionar no fim) - \u2705 Boa para LOOP sequencial - \u274c READ lento (tem que procurar tudo) - \u274c Permite duplicados</p> <p>Quando usar: - Processamento sequencial (LOOPs) - Ordem de inser\u00e7\u00e3o importante - Poucos registos (&lt; 1000)</p>","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/5_tabelas_internas/#2-sorted-table","title":"2. SORTED TABLE","text":"<p>Mant\u00e9m dados sempre ordenados.</p> <pre><code>DATA lt_customers TYPE SORTED TABLE OF kna1\n  WITH UNIQUE KEY kunnr.\n</code></pre> <p>Caracter\u00edsticas: - \u2705 READ r\u00e1pido (binary search autom\u00e1tico) - \u2705 Ordena\u00e7\u00e3o mantida - \u274c APPEND mais lento (tem que ordenar) - \u2705/\u274c Pode ter chave UNIQUE ou NON-UNIQUE</p> <p>Quando usar: - Leituras frequentes (READ) - Dados j\u00e1 ordenados - M\u00e9dio volume (1.000 - 100.000 registos)</p>","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/5_tabelas_internas/#3-hashed-table","title":"3. HASHED TABLE","text":"<p>Acesso por hash (mais r\u00e1pido).</p> <pre><code>DATA lt_customers TYPE HASHED TABLE OF kna1\n  WITH UNIQUE KEY kunnr.\n</code></pre> <p>Caracter\u00edsticas: - \u2705\u2705 READ muito r\u00e1pido (tempo constante O(1)) - \u2705 \u00danica chave obrigat\u00f3ria - \u274c N\u00e3o permite LOOP com INDEX - \u274c Ordem n\u00e3o garantida</p> <p>Quando usar: - Muitas leituras por chave - Grande volume (&gt; 10.000 registos) - Ordem n\u00e3o importa</p>","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/5_tabelas_internas/#comparacao-de-performance","title":"\ud83d\udd39 Compara\u00e7\u00e3o de Performance","text":"","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/5_tabelas_internas/#cenario-procurar-1-registo-em-100000","title":"Cen\u00e1rio: Procurar 1 registo em 100.000","text":"<pre><code>\" Dados de teste\nDATA: lt_standard TYPE STANDARD TABLE OF kna1,\n      lt_sorted   TYPE SORTED TABLE OF kna1 WITH UNIQUE KEY kunnr,\n      lt_hashed   TYPE HASHED TABLE OF kna1 WITH UNIQUE KEY kunnr.\n\n\" Popular com 100.000 clientes\nDO 100000 TIMES.\n  INSERT VALUE #( kunnr = sy-index name1 = |Cliente { sy-index }| ) \n    INTO TABLE lt_standard.\nENDDO.\n</code></pre>","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/5_tabelas_internas/#performance","title":"Performance","text":"Tipo Opera\u00e7\u00e3o Tempo Complexidade STANDARD READ 50ms O(n) - Linear SORTED READ 0.5ms O(log n) - Logar\u00edtmico HASHED READ 0.05ms O(1) - Constante <p>Resultado: - HASHED \u00e9 1000x mais r\u00e1pido que STANDARD! \ud83d\ude80 - SORTED \u00e9 100x mais r\u00e1pido que STANDARD</p>","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/5_tabelas_internas/#exemplo-standard-vs-hashed","title":"\ud83d\udd39 Exemplo: STANDARD vs HASHED","text":"","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/5_tabelas_internas/#ineficiente-standard-table","title":"\u274c Ineficiente (STANDARD TABLE)","text":"<pre><code>DATA: lt_customers TYPE STANDARD TABLE OF kna1,\n      ls_customer  TYPE kna1.\n\n\" Popular 50.000 clientes\nSELECT * FROM kna1 \n  INTO TABLE lt_customers\n  UP TO 50000 ROWS.\n\n\" Procurar 10.000 vezes\nDO 10000 TIMES.\n  READ TABLE lt_customers INTO ls_customer\n    WITH KEY kunnr = '0000012345'.  \" Lento! \u274c\nENDDO.\n\n\" Tempo: ~25 segundos \u274c\n</code></pre>","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/5_tabelas_internas/#eficiente-hashed-table","title":"\u2705 Eficiente (HASHED TABLE)","text":"<pre><code>DATA: lt_customers TYPE HASHED TABLE OF kna1 \n        WITH UNIQUE KEY kunnr,\n      ls_customer  TYPE kna1.\n\n\" Popular 50.000 clientes\nSELECT * FROM kna1 \n  INTO TABLE lt_customers\n  UP TO 50000 ROWS.\n\n\" Procurar 10.000 vezes\nDO 10000 TIMES.\n  READ TABLE lt_customers INTO ls_customer\n    WITH TABLE KEY kunnr = '0000012345'.  \" R\u00e1pido! \u2705\nENDDO.\n\n\" Tempo: ~0.25 segundos \u2705\n\" Ganho: 100x mais r\u00e1pido! \ud83d\ude80\n</code></pre>","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/5_tabelas_internas/#read-table-com-binary-search","title":"\ud83d\udd39 READ TABLE com BINARY SEARCH","text":"<p>Para SORTED tables, usar BINARY SEARCH:</p> <pre><code>DATA lt_sorted TYPE SORTED TABLE OF kna1\n  WITH NON-UNIQUE KEY kunnr.\n\n\" \u274c Linear search (lento)\nREAD TABLE lt_sorted INTO DATA(ls_cust)\n  WITH KEY kunnr = '0001234567'.\n\n\" \u2705 Binary search (r\u00e1pido) - autom\u00e1tico em SORTED\n\" (n\u00e3o precisa especificar BINARY SEARCH)\nREAD TABLE lt_sorted INTO ls_cust\n  WITH TABLE KEY kunnr = '0001234567'.\n</code></pre> <p>Para STANDARD tables, adicionar <code>BINARY SEARCH</code> manualmente:</p> <pre><code>DATA lt_standard TYPE STANDARD TABLE OF kna1.\n\n\" IMPORTANTE: Ordenar primeiro!\nSORT lt_standard BY kunnr.\n\n\" \u2705 Binary search manual\nREAD TABLE lt_standard INTO DATA(ls_cust)\n  WITH KEY kunnr = '0001234567'\n  BINARY SEARCH.\n\n\" \u26a0\ufe0f Verificar se encontrou\nIF sy-subrc = 0.\n  \" Processamento...\nENDIF.\n</code></pre>","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/5_tabelas_internas/#loop-com-performance","title":"\ud83d\udd39 LOOP com Performance","text":"","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/5_tabelas_internas/#standard-table","title":"STANDARD TABLE","text":"<pre><code>\" \u2705 LOOP normal (eficiente)\nLOOP AT lt_standard INTO DATA(ls_data).\n  \" Processamento...\nENDLOOP.\n\n\" \u2705 LOOP com WHERE (eficiente em ABAP 7.40+)\nLOOP AT lt_standard INTO ls_data WHERE status = 'A'.\n  \" Processamento...\nENDLOOP.\n</code></pre>","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/5_tabelas_internas/#hashed-table","title":"HASHED TABLE","text":"<pre><code>\" \u2705 LOOP sem \u00edndice (\u00fanico modo)\nLOOP AT lt_hashed INTO DATA(ls_data).\n  \" Processamento...\nENDLOOP.\n\n\" \u274c ERRO: HASHED n\u00e3o suporta \u00edndice\nLOOP AT lt_hashed INTO ls_data FROM 1 TO 10.  \" ERRO!\nENDLOOP.\n</code></pre>","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/5_tabelas_internas/#quando-usar-cada-tipo","title":"\ud83d\udd39 Quando Usar Cada Tipo","text":"","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/5_tabelas_internas/#matriz-de-decisao","title":"\ud83d\udcca Matriz de Decis\u00e3o","text":"<pre><code>Volume Pequeno (&lt; 1.000 registos)\n\u251c\u2500 Ordem importante? \n\u2502  \u251c\u2500 Sim \u2192 STANDARD\n\u2502  \u2514\u2500 N\u00e3o \u2192 STANDARD (simples)\n\nVolume M\u00e9dio (1.000 - 10.000)\n\u251c\u2500 Muitos READs?\n\u2502  \u251c\u2500 Sim \u2192 SORTED (com chave)\n\u2502  \u2514\u2500 N\u00e3o \u2192 STANDARD\n\nVolume Grande (&gt; 10.000)\n\u251c\u2500 Muitos READs por chave?\n\u2502  \u251c\u2500 Sim \u2192 HASHED \u2705\n\u2502  \u2514\u2500 Maioria LOOPs \u2192 SORTED\n</code></pre>","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/5_tabelas_internas/#casos-de-uso-comuns","title":"Casos de Uso Comuns","text":"Cen\u00e1rio Tipo Recomendado Cache de valida\u00e7\u00f5es HASHED Dados de configura\u00e7\u00e3o HASHED Resultados de SELECT STANDARD/SORTED Processamento sequencial STANDARD Lookup tables HASHED Dados ordenados SORTED","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/5_tabelas_internas/#exemplo-completo-otimizacao-real","title":"\ud83d\udd39 Exemplo Completo: Otimiza\u00e7\u00e3o Real","text":"","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/5_tabelas_internas/#cenario","title":"Cen\u00e1rio","text":"<p>Validar 100.000 documentos contra tabela de pre\u00e7os (50.000 itens).</p>","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/5_tabelas_internas/#versao-lenta","title":"\u274c Vers\u00e3o Lenta","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_SLOW_VALIDATION\n*&amp;---------------------------------------------------------------------*\nREPORT z_slow_validation.\n\n\" STANDARD table (lento para READ)\nDATA: lt_prices TYPE STANDARD TABLE OF zprices,\n      lt_docs   TYPE STANDARD TABLE OF zdocs.\n\nSTART-OF-SELECTION.\n\n  \" 1. Carregar pre\u00e7os\n  SELECT * FROM zprices INTO TABLE lt_prices.\n\n  \" 2. Carregar documentos\n  SELECT * FROM zdocs INTO TABLE lt_docs.\n\n  \" 3. Validar cada documento \u274c\n  LOOP AT lt_docs INTO DATA(ls_doc).\n    \" READ em STANDARD = lento!\n    READ TABLE lt_prices INTO DATA(ls_price)\n      WITH KEY matnr = ls_doc-matnr.\n\n    IF sy-subrc = 0.\n      ls_doc-price = ls_price-price.\n      MODIFY lt_docs FROM ls_doc.\n    ENDIF.\n  ENDLOOP.\n\n\" Tempo: ~5 minutos \u274c\n</code></pre>","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/5_tabelas_internas/#versao-rapida","title":"\u2705 Vers\u00e3o R\u00e1pida","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_FAST_VALIDATION\n*&amp;---------------------------------------------------------------------*\nREPORT z_fast_validation.\n\n\" \u2705 HASHED table para lookups r\u00e1pidos\nDATA: lt_prices TYPE HASHED TABLE OF zprices \n        WITH UNIQUE KEY matnr,\n      lt_docs   TYPE STANDARD TABLE OF zdocs.\n\nSTART-OF-SELECTION.\n\n  \" 1. Carregar pre\u00e7os em HASHED\n  SELECT * FROM zprices INTO TABLE lt_prices.\n\n  \" 2. Carregar documentos\n  SELECT * FROM zdocs INTO TABLE lt_docs.\n\n  \" 3. Validar cada documento \u2705\n  LOOP AT lt_docs INTO DATA(ls_doc).\n    \" READ em HASHED = muito r\u00e1pido!\n    READ TABLE lt_prices INTO DATA(ls_price)\n      WITH TABLE KEY matnr = ls_doc-matnr.\n\n    IF sy-subrc = 0.\n      ls_doc-price = ls_price-price.\n      MODIFY lt_docs FROM ls_doc.\n    ENDIF.\n  ENDLOOP.\n\n\" Tempo: ~3 segundos \u2705\n\" Ganho: 100x mais r\u00e1pido! \ud83d\ude80\n</code></pre>","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/5_tabelas_internas/#operacoes-por-tipo","title":"\ud83d\udd39 Opera\u00e7\u00f5es por Tipo","text":"","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/5_tabelas_internas/#append-vs-insert","title":"APPEND vs INSERT","text":"<pre><code>\" STANDARD: APPEND r\u00e1pido\nAPPEND VALUE #( kunnr = '001' name1 = 'Cliente' ) TO lt_standard.\n\n\" SORTED: INSERT mant\u00e9m ordem (mais lento)\nINSERT VALUE #( kunnr = '001' name1 = 'Cliente' ) INTO TABLE lt_sorted.\n\n\" HASHED: INSERT por hash\nINSERT VALUE #( kunnr = '001' name1 = 'Cliente' ) INTO TABLE lt_hashed.\n</code></pre>","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/5_tabelas_internas/#delete","title":"DELETE","text":"<pre><code>\" STANDARD: por \u00edndice ou condi\u00e7\u00e3o\nDELETE lt_standard INDEX 1.\nDELETE lt_standard WHERE status = 'X'.\n\n\" SORTED: por chave ou condi\u00e7\u00e3o\nDELETE TABLE lt_sorted WITH TABLE KEY kunnr = '001'.\n\n\" HASHED: s\u00f3 por chave\nDELETE TABLE lt_hashed WITH TABLE KEY kunnr = '001'.\n</code></pre>","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/5_tabelas_internas/#parallel-processing","title":"\ud83d\udd39 Parallel Processing","text":"<p>Para tabelas muito grandes, processar em paralelo:</p> <pre><code>DATA: lt_data TYPE STANDARD TABLE OF zdata,\n      lv_package_size TYPE i VALUE 10000.\n\n\" Processar em chunks\nLOOP AT lt_data INTO DATA(ls_data)\n  GROUP BY ( group_id = ( sy-tabix - 1 ) DIV lv_package_size ).\n\n  \" Processar grupo\n  LOOP AT GROUP ls_data INTO DATA(ls_item).\n    \" Processamento...\n  ENDLOOP.\nENDLOOP.\n</code></pre>","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/5_tabelas_internas/#boas-praticas","title":"\ud83d\udca1 Boas Pr\u00e1ticas","text":"\u2705 Fazer \u274c Evitar HASHED para muitos READs STANDARD com 100k+ READs SORTED para dados ordenados SORT repetido em STANDARD WITH TABLE KEY em HASHED WITH KEY kunnr = (sem TABLE) Definir chave apropriada Tabelas sem chave BINARY SEARCH em STANDARD ordenado READ sem BINARY SEARCH","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/5_tabelas_internas/#resumo","title":"\ud83d\ude80 Resumo","text":"<ul> <li>STANDARD: Default, bom para LOOPs</li> <li>SORTED: Dados ordenados, READs m\u00e9dios</li> <li>HASHED: Muitos READs, melhor performance</li> <li>Escolher tipo = ganho de 100x em performance! \ud83d\ude80</li> </ul>","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/5_tabelas_internas/#proximo-passo","title":"\ud83d\ude80 Pr\u00f3ximo Passo","text":"<p>Aprenda sobre Armadilhas Comuns em performance ABAP.</p>","tags":["ABAP","Performance","Tabelas Internas","HASHED","SORTED"]},{"location":"performance/6_armadilhas/","title":"Armadilhas Comuns de Performance","text":"<p>Conhe\u00e7a os erros mais comuns que destroem a performance em ABAP e como evit\u00e1-los.</p>","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#1-select-em-loop","title":"\ud83d\udd39 1. SELECT em LOOP","text":"","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#o-pior-erro-de-performance","title":"\u274c O Pior Erro de Performance","text":"<pre><code>\" \u274c\u274c\u274c NUNCA FA\u00c7A ISTO! \u274c\u274c\u274c\nSELECT * FROM vbak INTO TABLE @DATA(lt_orders) UP TO 1000 ROWS.\n\nLOOP AT lt_orders INTO DATA(ls_order).\n  \" 1000 queries \u00e0 base de dados! \ud83d\ude31\n  SELECT * FROM vbap\n    INTO TABLE @DATA(lt_items)\n    WHERE vbeln = @ls_order-vbeln.\n\n  \" Processamento...\nENDLOOP.\n\n\" Resultado: 1001 acessos \u00e0 BD\n\" Tempo: 15 segundos \u274c\n</code></pre>","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#solucao-1-for-all-entries","title":"\u2705 Solu\u00e7\u00e3o 1: FOR ALL ENTRIES","text":"<pre><code>SELECT * FROM vbak INTO TABLE @DATA(lt_orders) UP TO 1000 ROWS.\n\n\" \u2705 Uma \u00fanica query\nIF lt_orders IS NOT INITIAL.\n  SELECT * FROM vbap\n    INTO TABLE @DATA(lt_items)\n    FOR ALL ENTRIES IN @lt_orders\n    WHERE vbeln = @lt_orders-vbeln.\nENDIF.\n\n\" Resultado: 2 acessos \u00e0 BD\n\" Tempo: 0.5 segundos \u2705\n\" Ganho: 30x mais r\u00e1pido!\n</code></pre>","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#solucao-2-inner-join","title":"\u2705 Solu\u00e7\u00e3o 2: INNER JOIN","text":"<pre><code>\" \u2705 Ainda melhor: 1 \u00fanica query\nSELECT h~vbeln,\n       h~kunnr,\n       i~posnr,\n       i~matnr\n  FROM vbak AS h\n  INNER JOIN vbap AS i ON h~vbeln = i~vbeln\n  INTO TABLE @DATA(lt_result).\n\n\" Resultado: 1 acesso \u00e0 BD\n\" Tempo: 0.3 segundos \u2705\n</code></pre>","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#2-select-buscar-todos-os-campos","title":"\ud83d\udd39 2. SELECT * (Buscar Todos os Campos)","text":"","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#desperdicio-de-recursos","title":"\u274c Desperd\u00edcio de Recursos","text":"<pre><code>\" \u274c Busca 150 campos mas usa s\u00f3 3\nSELECT * FROM vbak\n  INTO TABLE @DATA(lt_orders).\n\nLOOP AT lt_orders INTO DATA(ls_order).\n  WRITE: / ls_order-vbeln, ls_order-kunnr.  \" S\u00f3 usa 2 campos!\nENDLOOP.\n</code></pre>","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#especificar-campos-necessarios","title":"\u2705 Especificar Campos Necess\u00e1rios","text":"<pre><code>\" \u2705 Busca apenas o necess\u00e1rio\nSELECT vbeln, kunnr, erdat\n  FROM vbak\n  INTO TABLE @DATA(lt_orders).\n\n\" Benef\u00edcios:\n\" - Menos dados transferidos\n\" - Menos mem\u00f3ria usada\n\" - Mais r\u00e1pido\n</code></pre> <p>Impacto: - SELECT * com 150 campos: 500KB de dados - SELECT 3 campos: 50KB de dados - Ganho: 10x menos dados transferidos!</p>","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#3-for-all-entries-sem-validacao","title":"\ud83d\udd39 3. FOR ALL ENTRIES Sem Valida\u00e7\u00e3o","text":"","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#bug-perigoso","title":"\u274c Bug Perigoso","text":"<pre><code>DATA lt_customers TYPE TABLE OF kna1.\n\" lt_customers est\u00e1 VAZIA!\n\n\" \u274c PERIGO: Retorna TODOS os registos da tabela!\nSELECT * FROM vbak\n  INTO TABLE @DATA(lt_orders)\n  FOR ALL ENTRIES IN @lt_customers\n  WHERE kunnr = @lt_customers-kunnr.\n\n\" Resultado: Milh\u00f5es de registos! Sistema pode crashar! \ud83d\ude31\n</code></pre>","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#sempre-validar","title":"\u2705 SEMPRE Validar","text":"<pre><code>DATA lt_customers TYPE TABLE OF kna1.\n\n\" \u2705 Valida\u00e7\u00e3o obrigat\u00f3ria\nIF lt_customers IS NOT INITIAL.\n  SELECT * FROM vbak\n    INTO TABLE @DATA(lt_orders)\n    FOR ALL ENTRIES IN @lt_customers\n    WHERE kunnr = @lt_customers-kunnr.\nELSE.\n  \" Tabela vazia = nenhum resultado\n  CLEAR lt_orders.\nENDIF.\n</code></pre>","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#4-nested-loops-sem-otimizacao","title":"\ud83d\udd39 4. NESTED LOOPs sem Otimiza\u00e7\u00e3o","text":"","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#complexidade-on2","title":"\u274c Complexidade O(n\u00b2)","text":"<pre><code>\" \u274c 1000 x 10000 = 10.000.000 itera\u00e7\u00f5es!\nLOOP AT lt_orders INTO DATA(ls_order).      \" 1.000 registos\n  LOOP AT lt_items INTO DATA(ls_item).      \" 10.000 registos\n    IF ls_item-vbeln = ls_order-vbeln.\n      \" Processamento...\n    ENDIF.\n  ENDLOOP.\nENDLOOP.\n\n\" Tempo: 2 minutos \u274c\n</code></pre>","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#usar-hashed-table","title":"\u2705 Usar HASHED Table","text":"<pre><code>\" \u2705 Converter para HASHED\nDATA lt_items_hash TYPE HASHED TABLE OF vbap\n  WITH UNIQUE KEY vbeln posnr.\n\nlt_items_hash = lt_items.\n\n\" \u2705 Apenas 1.000 itera\u00e7\u00f5es + 1.000 READs r\u00e1pidos\nLOOP AT lt_orders INTO DATA(ls_order).\n  LOOP AT lt_items_hash INTO DATA(ls_item)\n    WHERE vbeln = ls_order-vbeln.\n    \" Processamento...\n  ENDLOOP.\nENDLOOP.\n\n\" Tempo: 2 segundos \u2705\n\" Ganho: 60x mais r\u00e1pido!\n</code></pre>","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#5-modificar-tabela-durante-loop","title":"\ud83d\udd39 5. Modificar Tabela Durante LOOP","text":"","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#comportamento-imprevisivel","title":"\u274c Comportamento Imprevis\u00edvel","text":"<pre><code>\" \u274c Perigoso: modifica tabela durante itera\u00e7\u00e3o\nLOOP AT lt_data INTO DATA(ls_data).\n  IF ls_data-status = 'X'.\n    DELETE lt_data INDEX sy-tabix.  \" \u274c Pode saltar registos\n  ENDIF.\nENDLOOP.\n</code></pre>","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#marcar-e-deletar-depois","title":"\u2705 Marcar e Deletar Depois","text":"<pre><code>\" \u2705 Op\u00e7\u00e3o 1: Usar WHERE na loop\nLOOP AT lt_data INTO DATA(ls_data) WHERE status &lt;&gt; 'X'.\n  \" Processar apenas registos v\u00e1lidos\nENDLOOP.\n\n\" \u2705 Op\u00e7\u00e3o 2: DELETE com WHERE\nDELETE lt_data WHERE status = 'X'.\n\n\" \u2705 Op\u00e7\u00e3o 3: Nova tabela\nDATA lt_filtered LIKE lt_data.\nLOOP AT lt_data INTO DATA(ls_data) WHERE status &lt;&gt; 'X'.\n  APPEND ls_data TO lt_filtered.\nENDLOOP.\nlt_data = lt_filtered.\n</code></pre>","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#6-append-em-loop-grande","title":"\ud83d\udd39 6. APPEND em LOOP Grande","text":"","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#realocacao-constante","title":"\u274c Realoca\u00e7\u00e3o Constante","text":"<pre><code>DATA lt_result TYPE TABLE OF ty_data.\n\n\" \u274c Cada APPEND pode realocar mem\u00f3ria\nDO 100000 TIMES.\n  APPEND VALUE #( id = sy-index value = 'Test' ) TO lt_result.\nENDDO.\n\n\" Tempo: 5 segundos \u274c\n</code></pre>","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#value-com-lista","title":"\u2705 VALUE com Lista","text":"<pre><code>\" \u2705 Aloca\u00e7\u00e3o \u00fanica\nDATA(lt_result) = VALUE ty_t_data(\n  FOR i = 1 WHILE i &lt;= 100000\n  ( id = i value = 'Test' )\n).\n\n\" Tempo: 0.5 segundos \u2705\n</code></pre>","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#insert-lines-of","title":"\u2705 INSERT LINES OF","text":"<pre><code>\" \u2705 Para adicionar blocos\nDATA lt_result TYPE TABLE OF ty_data.\nDATA lt_chunk TYPE TABLE OF ty_data.\n\nDO 10 TIMES.\n  \" Criar chunk de 10.000\n  lt_chunk = VALUE #( FOR i = 1 WHILE i &lt;= 10000 ( id = i ) ).\n\n  \" Adicionar chunk de uma vez\n  INSERT LINES OF lt_chunk INTO TABLE lt_result.\nENDDO.\n</code></pre>","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#7-converter-tipos-repetidamente","title":"\ud83d\udd39 7. Converter Tipos Repetidamente","text":"","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#conversao-em-loop","title":"\u274c Convers\u00e3o em LOOP","text":"<pre><code>\" \u274c Converte 10.000 vezes\nLOOP AT lt_data INTO DATA(ls_data).\n  DATA(lv_string) = |{ ls_data-amount }|.  \" Convers\u00e3o repetida\n  \" Uso de lv_string...\nENDLOOP.\n</code></pre>","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#converter-uma-vez","title":"\u2705 Converter Uma Vez","text":"<pre><code>\" \u2705 Adicionar campo calculado antes do LOOP\nLOOP AT lt_data INTO DATA(ls_data).\n  ls_data-amount_string = |{ ls_data-amount }|.\n  MODIFY lt_data FROM ls_data.\nENDLOOP.\n\n\" Agora usar ls_data-amount_string sem convers\u00e3o\n</code></pre>","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#8-select-single-em-loop","title":"\ud83d\udd39 8. SELECT SINGLE em LOOP","text":"","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#multiplos-acessos","title":"\u274c M\u00faltiplos Acessos","text":"<pre><code>\" \u274c 1.000 SELECTs\nLOOP AT lt_materials INTO DATA(ls_mat).\n  SELECT SINGLE maktx FROM makt\n    INTO @DATA(lv_text)\n    WHERE matnr = @ls_mat-matnr\n      AND spras = @sy-langu.\nENDLOOP.\n</code></pre>","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#um-select-com-for-all-entries","title":"\u2705 Um SELECT com FOR ALL ENTRIES","text":"<pre><code>\" \u2705 1 SELECT apenas\nIF lt_materials IS NOT INITIAL.\n  SELECT matnr, maktx FROM makt\n    INTO TABLE @DATA(lt_texts)\n    FOR ALL ENTRIES IN @lt_materials\n    WHERE matnr = @lt_materials-matnr\n      AND spras = @sy-langu.\nENDIF.\n\n\" Converter para HASHED para lookups r\u00e1pidos\nDATA lt_texts_hash TYPE HASHED TABLE OF makt\n  WITH UNIQUE KEY matnr.\nlt_texts_hash = lt_texts.\n\n\" Usar no LOOP\nLOOP AT lt_materials INTO DATA(ls_mat).\n  READ TABLE lt_texts_hash INTO DATA(ls_text)\n    WITH TABLE KEY matnr = ls_mat-matnr.\n  \" Usar ls_text-maktx\nENDLOOP.\n</code></pre>","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#9-nao-usar-up-to-n-rows","title":"\ud83d\udd39 9. N\u00e3o Usar UP TO n ROWS","text":"","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#buscar-tudo-desnecessariamente","title":"\u274c Buscar Tudo Desnecessariamente","text":"<pre><code>\" \u274c Busca 10 milh\u00f5es de registos mas usa s\u00f3 100\nSELECT * FROM bseg\n  INTO TABLE @DATA(lt_items).\n\n\" Processar s\u00f3 100\nLOOP AT lt_items INTO DATA(ls_item) TO 100.\n  \" Processamento...\nENDLOOP.\n</code></pre>","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#limitar-na-query","title":"\u2705 Limitar na Query","text":"<pre><code>\" \u2705 Busca apenas o necess\u00e1rio\nSELECT * FROM bseg\n  INTO TABLE @DATA(lt_items)\n  UP TO 100 ROWS.\n\nLOOP AT lt_items INTO DATA(ls_item).\n  \" Processamento...\nENDLOOP.\n</code></pre>","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#10-string-concatenation-ineficiente","title":"\ud83d\udd39 10. String Concatenation Ineficiente","text":"","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#concatenacao-em-loop","title":"\u274c Concatena\u00e7\u00e3o em LOOP","text":"<pre><code>DATA lv_result TYPE string.\n\n\" \u274c Cada concatena\u00e7\u00e3o cria nova string\nLOOP AT lt_data INTO DATA(ls_data).\n  lv_result = lv_result &amp;&amp; ls_data-text &amp;&amp; cl_abap_char_utilities=&gt;newline.\nENDLOOP.\n\n\" Com 10.000 registos = muito lento!\n</code></pre>","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#usar-concatenate-lines-of","title":"\u2705 Usar CONCATENATE LINES OF","text":"<pre><code>\" \u2705 M\u00e9todo otimizado\nDATA(lv_result) = REDUCE string(\n  INIT result = ``\n  FOR &lt;line&gt; IN lt_data\n  NEXT result = result &amp;&amp; &lt;line&gt;-text &amp;&amp; cl_abap_char_utilities=&gt;newline\n).\n\n\" Ou simplesmente:\nDATA lt_strings TYPE TABLE OF string.\nLOOP AT lt_data INTO DATA(ls_data).\n  APPEND ls_data-text TO lt_strings.\nENDLOOP.\n\nCONCATENATE LINES OF lt_strings INTO lv_result\n  SEPARATED BY cl_abap_char_utilities=&gt;newline.\n</code></pre>","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#checklist-de-performance","title":"\ud83d\udcca Checklist de Performance","text":"<p>Antes de liberar c\u00f3digo:</p> <ul> <li>[ ] \u274c SELECT em LOOP \u2192 \u2705 FOR ALL ENTRIES ou JOIN</li> <li>[ ] \u274c SELECT * \u2192 \u2705 Especificar campos</li> <li>[ ] \u274c FOR ALL ENTRIES sem valida\u00e7\u00e3o \u2192 \u2705 IF IS NOT INITIAL</li> <li>[ ] \u274c NESTED LOOPS \u2192 \u2705 HASHED tables</li> <li>[ ] \u274c Modificar tabela em LOOP \u2192 \u2705 WHERE ou nova tabela</li> <li>[ ] \u274c APPEND em loops grandes \u2192 \u2705 VALUE ou INSERT LINES</li> <li>[ ] \u274c SELECT SINGLE em LOOP \u2192 \u2705 Um SELECT + HASHED</li> <li>[ ] \u274c Sem UP TO ROWS \u2192 \u2705 Limitar resultados</li> <li>[ ] \u274c Convers\u00f5es repetidas \u2192 \u2705 Calcular uma vez</li> <li>[ ] \u274c String concatenation \u2192 \u2705 CONCATENATE LINES OF</li> </ul>","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#regra-de-ouro","title":"\ud83d\udca1 Regra de Ouro","text":"<p>\"Se faz mais de 100 acessos \u00e0 BD, est\u00e1 ERRADO!\"</p> <p>Metas: - Online programs: &lt; 10 DB accesses - Background jobs: &lt; 100 DB accesses - Reports: Depende do volume, mas sempre otimizar</p>","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#ferramentas-de-validacao","title":"\ud83d\ude80 Ferramentas de Valida\u00e7\u00e3o","text":"<ol> <li>SAT (Runtime Analysis): Medir performance</li> <li>ST05 (SQL Trace): Ver queries SQL</li> <li>Code Inspector (SCI): Detetar anti-patterns</li> <li>ST22: Analisar dumps</li> <li>ST02: Monitorizar buffer</li> </ol>","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#resumo","title":"\ud83c\udfaf Resumo","text":"Armadilha Impacto Solu\u00e7\u00e3o SELECT em LOOP \ud83d\ude31\ud83d\ude31\ud83d\ude31 Cr\u00edtico FOR ALL ENTRIES SELECT * \ud83d\ude31\ud83d\ude31 Alto Especificar campos FAE sem valida\u00e7\u00e3o \ud83d\ude31\ud83d\ude31\ud83d\ude31 Cr\u00edtico IF IS NOT INITIAL NESTED LOOPS \ud83d\ude31\ud83d\ude31 Alto HASHED tables Modificar em LOOP \ud83d\ude31 M\u00e9dio WHERE ou nova tabela","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"performance/6_armadilhas/#proximo-passo","title":"\ud83d\ude80 Pr\u00f3ximo Passo","text":"<p>Reveja todos os t\u00f3picos de performance e aplique no seu c\u00f3digo: 1. FOR ALL ENTRIES 2. \u00cdndices 3. Runtime Analysis 4. Buffering 5. Tabelas Internas</p>","tags":["ABAP","Performance","Armadilhas","Anti-Patterns","Boas Pr\u00e1ticas"]},{"location":"security/","title":"\ud83d\udd12 Seguran\u00e7a e Autoriza\u00e7\u00e3o","text":"<p>Pr\u00e1ticas e exemplos para verificar autoriza\u00e7\u00f5es e proteger programas ABAP contra acessos n\u00e3o autorizados.</p>"},{"location":"security/#o-que-vais-aprender","title":"\ud83d\udcd6 O que vais aprender","text":"<ul> <li>Objetos de autoriza\u00e7\u00e3o</li> <li>AUTHORITY-CHECK</li> <li>Roles e perfis de utilizador (PFCG)</li> <li>SU53 para an\u00e1lise de erros</li> <li>Prote\u00e7\u00e3o de transa\u00e7\u00f5es customizadas</li> <li>Boas pr\u00e1ticas de seguran\u00e7a</li> <li>Auditoria e logs</li> </ul>"},{"location":"security/#conceitos-principais","title":"\ud83c\udfaf Conceitos Principais","text":""},{"location":"security/#objeto-de-autorizacao","title":"Objeto de Autoriza\u00e7\u00e3o","text":"<p>Define o qu\u00ea pode ser protegido (ex: S_TCODE para transa\u00e7\u00f5es)</p>"},{"location":"security/#campo-de-autorizacao","title":"Campo de Autoriza\u00e7\u00e3o","text":"<p>Define como \u00e9 protegido (ex: TCD = c\u00f3digo da transa\u00e7\u00e3o)</p>"},{"location":"security/#perfil-de-autorizacao","title":"Perfil de Autoriza\u00e7\u00e3o","text":"<p>Conjunto de autoriza\u00e7\u00f5es atribu\u00eddas a um utilizador</p>"},{"location":"security/#authority-check","title":"\ud83d\udd11 AUTHORITY-CHECK","text":""},{"location":"security/#verificacao-basica","title":"Verifica\u00e7\u00e3o B\u00e1sica","text":"<pre><code>AUTHORITY-CHECK OBJECT 'S_TCODE'\n  ID 'TCD' FIELD 'SE38'.\n\nIF sy-subrc &lt;&gt; 0.\n  MESSAGE 'Sem permiss\u00e3o para executar SE38' TYPE 'E'.\nENDIF.\n</code></pre>"},{"location":"security/#verificacao-com-multiplos-campos","title":"Verifica\u00e7\u00e3o com M\u00faltiplos Campos","text":"<pre><code>AUTHORITY-CHECK OBJECT 'M_MATE_WRK'\n  ID 'ACTVT' FIELD '02'      \" 02 = Altera\u00e7\u00e3o\n  ID 'WERKS' FIELD lv_planta.\n\nCASE sy-subrc.\n  WHEN 0.\n    \" Tem autoriza\u00e7\u00e3o\n  WHEN 4.\n    MESSAGE 'Sem autoriza\u00e7\u00e3o para alterar material nesta planta' TYPE 'E'.\n  WHEN 12.\n    MESSAGE 'Objeto de autoriza\u00e7\u00e3o n\u00e3o configurado' TYPE 'E'.\n  WHEN OTHERS.\n    MESSAGE 'Erro ao verificar autoriza\u00e7\u00e3o' TYPE 'E'.\nENDCASE.\n</code></pre>"},{"location":"security/#objetos-de-autorizacao-comuns","title":"\ud83d\udcca Objetos de Autoriza\u00e7\u00e3o Comuns","text":"Objeto Descri\u00e7\u00e3o <code>S_TCODE</code> Acesso a transa\u00e7\u00f5es <code>S_TABU_NAM</code> Acesso a tabelas <code>S_PROGRAM</code> Execu\u00e7\u00e3o de programs <code>S_DEVELOP</code> Objetos de desenvolvimento <code>M_MATE_WRK</code> Materiais por planta <code>F_BKPF_BUK</code> Documentos contabil\u00edsticos <code>V_VBAK_VKO</code> Ordens de venda <p>Consultar todos: Transa\u00e7\u00e3o SU21</p>"},{"location":"security/#exemplo-completo","title":"\ud83d\udca1 Exemplo Completo","text":"<pre><code>REPORT z_protegido.\n\n\" Par\u00e2metro de sele\u00e7\u00e3o\nPARAMETERS: p_bukrs TYPE bukrs.\n\nSTART-OF-SELECTION.\n\n  \" \u2705 Verificar autoriza\u00e7\u00e3o para a empresa\n  AUTHORITY-CHECK OBJECT 'F_BKPF_BUK'\n    ID 'BUKRS' FIELD p_bukrs\n    ID 'ACTVT' FIELD '03'.  \" 03 = Visualiza\u00e7\u00e3o\n\n  IF sy-subrc &lt;&gt; 0.\n    MESSAGE |Sem autoriza\u00e7\u00e3o para empresa { p_bukrs }| TYPE 'E'.\n  ENDIF.\n\n  \" Continuar processamento...\n  SELECT * FROM bkpf\n    INTO TABLE @DATA(lt_docs)\n    WHERE bukrs = @p_bukrs\n    UP TO 100 ROWS.\n\n  WRITE: / |Encontrados { lines( lt_docs ) } documentos|.\n</code></pre>"},{"location":"security/#ferramentas-de-analise","title":"\ud83d\udee0\ufe0f Ferramentas de An\u00e1lise","text":""},{"location":"security/#su53-analise-de-autorizacao","title":"SU53 - An\u00e1lise de Autoriza\u00e7\u00e3o","text":"<p>Ap\u00f3s um erro de autoriza\u00e7\u00e3o, executar SU53 para ver: - Objeto que faltou - Campos e valores verificados - Utilizador e timestamp</p>"},{"location":"security/#pfcg-gestao-de-roles","title":"PFCG - Gest\u00e3o de Roles","text":"<p>Criar e manter roles (perfis de autoriza\u00e7\u00e3o): 1. Transa\u00e7\u00e3o PFCG 2. Criar role (ex: Z_VENDAS_READONLY) 3. Adicionar transa\u00e7\u00f5es e objetos 4. Gerar perfil 5. Atribuir a utilizadores</p>"},{"location":"security/#st01-system-trace","title":"ST01 - System Trace","text":"<p>Rastrear todas as verifica\u00e7\u00f5es de autoriza\u00e7\u00e3o: 1. Ativar trace em ST01 2. Executar programa 3. Desativar trace 4. Analisar verifica\u00e7\u00f5es realizadas</p>"},{"location":"security/#boas-praticas","title":"\ud83d\udea8 Boas Pr\u00e1ticas","text":""},{"location":"security/#fazer","title":"\u2705 Fazer","text":"<ol> <li>Sempre verificar antes de opera\u00e7\u00f5es cr\u00edticas</li> <li>Mensagens claras sobre o que falta</li> <li>Logar tentativas de acesso n\u00e3o autorizado</li> <li>Princ\u00edpio do menor privil\u00e9gio: dar apenas o necess\u00e1rio</li> <li>Usar objetos custom para funcionalidades pr\u00f3prias (Z*)</li> <li>Documentar requirements de autoriza\u00e7\u00e3o</li> </ol>"},{"location":"security/#evitar","title":"\u274c Evitar","text":"<ol> <li>Hardcoded bypass (ex: <code>IF sy-uname = 'ADMIN'</code>)</li> <li>Autoriza\u00e7\u00e3o gen\u00e9rica demais (ex: S_TCODE = *)</li> <li>Confiar apenas em UI (sempre validar no backend)</li> <li>N\u00e3o tratar sy-subrc ap\u00f3s AUTHORITY-CHECK</li> <li>Expor dados sens\u00edveis em logs</li> </ol>"},{"location":"security/#exemplo-avancado-role-customizado","title":"\ud83c\udf93 Exemplo Avan\u00e7ado: Role Customizado","text":""},{"location":"security/#1-criar-objeto-de-autorizacao-su21","title":"1. Criar Objeto de Autoriza\u00e7\u00e3o (SU21)","text":"<pre><code>Objeto: Z_VENDAS\nClasse: BC_A (Application-specific)\n\nCampos:\n- ACTVT (Atividade): 01=Criar, 02=Alterar, 03=Visualizar\n- VKORG (Organiza\u00e7\u00e3o de vendas)\n- SPART (Setor de atividade)\n</code></pre>"},{"location":"security/#2-usar-no-codigo","title":"2. Usar no C\u00f3digo","text":"<pre><code>AUTHORITY-CHECK OBJECT 'Z_VENDAS'\n  ID 'ACTVT' FIELD '02'           \" Alterar\n  ID 'VKORG' FIELD ls_ordem-vkorg\n  ID 'SPART' FIELD ls_ordem-spart.\n\nIF sy-subrc &lt;&gt; 0.\n  MESSAGE 'Sem autoriza\u00e7\u00e3o para alterar ordem desta org. vendas' TYPE 'E'.\nENDIF.\n</code></pre>"},{"location":"security/#3-criar-role-pfcg","title":"3. Criar Role (PFCG)","text":"<ol> <li>PFCG \u2192 Criar role Z_VENDEDOR</li> <li>Aba Autoriza\u00e7\u00f5es</li> <li>Adicionar objeto Z_VENDAS</li> <li>Configurar valores:</li> <li>ACTVT: 01, 03 (Criar e Visualizar)</li> <li>VKORG: 1000</li> <li>SPART: *</li> <li>Gerar perfil e atribuir a utilizadores</li> </ol>"},{"location":"security/#auditoria-e-logs","title":"\ud83d\udd10 Auditoria e Logs","text":""},{"location":"security/#logar-tentativas-falhadas","title":"Logar Tentativas Falhadas","text":"<pre><code>IF sy-subrc &lt;&gt; 0.\n  \" Logar em Application Log (SLG1)\n  CALL FUNCTION 'BAL_LOG_CREATE'\n    EXPORTING\n      i_s_log = VALUE bal_s_log(\n        object    = 'ZSECURITY'\n        subobject = 'AUTH_CHECK'\n        aldate    = sy-datum\n        altime    = sy-uzeit\n        aluser    = sy-uname )\n    IMPORTING\n      e_log_handle = DATA(lv_handle).\n\n  CALL FUNCTION 'BAL_LOG_MSG_ADD'\n    EXPORTING\n      i_log_handle = lv_handle\n      i_s_msg      = VALUE bal_s_msg(\n        msgty = 'E'\n        msgid = 'ZZ'\n        msgno = '001'\n        msgv1 = |Tentativa falha: { sy-tcode }| ).\n\n  COMMIT WORK.\nENDIF.\n</code></pre>"},{"location":"security/#exercicios-praticos","title":"\ud83d\udcda Exerc\u00edcios Pr\u00e1ticos","text":"<p>Exerc\u00edcios dispon\u00edveis (ser\u00e3o desenvolvidos): - <code>ex01.md</code> \u2192 AUTHORITY-CHECK b\u00e1sico - <code>ex02.md</code> \u2192 Criar objeto customizado - <code>ex03.md</code> \u2192 Role com m\u00faltiplas autoriza\u00e7\u00f5es - <code>ex04.md</code> \u2192 Auditoria de acessos - <code>ex05.md</code> \u2192 An\u00e1lise com SU53/ST01</p>"},{"location":"security/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ol> <li>Leia Autoriza\u00e7\u00f5es - Entender sistema de autoriza\u00e7\u00f5es</li> <li>Pratique Authority Check - Implementar verifica\u00e7\u00f5es</li> <li>Configure Roles e Perfis - Gest\u00e3o em PFCG</li> <li>Estude S_DEVELOP - Proteger desenvolvimento</li> <li>Aplique Pr\u00e1ticas Seguras - Seguran\u00e7a no c\u00f3digo</li> <li>Previna SQL Injection - Proteger contra ataques</li> </ol>"},{"location":"security/1_autorizacoes/","title":"Autoriza\u00e7\u00f5es SAP","text":"","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>O sistema de autoriza\u00e7\u00f5es SAP controla quem pode fazer o qu\u00ea, protegendo dados e funcionalidades cr\u00edticas.</p>","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#conceitos-principais","title":"\ud83d\udd11 Conceitos Principais","text":"","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#objeto-de-autorizacao","title":"Objeto de Autoriza\u00e7\u00e3o","text":"<p>Define o qu\u00ea pode ser protegido.</p> <p>Exemplo: <code>S_TCODE</code> (acesso a transa\u00e7\u00f5es)</p>","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#campo-de-autorizacao","title":"Campo de Autoriza\u00e7\u00e3o","text":"<p>Define como \u00e9 protegido.</p> <p>Exemplo: <code>TCD</code> (c\u00f3digo da transa\u00e7\u00e3o dentro de S_TCODE)</p>","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#valor-de-atividade-actvt","title":"Valor de Atividade (ACTVT)","text":"<p>Tipo de opera\u00e7\u00e3o.</p> C\u00f3digo Atividade <code>01</code> Criar (Create) <code>02</code> Alterar (Change) <code>03</code> Visualizar (Display) <code>06</code> Deletar (Delete) <code>16</code> Executar (Execute)","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#transacoes-principais","title":"\ud83d\udee0\ufe0f Transa\u00e7\u00f5es Principais","text":"Transa\u00e7\u00e3o Descri\u00e7\u00e3o SU01 Manuten\u00e7\u00e3o de usu\u00e1rios SU21 Manuten\u00e7\u00e3o de objetos de autoriza\u00e7\u00e3o SU24 Verificar dados de autoriza\u00e7\u00e3o PFCG Manuten\u00e7\u00e3o de roles SU53 Avaliar verifica\u00e7\u00e3o de autoriza\u00e7\u00e3o ST01 System trace (autoriza \u00e7\u00f5es)","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#objetos-de-autorizacao-comuns","title":"\ud83d\udcca Objetos de Autoriza\u00e7\u00e3o Comuns","text":"","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#desenvolvimento","title":"Desenvolvimento","text":"<pre><code>S_DEVELOP - Objetos de desenvolvimento\n  Campos:\n    - DEVCLASS (Pacote)\n    - OBJTYPE (Tipo: PROG, CLAS, TABL...)\n    - OBJNAME (Nome do objeto)\n    - ACTVT (Atividade: 01, 02, 03...)\n</code></pre>","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#transacoes","title":"Transa\u00e7\u00f5es","text":"<pre><code>S_TCODE - Execu\u00e7\u00e3o de transa\u00e7\u00f5es\n  Campos:\n    - TCD (C\u00f3digo da transa\u00e7\u00e3o)\n</code></pre>","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#tabelas","title":"Tabelas","text":"<pre><code>S_TABU_NAM - Acesso a tabelas\n  Campos:\n    - TABLE (Nome da tabela)\n    - ACTVT (Atividade)\n</code></pre>","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#documentos-financeiros","title":"Documentos Financeiros","text":"<pre><code>F_BKPF_BUK - Documentos contabil\u00edsticos\n  Campos:\n    - BUKRS (Empresa)\n    - ACTVT (Atividade)\n</code></pre>","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#ordens-de-venda","title":"Ordens de Venda","text":"<pre><code>V_VBAK_VKO - Ordens de venda\n  Campos:\n    - VKORG (Org. vendas)\n    - VTWEG (Canal distribui\u00e7\u00e3o)\n    - ACTVT (Atividade)\n</code></pre>","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#consultar-objetos-su21","title":"\ud83d\udca1 Consultar Objetos (SU21)","text":"<ol> <li>Executar: <code>SU21</code></li> <li>Classe: (ex: BC_A - Application-specific)</li> <li>Ver objetos dispon\u00edveis</li> <li>Duplo-clique para ver campos</li> </ol>","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#verificar-autorizacoes-do-usuario","title":"\ud83d\udd0d Verificar Autoriza\u00e7\u00f5es do Usu\u00e1rio","text":"","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#su01-dados-do-usuario","title":"SU01 - Dados do Usu\u00e1rio","text":"<pre><code>1. SU01\n2. Inserir username\n3. Aba \"Roles\"\n4. Ver roles atribu\u00eddos\n</code></pre>","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#su53-analise-de-erro","title":"SU53 - An\u00e1lise de Erro","text":"<p>Executar imediatamente ap\u00f3s erro de autoriza\u00e7\u00e3o:</p> <pre><code>1. Erro: \"Sem autoriza\u00e7\u00e3o para transa\u00e7\u00e3o SE38\"\n2. Executar: SU53\n3. Ver:\n   - Objeto faltando (S_TCODE)\n   - Valor verificado (TCD = SE38)\n   - Resultado (Retorna: 4 - Sem autoriza\u00e7\u00e3o)\n</code></pre>","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#hierarquia-de-autorizacoes","title":"\ud83c\udfaf Hierarquia de Autoriza\u00e7\u00f5es","text":"<pre><code>Usu\u00e1rio (SU01)\n  \u2514\u2500\u2500 Roles (PFCG)\n        \u2514\u2500\u2500 Perfil de Autoriza\u00e7\u00e3o\n              \u2514\u2500\u2500 Objeto de Autoriza\u00e7\u00e3o (SU21)\n                    \u2514\u2500\u2500 Campo de Autoriza\u00e7\u00e3o\n                          \u2514\u2500\u2500 Valor\n</code></pre> <p>Exemplo: <pre><code>Usu\u00e1rio: BMOREIRA\n  \u2514\u2500\u2500 Role: Z_VENDEDOR\n        \u2514\u2500\u2500 Perfil: Z_VENDEDOR_P\n              \u2514\u2500\u2500 Objeto: V_VBAK_VKO\n                    \u251c\u2500\u2500 VKORG: 1000\n                    \u251c\u2500\u2500 VTWEG: *\n                    \u2514\u2500\u2500 ACTVT: 01, 03 (Criar, Visualizar)\n</code></pre></p>","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#principio-do-menor-privilegio","title":"\ud83d\udd10 Princ\u00edpio do Menor Privil\u00e9gio","text":"<p>Dar apenas as autoriza\u00e7\u00f5es necess\u00e1rias para o trabalho.</p>","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#correto","title":"\u2705 Correto","text":"<pre><code>Vendedor:\n  - V_VBAK_VKO (Ordens de venda): 01, 03  \u2705 Criar e visualizar\n  - V_VBAP_VKO (Itens): 01, 03\n</code></pre>","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#incorreto","title":"\u274c Incorreto","text":"<pre><code>Vendedor:\n  - S_TCODE: * (TODAS as transa\u00e7\u00f5es!)  \u274c PERIGOSO!\n  - F_BKPF_BUK: * (Documentos financeiros)  \u274c N\u00e3o precisa!\n</code></pre>","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#exemplo-criar-objeto-custom","title":"\ud83d\udca1 Exemplo: Criar Objeto Custom","text":"","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#1-su21-criar-objeto","title":"1. SU21 - Criar Objeto","text":"<pre><code>SU21 \u2192 Create\nObjeto: Z_VENDAS\nClasse: BC_A (Application)\n\nCampos:\n  - ACTVT (Atividade): 01, 02, 03\n  - VKORG (Org. vendas)\n  - SPART (Setor atividade)\n</code></pre>","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#2-usar-em-codigo","title":"2. Usar em C\u00f3digo","text":"<pre><code>AUTHORITY-CHECK OBJECT 'Z_VENDAS'\n  ID 'ACTVT' FIELD '02'  \" Alterar\n  ID 'VKORG' FIELD '1000'\n  ID 'SPART' FIELD '01'.\n\nIF sy-subrc &lt;&gt; 0.\n  MESSAGE 'Sem autoriza\u00e7\u00e3o para alterar vendas org 1000' TYPE 'E'.\nENDIF.\n</code></pre>","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#3-pfcg-incluir-em-role","title":"3. PFCG - Incluir em Role","text":"<pre><code>PFCG \u2192 Criar role Z_VENDEDOR_SP\nAba \"Authorizations\"\n  Adicionar objeto Z_VENDAS\n    ACTVT: 01, 02, 03\n    VKORG: 1000\n    SPART: 01\nGerar perfil\nAtribuir a usu\u00e1rios\n</code></pre>","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#trace-de-autorizacoes-st01","title":"\ud83c\udf93 Trace de Autoriza\u00e7\u00f5es (ST01)","text":"<p>Para descobrir que autoriza\u00e7\u00f5es um programa precisa:</p> <pre><code>1. ST01 \u2192 Ativar trace\n   Marcar: \"Authorization Check\"\n\n2. Executar programa/transa\u00e7\u00e3o\n\n3. ST01 \u2192 Desativar trace\n\n4. Analisar resultados:\n   - Objetos verificados\n   - Valores testados\n   - Resultado (OK / Fail)\n</code></pre>","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#boas-praticas","title":"\u26a1 Boas Pr\u00e1ticas","text":"","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#fazer","title":"\u2705 Fazer","text":"<pre><code>1. Usar objetos standard quando poss\u00edvel\n   - S_TCODE para transa\u00e7\u00f5es\n   - S_TABU_NAM para tabelas\n\n2. Criar objetos Z* para l\u00f3gica custom\n   - Z_VENDAS, Z_COMPRAS, etc.\n\n3. Documentar requisitos de autoriza\u00e7\u00e3o\n   - README do programa: \"Requer S_TCODE e Z_VENDAS\"\n\n4. Testar com usu\u00e1rio restrito\n   - N\u00e3o testar sempre como admin!\n\n5. Logging de falhas\n   - Logar tentativas de acesso n\u00e3o autorizado\n</code></pre>","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#evitar","title":"\u274c Evitar","text":"<pre><code>1. Dar SAP_ALL a todos  \u274c\n   - Apenas emergency user\n\n2. Wildcards demais  \u274c\n   - TCD: * (todas transa\u00e7\u00f5es)\n\n3. N\u00e3o validar autoriza\u00e7\u00f5es  \u274c\n   - Confiar apenas em UI\n\n4. Hardcoded bypass  \u274c\n   - IF sy-uname = 'ADMIN'. (sem auth check)\n\n5. N\u00e3o revisar roles periodicamente  \u274c\n   - Remover acessos desnecess\u00e1rios\n</code></pre>","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/1_autorizacoes/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>AUTHORITY-CHECK - Implementar verifica\u00e7\u00f5es</li> <li>Roles e Perfis - Gest\u00e3o em PFCG</li> <li>S_DEVELOP - Proteger desenvolvimento</li> </ul> <p>Tags: <code>#Authorization</code> <code>#Security</code> <code>#SU21</code> <code>#PFCG</code> <code>#SU53</code></p>","tags":["ABAP","Security","Authorization","SAP Security"]},{"location":"security/2_authority_check/","title":"AUTHORITY-CHECK","text":"","tags":["ABAP","Security","AUTHORITY-CHECK","Authorization"]},{"location":"security/2_authority_check/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>AUTHORITY-CHECK \u00e9 o comando ABAP para verificar se usu\u00e1rio atual tem autoriza\u00e7\u00e3o para executar uma opera\u00e7\u00e3o.</p>","tags":["ABAP","Security","AUTHORITY-CHECK","Authorization"]},{"location":"security/2_authority_check/#sintaxe-basica","title":"\ud83d\udd27 Sintaxe B\u00e1sica","text":"<pre><code>AUTHORITY-CHECK OBJECT 'NOME_OBJETO'\n  ID 'CAMPO1' FIELD valor1\n  ID 'CAMPO2' FIELD valor2\n  ID 'CAMPO3' DUMMY.  \" N\u00e3o verifica este campo\n\n\" Verificar resultado\nIF sy-subrc &lt;&gt; 0.\n  \" Sem autoriza\u00e7\u00e3o\nENDIF.\n</code></pre>","tags":["ABAP","Security","AUTHORITY-CHECK","Authorization"]},{"location":"security/2_authority_check/#valores-de-sy-subrc","title":"\ud83d\udcca Valores de sy-subrc","text":"sy-subrc Significado 0 \u2705 Tem autoriza\u00e7\u00e3o 4 \u274c Sem autoriza\u00e7\u00e3o 8 \u26a0\ufe0f Dado mestre incompleto 12 \u274c Objeto n\u00e3o existe 16 \u26a0\ufe0f Erro de sintaxe 24 \u274c Sem dado mestre","tags":["ABAP","Security","AUTHORITY-CHECK","Authorization"]},{"location":"security/2_authority_check/#exemplos-praticos","title":"\ud83d\udca1 Exemplos Pr\u00e1ticos","text":"","tags":["ABAP","Security","AUTHORITY-CHECK","Authorization"]},{"location":"security/2_authority_check/#verificar-acesso-a-transacao","title":"Verificar Acesso a Transa\u00e7\u00e3o","text":"<pre><code>AUTHORITY-CHECK OBJECT 'S_TCODE'\n  ID 'TCD' FIELD 'SE38'.\n\nCASE sy-subrc.\n  WHEN 0.\n    MESSAGE 'Acesso permitido' TYPE 'S'.\n  WHEN 4.\n    MESSAGE 'Sem autoriza\u00e7\u00e3o para SE38' TYPE 'E'.\n  WHEN 12.\n    MESSAGE 'Objeto S_TCODE n\u00e3o configurado' TYPE 'E'.\nENDCASE.\n</code></pre>","tags":["ABAP","Security","AUTHORITY-CHECK","Authorization"]},{"location":"security/2_authority_check/#verificar-acesso-a-empresa","title":"Verificar Acesso a Empresa","text":"<pre><code>PARAMETERS: p_bukrs TYPE bukrs.\n\nSTART-OF-SELECTION.\n\n  AUTHORITY-CHECK OBJECT 'F_BKPF_BUK'\n    ID 'BUKRS' FIELD p_bukrs\n    ID 'ACTVT' FIELD '03'.  \" 03 = Visualizar\n\n  IF sy-subrc &lt;&gt; 0.\n    MESSAGE |Sem autoriza\u00e7\u00e3o para empresa { p_bukrs }| TYPE 'E'.\n  ENDIF.\n\n  \" Continuar processamento...\n  SELECT * FROM bkpf\n    WHERE bukrs = @p_bukrs\n    INTO TABLE @DATA(lt_docs).\n</code></pre>","tags":["ABAP","Security","AUTHORITY-CHECK","Authorization"]},{"location":"security/2_authority_check/#verificar-multiplos-campos","title":"Verificar M\u00faltiplos Campos","text":"<pre><code>AUTHORITY-CHECK OBJECT 'M_MATE_WRK'\n  ID 'ACTVT' FIELD '02'         \" 02 = Alterar\n  ID 'WERKS' FIELD lv_planta\n  ID 'LGORT' FIELD lv_deposito.\n\nIF sy-subrc = 0.\n  \" Autorizado para alterar material nesta planta/dep\u00f3sito\n  mo_material-&gt;update( ).\nELSE.\n  MESSAGE 'Sem autoriza\u00e7\u00e3o para alterar material' TYPE 'E'.\nENDIF.\n</code></pre>","tags":["ABAP","Security","AUTHORITY-CHECK","Authorization"]},{"location":"security/2_authority_check/#dummy-ignorar-campo","title":"DUMMY - Ignorar Campo","text":"<pre><code>\" Verificar apenas ACTVT, ignorar WERKS\nAUTHORITY-CHECK OBJECT 'M_MATE_WRK'\n  ID 'ACTVT' FIELD '03'\n  ID 'WERKS' DUMMY.  \" N\u00e3o verificado (permite qualquer planta)\n\nIF sy-subrc = 0.\n  \" Pode visualizar materiais em qualquer planta\nENDIF.\n</code></pre>","tags":["ABAP","Security","AUTHORITY-CHECK","Authorization"]},{"location":"security/2_authority_check/#quando-verificar-autorizacoes","title":"\ud83c\udfaf Quando Verificar Autoriza\u00e7\u00f5es?","text":"","tags":["ABAP","Security","AUTHORITY-CHECK","Authorization"]},{"location":"security/2_authority_check/#sempre-verificar-antes-de","title":"\u2705 Sempre verificar antes de:","text":"<ol> <li> <p>Gravar/Alterar/Deletar dados <pre><code>AUTHORITY-CHECK OBJECT 'Z_VENDAS'\n  ID 'ACTVT' FIELD '02'.  \" Alterar\n\nIF sy-subrc = 0.\n  UPDATE vbak SET ...\nENDIF.\n</code></pre></p> </li> <li> <p>Executar transa\u00e7\u00e3o <pre><code>AUTHORITY-CHECK OBJECT 'S_TCODE'\n  ID 'TCD' FIELD 'SM37'.\n</code></pre></p> </li> <li> <p>Ler dados sens\u00edveis <pre><code>AUTHORITY-CHECK OBJECT 'F_BKPF_BUK'\n  ID 'BUKRS' FIELD lv_company\n  ID 'ACTVT' FIELD '03'.  \" Visualizar\n\nIF sy-subrc = 0.\n  SELECT * FROM bseg...\nENDIF.\n</code></pre></p> </li> <li> <p>Executar opera\u00e7\u00f5es cr\u00edticas <pre><code>AUTHORITY-CHECK OBJECT 'S_DATASET'\n  ID 'ACTVT' FIELD '34'  \" Execute\n  ID 'FILENAME' FIELD '/tmp/data.txt'.\n</code></pre></p> </li> </ol>","tags":["ABAP","Security","AUTHORITY-CHECK","Authorization"]},{"location":"security/2_authority_check/#exemplo-completo-report-protegido","title":"\ud83d\udca1 Exemplo Completo: Report Protegido","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_SALES_REPORT\n*&amp; Relat\u00f3rio de vendas (protegido por autoriza\u00e7\u00f5es)\n*&amp;---------------------------------------------------------------------*\nREPORT z_sales_report.\n\nPARAMETERS: p_vkorg TYPE vkorg,  \" Org. vendas\n            p_vtweg TYPE vtweg.  \" Canal\n\nSTART-OF-SELECTION.\n\n  \" \u2550\u2550\u2550 Verificar autoriza\u00e7\u00e3o para org. vendas \u2550\u2550\u2550\n  AUTHORITY-CHECK OBJECT 'V_VBAK_VKO'\n    ID 'VKORG' FIELD p_vkorg\n    ID 'VTWEG' FIELD p_vtweg\n    ID 'ACTVT' FIELD '03'.  \" Visualizar\n\n  CASE sy-subrc.\n    WHEN 0.\n      \" OK - tem autoriza\u00e7\u00e3o\n\n    WHEN 4.\n      MESSAGE |Sem autoriza\u00e7\u00e3o para org. vendas { p_vkorg }| TYPE 'E'.\n      RETURN.\n\n    WHEN 12.\n      MESSAGE 'Objeto V_VBAK_VKO n\u00e3o configurado' TYPE 'E'.\n      RETURN.\n\n    WHEN OTHERS.\n      MESSAGE 'Erro ao verificar autoriza\u00e7\u00e3o' TYPE 'E'.\n      RETURN.\n  ENDCASE.\n\n  \" \u2550\u2550\u2550 Processar apenas se autorizado \u2550\u2550\u2550\n  SELECT * FROM vbak\n    WHERE vkorg = @p_vkorg\n      AND vtweg = @p_vtweg\n    INTO TABLE @DATA(lt_orders).\n\n  LOOP AT lt_orders INTO DATA(ls_order).\n    WRITE: / ls_order-vbeln, ls_order-kunnr, ls_order-netwr.\n  ENDLOOP.\n\n  WRITE: / |Total: { lines( lt_orders ) } ordens|.\n</code></pre>","tags":["ABAP","Security","AUTHORITY-CHECK","Authorization"]},{"location":"security/2_authority_check/#verificacoes-dinamicas","title":"\ud83d\udd10 Verifica\u00e7\u00f5es Din\u00e2micas","text":"","tags":["ABAP","Security","AUTHORITY-CHECK","Authorization"]},{"location":"security/2_authority_check/#verificar-lista-de-valores","title":"Verificar Lista de Valores","text":"<pre><code>DATA: lt_empresas TYPE TABLE OF bukrs.\n\nlt_empresas = VALUE #( ( '1000' ) ( '2000' ) ( '3000' ) ).\n\nLOOP AT lt_empresas INTO DATA(lv_bukrs).\n\n  AUTHORITY-CHECK OBJECT 'F_BKPF_BUK'\n    ID 'BUKRS' FIELD lv_bukrs\n    ID 'ACTVT' FIELD '03'.\n\n  IF sy-subrc = 0.\n    \" Processar empresa autorizada\n    PERFORM process_company USING lv_bukrs.\n  ELSE.\n    WRITE: / |Empresa { lv_bukrs }: SEM AUTORIZA\u00c7\u00c3O|.\n  ENDIF.\n\nENDLOOP.\n</code></pre>","tags":["ABAP","Security","AUTHORITY-CHECK","Authorization"]},{"location":"security/2_authority_check/#verificar-antes-de-loop","title":"Verificar Antes de Loop","text":"<pre><code>\" \u2705 Verificar ANTES de buscar dados\nAUTHORITY-CHECK OBJECT 'S_TABU_NAM'\n  ID 'TABLE' FIELD 'MARA'\n  ID 'ACTVT' FIELD '03'.\n\nIF sy-subrc = 0.\n  \" Autorizado - buscar dados\n  SELECT * FROM mara INTO TABLE @DATA(lt_materials).\n\n  LOOP AT lt_materials INTO DATA(ls_material).\n    WRITE: / ls_material-matnr.\n  ENDLOOP.\nELSE.\n  MESSAGE 'Sem autoriza\u00e7\u00e3o para tabela MARA' TYPE 'E'.\nENDIF.\n</code></pre>","tags":["ABAP","Security","AUTHORITY-CHECK","Authorization"]},{"location":"security/2_authority_check/#proteger-transacao-custom","title":"\ud83d\udee1\ufe0f Proteger Transa\u00e7\u00e3o Custom","text":"","tags":["ABAP","Security","AUTHORITY-CHECK","Authorization"]},{"location":"security/2_authority_check/#1-criar-objeto-de-autorizacao-su21","title":"1. Criar Objeto de Autoriza\u00e7\u00e3o (SU21)","text":"<pre><code>Objeto: Z_MY_TCODE\nCampos:\n  - TCD (C\u00f3digo transa\u00e7\u00e3o)\n</code></pre>","tags":["ABAP","Security","AUTHORITY-CHECK","Authorization"]},{"location":"security/2_authority_check/#2-no-codigo-da-transacao","title":"2. No C\u00f3digo da Transa\u00e7\u00e3o","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Transaction Z_MY_TRANS\n*&amp;---------------------------------------------------------------------*\n\nINITIALIZATION.\n  \" Verificar autoriza\u00e7\u00e3o logo no in\u00edcio\n  AUTHORITY-CHECK OBJECT 'Z_MY_TCODE'\n    ID 'TCD' FIELD sy-tcode.  \" sy-tcode = Z_MY_TRANS\n\n  IF sy-subrc &lt;&gt; 0.\n    MESSAGE 'Sem autoriza\u00e7\u00e3o para executar esta transa\u00e7\u00e3o' TYPE 'E'.\n    LEAVE PROGRAM.\n  ENDIF.\n\nSTART-OF-SELECTION.\n  \" ... l\u00f3gica da transa\u00e7\u00e3o ...\n</code></pre>","tags":["ABAP","Security","AUTHORITY-CHECK","Authorization"]},{"location":"security/2_authority_check/#3-pfcg-incluir-em-role","title":"3. PFCG - Incluir em Role","text":"<pre><code>Role: Z_USER_ROLE\nAutoriza\u00e7\u00e3o:\n  Z_MY_TCODE\n    TCD: Z_MY_TRANS\n</code></pre>","tags":["ABAP","Security","AUTHORITY-CHECK","Authorization"]},{"location":"security/2_authority_check/#logging-de-tentativas","title":"\ud83d\udccb Logging de Tentativas","text":"<pre><code>AUTHORITY-CHECK OBJECT 'S_TCODE'\n  ID 'TCD' FIELD 'SE38'.\n\nIF sy-subrc &lt;&gt; 0.\n  \" Logar tentativa falhada\n  CALL FUNCTION 'BAL_LOG_CREATE'\n    EXPORTING\n      i_s_log = VALUE bal_s_log(\n        object    = 'ZSECURITY'\n        subobject = 'AUTH'\n        aluser    = sy-uname\n        aldate    = sy-datum\n        altime    = sy-uzeit )\n    IMPORTING\n      e_log_handle = DATA(lv_log_handle).\n\n  CALL FUNCTION 'BAL_LOG_MSG_ADD'\n    EXPORTING\n      i_log_handle = lv_log_handle\n      i_s_msg = VALUE bal_s_msg(\n        msgty = 'E'\n        msgid = 'ZZ'\n        msgno = '001'\n        msgv1 = |Tentativa negada: SE38 por { sy-uname }| ).\n\n  CALL FUNCTION 'BAL_DB_SAVE'.\n  COMMIT WORK.\n\n  \" Mensagem ao usu\u00e1rio\n  MESSAGE 'Acesso negado. Incidente registrado.' TYPE 'E'.\nENDIF.\n</code></pre>","tags":["ABAP","Security","AUTHORITY-CHECK","Authorization"]},{"location":"security/2_authority_check/#boas-praticas","title":"\u26a1 Boas Pr\u00e1ticas","text":"","tags":["ABAP","Security","AUTHORITY-CHECK","Authorization"]},{"location":"security/2_authority_check/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Sempre verificar sy-subrc\nAUTHORITY-CHECK OBJECT 'S_TCODE'\n  ID 'TCD' FIELD 'SE38'.\n\nIF sy-subrc &lt;&gt; 0.  \" \u2705 Verifica\n  MESSAGE 'Sem autoriza\u00e7\u00e3o' TYPE 'E'.\nENDIF.\n\n\" 2. Mensagens claras\nMESSAGE |Sem autoriza\u00e7\u00e3o para empresa { p_bukrs }| TYPE 'E'.  \" \u2705\n\n\" 3. Verificar ANTES de processar\nAUTHORITY-CHECK ...  \" \u2705 Primeiro\nIF sy-subrc = 0.\n  \" Processar\nENDIF.\n\n\" 4. Usar valores de atividade corretos\nID 'ACTVT' FIELD '01'.  \" \u2705 01 = Criar (correto)\n</code></pre>","tags":["ABAP","Security","AUTHORITY-CHECK","Authorization"]},{"location":"security/2_authority_check/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Ignorar sy-subrc\nAUTHORITY-CHECK OBJECT 'S_TCODE'\n  ID 'TCD' FIELD 'SE38'.\n\" \u274c N\u00e3o verifica sy-subrc!\n\n\" 2. Processar e depois verificar\nSELECT * FROM kna1...  \" \u274c J\u00e1 leu dados!\nAUTHORITY-CHECK ...    \" Tarde demais\n\n\" 3. Hardcoded bypass\nIF sy-uname = 'ADMIN'.\n  \" \u274c Pula verifica\u00e7\u00e3o\nELSE.\n  AUTHORITY-CHECK ...\nENDIF.\n\n\" 4. Mensagens gen\u00e9ricas\nMESSAGE 'Erro' TYPE 'E'.  \" \u274c N\u00e3o ajuda usu\u00e1rio\n</code></pre>","tags":["ABAP","Security","AUTHORITY-CHECK","Authorization"]},{"location":"security/2_authority_check/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>Autoriza\u00e7\u00f5es - Conceitos b\u00e1sicos</li> <li>Roles e Perfis - Gest\u00e3o em PFCG</li> <li>Pr\u00e1ticas Seguras - Seguran\u00e7a no c\u00f3digo</li> </ul> <p>Tags: <code>#AUTHORITY-CHECK</code> <code>#Security</code> <code>#Authorization</code> <code>#Access-Control</code></p>","tags":["ABAP","Security","AUTHORITY-CHECK","Authorization"]},{"location":"security/3_roles_perfis/","title":"Roles e Perfis (PFCG)","text":"","tags":["ABAP","Security","PFCG","Roles","Profiles"]},{"location":"security/3_roles_perfis/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Roles agrupam autoriza\u00e7\u00f5es que s\u00e3o atribu\u00eddas a usu\u00e1rios. PFCG \u00e9 a transa\u00e7\u00e3o para criar e manter roles.</p>","tags":["ABAP","Security","PFCG","Roles","Profiles"]},{"location":"security/3_roles_perfis/#conceitos","title":"\ud83c\udfaf Conceitos","text":"","tags":["ABAP","Security","PFCG","Roles","Profiles"]},{"location":"security/3_roles_perfis/#role-funcao","title":"Role (Fun\u00e7\u00e3o)","text":"<p>Conjunto de autoriza\u00e7\u00f5es para uma fun\u00e7\u00e3o de neg\u00f3cio.</p> <p>Exemplo: <code>Z_VENDEDOR</code> - Permite criar/visualizar ordens de venda</p>","tags":["ABAP","Security","PFCG","Roles","Profiles"]},{"location":"security/3_roles_perfis/#perfil-de-autorizacao","title":"Perfil de Autoriza\u00e7\u00e3o","text":"<p>Gerado automaticamente pelo role, cont\u00e9m autoriza\u00e7\u00f5es t\u00e9cnicas.</p>","tags":["ABAP","Security","PFCG","Roles","Profiles"]},{"location":"security/3_roles_perfis/#single-role-vs-composite-role","title":"Single Role vs Composite Role","text":"<ul> <li>Single: Autoriza\u00e7\u00f5es diretas</li> <li>Composite: Agrupa v\u00e1rios single roles</li> </ul>","tags":["ABAP","Security","PFCG","Roles","Profiles"]},{"location":"security/3_roles_perfis/#criar-role-pfcg","title":"\ud83d\udee0\ufe0f Criar Role (PFCG)","text":"","tags":["ABAP","Security","PFCG","Roles","Profiles"]},{"location":"security/3_roles_perfis/#passo-1-criar-role","title":"Passo 1: Criar Role","text":"<pre><code>1. Executar: PFCG\n2. Role: Z_VENDEDOR\n3. Descri\u00e7\u00e3o: \"Vendedor - Criar e visualizar ordens\"\n4. Salvar\n</code></pre>","tags":["ABAP","Security","PFCG","Roles","Profiles"]},{"location":"security/3_roles_perfis/#passo-2-adicionar-transacoes","title":"Passo 2: Adicionar Transa\u00e7\u00f5es","text":"<pre><code>Aba \"Menu\"\n  \u2192 Insert Transaction\n    - VA01 (Criar ordem)\n    - VA03 (Visualizar ordem)\n  \u2192 Salvar\n</code></pre>","tags":["ABAP","Security","PFCG","Roles","Profiles"]},{"location":"security/3_roles_perfis/#passo-3-gerar-autorizacoes","title":"Passo 3: Gerar Autoriza\u00e7\u00f5es","text":"<pre><code>Aba \"Authorizations\"\n  \u2192 Change Authorization Data\n  \u2192 Generate (bot\u00e3o)\n\nSistema adiciona automaticamente:\n  - S_TCODE (para VA01, VA03)\n  - V_VBAK_VKO (ordens de venda)\n</code></pre>","tags":["ABAP","Security","PFCG","Roles","Profiles"]},{"location":"security/3_roles_perfis/#passo-4-editar-valores","title":"Passo 4: Editar Valores","text":"<pre><code>Expandir V_VBAK_VKO:\n  ACTVT: 01, 03 (Criar, Visualizar)\n  VKORG: 1000 (Org. vendas espec\u00edfica)\n  VTWEG: * (Todos canais)\n  SPART: * (Todos setores)\n\nSalvar e Gerar\n</code></pre>","tags":["ABAP","Security","PFCG","Roles","Profiles"]},{"location":"security/3_roles_perfis/#passo-5-atribuir-a-usuarios","title":"Passo 5: Atribuir a Usu\u00e1rios","text":"<pre><code>Aba \"User\"\n  \u2192 User Comparison\n  \u2192 Adicionar: BMOREIRA, USER01, USER02\n  \u2192 Complete Comparison\n</code></pre>","tags":["ABAP","Security","PFCG","Roles","Profiles"]},{"location":"security/3_roles_perfis/#exemplo-completo","title":"\ud83d\udca1 Exemplo Completo","text":"","tags":["ABAP","Security","PFCG","Roles","Profiles"]},{"location":"security/3_roles_perfis/#role-para-vendas","title":"Role para Vendas","text":"<pre><code>Role: Z_SALES_CLERK\nDescri\u00e7\u00e3o: Auxiliar de Vendas\n\nMenu:\n  \u251c\u2500\u2500 VA01 - Criar ordem\n  \u251c\u2500\u2500 VA02 - Alterar ordem\n  \u251c\u2500\u2500 VA03 - Visualizar ordem\n  \u2514\u2500\u2500 VL01N - Criar remessa\n\nAutoriza\u00e7\u00f5es:\n  \u251c\u2500\u2500 S_TCODE\n  \u2502     TCD: VA01, VA02, VA03, VL01N\n  \u2502\n  \u251c\u2500\u2500 V_VBAK_VKO (Ordens)\n  \u2502     ACTVT: 01, 02, 03\n  \u2502     VKORG: 1000\n  \u2502     VTWEG: 10, 20\n  \u2502     SPART: *\n  \u2502\n  \u2514\u2500\u2500 V_LIKP_VKO (Remessas)\n        ACTVT: 01, 03\n        VKORG: 1000\n        VSTEL: *\n</code></pre>","tags":["ABAP","Security","PFCG","Roles","Profiles"]},{"location":"security/3_roles_perfis/#composite-role","title":"\ud83c\udfd7\ufe0f Composite Role","text":"<p>Agregar v\u00e1rios single roles:</p> <pre><code>Composite: Z_SALES_MANAGER\nDescri\u00e7\u00e3o: Gestor de Vendas\n\nCont\u00e9m:\n  \u251c\u2500\u2500 Z_SALES_CLERK (Single)\n  \u251c\u2500\u2500 Z_SALES_REPORTS (Single)\n  \u2514\u2500\u2500 Z_SALES_APPROVAL (Single)\n</code></pre> <p>Criar: <pre><code>PFCG \u2192 Role Type: Composite Role\n  \u2192 Add Roles:\n     - Z_SALES_CLERK\n     - Z_SALES_REPORTS\n     - Z_SALES_APPROVAL\n  \u2192 Salvar\n</code></pre></p>","tags":["ABAP","Security","PFCG","Roles","Profiles"]},{"location":"security/3_roles_perfis/#objetos-custom-em-roles","title":"\ud83d\udd10 Objetos Custom em Roles","text":"","tags":["ABAP","Security","PFCG","Roles","Profiles"]},{"location":"security/3_roles_perfis/#1-criar-objeto-su21","title":"1. Criar Objeto (SU21)","text":"<pre><code>Z_VENDAS\n  ACTVT: 01, 02, 03\n  VKORG\n  SPART\n</code></pre>","tags":["ABAP","Security","PFCG","Roles","Profiles"]},{"location":"security/3_roles_perfis/#2-adicionar-manual-em-pfcg","title":"2. Adicionar Manual em PFCG","text":"<pre><code>PFCG \u2192 Role Z_VENDEDOR\n  \u2192 Aba \"Authorizations\"\n  \u2192 Manually (bot\u00e3o)\n  \u2192 Object Class: BC_A\n  \u2192 Objeto: Z_VENDAS\n  \u2192 Editar valores:\n       ACTVT: 01, 03\n       VKORG: 1000\n       SPART: 01\n  \u2192 Salvar e Gerar\n</code></pre>","tags":["ABAP","Security","PFCG","Roles","Profiles"]},{"location":"security/3_roles_perfis/#transportar-roles","title":"\ud83c\udf93 Transportar Roles","text":"<pre><code>PFCG \u2192 Role Z_VENDEDOR\n  \u2192 Utilities \u2192 Transport\n  \u2192 Ordem de transporte: DEVK9##### \n  \u2192 Salvar\n</code></pre> <p>\u26a0\ufe0f Aten\u00e7\u00e3o: Usu\u00e1rios N\u00c3O s\u00e3o transportados! Devem ser atribu\u00eddos manualmente em cada sistema.</p>","tags":["ABAP","Security","PFCG","Roles","Profiles"]},{"location":"security/3_roles_perfis/#boas-praticas","title":"\u26a1 Boas Pr\u00e1ticas","text":"","tags":["ABAP","Security","PFCG","Roles","Profiles"]},{"location":"security/3_roles_perfis/#fazer","title":"\u2705 Fazer","text":"<pre><code>1. Naming convention clara\n   - Z_&lt;AREA&gt;_&lt;FUNCTION&gt;\n   - Z_SALES_CLERK, Z_FI_ACCOUNTANT\n\n2. Documentar descri\u00e7\u00e3o\n   - \"Vendedor - Criar e visualizar ordens org 1000\"\n\n3. Princ\u00edpio do menor privil\u00e9gio\n   - Apenas autoriza\u00e7\u00f5es necess\u00e1rias\n\n4. Single roles espec\u00edficos\n   - Um role = uma fun\u00e7\u00e3o\n\n5. Composite para roles complexos\n   - Gestor = Clerk + Reports + Approval\n</code></pre>","tags":["ABAP","Security","PFCG","Roles","Profiles"]},{"location":"security/3_roles_perfis/#evitar","title":"\u274c Evitar","text":"<pre><code>1. SAP_ALL para usu\u00e1rios normais  \u274c\n2. Wildcards demais (* em tudo)  \u274c\n3. Roles sem documenta\u00e7\u00e3o  \u274c\n4. Copiar SAP standard (S_*) e modificar  \u274c\n5. N\u00e3o revisar roles periodicamente  \u274c\n</code></pre>","tags":["ABAP","Security","PFCG","Roles","Profiles"]},{"location":"security/3_roles_perfis/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>Autoriza\u00e7\u00f5es - Conceitos b\u00e1sicos</li> <li>AUTHORITY-CHECK - Verifica\u00e7\u00f5es no c\u00f3digo</li> <li>S_DEVELOP - Proteger desenvolvimento</li> </ul> <p>Tags: <code>#PFCG</code> <code>#Roles</code> <code>#Profiles</code> <code>#Authorization-Management</code></p>","tags":["ABAP","Security","PFCG","Roles","Profiles"]},{"location":"security/4_s_develop/","title":"Objeto S_DEVELOP","text":"","tags":["ABAP","Security","S_DEVELOP","Development Authorization"]},{"location":"security/4_s_develop/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>S_DEVELOP controla acesso a objetos de desenvolvimento (programas, classes, tabelas, etc.) em SAP.</p>","tags":["ABAP","Security","S_DEVELOP","Development Authorization"]},{"location":"security/4_s_develop/#campos-do-s_develop","title":"\ud83d\udd11 Campos do S_DEVELOP","text":"<pre><code>S_DEVELOP - Development/Correction\n  Campos:\n    - DEVCLASS (Pacote)\n    - OBJTYPE (Tipo de objeto)\n    - OBJNAME (Nome do objeto)\n    - P_GROUP (Grupo de permiss\u00f5es)\n    - ACTVT (Atividade)\n</code></pre>","tags":["ABAP","Security","S_DEVELOP","Development Authorization"]},{"location":"security/4_s_develop/#tipos-de-objeto-objtype","title":"\ud83d\udcca Tipos de Objeto (OBJTYPE)","text":"OBJTYPE Descri\u00e7\u00e3o PROG Programas ABAP CLAS Classes ABAP FUGR Grupos de fun\u00e7\u00f5es TABL Tabelas/Estruturas DTEL Elementos de dados DOMA Dom\u00ednios TRAN Transa\u00e7\u00f5es DEVC Pacotes DEBUG Debugging","tags":["ABAP","Security","S_DEVELOP","Development Authorization"]},{"location":"security/4_s_develop/#atividades-actvt","title":"\ud83c\udfaf Atividades (ACTVT)","text":"ACTVT Descri\u00e7\u00e3o 01 Criar 02 Alterar 03 Visualizar 06 Deletar 70 Ler (SELECT)","tags":["ABAP","Security","S_DEVELOP","Development Authorization"]},{"location":"security/4_s_develop/#exemplos-praticos","title":"\ud83d\udca1 Exemplos Pr\u00e1ticos","text":"","tags":["ABAP","Security","S_DEVELOP","Development Authorization"]},{"location":"security/4_s_develop/#criar-programa-z","title":"Criar Programa Z*","text":"<pre><code>\" No SE38/SE80\nAUTHORITY-CHECK OBJECT 'S_DEVELOP'\n  ID 'DEVCLASS' FIELD '$TMP'\n  ID 'OBJTYPE'  FIELD 'PROG'\n  ID 'OBJNAME'  FIELD 'Z*'\n  ID 'P_GROUP'  FIELD '*'\n  ID 'ACTVT'    FIELD '01'.  \" Criar\n\nIF sy-subrc &lt;&gt; 0.\n  MESSAGE 'Sem autoriza\u00e7\u00e3o para criar programas' TYPE 'E'.\nENDIF.\n</code></pre>","tags":["ABAP","Security","S_DEVELOP","Development Authorization"]},{"location":"security/4_s_develop/#alterar-tabela-custom","title":"Alterar Tabela Custom","text":"<pre><code>AUTHORITY-CHECK OBJECT 'S_DEVELOP'\n  ID 'DEVCLASS' FIELD 'ZPACKAGE'\n  ID 'OBJTYPE'  FIELD 'TABL'\n  ID 'OBJNAME'  FIELD 'Z*'\n  ID 'P_GROUP'  FIELD '*'\n  ID 'ACTVT'    FIELD '02'.  \" Alterar\n\nIF sy-subrc &lt;&gt; 0.\n  MESSAGE 'Sem autoriza\u00e7\u00e3o para alterar tabelas' TYPE 'E'.\nENDIF.\n</code></pre>","tags":["ABAP","Security","S_DEVELOP","Development Authorization"]},{"location":"security/4_s_develop/#debug-em-producao","title":"Debug em Produ\u00e7\u00e3o","text":"<pre><code>AUTHORITY-CHECK OBJECT 'S_DEVELOP'\n  ID 'DEVCLASS' FIELD '*'\n  ID 'OBJTYPE'  FIELD 'DEBUG'\n  ID 'OBJNAME'  FIELD '*'\n  ID 'P_GROUP'  FIELD '*'\n  ID 'ACTVT'    FIELD '03'.  \" Executar debug\n\nIF sy-subrc &lt;&gt; 0.\n  MESSAGE 'Debug n\u00e3o permitido em produ\u00e7\u00e3o' TYPE 'E'.\n  LEAVE PROGRAM.\nENDIF.\n</code></pre>","tags":["ABAP","Security","S_DEVELOP","Development Authorization"]},{"location":"security/4_s_develop/#proteger-objetos-custom","title":"\ud83d\udee1\ufe0f Proteger Objetos Custom","text":"","tags":["ABAP","Security","S_DEVELOP","Development Authorization"]},{"location":"security/4_s_develop/#role-para-desenvolvedor-junior","title":"Role para Desenvolvedor Junior","text":"<pre><code>Role: Z_DEV_JUNIOR\n\nS_DEVELOP:\n  DEVCLASS: Z*, $TMP\n  OBJTYPE:  PROG, CLAS, FUGR\n  OBJNAME:  Z*\n  P_GROUP:  *\n  ACTVT:    01, 02, 03 (Criar, Alterar, Visualizar)\n</code></pre>","tags":["ABAP","Security","S_DEVELOP","Development Authorization"]},{"location":"security/4_s_develop/#role-para-desenvolvedor-senior","title":"Role para Desenvolvedor Senior","text":"<pre><code>Role: Z_DEV_SENIOR\n\nS_DEVELOP:\n  DEVCLASS: Z*, $TMP, SAP*\n  OBJTYPE:  * (Todos)\n  OBJNAME:  Z*, Y*\n  P_GROUP:  *\n  ACTVT:    01, 02, 03, 06 (+ Deletar)\n</code></pre>","tags":["ABAP","Security","S_DEVELOP","Development Authorization"]},{"location":"security/4_s_develop/#debug-em-producao_1","title":"\ud83d\udea8 Debug em Produ\u00e7\u00e3o","text":"<p>Restringir severamente!</p> <pre><code>Role: Z_PROD_SUPPORT\n\nS_DEVELOP:\n  OBJTYPE:  DEBUG\n  ACTVT:    03\n\n+ Condi\u00e7\u00f5es:\n  - Apenas emergency user\n  - Logging de sess\u00f5es debug\n  - Aprova\u00e7\u00e3o obrigat\u00f3ria\n</code></pre>","tags":["ABAP","Security","S_DEVELOP","Development Authorization"]},{"location":"security/4_s_develop/#boas-praticas","title":"\u26a1 Boas Pr\u00e1ticas","text":"","tags":["ABAP","Security","S_DEVELOP","Development Authorization"]},{"location":"security/4_s_develop/#fazer","title":"\u2705 Fazer","text":"<pre><code>1. Separar por ambiente\n   DEV: S_DEVELOP com ACTVT 01, 02, 03, 06\n   QAS: S_DEVELOP apenas 03 (visualizar)\n   PRD: SEM S_DEVELOP (exceto suporte)\n\n2. Limitar por namespace\n   OBJNAME: Z*, Y* (apenas custom)\n\n3. Debug controlado\n   Apenas emergency user em produ\u00e7\u00e3o\n\n4. Logging\n   Registrar cria\u00e7\u00e3o/altera\u00e7\u00e3o de objetos\n</code></pre>","tags":["ABAP","Security","S_DEVELOP","Development Authorization"]},{"location":"security/4_s_develop/#evitar","title":"\u274c Evitar","text":"<pre><code>1. S_DEVELOP com * em produ\u00e7\u00e3o  \u274c\n2. Debug liberado para todos  \u274c\n3. Deletar objetos SAP standard  \u274c\n4. N\u00e3o auditar mudan\u00e7as  \u274c\n</code></pre>","tags":["ABAP","Security","S_DEVELOP","Development Authorization"]},{"location":"security/4_s_develop/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>Autoriza\u00e7\u00f5es - Conceitos</li> <li>Pr\u00e1ticas Seguras - Seguran\u00e7a no c\u00f3digo</li> </ul> <p>Tags: <code>#S_DEVELOP</code> <code>#Development-Security</code> <code>#Debug-Authorization</code></p>","tags":["ABAP","Security","S_DEVELOP","Development Authorization"]},{"location":"security/5_praticas_seguras/","title":"Pr\u00e1ticas Seguras de C\u00f3digo","text":"","tags":["ABAP","Security","Best Practices","Secure Coding"]},{"location":"security/5_praticas_seguras/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Pr\u00e1ticas seguras protegem contra vulnerabilidades, vazamento de dados e acessos n\u00e3o autorizados.</p>","tags":["ABAP","Security","Best Practices","Secure Coding"]},{"location":"security/5_praticas_seguras/#principio-do-menor-privilegio","title":"\ud83d\udd10 Princ\u00edpio do Menor Privil\u00e9gio","text":"<p>Dar apenas autoriza\u00e7\u00f5es necess\u00e1rias.</p>","tags":["ABAP","Security","Best Practices","Secure Coding"]},{"location":"security/5_praticas_seguras/#correto","title":"\u2705 Correto","text":"<pre><code>AUTHORITY-CHECK OBJECT 'V_VBAK_VKO'\n  ID 'VKORG' FIELD '1000'  \" \u2705 Espec\u00edfico\n  ID 'ACTVT' FIELD '03'.   \" \u2705 Apenas visualizar\n</code></pre>","tags":["ABAP","Security","Best Practices","Secure Coding"]},{"location":"security/5_praticas_seguras/#incorreto","title":"\u274c Incorreto","text":"<pre><code>\" \u274c Wildcards demais\nID 'VKORG' FIELD '*'\nID 'ACTVT' FIELD '*'\n</code></pre>","tags":["ABAP","Security","Best Practices","Secure Coding"]},{"location":"security/5_praticas_seguras/#validar-sempre-inputs","title":"\ud83d\udee1\ufe0f Validar Sempre Inputs","text":"","tags":["ABAP","Security","Best Practices","Secure Coding"]},{"location":"security/5_praticas_seguras/#validacao-completa","title":"\u2705 Valida\u00e7\u00e3o Completa","text":"<pre><code>PARAMETERS: p_kunnr TYPE kunnr.\n\nSTART-OF-SELECTION.\n  \" Validar formato\n  IF p_kunnr IS INITIAL OR strlen( p_kunnr ) &lt;&gt; 10.\n    MESSAGE 'Customer ID inv\u00e1lido' TYPE 'E'.\n    RETURN.\n  ENDIF.\n\n  \" Validar exist\u00eancia\n  SELECT SINGLE @abap_true FROM kna1\n    WHERE kunnr = @p_kunnr\n    INTO @DATA(lv_exists).\n\n  IF sy-subrc &lt;&gt; 0.\n    MESSAGE |Cliente { p_kunnr } n\u00e3o existe| TYPE 'E'.\n    RETURN.\n  ENDIF.\n\n  \" Validar autoriza\u00e7\u00e3o\n  AUTHORITY-CHECK OBJECT 'F_KNA1_GEN'\n    ID 'KUNNR' FIELD p_kunnr\n    ID 'ACTVT' FIELD '03'.\n\n  IF sy-subrc &lt;&gt; 0.\n    MESSAGE 'Sem autoriza\u00e7\u00e3o' TYPE 'E'.\n    RETURN.\n  ENDIF.\n\n  \" Processar\nENDMETHOD.\n</code></pre>","tags":["ABAP","Security","Best Practices","Secure Coding"]},{"location":"security/5_praticas_seguras/#nunca-hardcodear-credenciais","title":"\ud83d\udeab Nunca Hardcodear Credenciais","text":"","tags":["ABAP","Security","Best Practices","Secure Coding"]},{"location":"security/5_praticas_seguras/#ruim","title":"\u274c Ruim","text":"<pre><code>\" \u274c NUNCA fazer isso!\nDATA: lv_user TYPE string VALUE 'ADMIN',\n      lv_pass TYPE string VALUE 'Password123'.\n\nCALL FUNCTION 'RFC_CONNECTION'\n  EXPORTING\n    username = lv_user\n    password = lv_pass.\n</code></pre>","tags":["ABAP","Security","Best Practices","Secure Coding"]},{"location":"security/5_praticas_seguras/#bom","title":"\u2705 Bom","text":"<pre><code>\" \u2705 Usar Secure Store\nCALL METHOD cl_sec_sxml_writer=&gt;get_instance\n  RECEIVING\n    r_instance = DATA(lo_sec_store).\n\nlo_sec_store-&gt;get_credentials(\n  IMPORTING\n    ev_username = DATA(lv_user)\n    ev_password = DATA(lv_pass) ).\n</code></pre>","tags":["ABAP","Security","Best Practices","Secure Coding"]},{"location":"security/5_praticas_seguras/#proteger-dados-sensiveis","title":"\ud83d\udd12 Proteger Dados Sens\u00edveis","text":"","tags":["ABAP","Security","Best Practices","Secure Coding"]},{"location":"security/5_praticas_seguras/#logs-e-mensagens","title":"Logs e Mensagens","text":"<pre><code>\" \u274c Expor senha em log\nWRITE: / |Login: { lv_user } / { lv_password }|.\n\n\" \u2705 Ocultar dados sens\u00edveis\nWRITE: / |Login: { lv_user } / ********|.\n</code></pre>","tags":["ABAP","Security","Best Practices","Secure Coding"]},{"location":"security/5_praticas_seguras/#nao-logar-dados-pessoais-gdpr","title":"N\u00e3o Logar Dados Pessoais (GDPR)","text":"<pre><code>\" \u274c Logar CPF/Email completo\nMESSAGE |Processando CPF { lv_cpf }| TYPE 'I'.\n\n\" \u2705 Mascarar\nDATA(lv_masked) = |{ lv_cpf(3) }.***.***-**|.\nMESSAGE |Processando CPF { lv_masked }| TYPE 'I'.\n</code></pre>","tags":["ABAP","Security","Best Practices","Secure Coding"]},{"location":"security/5_praticas_seguras/#sessoes-e-timeouts","title":"\ud83d\udd10 Sess\u00f5es e Timeouts","text":"<pre><code>\" Verificar timeout de sess\u00e3o\nIF sy-datum &gt; lv_session_date + 1 OR\n   sy-uzeit &gt; lv_session_time + 3600.  \" 1 hora\n\n  MESSAGE 'Sess\u00e3o expirada. Fa\u00e7a login novamente.' TYPE 'E'.\n  LEAVE PROGRAM.\nENDIF.\n</code></pre>","tags":["ABAP","Security","Best Practices","Secure Coding"]},{"location":"security/5_praticas_seguras/#protecao-contra-ataques","title":"\ud83d\udee1\ufe0f Prote\u00e7\u00e3o contra Ataques","text":"","tags":["ABAP","Security","Best Practices","Secure Coding"]},{"location":"security/5_praticas_seguras/#sql-injection-ver-pagina-dedicada","title":"SQL Injection (ver p\u00e1gina dedicada)","text":"<pre><code>\" \u2705 Usar @-escaping\nSELECT * FROM kna1\n  WHERE kunnr = @lv_customer  \" \u2705 Seguro\n  INTO TABLE @DATA(lt_customers).\n</code></pre>","tags":["ABAP","Security","Best Practices","Secure Coding"]},{"location":"security/5_praticas_seguras/#command-injection","title":"Command Injection","text":"<pre><code>\" \u274c Perigoso\nDATA(lv_command) = |rm -rf { lv_path }|.\nCALL 'SYSTEM' ID 'COMMAND' FIELD lv_command.\n\n\" \u2705 Validar input\nIF lv_path CA '/\\*?&lt;&gt;|'.\n  MESSAGE 'Caracteres inv\u00e1lidos no path' TYPE 'E'.\n  RETURN.\nENDIF.\n</code></pre>","tags":["ABAP","Security","Best Practices","Secure Coding"]},{"location":"security/5_praticas_seguras/#auditoria-e-logging","title":"\ud83d\udccb Auditoria e Logging","text":"","tags":["ABAP","Security","Best Practices","Secure Coding"]},{"location":"security/5_praticas_seguras/#logar-operacoes-criticas","title":"Logar Opera\u00e7\u00f5es Cr\u00edticas","text":"<pre><code>METHOD delete_customer.\n  \" Verificar autoriza\u00e7\u00e3o\n  AUTHORITY-CHECK OBJECT 'F_KNA1_DEL'\n    ID 'KUNNR' FIELD iv_customer\n    ID 'ACTVT' FIELD '06'.\n\n  IF sy-subrc &lt;&gt; 0.\n    \" Logar tentativa falhada\n    CALL FUNCTION 'BAL_LOG_MSG_ADD'\n      EXPORTING\n        i_s_msg = VALUE #(\n          msgty = 'E'\n          msgv1 = |User { sy-uname } tentou deletar { iv_customer }| ).\n\n    MESSAGE 'Sem autoriza\u00e7\u00e3o' TYPE 'E'.\n    RETURN.\n  ENDIF.\n\n  \" Logar sucesso\n  DELETE FROM kna1 WHERE kunnr = iv_customer.\n\n  CALL FUNCTION 'BAL_LOG_MSG_ADD'\n    EXPORTING\n      i_s_msg = VALUE #(\n        msgty = 'I'\n        msgv1 = |Cliente { iv_customer } deletado por { sy-uname }| ).\nENDMETHOD.\n</code></pre>","tags":["ABAP","Security","Best Practices","Secure Coding"]},{"location":"security/5_praticas_seguras/#criptografia","title":"\ud83d\udd10 Criptografia","text":"","tags":["ABAP","Security","Best Practices","Secure Coding"]},{"location":"security/5_praticas_seguras/#dados-sensiveis","title":"Dados Sens\u00edveis","text":"<pre><code>\" Criptografar senha antes de gravar\nDATA(lo_encryptor) = cl_sec_sxml_writer=&gt;create( ).\n\nlo_encryptor-&gt;encrypt(\n  EXPORTING\n    plaintext  = lv_password\n  IMPORTING\n    ciphertext = lv_encrypted_password ).\n\nINSERT INTO ztab_credentials VALUES\n  ( user = lv_user password = lv_encrypted_password ).\n</code></pre>","tags":["ABAP","Security","Best Practices","Secure Coding"]},{"location":"security/5_praticas_seguras/#boas-praticas","title":"\u26a1 Boas Pr\u00e1ticas","text":"","tags":["ABAP","Security","Best Practices","Secure Coding"]},{"location":"security/5_praticas_seguras/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Sempre validar inputs\nIF p_input IS INITIAL OR p_input CA '*?/\\'.\n  MESSAGE 'Input inv\u00e1lido' TYPE 'E'.\nENDIF.\n\n\" 2. Verificar autoriza\u00e7\u00f5es ANTES de processar\nAUTHORITY-CHECK ...\nIF sy-subrc = 0.\n  \" Processar\nENDIF.\n\n\" 3. Usar parametrized queries\nSELECT * FROM kna1\n  WHERE kunnr = @lv_customer  \" \u2705\n\n\" 4. Logar opera\u00e7\u00f5es cr\u00edticas\nCALL FUNCTION 'BAL_LOG_MSG_ADD' ...\n\n\" 5. Timeout de sess\u00f5es\nIF session_expired( ).\n  LEAVE PROGRAM.\nENDIF.\n\n\" 6. Mascarar dados sens\u00edveis em logs\nlv_masked = mask_cpf( lv_cpf ).\n</code></pre>","tags":["ABAP","Security","Best Practices","Secure Coding"]},{"location":"security/5_praticas_seguras/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Hardcodear credenciais\nDATA: lv_pass VALUE 'admin123'.  \" \u274c\n\n\" 2. SQL din\u00e2mico sem valida\u00e7\u00e3o\nDATA(lv_sql) = |SELECT * FROM { lv_table }|.  \" \u274c\n\n\" 3. Expor dados sens\u00edveis\nWRITE: / lv_credit_card.  \" \u274c\n\n\" 4. N\u00e3o validar input\nSELECT * WHERE name = p_name.  \" \u274c E se p_name = \"'; DROP TABLE--\"?\n\n\" 5. Confiar apenas em UI\n\" \u274c SEMPRE validar no backend tamb\u00e9m\n\n\" 6. N\u00e3o logar opera\u00e7\u00f5es cr\u00edticas\nDELETE FROM important_table.  \" \u274c Sem log!\n</code></pre>","tags":["ABAP","Security","Best Practices","Secure Coding"]},{"location":"security/5_praticas_seguras/#checklist-de-seguranca","title":"\ud83c\udf93 Checklist de Seguran\u00e7a","text":"<pre><code>[ ] Autoriza\u00e7\u00f5es verificadas antes de opera\u00e7\u00f5es\n[ ] Inputs validados (formato, range, exist\u00eancia)\n[ ] Dados sens\u00edveis N\u00c3O em logs\n[ ] Credenciais em Secure Store, n\u00e3o hardcoded\n[ ] SQL parametrizado (@-escaping)\n[ ] Opera\u00e7\u00f5es cr\u00edticas logadas\n[ ] Timeouts de sess\u00e3o implementados\n[ ] Dados criptografados quando necess\u00e1rio\n[ ] Erro handling sem expor detalhes internos\n[ ] Code review de seguran\u00e7a realizado\n</code></pre>","tags":["ABAP","Security","Best Practices","Secure Coding"]},{"location":"security/5_praticas_seguras/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>SQL Injection - Prevenir ataques</li> <li>AUTHORITY-CHECK - Verifica\u00e7\u00f5es</li> <li>Roles e Perfis - Gest\u00e3o de acessos</li> </ul> <p>Tags: <code>#Secure-Coding</code> <code>#Best-Practices</code> <code>#GDPR</code> <code>#Encryption</code></p>","tags":["ABAP","Security","Best Practices","Secure Coding"]},{"location":"security/6_sql_injection/","title":"SQL Injection","text":"","tags":["ABAP","Security","SQL Injection","Dynamic SQL"]},{"location":"security/6_sql_injection/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>SQL Injection \u00e9 uma t\u00e9cnica de ataque onde c\u00f3digo SQL malicioso \u00e9 inserido em queries, permitindo acesso n\u00e3o autorizado a dados.</p>","tags":["ABAP","Security","SQL Injection","Dynamic SQL"]},{"location":"security/6_sql_injection/#o-problema","title":"\u26a0\ufe0f O Problema","text":"","tags":["ABAP","Security","SQL Injection","Dynamic SQL"]},{"location":"security/6_sql_injection/#codigo-vulneravel","title":"C\u00f3digo Vulner\u00e1vel","text":"<pre><code>PARAMETERS: p_name TYPE string.\n\n\" \u274c VULNER\u00c1VEL!\nDATA(lv_sql) = |SELECT * FROM kna1 WHERE name1 = '{ p_name }'|.\n\nEXEC SQL.\n  :lv_sql\nENDEXEC.\n</code></pre> <p>Ataque: <pre><code>User digita: admin' OR '1'='1\nQuery gerada: SELECT * FROM kna1 WHERE name1 = 'admin' OR '1'='1'\nResultado: Retorna TODOS os clientes! (1=1 sempre verdade)\n</code></pre></p>","tags":["ABAP","Security","SQL Injection","Dynamic SQL"]},{"location":"security/6_sql_injection/#solucoes","title":"\ud83d\udd12 Solu\u00e7\u00f5es","text":"","tags":["ABAP","Security","SQL Injection","Dynamic SQL"]},{"location":"security/6_sql_injection/#1-usar-escaping-recomendado","title":"1\ufe0f\u20e3 Usar @-Escaping (Recomendado)","text":"<pre><code>PARAMETERS: p_name TYPE string.\n\n\" \u2705 SEGURO\nSELECT * FROM kna1\n  WHERE name1 = @p_name  \" @ protege contra injection\n  INTO TABLE @DATA(lt_customers).\n</code></pre> <p>Por qu\u00ea funciona? - <code>@p_name</code> \u00e9 tratado como valor, n\u00e3o c\u00f3digo SQL - Caracteres especiais (<code>'</code>, <code>--</code>, <code>;</code>) s\u00e3o escapados automaticamente</p>","tags":["ABAP","Security","SQL Injection","Dynamic SQL"]},{"location":"security/6_sql_injection/#2-validar-e-sanitizar-input","title":"2\ufe0f\u20e3 Validar e Sanitizar Input","text":"<pre><code>PARAMETERS: p_name TYPE string.\n\n\" Validar caracteres permitidos\nIF p_name CA `';--*?/\\`.\n  MESSAGE 'Caracteres inv\u00e1lidos no nome' TYPE 'E'.\n  RETURN.\nENDIF.\n\n\" Limitar tamanho\nIF strlen( p_name ) &gt; 35.\n  MESSAGE 'Nome muito longo' TYPE 'E'.\n  RETURN.\nENDIF.\n\n\" Usar com @-escaping\nSELECT * FROM kna1\n  WHERE name1 = @p_name\n  INTO TABLE @DATA(lt_customers).\n</code></pre>","tags":["ABAP","Security","SQL Injection","Dynamic SQL"]},{"location":"security/6_sql_injection/#3-prepared-statements-adbc","title":"3\ufe0f\u20e3 Prepared Statements (ADBC)","text":"<pre><code>DATA: lo_sql    TYPE REF TO cl_sql_statement,\n      lo_result TYPE REF TO cl_sql_result_set.\n\nlo_sql = cl_sql_statement=&gt;create_instance( ).\n\n\" \u2705 Prepared statement\nDATA(lv_sql) = 'SELECT * FROM kna1 WHERE name1 = ?'.\n\nlo_result = lo_sql-&gt;execute_query(\n  statement = lv_sql\n  p_bnd_tab = VALUE #( ( p_name ) ) ).  \" Par\u00e2metro seguro\n\nlo_result-&gt;next_package( IMPORTING et_data = lt_customers ).\n</code></pre>","tags":["ABAP","Security","SQL Injection","Dynamic SQL"]},{"location":"security/6_sql_injection/#exemplos-de-ataques","title":"\ud83d\udca1 Exemplos de Ataques","text":"","tags":["ABAP","Security","SQL Injection","Dynamic SQL"]},{"location":"security/6_sql_injection/#ataque-1-bypass-de-autenticacao","title":"Ataque 1: Bypass de Autentica\u00e7\u00e3o","text":"<pre><code>\" C\u00f3digo vulner\u00e1vel\nSELECT SINGLE * FROM zusr_login\n  WHERE username = p_user\n    AND password = p_pass.\n\n\" Ataque:\np_user = \"admin\"\np_pass = \"' OR '1'='1\"\n\n\" Query gerada:\n\" SELECT * WHERE username = 'admin' AND password = '' OR '1'='1'\n\" Resultado: Login sem senha!\n</code></pre> <p>Prote\u00e7\u00e3o: <pre><code>\" \u2705 SEGURO\nSELECT SINGLE * FROM zusr_login\n  WHERE username = @p_user\n    AND password = @p_pass.\n</code></pre></p>","tags":["ABAP","Security","SQL Injection","Dynamic SQL"]},{"location":"security/6_sql_injection/#ataque-2-data-exfiltration","title":"Ataque 2: Data Exfiltration","text":"<pre><code>\" Vulner\u00e1vel\np_id = \"100001' UNION SELECT username, password, '0' FROM zusr_login--\"\n\n\" Query gerada:\n\" SELECT name, city, country FROM kna1\n\"   WHERE kunnr = '100001'\n\"   UNION SELECT username, password, '0' FROM zusr_login--'\n\n\" Resultado: Exp\u00f5e tabela de senhas!\n</code></pre> <p>Prote\u00e7\u00e3o: <pre><code>\" \u2705 SEGURO\nSELECT name1, ort01, land1 FROM kna1\n  WHERE kunnr = @p_id\n  INTO TABLE @DATA(lt_data).\n</code></pre></p>","tags":["ABAP","Security","SQL Injection","Dynamic SQL"]},{"location":"security/6_sql_injection/#ataque-3-data-destruction","title":"Ataque 3: Data Destruction","text":"<pre><code>\" Vulner\u00e1vel\np_table = \"kna1'; DELETE FROM zusr_login; SELECT * FROM kna1 WHERE '1'='1\"\n\n\" Queries geradas:\n\" 1. SELECT * FROM kna1'\n\" 2. DELETE FROM zusr_login\n\" 3. SELECT * FROM kna1 WHERE '1'='1'\n\n\" Resultado: Tabela deletada!\n</code></pre> <p>Prote\u00e7\u00e3o: <pre><code>\" \u2705 Validar nome da tabela\nDATA(lt_allowed_tables) = VALUE stringtab( ( 'KNA1' ) ( 'MARA' ) ).\n\nIF NOT line_exists( lt_allowed_tables[ table_value = to_upper( p_table ) ] ).\n  MESSAGE 'Tabela n\u00e3o permitida' TYPE 'E'.\n  RETURN.\nENDIF.\n\n\" Usar @-escaping\nSELECT * FROM (p_table)\n  UP TO 100 ROWS\n  INTO TABLE @DATA(lt_data).\n</code></pre></p>","tags":["ABAP","Security","SQL Injection","Dynamic SQL"]},{"location":"security/6_sql_injection/#dynamic-sql-seguro","title":"\ud83d\udee1\ufe0f Dynamic SQL Seguro","text":"","tags":["ABAP","Security","SQL Injection","Dynamic SQL"]},{"location":"security/6_sql_injection/#where-dinamico-errado","title":"WHERE Din\u00e2mico - ERRADO","text":"<pre><code>\" \u274c VULNER\u00c1VEL\nDATA(lv_where) = |name1 = '{ p_name }'|.\n\nSELECT * FROM kna1\n  WHERE (lv_where)\n  INTO TABLE @DATA(lt_data).\n</code></pre>","tags":["ABAP","Security","SQL Injection","Dynamic SQL"]},{"location":"security/6_sql_injection/#where-dinamico-correto","title":"WHERE Din\u00e2mico - CORRETO","text":"<pre><code>\" \u2705 SEGURO\nDATA(lv_where) = |name1 = @p_name|.  \" @ no string din\u00e2mico\n\nSELECT * FROM kna1\n  WHERE (lv_where)\n  INTO TABLE @DATA(lt_data).\n</code></pre>","tags":["ABAP","Security","SQL Injection","Dynamic SQL"]},{"location":"security/6_sql_injection/#validar-campos-dinamicos","title":"Validar Campos Din\u00e2micos","text":"<pre><code>\" \u2705 Whitelist de campos permitidos\nDATA(lt_allowed_fields) = VALUE stringtab(\n  ( 'NAME1' ) ( 'ORT01' ) ( 'LAND1' ) ).\n\nIF NOT line_exists( lt_allowed_fields[ table_value = to_upper( p_field ) ] ).\n  MESSAGE 'Campo n\u00e3o permitido' TYPE 'E'.\n  RETURN.\nENDIF.\n\n\" Usar campo validado\nSELECT * FROM kna1\n  ORDER BY (p_field)\n  INTO TABLE @DATA(lt_data).\n</code></pre>","tags":["ABAP","Security","SQL Injection","Dynamic SQL"]},{"location":"security/6_sql_injection/#exemplo-completo-search-seguro","title":"\ud83c\udf93 Exemplo Completo: Search Seguro","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_SECURE_SEARCH\n*&amp;---------------------------------------------------------------------*\nREPORT z_secure_search.\n\nPARAMETERS: p_search TYPE string.\n\nSTART-OF-SELECTION.\n\n  \" \u2550\u2550\u2550 VALIDA\u00c7\u00c3O DE INPUT \u2550\u2550\u2550\n\n  \" 1. N\u00e3o vazio\n  IF p_search IS INITIAL.\n    MESSAGE 'Digite algo para buscar' TYPE 'I'.\n    RETURN.\n  ENDIF.\n\n  \" 2. Tamanho m\u00e1ximo\n  IF strlen( p_search ) &gt; 35.\n    MESSAGE 'Busca muito longa (m\u00e1x 35 caracteres)' TYPE 'E'.\n    RETURN.\n  ENDIF.\n\n  \" 3. Caracteres perigosos\n  IF p_search CA `';--*/\\`.\n    MESSAGE 'Caracteres n\u00e3o permitidos: ; -- * / \\' TYPE 'E'.\n    RETURN.\n  ENDIF.\n\n  \" \u2550\u2550\u2550 QUERY SEGURA \u2550\u2550\u2550\n\n  SELECT * FROM kna1\n    WHERE name1 LIKE @p_search  \" \u2705 @-escaping\n       OR ort01 LIKE @p_search\n    INTO TABLE @DATA(lt_customers)\n    UP TO 100 ROWS.\n\n  \" \u2550\u2550\u2550 RESULTADO \u2550\u2550\u2550\n\n  IF lt_customers IS INITIAL.\n    MESSAGE 'Nenhum cliente encontrado' TYPE 'I'.\n  ELSE.\n    LOOP AT lt_customers INTO DATA(ls_customer).\n      WRITE: / ls_customer-kunnr, ls_customer-name1, ls_customer-ort01.\n    ENDLOOP.\n\n    WRITE: / |Total: { lines( lt_customers ) } clientes|.\n  ENDIF.\n</code></pre>","tags":["ABAP","Security","SQL Injection","Dynamic SQL"]},{"location":"security/6_sql_injection/#boas-praticas","title":"\u26a1 Boas Pr\u00e1ticas","text":"","tags":["ABAP","Security","SQL Injection","Dynamic SQL"]},{"location":"security/6_sql_injection/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. SEMPRE usar @-escaping\nSELECT * FROM kna1\n  WHERE kunnr = @p_customer.  \" \u2705\n\n\" 2. Validar inputs\nIF p_input CA `';--*`.\n  MESSAGE 'Caracteres inv\u00e1lidos' TYPE 'E'.\nENDIF.\n\n\" 3. Whitelist para valores din\u00e2micos\nIF NOT line_exists( lt_allowed[ table_value = p_table ] ).\n  MESSAGE 'N\u00e3o permitido' TYPE 'E'.\nENDIF.\n\n\" 4. Limitar resultados\nSELECT * ... UP TO 100 ROWS.  \" \u2705\n\n\" 5. Prepared statements para ADBC\nlo_sql-&gt;execute_query(\n  statement = 'SELECT * FROM kna1 WHERE kunnr = ?'\n  p_bnd_tab = VALUE #( ( p_customer ) ) ).\n</code></pre>","tags":["ABAP","Security","SQL Injection","Dynamic SQL"]},{"location":"security/6_sql_injection/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. SQL din\u00e2mico sem @-escaping\nDATA(lv_sql) = |SELECT * WHERE id = '{ p_id }'|.  \" \u274c\n\n\" 2. Concatenar strings em WHERE\nlv_where = |name = '{ p_name }'|.  \" \u274c\n\n\" 3. EXEC SQL com input do usu\u00e1rio\nEXEC SQL.\n  SELECT * WHERE :p_field = :p_value\nENDEXEC.  \" \u274c\n\n\" 4. N\u00e3o validar inputs\nSELECT * WHERE (p_field) = @p_value.  \" \u274c p_field n\u00e3o validado\n\n\" 5. Confiar no frontend\n\" \u274c SEMPRE validar no backend tamb\u00e9m\n</code></pre>","tags":["ABAP","Security","SQL Injection","Dynamic SQL"]},{"location":"security/6_sql_injection/#detectar-vulnerabilidades","title":"\ud83d\udd0d Detectar Vulnerabilidades","text":"","tags":["ABAP","Security","SQL Injection","Dynamic SQL"]},{"location":"security/6_sql_injection/#code-inspector-sci","title":"Code Inspector (SCI)","text":"<pre><code>SE38 \u2192 Code Inspector (Ctrl+Shift+F3)\nCheck Variant: SECURITY\n</code></pre>","tags":["ABAP","Security","SQL Injection","Dynamic SQL"]},{"location":"security/6_sql_injection/#revisao-manual","title":"Revis\u00e3o Manual","text":"<p>Procurar por: - <code>WHERE (lv_variable)</code> sem valida\u00e7\u00e3o - Concatena\u00e7\u00e3o de strings em SQL - <code>EXEC SQL</code> com inputs din\u00e2micos - Falta de <code>@</code> antes de vari\u00e1veis</p>","tags":["ABAP","Security","SQL Injection","Dynamic SQL"]},{"location":"security/6_sql_injection/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>Pr\u00e1ticas Seguras - Mais seguran\u00e7a no c\u00f3digo</li> <li>AUTHORITY-CHECK - Controle de acesso</li> <li>SQL Otimizado - Performance + Seguran\u00e7a</li> </ul> <p>Tags: <code>#SQL-Injection</code> <code>#Security</code> <code>#Dynamic-SQL</code> <code>#Input-Validation</code></p>","tags":["ABAP","Security","SQL Injection","Dynamic SQL"]},{"location":"sql/","title":"\ud83d\udcbe SQL ABAP","text":"<p>Consultas b\u00e1sicas, JOINS, agrega\u00e7\u00f5es e manipula\u00e7\u00e3o de dados na base de dados SAP.</p>"},{"location":"sql/#o-que-vais-aprender","title":"\ud83d\udcd6 O que vais aprender","text":"<ul> <li>Executar SELECTs b\u00e1sicos e avan\u00e7ados</li> <li>Usar JOINS para combinar tabelas</li> <li>Fun\u00e7\u00f5es de agrega\u00e7\u00e3o (COUNT, SUM, AVG, MAX, MIN)</li> <li>GROUP BY e HAVING</li> <li>Otimiza\u00e7\u00f5es e boas pr\u00e1ticas SQL</li> <li>Cl\u00e1usulas WHERE din\u00e2micas</li> <li>INSERT, UPDATE, DELETE e MODIFY</li> </ul>"},{"location":"sql/#ordem-de-aprendizagem","title":"\ud83c\udfaf Ordem de Aprendizagem","text":""},{"location":"sql/#1-select-basico","title":"1\ufe0f\u20e3 SELECT B\u00e1sico","text":"<p>Como buscar dados de tabelas SAP.</p> <p>Exemplo: <pre><code>SELECT * FROM scarr INTO TABLE @DATA(lt_scarr).\nLOOP AT lt_scarr INTO DATA(ls_scarr).\n  WRITE: / ls_scarr-carrid, ls_scarr-carrname.\nENDLOOP.\n</code></pre></p>"},{"location":"sql/#2-joins","title":"2\ufe0f\u20e3 JOINS","text":"<p>Combinar dados de m\u00faltiplas tabelas.</p> <p>Exemplo: <pre><code>SELECT a~carrid, a~connid, b~carrname\n  FROM spfli AS a\n  INNER JOIN scarr AS b ON a~carrid = b~carrid\n  INTO TABLE @DATA(lt_join)\n  UP TO 10 ROWS.\n</code></pre></p>"},{"location":"sql/#3-agregacoes-e-group-by","title":"3\ufe0f\u20e3 Agrega\u00e7\u00f5es e GROUP BY","text":"<p>Fun\u00e7\u00f5es estat\u00edsticas e agrupamento.</p> <p>Exemplo: <pre><code>SELECT carrid, \n       COUNT( * ) AS total_voos, \n       AVG( price AS DEC( 15,2 ) ) AS preco_medio\n  FROM sflight\n  GROUP BY carrid\n  INTO TABLE @DATA(lt_stats).\n</code></pre></p>"},{"location":"sql/#4-insert-update-delete","title":"4\ufe0f\u20e3 INSERT, UPDATE, DELETE","text":"<p>Manipular dados na base de dados.</p> <p>Exemplo: <pre><code>INSERT scarr FROM @( VALUE #(\n  carrid = 'PT' carrname = 'TAP Air Portugal'\n) ).\n\nUPDATE sflight SET price = price * '1.10'\n  WHERE carrid = 'LH'.\n</code></pre></p>"},{"location":"sql/#5-where-dinamico","title":"5\ufe0f\u20e3 WHERE Din\u00e2mico","text":"<p>Consultas SQL flex\u00edveis em tempo de execu\u00e7\u00e3o.</p> <p>Exemplo: <pre><code>DATA(lv_where) = |carrid = '{ p_carrid }' AND price &gt;= { p_preco }|.\n\nSELECT * FROM sflight\n  WHERE (lv_where)\n  INTO TABLE @DATA(lt_voos).\n</code></pre></p>"},{"location":"sql/#6-otimizacoes-sql","title":"6\ufe0f\u20e3 Otimiza\u00e7\u00f5es SQL","text":"<p>T\u00e9cnicas para melhorar performance.</p> <p>Exemplo: <pre><code>\" \u2705 R\u00e1pido: SELECT \u00fanico com FOR ALL ENTRIES\nIF lt_pedidos IS NOT INITIAL.\n  SELECT * FROM vbap\n    FOR ALL ENTRIES IN @lt_pedidos\n    WHERE vbeln = @lt_pedidos-vbeln\n    INTO TABLE @DATA(lt_itens).\nENDIF.\n</code></pre></p>"},{"location":"sql/#boas-praticas","title":"\ud83d\ude80 Boas Pr\u00e1ticas","text":""},{"location":"sql/#fazer","title":"\u2705 Fazer","text":"<ul> <li>Usar <code>@</code> para host variables (ABAP 7.40+)</li> <li>Limitar resultados com <code>UP TO n ROWS</code></li> <li>Usar \u00edndices nas cl\u00e1usulas WHERE</li> <li>Evitar SELECT * (especificar campos necess\u00e1rios)</li> </ul>"},{"location":"sql/#evitar","title":"\u274c Evitar","text":"<ul> <li>SELECTs dentro de LOOPs</li> <li>N\u00e3o usar FOR ALL ENTRIES sem valida\u00e7\u00e3o</li> <li>Evitar fun\u00e7\u00f5es pesadas em WHERE</li> </ul>"},{"location":"sql/#exemplo-completo","title":"\ud83d\udca1 Exemplo Completo","text":"<pre><code>REPORT z_sql_demo.\n\nPARAMETERS: p_carr TYPE s_carr_id DEFAULT 'LH'.\n\nSTART-OF-SELECTION.\n\n  \" SELECT com JOIN e agrega\u00e7\u00e3o\n  SELECT a~carrid,\n         a~carrname,\n         COUNT( * ) AS num_flights,\n         AVG( b~price ) AS avg_price\n    FROM scarr AS a\n    INNER JOIN sflight AS b ON a~carrid = b~carrid\n    WHERE a~carrid = @p_carr\n    GROUP BY a~carrid, a~carrname\n    INTO TABLE @DATA(lt_result).\n\n  \" Exibir resultados\n  LOOP AT lt_result INTO DATA(ls_result).\n    WRITE: / ls_result-carrid, \n           ls_result-carrname, \n           ls_result-num_flights, \n           ls_result-avg_price.\n  ENDLOOP.\n</code></pre>"},{"location":"sql/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ol> <li>Comece por SELECT B\u00e1sico</li> <li>Depois siga para JOINS</li> <li>Continue com Agrega\u00e7\u00f5es</li> <li>Aprenda a manipular dados</li> <li>Explore WHERE Din\u00e2mico</li> <li>Domine Otimiza\u00e7\u00f5es SQL</li> <li>Avance para Performance para otimiza\u00e7\u00f5es avan\u00e7adas</li> </ol>"},{"location":"sql/1_select_basico/","title":"SELECT B\u00e1sico em ABAP","text":"<p>O comando <code>SELECT</code> \u00e9 usado para ler dados das tabelas da base de dados SAP.</p>","tags":["ABAP","SQL","SELECT","Database"]},{"location":"sql/1_select_basico/#sintaxe-basica","title":"\ud83d\udd39 Sintaxe B\u00e1sica","text":"<pre><code>SELECT &lt;campos&gt;\n  FROM &lt;tabela&gt;\n  INTO &lt;destino&gt;\n  [WHERE &lt;condi\u00e7\u00f5es&gt;]\n  [ORDER BY &lt;campos&gt;].\n</code></pre>","tags":["ABAP","SQL","SELECT","Database"]},{"location":"sql/1_select_basico/#select-simples","title":"\ud83d\udd39 SELECT Simples","text":"","tags":["ABAP","SQL","SELECT","Database"]},{"location":"sql/1_select_basico/#todos-os-campos-todas-as-linhas","title":"Todos os campos, todas as linhas","text":"<pre><code>REPORT z_select_basico.\n\nDATA lt_scarr TYPE TABLE OF scarr.\n\nSTART-OF-SELECTION.\n  \" Buscar todas as companhias a\u00e9reas\n  SELECT * FROM scarr INTO TABLE @lt_scarr.\n\n  \" Mostrar resultados\n  LOOP AT lt_scarr INTO DATA(ls_scarr).\n    WRITE: / ls_scarr-carrid, ls_scarr-carrname.\n  ENDLOOP.\n</code></pre>","tags":["ABAP","SQL","SELECT","Database"]},{"location":"sql/1_select_basico/#select-com-campos-especificos","title":"\ud83d\udd39 SELECT com Campos Espec\u00edficos","text":"<p>Boa Pr\u00e1tica</p> <p>Selecione apenas os campos que vai usar. Evite <code>SELECT *</code>.</p> <pre><code>DATA: BEGIN OF ls_flight,\n        carrid TYPE s_carr_id,\n        connid TYPE s_conn_id,\n        price  TYPE s_price,\n      END OF ls_flight.\n\nDATA lt_flights LIKE TABLE OF ls_flight.\n\n\" \u2705 Selecionar apenas campos necess\u00e1rios\nSELECT carrid, connid, price\n  FROM sflight\n  INTO TABLE @lt_flights\n  UP TO 100 ROWS.\n</code></pre>","tags":["ABAP","SQL","SELECT","Database"]},{"location":"sql/1_select_basico/#select-single","title":"\ud83d\udd39 SELECT SINGLE","text":"<p>Para buscar apenas um registo:</p> <pre><code>DATA ls_carrier TYPE scarr.\n\n\" Buscar companhia espec\u00edfica\nSELECT SINGLE * FROM scarr\n  INTO @ls_carrier\n  WHERE carrid = 'LH'.\n\nIF sy-subrc = 0.\n  WRITE: / 'Encontrado:', ls_carrier-carrname.\nELSE.\n  WRITE: / 'N\u00e3o encontrado'.\nENDIF.\n</code></pre> <p>Aten\u00e7\u00e3o</p> <p>Sempre verifique <code>sy-subrc</code> ap\u00f3s SELECT SINGLE. - <code>sy-subrc = 0</code> \u2192 Registo encontrado - <code>sy-subrc \u2260 0</code> \u2192 Registo n\u00e3o encontrado</p>","tags":["ABAP","SQL","SELECT","Database"]},{"location":"sql/1_select_basico/#where-condicoes","title":"\ud83d\udd39 WHERE Condi\u00e7\u00f5es","text":"<pre><code>\" Condi\u00e7\u00e3o simples\nSELECT * FROM sflight\n  INTO TABLE @DATA(lt_flights)\n  WHERE carrid = 'LH'\n    AND fldate &gt;= '20250101'.\n\n\" M\u00faltiplas condi\u00e7\u00f5es\nSELECT * FROM sflight\n  INTO TABLE @lt_flights\n  WHERE carrid = 'LH'\n    AND ( price &gt; 500 OR currency = 'EUR' ).\n\n\" LIKE para padr\u00f5es\nSELECT * FROM scarr\n  INTO TABLE @DATA(lt_carriers)\n  WHERE carrname LIKE '%Airlines%'.\n\n\" IN para lista de valores\nSELECT * FROM sflight\n  INTO TABLE @lt_flights\n  WHERE carrid IN ('LH', 'BA', 'AA').\n</code></pre>","tags":["ABAP","SQL","SELECT","Database"]},{"location":"sql/1_select_basico/#inline-declarations-abap-740","title":"\ud83d\udd39 Inline Declarations (ABAP 7.40+)","text":"<pre><code>\" Declara\u00e7\u00e3o inline da vari\u00e1vel de destino\nSELECT * FROM scarr INTO TABLE @DATA(lt_carriers).\n\n\" Inline em LOOP\nSELECT * FROM sflight\n  INTO TABLE @DATA(lt_flights)\n  WHERE carrid = 'LH'.\n\nLOOP AT lt_flights INTO DATA(ls_flight).\n  WRITE: / ls_flight-connid, ls_flight-price.\nENDLOOP.\n</code></pre>","tags":["ABAP","SQL","SELECT","Database"]},{"location":"sql/1_select_basico/#order-by","title":"\ud83d\udd39 ORDER BY","text":"<pre><code>\" Ordenar por um campo\nSELECT * FROM sflight\n  INTO TABLE @DATA(lt_flights)\n  WHERE carrid = 'LH'\n  ORDER BY price ASCENDING.\n\n\" Ordenar por m\u00faltiplos campos\nSELECT * FROM sflight\n  INTO TABLE @lt_flights\n  WHERE carrid = 'LH'\n  ORDER BY fldate DESCENDING, connid ASCENDING.\n</code></pre>","tags":["ABAP","SQL","SELECT","Database"]},{"location":"sql/1_select_basico/#distinct-valores-unicos","title":"\ud83d\udd39 DISTINCT (Valores \u00danicos)","text":"<pre><code>\" Buscar apenas valores \u00fanicos de carrid\nSELECT DISTINCT carrid\n  FROM sflight\n  INTO TABLE @DATA(lt_carriers).\n</code></pre>","tags":["ABAP","SQL","SELECT","Database"]},{"location":"sql/1_select_basico/#up-to-n-rows","title":"\ud83d\udd39 UP TO n ROWS","text":"<p>Limitar o n\u00famero de registos retornados:</p> <pre><code>\" Buscar apenas 10 registos\nSELECT * FROM sflight\n  INTO TABLE @DATA(lt_flights)\n  UP TO 10 ROWS.\n</code></pre> <p>Performance</p> <p>Use <code>UP TO n ROWS</code> quando n\u00e3o precisa de todos os dados para melhorar a performance.</p>","tags":["ABAP","SQL","SELECT","Database"]},{"location":"sql/1_select_basico/#into-vs-into-table-vs-appending","title":"\ud83d\udd39 INTO vs INTO TABLE vs APPENDING","text":"<pre><code>\" INTO TABLE - substitui o conte\u00fado\nSELECT * FROM scarr INTO TABLE @lt_carriers.\n\n\" APPENDING TABLE - adiciona ao conte\u00fado existente\nSELECT * FROM scarr APPENDING TABLE @lt_carriers WHERE carrid = 'LH'.\n\n\" INTO (linha a linha) - menos eficiente\nSELECT * FROM scarr INTO @DATA(ls_carrier).\n  WRITE: / ls_carrier-carrid.\nENDSELECT.\n</code></pre> <p>Performance</p> <p>Evite <code>SELECT...ENDSELECT</code> (linha a linha). Use <code>INTO TABLE</code> sempre que poss\u00edvel.</p>","tags":["ABAP","SQL","SELECT","Database"]},{"location":"sql/1_select_basico/#exemplo-completo","title":"\ud83d\udd39 Exemplo Completo","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_SELECT_BASICO_DEMO\n*&amp;---------------------------------------------------------------------*\nREPORT z_select_basico_demo.\n\nPARAMETERS: p_carrid TYPE s_carr_id DEFAULT 'LH'.\n\nDATA: BEGIN OF ls_flight,\n        carrid TYPE s_carr_id,\n        connid TYPE s_conn_id,\n        fldate TYPE s_date,\n        price  TYPE s_price,\n        curr   TYPE s_currcode,\n      END OF ls_flight.\n\nDATA lt_flights LIKE TABLE OF ls_flight.\n\nSTART-OF-SELECTION.\n\n  \" Buscar voos da companhia selecionada\n  SELECT carrid, connid, fldate, price, currency\n    FROM sflight\n    INTO TABLE @lt_flights\n    WHERE carrid = @p_carrid\n      AND fldate &gt;= @sy-datum\n    ORDER BY fldate ASCENDING, price ASCENDING\n    UP TO 50 ROWS.\n\n  IF sy-subrc = 0.\n    WRITE: / |Encontrados { lines( lt_flights ) } voos para { p_carrid }|.\n    SKIP.\n\n    LOOP AT lt_flights INTO ls_flight.\n      WRITE: / ls_flight-connid,\n               ls_flight-fldate,\n               ls_flight-price,\n               ls_flight-curr.\n    ENDLOOP.\n  ELSE.\n    WRITE: / 'Nenhum voo encontrado.'.\n  ENDIF.\n</code></pre>","tags":["ABAP","SQL","SELECT","Database"]},{"location":"sql/1_select_basico/#boas-praticas","title":"\ud83d\udca1 Boas Pr\u00e1ticas","text":"\u2705 Fazer \u274c Evitar <code>SELECT campo1, campo2</code> <code>SELECT *</code> <code>INTO TABLE @lt_data</code> <code>SELECT...ENDSELECT</code> <code>WHERE</code> com campos indexados WHERE sem \u00edndices <code>UP TO n ROWS</code> Buscar todos sem limite Verificar <code>sy-subrc</code> Assumir que dados existem <code>@</code> para host variables (7.40+) Sintaxe antiga","tags":["ABAP","SQL","SELECT","Database"]},{"location":"sql/1_select_basico/#proximo-passo","title":"\ud83d\ude80 Pr\u00f3ximo Passo","text":"<p>Depois de dominar os SELECTs b\u00e1sicos, aprenda sobre JOINs para combinar dados de m\u00faltiplas tabelas.</p>","tags":["ABAP","SQL","SELECT","Database"]},{"location":"sql/2_joins/","title":"JOINs em ABAP SQL","text":"<p>Os JOINs permitem combinar dados de m\u00faltiplas tabelas numa \u00fanica consulta.</p>","tags":["ABAP","SQL","JOIN","INNER JOIN","LEFT JOIN"]},{"location":"sql/2_joins/#tipos-de-join","title":"\ud83d\udd39 Tipos de JOIN","text":"Tipo Descri\u00e7\u00e3o INNER JOIN Retorna apenas registos que existem em ambas as tabelas LEFT OUTER JOIN Retorna todos da esquerda + correspondentes da direita RIGHT OUTER JOIN Retorna todos da direita + correspondentes da esquerda <p>Nota</p> <p>ABAP SQL suporta principalmente INNER JOIN e LEFT OUTER JOIN.</p>","tags":["ABAP","SQL","JOIN","INNER JOIN","LEFT JOIN"]},{"location":"sql/2_joins/#inner-join","title":"\ud83d\udd39 INNER JOIN","text":"","tags":["ABAP","SQL","JOIN","INNER JOIN","LEFT JOIN"]},{"location":"sql/2_joins/#exemplo-1-voos-com-nome-da-companhia","title":"Exemplo 1: Voos com Nome da Companhia","text":"<pre><code>REPORT z_inner_join_demo.\n\nDATA: BEGIN OF ls_flight,\n        carrid   TYPE s_carr_id,\n        connid   TYPE s_conn_id,\n        carrname TYPE s_carrname,\n        fldate   TYPE s_date,\n        price    TYPE s_price,\n      END OF ls_flight.\n\nDATA lt_flights LIKE TABLE OF ls_flight.\n\nSTART-OF-SELECTION.\n\n  \" Juntar tabelas SFLIGHT (voos) e SCARR (companhias)\n  SELECT a~carrid,\n         a~connid,\n         b~carrname,\n         a~fldate,\n         a~price\n    FROM sflight AS a\n    INNER JOIN scarr AS b ON a~carrid = b~carrid\n    INTO TABLE @lt_flights\n    WHERE a~carrid = 'LH'\n    UP TO 20 ROWS.\n\n  LOOP AT lt_flights INTO ls_flight.\n    WRITE: / ls_flight-carrid,\n             ls_flight-connid,\n             ls_flight-carrname,\n             ls_flight-fldate,\n             ls_flight-price.\n  ENDLOOP.\n</code></pre>","tags":["ABAP","SQL","JOIN","INNER JOIN","LEFT JOIN"]},{"location":"sql/2_joins/#exemplo-2-conexoes-com-aeroportos","title":"Exemplo 2: Conex\u00f5es com Aeroportos","text":"<pre><code>\" Juntar SPFLI (conex\u00f5es) com T005T (pa\u00edses)\nSELECT a~carrid,\n       a~connid,\n       a~cityfrom,\n       a~cityto,\n       b~landx AS pais\n  FROM spfli AS a\n  INNER JOIN t005t AS b ON a~countryfr = b~land1\n  INTO TABLE @DATA(lt_connections)\n  WHERE b~spras = @sy-langu\n  UP TO 50 ROWS.\n</code></pre>","tags":["ABAP","SQL","JOIN","INNER JOIN","LEFT JOIN"]},{"location":"sql/2_joins/#left-outer-join","title":"\ud83d\udd39 LEFT OUTER JOIN","text":"<p>Retorna todos os registos da tabela \u00e0 esquerda, mesmo que n\u00e3o haja correspond\u00eancia na direita.</p> <pre><code>REPORT z_left_join_demo.\n\nDATA: BEGIN OF ls_result,\n        carrid   TYPE s_carr_id,\n        carrname TYPE s_carrname,\n        connid   TYPE s_conn_id,\n        cityfrom TYPE s_from_cit,\n        cityto   TYPE s_to_city,\n      END OF ls_result.\n\nDATA lt_results LIKE TABLE OF ls_result.\n\nSTART-OF-SELECTION.\n\n  \" Buscar todas as companhias, mesmo que n\u00e3o tenham conex\u00f5es\n  SELECT a~carrid,\n         a~carrname,\n         b~connid,\n         b~cityfrom,\n         b~cityto\n    FROM scarr AS a\n    LEFT OUTER JOIN spfli AS b ON a~carrid = b~carrid\n    INTO TABLE @lt_results\n    UP TO 100 ROWS.\n\n  LOOP AT lt_results INTO ls_result.\n    WRITE: / ls_result-carrid,\n             ls_result-carrname,\n             ls_result-connid.\n  ENDLOOP.\n</code></pre> <p>Uso</p> <p>Use LEFT OUTER JOIN quando precisar de todos os registos da primeira tabela, independentemente de existirem na segunda.</p>","tags":["ABAP","SQL","JOIN","INNER JOIN","LEFT JOIN"]},{"location":"sql/2_joins/#join-com-multiplas-tabelas","title":"\ud83d\udd39 JOIN com M\u00faltiplas Tabelas","text":"<p>Pode juntar 3 ou mais tabelas:</p> <pre><code>\" Juntar SFLIGHT + SPFLI + SCARR\nSELECT f~carrid,\n       c~carrname,\n       f~connid,\n       p~cityfrom,\n       p~cityto,\n       f~fldate,\n       f~price,\n       f~currency\n  FROM sflight AS f\n  INNER JOIN spfli AS p ON f~carrid = p~carrid\n                       AND f~connid = p~connid\n  INNER JOIN scarr AS c ON f~carrid = c~carrid\n  INTO TABLE @DATA(lt_full_info)\n  WHERE f~carrid = 'LH'\n  UP TO 20 ROWS.\n</code></pre>","tags":["ABAP","SQL","JOIN","INNER JOIN","LEFT JOIN"]},{"location":"sql/2_joins/#join-com-condicoes-complexas","title":"\ud83d\udd39 JOIN com Condi\u00e7\u00f5es Complexas","text":"<pre><code>\" JOIN com m\u00faltiplas condi\u00e7\u00f5es\nSELECT a~vbeln,\n       a~kunnr,\n       b~name1,\n       a~netwr\n  FROM vbak AS a\n  INNER JOIN kna1 AS b ON a~kunnr = b~kunnr\n  INTO TABLE @DATA(lt_orders)\n  WHERE a~erdat &gt;= '20240101'\n    AND a~auart = 'OR'\n    AND b~land1 = 'PT'.\n</code></pre>","tags":["ABAP","SQL","JOIN","INNER JOIN","LEFT JOIN"]},{"location":"sql/2_joins/#comparacao-join-vs-for-all-entries","title":"\ud83d\udd39 Compara\u00e7\u00e3o: JOIN vs FOR ALL ENTRIES","text":"","tags":["ABAP","SQL","JOIN","INNER JOIN","LEFT JOIN"]},{"location":"sql/2_joins/#evitar-select-em-loop","title":"\u274c Evitar (SELECT em LOOP)","text":"<pre><code>\" M\u00e1 pr\u00e1tica - m\u00faltiplas queries\nSELECT * FROM scarr INTO TABLE @DATA(lt_carriers).\n\nLOOP AT lt_carriers INTO DATA(ls_carrier).\n  SELECT * FROM spfli\n    INTO TABLE @DATA(lt_temp)\n    WHERE carrid = @ls_carrier-carrid.\n  \" Processamento...\nENDLOOP.\n</code></pre>","tags":["ABAP","SQL","JOIN","INNER JOIN","LEFT JOIN"]},{"location":"sql/2_joins/#opcao-1-inner-join","title":"\u2705 Op\u00e7\u00e3o 1: INNER JOIN","text":"<pre><code>\" Boa pr\u00e1tica - uma \u00fanica query\nSELECT a~carrid,\n       a~carrname,\n       b~connid,\n       b~cityfrom\n  FROM scarr AS a\n  INNER JOIN spfli AS b ON a~carrid = b~carrid\n  INTO TABLE @DATA(lt_results).\n</code></pre>","tags":["ABAP","SQL","JOIN","INNER JOIN","LEFT JOIN"]},{"location":"sql/2_joins/#opcao-2-for-all-entries","title":"\u2705 Op\u00e7\u00e3o 2: FOR ALL ENTRIES","text":"<pre><code>\" Alternativa quando JOIN n\u00e3o \u00e9 poss\u00edvel\nSELECT * FROM scarr INTO TABLE @DATA(lt_carriers) UP TO 100 ROWS.\n\nIF lt_carriers IS NOT INITIAL.\n  SELECT * FROM spfli\n    INTO TABLE @DATA(lt_connections)\n    FOR ALL ENTRIES IN @lt_carriers\n    WHERE carrid = @lt_carriers-carrid.\nENDIF.\n</code></pre>","tags":["ABAP","SQL","JOIN","INNER JOIN","LEFT JOIN"]},{"location":"sql/2_joins/#exemplo-completo-relatorio-de-voos","title":"\ud83d\udd39 Exemplo Completo: Relat\u00f3rio de Voos","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_JOIN_RELATORIO_VOOS\n*&amp;---------------------------------------------------------------------*\nREPORT z_join_relatorio_voos.\n\nPARAMETERS: p_carrid TYPE s_carr_id DEFAULT 'LH',\n            p_datum  TYPE s_date DEFAULT sy-datum.\n\nDATA: BEGIN OF ls_voo,\n        carrid   TYPE s_carr_id,\n        carrname TYPE s_carrname,\n        connid   TYPE s_conn_id,\n        cityfrom TYPE s_from_cit,\n        cityto   TYPE s_to_city,\n        fldate   TYPE s_date,\n        price    TYPE s_price,\n        currency TYPE s_currcode,\n        seats    TYPE s_seatsmax,\n      END OF ls_voo.\n\nDATA lt_voos LIKE TABLE OF ls_voo.\n\nSTART-OF-SELECTION.\n\n  \" JOIN triplo: SFLIGHT + SPFLI + SCARR\n  SELECT f~carrid,\n         c~carrname,\n         f~connid,\n         p~cityfrom,\n         p~cityto,\n         f~fldate,\n         f~price,\n         f~currency,\n         f~seatsmax\n    FROM sflight AS f\n    INNER JOIN spfli AS p ON f~carrid = p~carrid\n                         AND f~connid = p~connid\n    INNER JOIN scarr AS c ON f~carrid = c~carrid\n    INTO TABLE @lt_voos\n    WHERE f~carrid = @p_carrid\n      AND f~fldate &gt;= @p_datum\n    ORDER BY f~fldate ASCENDING.\n\n  IF sy-subrc = 0.\n    \" Cabe\u00e7alho\n    WRITE: / 'Companhia:', p_carrid.\n    SKIP.\n    WRITE: / 'Liga\u00e7\u00e3o', 12 'De', 25 'Para', 40 'Data', 55 'Pre\u00e7o', 70 'Lugares'.\n    ULINE.\n\n    \" Dados\n    LOOP AT lt_voos INTO ls_voo.\n      WRITE: / ls_voo-connid,\n               12 ls_voo-cityfrom,\n               25 ls_voo-cityto,\n               40 ls_voo-fldate,\n               55 ls_voo-price,\n               65 ls_voo-currency,\n               70 ls_voo-seats.\n    ENDLOOP.\n\n    SKIP.\n    WRITE: / |Total de voos: { lines( lt_voos ) }|.\n  ELSE.\n    WRITE: / 'Nenhum voo encontrado para os crit\u00e9rios selecionados.'.\n  ENDIF.\n</code></pre>","tags":["ABAP","SQL","JOIN","INNER JOIN","LEFT JOIN"]},{"location":"sql/2_joins/#boas-praticas","title":"\ud83d\udca1 Boas Pr\u00e1ticas","text":"\u2705 Fazer \u274c Evitar Usar INNER JOIN para performance SELECT em LOOP Especificar apenas campos necess\u00e1rios JOIN de muitas tabelas sem necessidade Usar aliases (AS a, AS b) Nomes de tabela completos WHERE nas condi\u00e7\u00f5es principais Filtros s\u00f3 no lado aplicacional Verificar sy-subrc Assumir que dados existem","tags":["ABAP","SQL","JOIN","INNER JOIN","LEFT JOIN"]},{"location":"sql/2_joins/#proximo-passo","title":"\ud83d\ude80 Pr\u00f3ximo Passo","text":"<p>Aprenda sobre Agrega\u00e7\u00f5es e GROUP BY para calcular totais, m\u00e9dias e contagens.</p>","tags":["ABAP","SQL","JOIN","INNER JOIN","LEFT JOIN"]},{"location":"sql/3_agregacoes/","title":"Agrega\u00e7\u00f5es e GROUP BY","text":""},{"location":"sql/3_agregacoes/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>As fun\u00e7\u00f5es de agrega\u00e7\u00e3o permitem realizar c\u00e1lculos estat\u00edsticos sobre conjuntos de dados, como contar registos, calcular m\u00e9dias, somas, valores m\u00e1ximos e m\u00ednimos.</p>"},{"location":"sql/3_agregacoes/#funcoes-de-agregacao","title":"\ud83d\udd22 Fun\u00e7\u00f5es de Agrega\u00e7\u00e3o","text":""},{"location":"sql/3_agregacoes/#count-contar-registos","title":"COUNT - Contar Registos","text":"<pre><code>\" Contar todos os registos\nSELECT COUNT( * ) \n  FROM sflight\n  INTO @DATA(lv_total).\n\nWRITE: / 'Total de voos:', lv_total.\n\n\" Contar valores distintos\nSELECT COUNT( DISTINCT carrid )\n  FROM sflight\n  INTO @DATA(lv_companhias).\n\nWRITE: / 'Companhias diferentes:', lv_companhias.\n\n\" Contar com condi\u00e7\u00e3o\nSELECT COUNT( * )\n  FROM sflight\n  WHERE carrid = 'LH'\n  INTO @DATA(lv_voos_lh).\n</code></pre>"},{"location":"sql/3_agregacoes/#sum-somar-valores","title":"SUM - Somar Valores","text":"<pre><code>\" Soma total\nSELECT SUM( price )\n  FROM sflight\n  WHERE currency = 'EUR'\n  INTO @DATA(lv_total_preco).\n\nWRITE: / 'Receita total:', lv_total_preco.\n\n\" Soma com v\u00e1rias moedas\nSELECT currency,\n       SUM( price ) AS total\n  FROM sflight\n  GROUP BY currency\n  INTO TABLE @DATA(lt_totais).\n\nLOOP AT lt_totais INTO DATA(ls_total).\n  WRITE: / ls_total-currency, ls_total-total.\nENDLOOP.\n</code></pre>"},{"location":"sql/3_agregacoes/#avg-calcular-media","title":"AVG - Calcular M\u00e9dia","text":"<pre><code>\" M\u00e9dia simples\nSELECT AVG( price AS DEC( 15,2 ) )\n  FROM sflight\n  WHERE carrid = 'AA'\n  INTO @DATA(lv_preco_medio).\n\nWRITE: / 'Pre\u00e7o m\u00e9dio:', lv_preco_medio.\n\n\" M\u00e9dia por companhia\nSELECT carrid,\n       AVG( price AS DEC( 15,2 ) ) AS preco_medio\n  FROM sflight\n  GROUP BY carrid\n  INTO TABLE @DATA(lt_medias).\n</code></pre>"},{"location":"sql/3_agregacoes/#max-e-min-valores-extremos","title":"MAX e MIN - Valores Extremos","text":"<pre><code>\" M\u00e1ximo e m\u00ednimo\nSELECT MAX( price ) AS max_preco,\n       MIN( price ) AS min_preco\n  FROM sflight\n  INTO @DATA(ls_extremos).\n\nWRITE: / 'Pre\u00e7o m\u00e1ximo:', ls_extremos-max_preco.\nWRITE: / 'Pre\u00e7o m\u00ednimo:', ls_extremos-min_preco.\n\n\" Por grupo\nSELECT carrid,\n       MAX( price ) AS max_preco,\n       MIN( price ) AS min_preco\n  FROM sflight\n  GROUP BY carrid\n  INTO TABLE @DATA(lt_ranges).\n</code></pre>"},{"location":"sql/3_agregacoes/#group-by-agrupar-dados","title":"\ud83d\udcca GROUP BY - Agrupar Dados","text":""},{"location":"sql/3_agregacoes/#agrupamento-simples","title":"Agrupamento Simples","text":"<pre><code>\" Agrupar por companhia\nSELECT carrid,\n       COUNT( * ) AS num_voos\n  FROM sflight\n  GROUP BY carrid\n  INTO TABLE @DATA(lt_por_companhia).\n\nLOOP AT lt_por_companhia INTO DATA(ls_comp).\n  WRITE: / ls_comp-carrid, ls_comp-num_voos.\nENDLOOP.\n</code></pre>"},{"location":"sql/3_agregacoes/#agrupamento-multiplo","title":"Agrupamento M\u00faltiplo","text":"<pre><code>\" Agrupar por companhia e moeda\nSELECT carrid,\n       currency,\n       COUNT( * ) AS quantidade,\n       SUM( price ) AS total,\n       AVG( price AS DEC( 15,2 ) ) AS media\n  FROM sflight\n  GROUP BY carrid, currency\n  INTO TABLE @DATA(lt_estatisticas).\n\nLOOP AT lt_estatisticas INTO DATA(ls_stat).\n  WRITE: / ls_stat-carrid, \n         ls_stat-currency,\n         ls_stat-quantidade,\n         ls_stat-total,\n         ls_stat-media.\nENDLOOP.\n</code></pre>"},{"location":"sql/3_agregacoes/#group-by-com-joins","title":"GROUP BY com JOINs","text":"<pre><code>\" Estat\u00edsticas com informa\u00e7\u00e3o de m\u00faltiplas tabelas\nSELECT a~carrid,\n       b~carrname,\n       COUNT( * ) AS num_voos,\n       AVG( a~price AS DEC( 15,2 ) ) AS preco_medio\n  FROM sflight AS a\n  INNER JOIN scarr AS b ON a~carrid = b~carrid\n  GROUP BY a~carrid, b~carrname\n  INTO TABLE @DATA(lt_completo).\n</code></pre>"},{"location":"sql/3_agregacoes/#having-filtrar-grupos","title":"\ud83d\udd0d HAVING - Filtrar Grupos","text":""},{"location":"sql/3_agregacoes/#filtrar-apos-agregacao","title":"Filtrar Ap\u00f3s Agrega\u00e7\u00e3o","text":"<pre><code>\" Apenas companhias com mais de 10 voos\nSELECT carrid,\n       COUNT( * ) AS num_voos\n  FROM sflight\n  GROUP BY carrid\n  HAVING COUNT( * ) &gt; 10\n  INTO TABLE @DATA(lt_frequentes).\n\n\" Companhias com pre\u00e7o m\u00e9dio acima de 500\nSELECT carrid,\n       AVG( price AS DEC( 15,2 ) ) AS preco_medio\n  FROM sflight\n  GROUP BY carrid\n  HAVING AVG( price ) &gt; 500\n  INTO TABLE @DATA(lt_premium).\n</code></pre>"},{"location":"sql/3_agregacoes/#having-vs-where","title":"HAVING vs WHERE","text":"<pre><code>\" WHERE filtra ANTES do GROUP BY (mais eficiente)\nSELECT carrid,\n       COUNT( * ) AS num_voos\n  FROM sflight\n  WHERE fldate &gt;= '20240101'  \" Filtra primeiro\n  GROUP BY carrid\n  HAVING COUNT( * ) &gt; 5      \" Depois filtra grupos\n  INTO TABLE @DATA(lt_resultado).\n\n\" Regra: Use WHERE para filtros de linhas individuais\n\"        Use HAVING para filtros de resultados agregados\n</code></pre>"},{"location":"sql/3_agregacoes/#agregacoes-avancadas","title":"\ud83d\udcc8 Agrega\u00e7\u00f5es Avan\u00e7adas","text":""},{"location":"sql/3_agregacoes/#multiplas-agregacoes","title":"M\u00faltiplas Agrega\u00e7\u00f5es","text":"<pre><code>\" V\u00e1rias estat\u00edsticas de uma s\u00f3 vez\nSELECT carrid,\n       COUNT( * ) AS total_voos,\n       SUM( seatsocc ) AS assentos_ocupados,\n       SUM( seatsmax ) AS assentos_totais,\n       AVG( price AS DEC( 15,2 ) ) AS preco_medio,\n       MAX( price ) AS preco_maximo,\n       MIN( price ) AS preco_minimo\n  FROM sflight\n  GROUP BY carrid\n  INTO TABLE @DATA(lt_analise_completa).\n</code></pre>"},{"location":"sql/3_agregacoes/#calculos-derivados","title":"C\u00e1lculos Derivados","text":"<pre><code>\" Taxa de ocupa\u00e7\u00e3o calculada\nSELECT carrid,\n       SUM( seatsocc ) AS ocupados,\n       SUM( seatsmax ) AS total,\n       CAST( SUM( seatsocc ) AS DEC( 15,2 ) ) / \n       CAST( SUM( seatsmax ) AS DEC( 15,2 ) ) * 100 \n         AS taxa_ocupacao\n  FROM sflight\n  GROUP BY carrid\n  INTO TABLE @DATA(lt_ocupacao).\n\nLOOP AT lt_ocupacao INTO DATA(ls_ocup).\n  WRITE: / ls_ocup-carrid, \n         'Ocupa\u00e7\u00e3o:', ls_ocup-taxa_ocupacao, '%'.\nENDLOOP.\n</code></pre>"},{"location":"sql/3_agregacoes/#case-em-agregacoes","title":"CASE em Agrega\u00e7\u00f5es","text":"<pre><code>\" Contar por categoria\nSELECT carrid,\n       COUNT( * ) AS total_voos,\n       COUNT( CASE WHEN price &lt; 500 THEN 1 END ) AS voos_economicos,\n       COUNT( CASE WHEN price BETWEEN 500 AND 1000 THEN 1 END ) AS voos_normais,\n       COUNT( CASE WHEN price &gt; 1000 THEN 1 END ) AS voos_premium\n  FROM sflight\n  GROUP BY carrid\n  INTO TABLE @DATA(lt_categorias).\n</code></pre>"},{"location":"sql/3_agregacoes/#exemplos-praticos","title":"\ud83d\udca1 Exemplos Pr\u00e1ticos","text":""},{"location":"sql/3_agregacoes/#dashboard-de-vendas","title":"Dashboard de Vendas","text":"<pre><code>REPORT z_dashboard_vendas.\n\nSTART-OF-SELECTION.\n\n  \" An\u00e1lise de vendas por m\u00eas\n  SELECT SUBSTRING( fldate, 1, 6 ) AS mes,\n         COUNT( * ) AS num_vendas,\n         SUM( price ) AS receita_total,\n         AVG( price AS DEC( 15,2 ) ) AS ticket_medio\n    FROM sflight\n    WHERE fldate &gt;= '20240101'\n    GROUP BY SUBSTRING( fldate, 1, 6 )\n    ORDER BY mes\n    INTO TABLE @DATA(lt_mensal).\n\n  WRITE: / 'Dashboard Mensal'.\n  WRITE: / '================'.\n\n  LOOP AT lt_mensal INTO DATA(ls_mes).\n    WRITE: / ls_mes-mes,\n           'Vendas:', ls_mes-num_vendas,\n           'Receita:', ls_mes-receita_total,\n           'Ticket M\u00e9dio:', ls_mes-ticket_medio.\n  ENDLOOP.\n</code></pre>"},{"location":"sql/3_agregacoes/#top-companhias","title":"Top Companhias","text":"<pre><code>METHOD obter_top_companhias.\n  \" Top 10 companhias por receita\n  SELECT TOP 10\n         a~carrid,\n         b~carrname,\n         COUNT( * ) AS num_voos,\n         SUM( a~price ) AS receita_total\n    FROM sflight AS a\n    INNER JOIN scarr AS b ON a~carrid = b~carrid\n    GROUP BY a~carrid, b~carrname\n    ORDER BY receita_total DESCENDING\n    INTO TABLE @DATA(lt_top).\n\n  RETURN lt_top.\nENDMETHOD.\n</code></pre>"},{"location":"sql/3_agregacoes/#analise-de-tendencias","title":"An\u00e1lise de Tend\u00eancias","text":"<pre><code>\" Comparar performance ano a ano\nSELECT SUBSTRING( fldate, 1, 4 ) AS ano,\n       carrid,\n       COUNT( * ) AS voos,\n       AVG( seatsocc AS DEC( 15,2 ) ) AS ocupacao_media\n  FROM sflight\n  GROUP BY SUBSTRING( fldate, 1, 4 ), carrid\n  HAVING COUNT( * ) &gt; 50\n  ORDER BY ano, carrid\n  INTO TABLE @DATA(lt_tendencias).\n</code></pre>"},{"location":"sql/3_agregacoes/#boas-praticas","title":"\ud83c\udfaf Boas Pr\u00e1ticas","text":""},{"location":"sql/3_agregacoes/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Especificar todos os campos no GROUP BY\nSELECT carrid, connid, COUNT( * )\n  FROM sflight\n  GROUP BY carrid, connid  \" \u2705 Correto\n  INTO TABLE @DATA(lt_data).\n\n\" 2. Usar aliases para melhor legibilidade\nSELECT carrid,\n       COUNT( * ) AS total_voos,\n       AVG( price AS DEC( 15,2 ) ) AS preco_medio  \" \u2705\n  FROM sflight\n  GROUP BY carrid\n  INTO TABLE @DATA(lt_stats).\n\n\" 3. Combinar WHERE e HAVING adequadamente\nSELECT carrid, COUNT( * ) AS num\n  FROM sflight\n  WHERE fldate &gt;= '20240101'  \" \u2705 Filtra antes (mais r\u00e1pido)\n  GROUP BY carrid\n  HAVING COUNT( * ) &gt; 10      \" \u2705 Filtra resultado agregado\n  INTO TABLE @DATA(lt_result).\n</code></pre>"},{"location":"sql/3_agregacoes/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Campos n\u00e3o agregados sem GROUP BY\nSELECT carrid, connid, COUNT( * )  \" \u274c connid n\u00e3o est\u00e1 no GROUP BY\n  FROM sflight\n  GROUP BY carrid\n  INTO TABLE @DATA(lt_data).\n\n\" 2. SELECT * com GROUP BY\nSELECT *, COUNT( * )  \" \u274c Amb\u00edguo\n  FROM sflight\n  GROUP BY carrid\n  INTO TABLE @DATA(lt_data).\n\n\" 3. Agrega\u00e7\u00f5es desnecess\u00e1rias\nSELECT carrid, COUNT( * )\n  FROM sflight\n  GROUP BY carrid\n  HAVING carrid = 'LH'  \" \u274c Deve estar no WHERE\n  INTO TABLE @DATA(lt_data).\n\n\" Correto:\nSELECT carrid, COUNT( * )\n  FROM sflight\n  WHERE carrid = 'LH'  \" \u2705\n  GROUP BY carrid\n  INTO TABLE @DATA(lt_data).\n</code></pre>"},{"location":"sql/3_agregacoes/#performance","title":"\ud83d\udcca Performance","text":""},{"location":"sql/3_agregacoes/#otimizacoes","title":"Otimiza\u00e7\u00f5es","text":"<ol> <li>Use \u00edndices no WHERE: Filtre antes de agrupar</li> <li>Limite resultados: Use <code>UP TO n ROWS</code> quando poss\u00edvel</li> <li>Evite HAVING complexos: Use WHERE sempre que poss\u00edvel</li> <li>Agrega\u00e7\u00f5es espec\u00edficas: N\u00e3o use <code>COUNT(*)</code> se pode usar <code>COUNT(campo_indexado)</code></li> </ol> <pre><code>\" \u274c Lento\nSELECT carrid, COUNT( * )\n  FROM sflight\n  GROUP BY carrid\n  HAVING carrid IN ('AA', 'LH', 'BA')\n  INTO TABLE @DATA(lt_slow).\n\n\" \u2705 R\u00e1pido\nSELECT carrid, COUNT( * )\n  FROM sflight\n  WHERE carrid IN ('AA', 'LH', 'BA')  \" Usa \u00edndice\n  GROUP BY carrid\n  INTO TABLE @DATA(lt_fast).\n</code></pre>"},{"location":"sql/3_agregacoes/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>INSERT UPDATE DELETE - Manipular dados</li> <li>WHERE Din\u00e2mico - Consultas flex\u00edveis</li> <li>Otimiza\u00e7\u00f5es SQL - Performance avan\u00e7ada</li> </ul> <p>Tags: <code>#SQL</code> <code>#Agrega\u00e7\u00f5es</code> <code>#GROUP-BY</code> <code>#HAVING</code> <code>#COUNT</code> <code>#SUM</code> <code>#AVG</code></p>"},{"location":"sql/4_insert_update_delete/","title":"INSERT, UPDATE e DELETE","text":""},{"location":"sql/4_insert_update_delete/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Opera\u00e7\u00f5es para manipular dados na base de dados: inserir novos registos, atualizar existentes e eliminar dados.</p>"},{"location":"sql/4_insert_update_delete/#insert-inserir-dados","title":"\u2795 INSERT - Inserir Dados","text":""},{"location":"sql/4_insert_update_delete/#insert-simples","title":"INSERT Simples","text":"<pre><code>\" Inserir um registo\nDATA ls_scarr TYPE scarr.\n\nls_scarr-carrid   = 'PT'.\nls_scarr-carrname = 'TAP Air Portugal'.\nls_scarr-currcode = 'EUR'.\nls_scarr-url      = 'https://www.flytap.com'.\n\nINSERT scarr FROM ls_scarr.\n\nIF sy-subrc = 0.\n  WRITE: / 'Companhia inserida com sucesso'.\nELSE.\n  WRITE: / 'Erro ao inserir:', sy-subrc.\nENDIF.\n</code></pre>"},{"location":"sql/4_insert_update_delete/#insert-com-value","title":"INSERT com VALUE","text":"<pre><code>\" Sintaxe moderna\nINSERT scarr FROM @( VALUE #(\n  carrid   = 'PT'\n  carrname = 'TAP Air Portugal'\n  currcode = 'EUR'\n  url      = 'https://www.flytap.com'\n) ).\n</code></pre>"},{"location":"sql/4_insert_update_delete/#insert-em-massa-array","title":"INSERT em Massa (Array)","text":"<pre><code>\" Inserir m\u00faltiplos registos de uma vez\nDATA lt_novos_voos TYPE TABLE OF sflight.\n\nlt_novos_voos = VALUE #(\n  ( carrid = 'PT' connid = '0001' fldate = '20250101' price = '299.00' )\n  ( carrid = 'PT' connid = '0002' fldate = '20250102' price = '350.00' )\n  ( carrid = 'PT' connid = '0003' fldate = '20250103' price = '275.00' )\n).\n\nINSERT sflight FROM TABLE lt_novos_voos.\n\nIF sy-subrc = 0.\n  WRITE: / sy-dbcnt, 'registos inseridos'.\nELSE.\n  WRITE: / 'Erro ao inserir em massa'.\nENDIF.\n</code></pre>"},{"location":"sql/4_insert_update_delete/#insert-com-accepting-duplicate-keys","title":"INSERT com ACCEPTING DUPLICATE KEYS","text":"<pre><code>\" Inserir e ignorar duplicados (n\u00e3o gera erro)\nINSERT sflight FROM TABLE lt_novos_voos \n  ACCEPTING DUPLICATE KEYS.\n\n\" sy-dbcnt cont\u00e9m o n\u00famero de registos inseridos\nWRITE: / sy-dbcnt, 'registos inseridos (duplicados ignorados)'.\n</code></pre>"},{"location":"sql/4_insert_update_delete/#update-atualizar-dados","title":"\ud83d\udd04 UPDATE - Atualizar Dados","text":""},{"location":"sql/4_insert_update_delete/#update-simples","title":"UPDATE Simples","text":"<pre><code>\" Atualizar um registo espec\u00edfico\nDATA ls_scarr TYPE scarr.\n\nls_scarr-carrid   = 'PT'.\nls_scarr-carrname = 'TAP Air Portugal S.A.'.\nls_scarr-currcode = 'EUR'.\nls_scarr-url      = 'https://www.flytap.com'.\n\nUPDATE scarr FROM ls_scarr.\n\nIF sy-subrc = 0.\n  WRITE: / 'Companhia atualizada'.\nELSE.\n  WRITE: / 'Companhia n\u00e3o encontrada'.\nENDIF.\n</code></pre>"},{"location":"sql/4_insert_update_delete/#update-com-set","title":"UPDATE com SET","text":"<pre><code>\" Atualizar campos espec\u00edficos com WHERE\nUPDATE sflight\n  SET price = price * '1.10'  \" Aumentar 10%\n  WHERE carrid = 'LH'\n    AND fldate &gt;= '20250101'.\n\nWRITE: / sy-dbcnt, 'voos atualizados'.\n</code></pre>"},{"location":"sql/4_insert_update_delete/#update-em-massa","title":"UPDATE em Massa","text":"<pre><code>\" Atualizar m\u00faltiplos registos\nDATA lt_voos TYPE TABLE OF sflight.\n\n\" Buscar voos\nSELECT * FROM sflight\n  WHERE carrid = 'AA'\n  INTO TABLE @lt_voos.\n\n\" Modificar pre\u00e7os\nLOOP AT lt_voos ASSIGNING FIELD-SYMBOL(&lt;ls_voo&gt;).\n  &lt;ls_voo&gt;-price = &lt;ls_voo&gt;-price * '0.95'.  \" Desconto 5%\nENDLOOP.\n\n\" Atualizar na base de dados\nUPDATE sflight FROM TABLE lt_voos.\n\nWRITE: / sy-dbcnt, 'registos atualizados'.\n</code></pre>"},{"location":"sql/4_insert_update_delete/#update-com-where-complexo","title":"UPDATE com WHERE Complexo","text":"<pre><code>\" Atualizar com m\u00faltiplas condi\u00e7\u00f5es\nUPDATE sflight\n  SET seatsocc = seatsmax,\n      price    = price * '1.20'\n  WHERE carrid = 'BA'\n    AND connid IN ('0001', '0002', '0003')\n    AND fldate &gt;= '20250101'\n    AND seatsocc / seatsmax &lt; '0.5'.  \" Menos de 50% ocupado\n\nWRITE: / sy-dbcnt, 'voos atualizados'.\n</code></pre>"},{"location":"sql/4_insert_update_delete/#delete-eliminar-dados","title":"\u274c DELETE - Eliminar Dados","text":""},{"location":"sql/4_insert_update_delete/#delete-simples","title":"DELETE Simples","text":"<pre><code>\" Eliminar um registo espec\u00edfico\nDELETE FROM scarr WHERE carrid = 'XX'.\n\nIF sy-subrc = 0.\n  WRITE: / 'Companhia eliminada'.\nELSE.\n  WRITE: / 'Companhia n\u00e3o encontrada'.\nENDIF.\n</code></pre>"},{"location":"sql/4_insert_update_delete/#delete-com-where","title":"DELETE com WHERE","text":"<pre><code>\" Eliminar voos antigos\nDELETE FROM sflight\n  WHERE fldate &lt; '20200101'.\n\nWRITE: / sy-dbcnt, 'voos antigos eliminados'.\n\n\" Eliminar voos cancelados\nDELETE FROM sflight\n  WHERE carrid = 'XX'\n    AND fldate &gt;= sy-datum.\n\nWRITE: / sy-dbcnt, 'voos cancelados eliminados'.\n</code></pre>"},{"location":"sql/4_insert_update_delete/#delete-from-table","title":"DELETE FROM TABLE","text":"<pre><code>\" Eliminar baseado em tabela interna\nDATA lt_para_eliminar TYPE TABLE OF sflight.\n\n\" Buscar voos a eliminar\nSELECT * FROM sflight\n  WHERE carrid = 'ZZ'\n  INTO TABLE @lt_para_eliminar.\n\n\" Eliminar\nDELETE sflight FROM TABLE lt_para_eliminar.\n\nWRITE: / sy-dbcnt, 'registos eliminados'.\n</code></pre>"},{"location":"sql/4_insert_update_delete/#modify-inserir-ou-atualizar","title":"\ud83d\udd00 MODIFY - Inserir ou Atualizar","text":""},{"location":"sql/4_insert_update_delete/#modify-simples","title":"MODIFY Simples","text":"<pre><code>\" Se existir atualiza, sen\u00e3o insere\nDATA ls_scarr TYPE scarr.\n\nls_scarr-carrid   = 'PT'.\nls_scarr-carrname = 'TAP Air Portugal'.\nls_scarr-currcode = 'EUR'.\n\nMODIFY scarr FROM ls_scarr.\n\nIF sy-subrc = 0.\n  WRITE: / 'Opera\u00e7\u00e3o bem sucedida (INSERT ou UPDATE)'.\nENDIF.\n</code></pre>"},{"location":"sql/4_insert_update_delete/#modify-em-massa","title":"MODIFY em Massa","text":"<pre><code>\" Inserir ou atualizar m\u00faltiplos registos\nDATA lt_voos TYPE TABLE OF sflight.\n\nlt_voos = VALUE #(\n  ( carrid = 'LH' connid = '0400' fldate = '20250101' price = '500' )\n  ( carrid = 'LH' connid = '0401' fldate = '20250102' price = '550' )\n).\n\nMODIFY sflight FROM TABLE lt_voos.\n\nWRITE: / sy-dbcnt, 'registos modificados (insert/update)'.\n</code></pre>"},{"location":"sql/4_insert_update_delete/#transacoes-e-commit","title":"\ud83d\udd12 Transa\u00e7\u00f5es e COMMIT","text":""},{"location":"sql/4_insert_update_delete/#commit-work","title":"COMMIT WORK","text":"<pre><code>\" Todas as opera\u00e7\u00f5es DML precisam de COMMIT\nDATA ls_cliente TYPE kna1.\n\nls_cliente-kunnr = '0000100001'.\nls_cliente-name1 = 'Novo Cliente'.\n\nINSERT kna1 FROM ls_cliente.\n\nIF sy-subrc = 0.\n  COMMIT WORK.  \" Confirmar transa\u00e7\u00e3o\n  WRITE: / 'Cliente inserido e confirmado'.\nELSE.\n  ROLLBACK WORK.  \" Reverter em caso de erro\n  WRITE: / 'Erro - transa\u00e7\u00e3o revertida'.\nENDIF.\n</code></pre>"},{"location":"sql/4_insert_update_delete/#commit-work-and-wait","title":"COMMIT WORK AND WAIT","text":"<pre><code>\" Esperar pela confirma\u00e7\u00e3o\nINSERT kna1 FROM ls_cliente.\nCOMMIT WORK AND WAIT.\n\n\" Garantir que o registo est\u00e1 dispon\u00edvel\nSELECT SINGLE * FROM kna1\n  WHERE kunnr = @ls_cliente-kunnr\n  INTO @DATA(ls_verificar).\n\nIF sy-subrc = 0.\n  WRITE: / 'Registo confirmado e dispon\u00edvel'.\nENDIF.\n</code></pre>"},{"location":"sql/4_insert_update_delete/#exemplos-praticos","title":"\ud83d\udca1 Exemplos Pr\u00e1ticos","text":""},{"location":"sql/4_insert_update_delete/#importacao-de-dados","title":"Importa\u00e7\u00e3o de Dados","text":"<pre><code>METHOD importar_clientes.\n  DATA lt_clientes TYPE TABLE OF kna1.\n\n  \" Ler dados de ficheiro (exemplo simplificado)\n  lt_clientes = VALUE #(\n    ( kunnr = '0000100001' name1 = 'Cliente A' ort01 = 'Lisboa' )\n    ( kunnr = '0000100002' name1 = 'Cliente B' ort01 = 'Porto' )\n    ( kunnr = '0000100003' name1 = 'Cliente C' ort01 = 'Faro' )\n  ).\n\n  \" Inserir em massa\n  INSERT kna1 FROM TABLE lt_clientes \n    ACCEPTING DUPLICATE KEYS.\n\n  COMMIT WORK.\n\n  MESSAGE |{ sy-dbcnt } clientes importados| TYPE 'S'.\nENDMETHOD.\n</code></pre>"},{"location":"sql/4_insert_update_delete/#atualizacao-em-lote","title":"Atualiza\u00e7\u00e3o em Lote","text":"<pre><code>METHOD atualizar_precos_promocao.\n  \" Aplicar desconto de 15% em voos selecionados\n  UPDATE sflight\n    SET price = price * '0.85'\n    WHERE carrid IN ('AA', 'LH', 'BA')\n      AND fldate BETWEEN '20250601' AND '20250831'\n      AND seatsocc / seatsmax &lt; '0.7'.  \" Ocupa\u00e7\u00e3o &lt; 70%\n\n  DATA(lv_atualizados) = sy-dbcnt.\n\n  IF lv_atualizados &gt; 0.\n    COMMIT WORK.\n    MESSAGE |{ lv_atualizados } voos em promo\u00e7\u00e3o| TYPE 'S'.\n  ELSE.\n    MESSAGE 'Nenhum voo eleg\u00edvel' TYPE 'I'.\n  ENDIF.\nENDMETHOD.\n</code></pre>"},{"location":"sql/4_insert_update_delete/#limpeza-de-dados","title":"Limpeza de Dados","text":"<pre><code>METHOD limpar_dados_antigos.\n  DATA lv_data_limite TYPE datum.\n\n  \" Data limite: 2 anos atr\u00e1s\n  lv_data_limite = sy-datum - 730.\n\n  \" Eliminar registos antigos\n  DELETE FROM sflight\n    WHERE fldate &lt; lv_data_limite.\n\n  DATA(lv_eliminados) = sy-dbcnt.\n\n  IF lv_eliminados &gt; 0.\n    COMMIT WORK.\n    MESSAGE |{ lv_eliminados } registos antigos eliminados| TYPE 'S'.\n  ELSE.\n    MESSAGE 'Nenhum registo para eliminar' TYPE 'I'.\n  ENDIF.\nENDMETHOD.\n</code></pre>"},{"location":"sql/4_insert_update_delete/#sincronizacao-de-dados","title":"Sincroniza\u00e7\u00e3o de Dados","text":"<pre><code>METHOD sincronizar_com_externa.\n  DATA lt_externos TYPE TABLE OF ty_cliente_externo.\n  DATA lt_internos TYPE TABLE OF kna1.\n\n  \" Buscar dados do sistema externo\n  CALL FUNCTION 'Z_GET_EXTERNAL_CLIENTS'\n    TABLES\n      et_clients = lt_externos.\n\n  \" Converter para estrutura interna\n  lt_internos = CORRESPONDING #( lt_externos ).\n\n  \" Usar MODIFY para inserir novos ou atualizar existentes\n  MODIFY kna1 FROM TABLE lt_internos.\n\n  COMMIT WORK AND WAIT.\n\n  MESSAGE |{ sy-dbcnt } clientes sincronizados| TYPE 'S'.\nENDMETHOD.\n</code></pre>"},{"location":"sql/4_insert_update_delete/#boas-praticas","title":"\ud83c\udfaf Boas Pr\u00e1ticas","text":""},{"location":"sql/4_insert_update_delete/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Sempre verificar sy-subrc\nINSERT scarr FROM ls_scarr.\nIF sy-subrc = 0.\n  COMMIT WORK.\nELSE.\n  ROLLBACK WORK.\n  \" Tratar erro\nENDIF.\n\n\" 2. Usar opera\u00e7\u00f5es em massa quando poss\u00edvel\nINSERT sflight FROM TABLE lt_voos.  \" \u2705 Mais r\u00e1pido\n\n\" Em vez de:\nLOOP AT lt_voos INTO DATA(ls_voo).\n  INSERT sflight FROM ls_voo.  \" \u274c Lento\nENDLOOP.\n\n\" 3. Usar MODIFY quando n\u00e3o sabe se registo existe\nMODIFY kna1 FROM ls_cliente.  \" \u2705 INSERT ou UPDATE autom\u00e1tico\n\n\" 4. Limitar DELETE com WHERE espec\u00edfico\nDELETE FROM sflight WHERE carrid = 'XX'.  \" \u2705 Seguro\n\n\" Nunca:\n\" DELETE FROM sflight.  \" \u274c PERIGOSO! Apaga tudo!\n</code></pre>"},{"location":"sql/4_insert_update_delete/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Updates sem WHERE (perigoso!)\nUPDATE sflight SET price = 0.  \" \u274c Atualiza TODOS!\n\n\" Correto:\nUPDATE sflight SET price = 0 \n  WHERE carrid = 'XX'.  \" \u2705\n\n\" 2. N\u00e3o fazer COMMIT em loops\nLOOP AT lt_data INTO DATA(ls_data).\n  INSERT table FROM ls_data.\n  COMMIT WORK.  \" \u274c Lento e problem\u00e1tico\nENDLOOP.\n\n\" Correto:\nINSERT table FROM TABLE lt_data.\nCOMMIT WORK.  \" \u2705 Um \u00fanico commit\n\n\" 3. Ignorar erros\nINSERT scarr FROM ls_scarr.\n\" Sem verificar sy-subrc  \" \u274c M\u00e1 pr\u00e1tica\n\n\" 4. DELETE sem condi\u00e7\u00f5es claras\nDELETE FROM sflight.  \" \u274c PERIGO: apaga tudo!\n</code></pre>"},{"location":"sql/4_insert_update_delete/#controlo-de-autorizacao","title":"\ud83d\udd12 Controlo de Autoriza\u00e7\u00e3o","text":"<pre><code>\" Verificar autoriza\u00e7\u00e3o antes de modificar\nAUTHORITY-CHECK OBJECT 'S_TABU_DIS'\n  ID 'DICBERCLS' FIELD 'SCARR'\n  ID 'ACTVT' FIELD '02'.  \" 02 = UPDATE\n\nIF sy-subrc &lt;&gt; 0.\n  MESSAGE 'Sem autoriza\u00e7\u00e3o para modificar' TYPE 'E'.\n  RETURN.\nENDIF.\n\n\" Prosseguir com UPDATE\nUPDATE scarr FROM ls_scarr.\n</code></pre>"},{"location":"sql/4_insert_update_delete/#performance","title":"\ud83d\udcca Performance","text":""},{"location":"sql/4_insert_update_delete/#otimizacoes","title":"Otimiza\u00e7\u00f5es","text":"<ol> <li>Usar opera\u00e7\u00f5es em massa: <code>FROM TABLE</code> \u00e9 muito mais r\u00e1pido</li> <li>Indexes no WHERE: Garanta que campos no WHERE t\u00eam \u00edndices</li> <li>COMMIT uma vez: N\u00e3o fa\u00e7a COMMIT em loops</li> <li>MODIFY vs INSERT+UPDATE: MODIFY \u00e9 mais conveniente mas pode ser menos eficiente</li> </ol> <pre><code>\" \u274c Lento (um por um)\nLOOP AT lt_voos INTO DATA(ls_voo).\n  UPDATE sflight FROM ls_voo.\nENDLOOP.\n\n\" \u2705 R\u00e1pido (em massa)\nUPDATE sflight FROM TABLE lt_voos.\n</code></pre>"},{"location":"sql/4_insert_update_delete/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>WHERE Din\u00e2mico - Consultas flex\u00edveis</li> <li>Otimiza\u00e7\u00f5es SQL - Performance avan\u00e7ada</li> <li>Performance - Boas pr\u00e1ticas gerais</li> </ul> <p>Tags: <code>#SQL</code> <code>#INSERT</code> <code>#UPDATE</code> <code>#DELETE</code> <code>#MODIFY</code> <code>#DML</code> <code>#Database</code></p>"},{"location":"sql/5_where_dinamico/","title":"WHERE Din\u00e2mico","text":""},{"location":"sql/5_where_dinamico/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>WHERE din\u00e2mico permite construir consultas SQL flex\u00edveis em tempo de execu\u00e7\u00e3o, essencial para criar pesquisas configur\u00e1veis, filtros de utilizador e queries adapt\u00e1veis.</p>"},{"location":"sql/5_where_dinamico/#sintaxe-basica","title":"\ud83c\udfaf Sintaxe B\u00e1sica","text":""},{"location":"sql/5_where_dinamico/#where-com-string","title":"WHERE com String","text":"<pre><code>DATA lv_where TYPE string.\n\n\" Construir cl\u00e1usula WHERE dinamicamente\nlv_where = |carrid = 'LH'|.\n\nSELECT * FROM sflight\n  WHERE (lv_where)\n  INTO TABLE @DATA(lt_voos).\n\nWRITE: / lines( lt_voos ), 'voos encontrados'.\n</code></pre>"},{"location":"sql/5_where_dinamico/#where-com-variaveis","title":"WHERE com Vari\u00e1veis","text":"<pre><code>PARAMETERS: p_carrid TYPE s_carr_id,\n            p_connid TYPE s_conn_id.\n\nDATA lv_where TYPE string.\n\n\" Construir WHERE baseado em par\u00e2metros\nIF p_carrid IS NOT INITIAL.\n  lv_where = |carrid = '{ p_carrid }'|.\nENDIF.\n\nIF p_connid IS NOT INITIAL.\n  IF lv_where IS NOT INITIAL.\n    lv_where = |{ lv_where } AND connid = '{ p_connid }'|.\n  ELSE.\n    lv_where = |connid = '{ p_connid }'|.\n  ENDIF.\nENDIF.\n\nIF lv_where IS NOT INITIAL.\n  SELECT * FROM sflight\n    WHERE (lv_where)\n    INTO TABLE @DATA(lt_result).\nELSE.\n  SELECT * FROM sflight\n    INTO TABLE @lt_result\n    UP TO 100 ROWS.\nENDIF.\n</code></pre>"},{"location":"sql/5_where_dinamico/#construcao-de-where-dinamico","title":"\ud83d\udd27 Constru\u00e7\u00e3o de WHERE Din\u00e2mico","text":""},{"location":"sql/5_where_dinamico/#metodo-simples-string-concatenation","title":"M\u00e9todo Simples - String Concatenation","text":"<pre><code>DATA lv_where TYPE string.\nDATA lt_conditions TYPE TABLE OF string.\n\n\" Adicionar condi\u00e7\u00f5es\nIF p_carrid IS NOT INITIAL.\n  APPEND |carrid = '{ p_carrid }'| TO lt_conditions.\nENDIF.\n\nIF p_price_min IS NOT INITIAL.\n  APPEND |price &gt;= { p_price_min }| TO lt_conditions.\nENDIF.\n\nIF p_price_max IS NOT INITIAL.\n  APPEND |price &lt;= { p_price_max }| TO lt_conditions.\nENDIF.\n\nIF p_date_from IS NOT INITIAL.\n  APPEND |fldate &gt;= '{ p_date_from }'| TO lt_conditions.\nENDIF.\n\n\" Juntar com AND\nIF lt_conditions IS NOT INITIAL.\n  lv_where = concat_lines_of( table = lt_conditions sep = ' AND ' ).\n\n  SELECT * FROM sflight\n    WHERE (lv_where)\n    INTO TABLE @DATA(lt_voos).\nENDIF.\n</code></pre>"},{"location":"sql/5_where_dinamico/#metodo-avancado-classe-de-utilidade","title":"M\u00e9todo Avan\u00e7ado - Classe de Utilidade","text":"<pre><code>CLASS lcl_where_builder DEFINITION.\n  PUBLIC SECTION.\n    METHODS:\n      add_condition\n        IMPORTING iv_field TYPE string\n                  iv_operator TYPE string DEFAULT '='\n                  iv_value TYPE any,\n      get_where\n        RETURNING VALUE(rv_where) TYPE string.\n\n  PRIVATE SECTION.\n    DATA mt_conditions TYPE TABLE OF string.\nENDCLASS.\n\nCLASS lcl_where_builder IMPLEMENTATION.\n  METHOD add_condition.\n    DATA lv_condition TYPE string.\n\n    \" Tratar strings com aspas\n    IF iv_value IS SUPPLIED AND iv_value IS NOT INITIAL.\n      DATA lv_value_str TYPE string.\n      lv_value_str = |{ iv_value }|.\n\n      \" Adicionar aspas se for texto\n      IF iv_value CO '0123456789. '.\n        lv_condition = |{ iv_field } { iv_operator } { lv_value_str }|.\n      ELSE.\n        lv_condition = |{ iv_field } { iv_operator } '{ lv_value_str }'|.\n      ENDIF.\n\n      APPEND lv_condition TO mt_conditions.\n    ENDIF.\n  ENDMETHOD.\n\n  METHOD get_where.\n    IF mt_conditions IS NOT INITIAL.\n      rv_where = concat_lines_of( table = mt_conditions sep = ' AND ' ).\n    ENDIF.\n  ENDMETHOD.\nENDCLASS.\n\n\" Uso:\nSTART-OF-SELECTION.\n  DATA(lo_where) = NEW lcl_where_builder( ).\n\n  IF p_carrid IS NOT INITIAL.\n    lo_where-&gt;add_condition( iv_field = 'carrid' iv_value = p_carrid ).\n  ENDIF.\n\n  IF p_price_min IS NOT INITIAL.\n    lo_where-&gt;add_condition( \n      iv_field = 'price' \n      iv_operator = '&gt;=' \n      iv_value = p_price_min ).\n  ENDIF.\n\n  DATA(lv_where) = lo_where-&gt;get_where( ).\n\n  IF lv_where IS NOT INITIAL.\n    SELECT * FROM sflight\n      WHERE (lv_where)\n      INTO TABLE @DATA(lt_voos).\n  ENDIF.\n</code></pre>"},{"location":"sql/5_where_dinamico/#operadores-dinamicos","title":"\ud83d\udd0d Operadores Din\u00e2micos","text":""},{"location":"sql/5_where_dinamico/#operadores-de-comparacao","title":"Operadores de Compara\u00e7\u00e3o","text":"<pre><code>DATA: lv_field    TYPE string VALUE 'price',\n      lv_operator TYPE string VALUE '&gt;=',\n      lv_value    TYPE string VALUE '500'.\n\nDATA(lv_where) = |{ lv_field } { lv_operator } { lv_value }|.\n\nSELECT * FROM sflight\n  WHERE (lv_where)\n  INTO TABLE @DATA(lt_result).\n\n\" Exemplos de operadores:\n\" =  : Igual\n\" &lt;&gt; : Diferente\n\" &gt;  : Maior\n\" &gt;= : Maior ou igual\n\" &lt;  : Menor\n\" &lt;= : Menor ou igual\n</code></pre>"},{"location":"sql/5_where_dinamico/#in-e-between","title":"IN e BETWEEN","text":"<pre><code>\" Operador IN\nDATA lv_carrids TYPE string VALUE |carrid IN ('AA', 'LH', 'BA')|.\n\nSELECT * FROM sflight\n  WHERE (lv_carrids)\n  INTO TABLE @DATA(lt_voos).\n\n\" Operador BETWEEN\nDATA lv_range TYPE string VALUE |price BETWEEN 100 AND 500|.\n\nSELECT * FROM sflight\n  WHERE (lv_range)\n  INTO TABLE @lt_voos.\n</code></pre>"},{"location":"sql/5_where_dinamico/#like-para-padroes","title":"LIKE para Padr\u00f5es","text":"<pre><code>DATA lv_pattern TYPE string.\n\n\" Construir padr\u00e3o LIKE\nlv_pattern = |carrname LIKE '%Air%'|.\n\nSELECT * FROM scarr\n  WHERE (lv_pattern)\n  INTO TABLE @DATA(lt_carriers).\n\n\" Padr\u00f5es:\n\" %    = qualquer sequ\u00eancia de caracteres\n\" _    = um \u00fanico caractere\n</code></pre>"},{"location":"sql/5_where_dinamico/#select-options-dinamico","title":"\ud83d\udce6 SELECT-OPTIONS Din\u00e2mico","text":""},{"location":"sql/5_where_dinamico/#usar-select-options-em-where","title":"Usar SELECT-OPTIONS em WHERE","text":"<pre><code>SELECT-OPTIONS: s_carrid FOR sflight-carrid,\n                s_connid FOR sflight-connid,\n                s_fldate FOR sflight-fldate,\n                s_price  FOR sflight-price.\n\n\" SELECT-OPTIONS j\u00e1 funciona dinamicamente!\nSELECT * FROM sflight\n  WHERE carrid IN @s_carrid\n    AND connid IN @s_connid\n    AND fldate IN @s_fldate\n    AND price  IN @s_price\n  INTO TABLE @DATA(lt_voos).\n</code></pre>"},{"location":"sql/5_where_dinamico/#construir-where-com-ranges","title":"Construir WHERE com Ranges","text":"<pre><code>DATA: lr_carrid TYPE RANGE OF s_carr_id,\n      lr_price  TYPE RANGE OF s_price.\n\n\" Preencher ranges\nlr_carrid = VALUE #(\n  ( sign = 'I' option = 'EQ' low = 'AA' )\n  ( sign = 'I' option = 'EQ' low = 'LH' )\n).\n\nlr_price = VALUE #(\n  ( sign = 'I' option = 'BT' low = '100' high = '500' )\n).\n\n\" Usar em SELECT\nSELECT * FROM sflight\n  WHERE carrid IN @lr_carrid\n    AND price IN @lr_price\n  INTO TABLE @DATA(lt_voos).\n</code></pre>"},{"location":"sql/5_where_dinamico/#exemplos-praticos","title":"\ud83c\udfa8 Exemplos Pr\u00e1ticos","text":""},{"location":"sql/5_where_dinamico/#pesquisa-flexivel-de-clientes","title":"Pesquisa Flex\u00edvel de Clientes","text":"<pre><code>REPORT z_pesquisa_clientes.\n\nPARAMETERS: p_kunnr TYPE kunnr,\n            p_name1 TYPE name1,\n            p_ort01 TYPE ort01,\n            p_land1 TYPE land1.\n\nSTART-OF-SELECTION.\n  DATA lt_where TYPE TABLE OF string.\n\n  \" Construir WHERE baseado em input\n  IF p_kunnr IS NOT INITIAL.\n    APPEND |kunnr = '{ p_kunnr }'| TO lt_where.\n  ENDIF.\n\n  IF p_name1 IS NOT INITIAL.\n    APPEND |name1 LIKE '%{ p_name1 }%'| TO lt_where.\n  ENDIF.\n\n  IF p_ort01 IS NOT INITIAL.\n    APPEND |ort01 = '{ p_ort01 }'| TO lt_where.\n  ENDIF.\n\n  IF p_land1 IS NOT INITIAL.\n    APPEND |land1 = '{ p_land1 }'| TO lt_where.\n  ENDIF.\n\n  IF lt_where IS NOT INITIAL.\n    DATA(lv_where) = concat_lines_of( table = lt_where sep = ' AND ' ).\n\n    SELECT * FROM kna1\n      WHERE (lv_where)\n      INTO TABLE @DATA(lt_clientes)\n      UP TO 100 ROWS.\n\n    WRITE: / lines( lt_clientes ), 'clientes encontrados'.\n  ELSE.\n    WRITE: / 'Especifique pelo menos um crit\u00e9rio'.\n  ENDIF.\n</code></pre>"},{"location":"sql/5_where_dinamico/#filtro-de-relatorio-configuravel","title":"Filtro de Relat\u00f3rio Configur\u00e1vel","text":"<pre><code>METHOD executar_relatorio.\n  DATA: lt_campos    TYPE TABLE OF string,\n        lt_where     TYPE TABLE OF string,\n        lv_from      TYPE string VALUE 'sflight',\n        lv_where_str TYPE string,\n        lv_campos_str TYPE string.\n\n  \" Campos a selecionar (configur\u00e1vel)\n  APPEND 'carrid' TO lt_campos.\n  APPEND 'connid' TO lt_campos.\n  APPEND 'fldate' TO lt_campos.\n  APPEND 'price' TO lt_campos.\n\n  \" Condi\u00e7\u00f5es (baseadas em config)\n  IF config-filtro_companhia IS NOT INITIAL.\n    APPEND |carrid = '{ config-filtro_companhia }'| TO lt_where.\n  ENDIF.\n\n  IF config-data_inicio IS NOT INITIAL.\n    APPEND |fldate &gt;= '{ config-data_inicio }'| TO lt_where.\n  ENDIF.\n\n  IF config-preco_minimo IS NOT INITIAL.\n    APPEND |price &gt;= { config-preco_minimo }| TO lt_where.\n  ENDIF.\n\n  \" Construir query\n  lv_campos_str = concat_lines_of( table = lt_campos sep = ', ' ).\n  lv_where_str  = concat_lines_of( table = lt_where sep = ' AND ' ).\n\n  \" Executar SELECT din\u00e2mico completo\n  IF lv_where_str IS NOT INITIAL.\n    SELECT (lv_campos_str)\n      FROM (lv_from)\n      WHERE (lv_where_str)\n      INTO TABLE @DATA(lt_result).\n  ENDIF.\n\n  RETURN lt_result.\nENDMETHOD.\n</code></pre>"},{"location":"sql/5_where_dinamico/#query-builder-interativo","title":"Query Builder Interativo","text":"<pre><code>CLASS lcl_query_builder DEFINITION.\n  PUBLIC SECTION.\n    METHODS:\n      constructor,\n      adicionar_filtro\n        IMPORTING iv_campo    TYPE string\n                  iv_operador TYPE string\n                  iv_valor    TYPE string,\n      limpar_filtros,\n      executar\n        RETURNING VALUE(rt_dados) TYPE REF TO data.\n\n  PRIVATE SECTION.\n    DATA: mt_filtros TYPE TABLE OF string,\n          mv_tabela  TYPE string.\nENDCLASS.\n\nCLASS lcl_query_builder IMPLEMENTATION.\n  METHOD constructor.\n    mv_tabela = 'SFLIGHT'.\n  ENDMETHOD.\n\n  METHOD adicionar_filtro.\n    DATA lv_filtro TYPE string.\n\n    \" Adicionar aspas a strings\n    IF iv_valor CO '0123456789. '.\n      lv_filtro = |{ iv_campo } { iv_operador } { iv_valor }|.\n    ELSE.\n      lv_filtro = |{ iv_campo } { iv_operador } '{ iv_valor }'|.\n    ENDIF.\n\n    APPEND lv_filtro TO mt_filtros.\n  ENDMETHOD.\n\n  METHOD limpar_filtros.\n    CLEAR mt_filtros.\n  ENDMETHOD.\n\n  METHOD executar.\n    DATA lv_where TYPE string.\n\n    IF mt_filtros IS NOT INITIAL.\n      lv_where = concat_lines_of( table = mt_filtros sep = ' AND ' ).\n\n      SELECT * FROM (mv_tabela)\n        WHERE (lv_where)\n        INTO TABLE @DATA(lt_result).\n\n      \" Retornar refer\u00eancia aos dados\n      GET REFERENCE OF lt_result INTO rt_dados.\n    ENDIF.\n  ENDMETHOD.\nENDCLASS.\n\n\" Uso:\nDATA(lo_query) = NEW lcl_query_builder( ).\n\nlo_query-&gt;adicionar_filtro( \n  iv_campo = 'carrid' \n  iv_operador = '=' \n  iv_valor = 'LH' \n).\n\nlo_query-&gt;adicionar_filtro( \n  iv_campo = 'price' \n  iv_operador = '&gt;=' \n  iv_valor = '500' \n).\n\nDATA(lr_dados) = lo_query-&gt;executar( ).\n</code></pre>"},{"location":"sql/5_where_dinamico/#seguranca-sql-injection","title":"\u26a0\ufe0f Seguran\u00e7a - SQL Injection","text":""},{"location":"sql/5_where_dinamico/#perigoso-vulneravel-a-sql-injection","title":"\u274c PERIGOSO - Vulner\u00e1vel a SQL Injection","text":"<pre><code>\" NUNCA fazer isto em produ\u00e7\u00e3o!\nDATA lv_input TYPE string.\nlv_input = p_user_input.  \" Input do utilizador\n\nDATA(lv_where) = |carrid = '{ lv_input }'|.  \" \u274c PERIGOSO!\n\nSELECT * FROM sflight\n  WHERE (lv_where)\n  INTO TABLE @DATA(lt_data).\n\n\" Utilizador malicioso pode inserir: ' OR '1'='1\n\" Resultado: carrid = '' OR '1'='1' (retorna tudo!)\n</code></pre>"},{"location":"sql/5_where_dinamico/#seguro-validar-e-sanitizar","title":"\u2705 SEGURO - Validar e Sanitizar","text":"<pre><code>METHOD validar_input.\n  \" Apenas permitir caracteres seguros\n  IF iv_input CA ';''\"`'.  \" Caracteres perigosos\n    RAISE EXCEPTION TYPE cx_invalid_input.\n  ENDIF.\n\n  \" Validar contra lista permitida\n  IF iv_campo NOT IN ('carrid', 'connid', 'fldate').\n    RAISE EXCEPTION TYPE cx_invalid_field.\n  ENDIF.\n\n  RETURN iv_input.\nENDMETHOD.\n\n\" Uso seguro:\nTRY.\n    DATA(lv_campo_seguro) = validar_input( p_user_input ).\n    DATA(lv_where) = |{ lv_campo_seguro } = '{ p_valor }'|.\n  CATCH cx_invalid_input cx_invalid_field.\n    MESSAGE 'Input inv\u00e1lido' TYPE 'E'.\n    RETURN.\nENDTRY.\n</code></pre>"},{"location":"sql/5_where_dinamico/#boas-praticas","title":"\ud83c\udfaf Boas Pr\u00e1ticas","text":""},{"location":"sql/5_where_dinamico/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Validar sempre inputs do utilizador\nIF lv_input CA ';''\"`'.\n  \" Rejeitar input perigoso\nENDIF.\n\n\" 2. Usar lista branca de campos permitidos\nDATA lt_campos_validos TYPE TABLE OF string.\nlt_campos_validos = VALUE #( ( 'carrid' ) ( 'connid' ) ( 'price' ) ).\n\nIF NOT line_exists( lt_campos_validos[ table_line = lv_campo ] ).\n  \" Campo n\u00e3o permitido\nENDIF.\n\n\" 3. Usar @ para host variables sempre que poss\u00edvel\nSELECT * FROM sflight\n  WHERE carrid = @p_carrid  \" \u2705 Mais seguro\n  INTO TABLE @DATA(lt_data).\n\n\" 4. Construir WHERE de forma estruturada\nDATA(lo_builder) = NEW lcl_where_builder( ).\nlo_builder-&gt;add_condition( ... ).\n</code></pre>"},{"location":"sql/5_where_dinamico/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Concatena\u00e7\u00e3o direta de input do utilizador\nlv_where = |campo = '{ p_input }'|.  \" \u274c Perigoso\n\n\" 2. WHERE complexo numa \u00fanica string gigante\nlv_where = |carrid = 'AA' AND connid = '001' AND ...|.  \" \u274c Dif\u00edcil manter\n\n\" 3. N\u00e3o validar tipos de dados\nlv_where = |price = { lv_texto }|.  \" \u274c Se lv_texto n\u00e3o for n\u00famero?\n</code></pre>"},{"location":"sql/5_where_dinamico/#performance","title":"\ud83d\udcca Performance","text":""},{"location":"sql/5_where_dinamico/#otimizacoes","title":"Otimiza\u00e7\u00f5es","text":"<ol> <li>\u00cdndices: Certifique-se que campos em WHERE t\u00eam \u00edndices</li> <li>Caching: Cache queries frequentes</li> <li>Limitar resultados: Use <code>UP TO n ROWS</code></li> <li>Preparar statements: Reutilize WHERE quando poss\u00edvel</li> </ol> <pre><code>\" \u2705 Bom: Reutilizar WHERE\nDATA(lv_where) = construir_where( ).\n\nSELECT * FROM sflight WHERE (lv_where) INTO TABLE @lt_voos1.\nSELECT * FROM spfli WHERE (lv_where) INTO TABLE @lt_ligacoes.\n\n\" \u274c Mau: Reconstruir sempre\nLOOP AT lt_queries INTO DATA(lv_query).\n  DATA(lv_where_temp) = construir_where( ).  \" Desnecess\u00e1rio\n  SELECT...\nENDLOOP.\n</code></pre>"},{"location":"sql/5_where_dinamico/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>Otimiza\u00e7\u00f5es SQL - Performance avan\u00e7ada</li> <li>Performance - Boas pr\u00e1ticas gerais</li> <li>Security - Prevenir SQL Injection</li> </ul> <p>Tags: <code>#SQL</code> <code>#WHERE-Din\u00e2mico</code> <code>#Dynamic-SQL</code> <code>#Security</code> <code>#SQL-Injection</code></p>"},{"location":"sql/6_otimizacoes/","title":"Otimiza\u00e7\u00f5es SQL","text":""},{"location":"sql/6_otimizacoes/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>T\u00e9cnicas e boas pr\u00e1ticas para escrever consultas SQL eficientes em ABAP, melhorando a performance e reduzindo o tempo de resposta das aplica\u00e7\u00f5es.</p>"},{"location":"sql/6_otimizacoes/#regras-de-ouro","title":"\ud83c\udfaf Regras de Ouro","text":""},{"location":"sql/6_otimizacoes/#1-evitar-select-em-loops","title":"1. Evitar SELECT em LOOPs","text":"<pre><code>\" \u274c MUITO LENTO - SELECT dentro de LOOP\nLOOP AT lt_pedidos INTO DATA(ls_pedido).\n  SELECT SINGLE * FROM kna1\n    WHERE kunnr = @ls_pedido-kunnr\n    INTO @DATA(ls_cliente).\n  \" Processar...\nENDLOOP.\n\" Se lt_pedidos tem 1000 linhas = 1000 SELECTs!\n\n\" \u2705 R\u00c1PIDO - SELECT \u00fanico com FOR ALL ENTRIES\nSELECT * FROM kna1\n  FOR ALL ENTRIES IN @lt_pedidos\n  WHERE kunnr = @lt_pedidos-kunnr\n  INTO TABLE @DATA(lt_clientes).\n\n\" Depois fazer LOOP e READ TABLE\nLOOP AT lt_pedidos INTO ls_pedido.\n  READ TABLE lt_clientes INTO DATA(ls_cliente)\n    WITH KEY kunnr = ls_pedido-kunnr.\n  \" Processar...\nENDLOOP.\n</code></pre>"},{"location":"sql/6_otimizacoes/#2-selecionar-apenas-campos-necessarios","title":"2. Selecionar Apenas Campos Necess\u00e1rios","text":"<pre><code>\" \u274c Desnecess\u00e1rio - traz todos os campos\nSELECT * FROM kna1\n  WHERE land1 = 'PT'\n  INTO TABLE @DATA(lt_clientes).\n\n\" \u2705 Eficiente - apenas campos necess\u00e1rios\nSELECT kunnr, name1, ort01\n  FROM kna1\n  WHERE land1 = 'PT'\n  INTO TABLE @DATA(lt_clientes).\n\n\" Reduz:\n\" - Tr\u00e1fego de rede\n\" - Uso de mem\u00f3ria\n\" - Tempo de processamento\n</code></pre>"},{"location":"sql/6_otimizacoes/#3-usar-indices-corretamente","title":"3. Usar \u00cdndices Corretamente","text":"<pre><code>\" \u274c N\u00e3o usa \u00edndice - campo n\u00e3o indexado\nSELECT * FROM vbak\n  WHERE erdat = '20250101'\n  INTO TABLE @DATA(lt_pedidos).\n\n\" \u2705 Usa \u00edndice - campo chave/indexado\nSELECT * FROM vbak\n  WHERE vbeln = '0000000001'\n  INTO TABLE @lt_pedidos.\n\n\" Ver \u00edndices: Transa\u00e7\u00e3o SE11 &gt; Display &gt; \u00cdndices\n</code></pre>"},{"location":"sql/6_otimizacoes/#for-all-entries","title":"\ud83d\ude80 FOR ALL ENTRIES","text":""},{"location":"sql/6_otimizacoes/#uso-correto","title":"Uso Correto","text":"<pre><code>DATA lt_pedidos TYPE TABLE OF vbak.\nDATA lt_itens   TYPE TABLE OF vbap.\n\n\" Buscar pedidos\nSELECT * FROM vbak\n  WHERE vkorg = '1000'\n  INTO TABLE @lt_pedidos\n  UP TO 1000 ROWS.\n\n\" \u2705 IMPORTANTE: Verificar se tabela n\u00e3o est\u00e1 vazia!\nIF lt_pedidos IS NOT INITIAL.\n  SELECT * FROM vbap\n    FOR ALL ENTRIES IN @lt_pedidos\n    WHERE vbeln = @lt_pedidos-vbeln\n    INTO TABLE @lt_itens.\nENDIF.\n\n\" Se lt_pedidos estiver vazia, SELECT retorna TUDO!\n</code></pre>"},{"location":"sql/6_otimizacoes/#otimizar-for-all-entries","title":"Otimizar FOR ALL ENTRIES","text":"<pre><code>\" \u2705 Remover duplicados antes de FOR ALL ENTRIES\nDATA lt_pedidos_uniq LIKE lt_pedidos.\n\nlt_pedidos_uniq = lt_pedidos.\nSORT lt_pedidos_uniq BY vbeln.\nDELETE ADJACENT DUPLICATES FROM lt_pedidos_uniq COMPARING vbeln.\n\n\" Agora usar a tabela sem duplicados\nIF lt_pedidos_uniq IS NOT INITIAL.\n  SELECT * FROM vbap\n    FOR ALL ENTRIES IN @lt_pedidos_uniq\n    WHERE vbeln = @lt_pedidos_uniq-vbeln\n    INTO TABLE @DATA(lt_itens).\nENDIF.\n</code></pre>"},{"location":"sql/6_otimizacoes/#joins-vs-for-all-entries","title":"\ud83d\udcca JOINs vs. FOR ALL ENTRIES","text":""},{"location":"sql/6_otimizacoes/#quando-usar-join","title":"Quando Usar JOIN","text":"<pre><code>\" \u2705 JOIN - Melhor para rela\u00e7\u00f5es 1:1 ou 1:N simples\nSELECT a~vbeln,\n       a~erdat,\n       b~posnr,\n       b~matnr\n  FROM vbak AS a\n  INNER JOIN vbap AS b ON a~vbeln = b~vbeln\n  WHERE a~vkorg = '1000'\n  INTO TABLE @DATA(lt_resultado).\n\n\" Vantagens:\n\" - Uma \u00fanica query\n\" - Menos c\u00f3digo\n\" - Processado na base de dados\n</code></pre>"},{"location":"sql/6_otimizacoes/#quando-usar-for-all-entries","title":"Quando Usar FOR ALL ENTRIES","text":"<pre><code>\" \u2705 FOR ALL ENTRIES - Melhor quando:\n\" - Rela\u00e7\u00f5es complexas\n\" - Precisa filtrar dados antes\n\" - Tabelas em bases de dados diferentes\n\n\" 1. Buscar e filtrar pedidos\nSELECT * FROM vbak\n  WHERE vkorg = '1000'\n  INTO TABLE @DATA(lt_pedidos).\n\n\" Filtrar programaticamente\nDELETE lt_pedidos WHERE erdat &lt; '20240101'.\n\n\" 2. Buscar itens apenas dos pedidos filtrados\nIF lt_pedidos IS NOT INITIAL.\n  SELECT * FROM vbap\n    FOR ALL ENTRIES IN @lt_pedidos\n    WHERE vbeln = @lt_pedidos-vbeln\n    INTO TABLE @DATA(lt_itens).\nENDIF.\n</code></pre>"},{"location":"sql/6_otimizacoes/#up-to-n-rows","title":"\ud83c\udfaf UP TO n ROWS","text":""},{"location":"sql/6_otimizacoes/#limitar-resultados","title":"Limitar Resultados","text":"<pre><code>\" \u2705 Sempre limitar quando n\u00e3o precisa de tudo\nSELECT * FROM sflight\n  WHERE carrid = 'LH'\n  INTO TABLE @DATA(lt_voos)\n  UP TO 100 ROWS.\n\n\" Especialmente \u00fatil em:\n\" - Telas de pesquisa (pagina\u00e7\u00e3o)\n\" - Testes / Desenvolvimento\n\" - Valida\u00e7\u00f5es (existe pelo menos um?)\n\n\" Verificar se existe pelo menos um registo\nSELECT SINGLE carrid FROM scarr\n  WHERE carrid = 'LH'\n  INTO @DATA(lv_carrid).\n\nIF sy-subrc = 0.\n  \" Companhia existe\nENDIF.\n</code></pre>"},{"location":"sql/6_otimizacoes/#agregacoes-na-base-de-dados","title":"\ud83d\udd0d Agrega\u00e7\u00f5es na Base de Dados","text":""},{"location":"sql/6_otimizacoes/#processar-na-bd-vs-abap","title":"Processar na BD vs. ABAP","text":"<pre><code>\" \u274c Processar em ABAP (lento)\nSELECT * FROM sflight\n  WHERE carrid = 'LH'\n  INTO TABLE @DATA(lt_voos).\n\nDATA lv_total TYPE p DECIMALS 2.\nLOOP AT lt_voos INTO DATA(ls_voo).\n  lv_total = lv_total + ls_voo-price.\nENDLOOP.\n\n\" \u2705 Processar na base de dados (r\u00e1pido)\nSELECT SUM( price )\n  FROM sflight\n  WHERE carrid = 'LH'\n  INTO @DATA(lv_total).\n\n\" Regra: Sempre que poss\u00edvel, processar na BD!\n</code></pre>"},{"location":"sql/6_otimizacoes/#agregacoes-complexas","title":"Agrega\u00e7\u00f5es Complexas","text":"<pre><code>\" \u2705 Estat\u00edsticas calculadas na BD\nSELECT carrid,\n       COUNT( * ) AS num_voos,\n       SUM( price ) AS receita,\n       AVG( price AS DEC( 15,2 ) ) AS preco_medio,\n       MAX( price ) AS preco_max,\n       MIN( price ) AS preco_min\n  FROM sflight\n  GROUP BY carrid\n  HAVING COUNT( * ) &gt; 10\n  INTO TABLE @DATA(lt_estatisticas).\n\n\" Muito mais r\u00e1pido que fazer LOOPs em ABAP!\n</code></pre>"},{"location":"sql/6_otimizacoes/#buffering","title":"\ud83d\udcbe Buffering","text":""},{"location":"sql/6_otimizacoes/#usar-buffer-sap","title":"Usar Buffer SAP","text":"<pre><code>\" Tabelas pequenas e raramente alteradas devem ter buffer\n\" Configurar em SE11 &gt; Tabela &gt; Technical Settings\n\n\" \u2705 SELECT em tabelas bufferizadas \u00e9 instant\u00e2neo\nSELECT SINGLE * FROM t001  \" Empresas (bufferizada)\n  WHERE bukrs = '1000'\n  INTO @DATA(ls_empresa).\n\n\" Verificar se tabela tem buffer: SE11 &gt; Display\n\n\" Tabelas que devem ter buffer:\n\" - Tabelas de configura\u00e7\u00e3o\n\" - Tabelas pequenas (&lt; 1000 linhas)\n\" - Tabelas raramente alteradas\n\" - Acedidas frequentemente\n</code></pre>"},{"location":"sql/6_otimizacoes/#bypassing-buffer","title":"BYPASSING BUFFER","text":"<pre><code>\" Quando precisa de dados em tempo real\nSELECT * FROM ztabela\n  BYPASSING BUFFER\n  WHERE campo = @valor\n  INTO TABLE @DATA(lt_data).\n\n\" Usar quando:\n\" - Dados devem estar atualizados\n\" - Ap\u00f3s modifica\u00e7\u00f5es recentes\n\" - Em processos cr\u00edticos\n</code></pre>"},{"location":"sql/6_otimizacoes/#otimizacoes-avancadas","title":"\ud83d\udd27 Otimiza\u00e7\u00f5es Avan\u00e7adas","text":""},{"location":"sql/6_otimizacoes/#select-com-case","title":"SELECT com CASE","text":"<pre><code>\" \u2705 Classificar na base de dados\nSELECT carrid,\n       connid,\n       price,\n       CASE\n         WHEN price &lt; 500 THEN 'Econ\u00f3mico'\n         WHEN price &lt; 1000 THEN 'Normal'\n         ELSE 'Premium'\n       END AS categoria\n  FROM sflight\n  INTO TABLE @DATA(lt_classificados).\n\n\" Evita LOOP em ABAP para classificar\n</code></pre>"},{"location":"sql/6_otimizacoes/#subconsultas-subqueries","title":"Subconsultas (Subqueries)","text":"<pre><code>\" \u2705 Filtrar com subquery\nSELECT * FROM vbak\n  WHERE vbeln IN (\n    SELECT vbeln FROM vbap WHERE matnr = 'MAT001'\n  )\n  INTO TABLE @DATA(lt_pedidos).\n\n\" Alternativa com JOIN (geralmente mais r\u00e1pido):\nSELECT DISTINCT a~*\n  FROM vbak AS a\n  INNER JOIN vbap AS b ON a~vbeln = b~vbeln\n  WHERE b~matnr = 'MAT001'\n  INTO CORRESPONDING FIELDS OF TABLE @lt_pedidos.\n</code></pre>"},{"location":"sql/6_otimizacoes/#uso-de-with-common-table-expression","title":"Uso de WITH (Common Table Expression)","text":"<pre><code>\" \u2705 CTE para queries complexas (HANA)\nWITH +pedidos_2024 AS (\n  SELECT vbeln, kunnr, netwr\n  FROM vbak\n  WHERE erdat BETWEEN '20240101' AND '20241231'\n)\nSELECT p~vbeln,\n       p~netwr,\n       k~name1\n  FROM +pedidos_2024 AS p\n  INNER JOIN kna1 AS k ON p~kunnr = k~kunnr\n  WHERE p~netwr &gt; 10000\n  INTO TABLE @DATA(lt_resultado).\n</code></pre>"},{"location":"sql/6_otimizacoes/#ferramentas-de-analise","title":"\ud83d\udcc8 Ferramentas de An\u00e1lise","text":""},{"location":"sql/6_otimizacoes/#runtime-analysis-satse30","title":"Runtime Analysis (SAT/SE30)","text":"<pre><code>\" Analisar performance do c\u00f3digo\n\" 1. Transaction SAT (ou SE30)\n\" 2. Executar programa\n\" 3. Analisar resultados\n\n\" Ver:\n\" - Tempo de cada SELECT\n\" - N\u00famero de registos lidos\n\" - Uso de buffer\n\" - Opera\u00e7\u00f5es mais lentas\n</code></pre>"},{"location":"sql/6_otimizacoes/#sql-trace-st05","title":"SQL Trace (ST05)","text":"<pre><code>\" Analisar queries SQL\n\" 1. Transaction ST05\n\" 2. Ativar SQL Trace\n\" 3. Executar programa\n\" 4. Desativar e analisar\n\n\" Identificar:\n\" - SELECTs sem \u00edndice\n\" - Table scans\n\" - Queries duplicadas\n\" - Tempo de execu\u00e7\u00e3o\n</code></pre>"},{"location":"sql/6_otimizacoes/#code-inspector-sci","title":"Code Inspector (SCI)","text":"<pre><code>\" Verificar performance do c\u00f3digo\n\" Transaction SCI ou ATC\n\n\" Detecta:\n\" - SELECT em LOOPs\n\" - SELECT * desnecess\u00e1rio\n\" - FOR ALL ENTRIES sem valida\u00e7\u00e3o\n\" - Opera\u00e7\u00f5es ineficientes\n</code></pre>"},{"location":"sql/6_otimizacoes/#exemplos-de-otimizacao","title":"\ud83d\udca1 Exemplos de Otimiza\u00e7\u00e3o","text":""},{"location":"sql/6_otimizacoes/#antes-e-depois","title":"Antes e Depois","text":""},{"location":"sql/6_otimizacoes/#exemplo-1-buscar-clientes-e-pedidos","title":"Exemplo 1: Buscar Clientes e Pedidos","text":"<pre><code>\" \u274c ANTES - Muito lento (1000+ SELECTs)\nSELECT * FROM kna1\n  WHERE land1 = 'PT'\n  INTO TABLE @DATA(lt_clientes).\n\nLOOP AT lt_clientes INTO DATA(ls_cliente).\n  SELECT COUNT( * ) FROM vbak\n    WHERE kunnr = @ls_cliente-kunnr\n    INTO @DATA(lv_num_pedidos).\n\n  ls_cliente-num_pedidos = lv_num_pedidos.\n  MODIFY lt_clientes FROM ls_cliente.\nENDLOOP.\n\n\" \u2705 DEPOIS - R\u00e1pido (2 SELECTs apenas)\nSELECT * FROM kna1\n  WHERE land1 = 'PT'\n  INTO TABLE @lt_clientes.\n\nIF lt_clientes IS NOT INITIAL.\n  SELECT kunnr, COUNT( * ) AS num_pedidos\n    FROM vbak\n    FOR ALL ENTRIES IN @lt_clientes\n    WHERE kunnr = @lt_clientes-kunnr\n    GROUP BY kunnr\n    INTO TABLE @DATA(lt_contagens).\n\n  LOOP AT lt_clientes ASSIGNING FIELD-SYMBOL(&lt;ls_cliente&gt;).\n    READ TABLE lt_contagens INTO DATA(ls_count)\n      WITH KEY kunnr = &lt;ls_cliente&gt;-kunnr.\n    IF sy-subrc = 0.\n      &lt;ls_cliente&gt;-num_pedidos = ls_count-num_pedidos.\n    ENDIF.\n  ENDLOOP.\nENDIF.\n</code></pre>"},{"location":"sql/6_otimizacoes/#exemplo-2-relatorio-de-vendas","title":"Exemplo 2: Relat\u00f3rio de Vendas","text":"<pre><code>\" \u274c ANTES - Processar tudo em ABAP\nSELECT * FROM vbak INTO TABLE @DATA(lt_pedidos).\n\nDATA: lv_total TYPE p DECIMALS 2,\n      lv_count TYPE i.\n\nLOOP AT lt_pedidos INTO DATA(ls_pedido) WHERE vkorg = '1000'.\n  lv_total = lv_total + ls_pedido-netwr.\n  lv_count = lv_count + 1.\nENDLOOP.\n\nDATA(lv_media) = lv_total / lv_count.\n\n\" \u2705 DEPOIS - Processar na base de dados\nSELECT COUNT( * ) AS total_pedidos,\n       SUM( netwr ) AS valor_total,\n       AVG( netwr AS DEC( 15,2 ) ) AS valor_medio\n  FROM vbak\n  WHERE vkorg = '1000'\n  INTO @DATA(ls_estatisticas).\n</code></pre>"},{"location":"sql/6_otimizacoes/#checklist-de-otimizacao","title":"\ud83c\udfaf Checklist de Otimiza\u00e7\u00e3o","text":""},{"location":"sql/6_otimizacoes/#verificar-sempre","title":"\u2705 Verificar Sempre","text":"<ul> <li>[ ] N\u00e3o h\u00e1 SELECT dentro de LOOPs?</li> <li>[ ] SELECT usa campos indexados no WHERE?</li> <li>[ ] Seleciona apenas campos necess\u00e1rios (n\u00e3o SELECT *)?</li> <li>[ ] Usa UP TO ROWS quando apropriado?</li> <li>[ ] FOR ALL ENTRIES verifica se tabela n\u00e3o est\u00e1 vazia?</li> <li>[ ] Agrega\u00e7\u00f5es s\u00e3o feitas na BD (n\u00e3o em LOOP)?</li> <li>[ ] Usa JOIN em vez de m\u00faltiplos SELECTs?</li> <li>[ ] Tabelas pequenas t\u00eam buffer ativado?</li> </ul>"},{"location":"sql/6_otimizacoes/#medir-performance","title":"\ud83d\udcca Medir Performance","text":"<ol> <li>Runtime Analysis (SAT): Tempo de execu\u00e7\u00e3o</li> <li>SQL Trace (ST05): An\u00e1lise detalhada de queries</li> <li>Code Inspector (SCI): Problemas de c\u00f3digo</li> <li>ABAP Test Cockpit (ATC): Verifica\u00e7\u00e3o autom\u00e1tica</li> </ol>"},{"location":"sql/6_otimizacoes/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>Performance - Otimiza\u00e7\u00f5es gerais ABAP</li> <li>FOR ALL ENTRIES - Uso avan\u00e7ado</li> <li>\u00cdndices - Como criar e usar</li> </ul> <p>Tags: <code>#SQL</code> <code>#Performance</code> <code>#Otimiza\u00e7\u00e3o</code> <code>#Best-Practices</code> <code>#FOR-ALL-ENTRIES</code></p>"},{"location":"testes/","title":"\ud83e\uddea Testes Unit\u00e1rios (ABAP Unit)","text":"<p>Aprenda a criar testes automatizados em ABAP para garantir qualidade, facilitar refatora\u00e7\u00e3o e documentar comportamento esperado do c\u00f3digo.</p>"},{"location":"testes/#o-que-vais-aprender","title":"\ud83d\udcd6 O que vais aprender","text":"<ul> <li>ABAP Unit Framework</li> <li>Estruturar classes de teste</li> <li>Assertions e verifica\u00e7\u00f5es</li> <li>Test Doubles (Mocks e Stubs)</li> <li>Inje\u00e7\u00e3o de depend\u00eancias</li> <li>Code Coverage</li> <li>Test-Driven Development (TDD)</li> <li>Boas pr\u00e1ticas de testes</li> </ul>"},{"location":"testes/#por-que-testar","title":"\ud83c\udfaf Por que Testar?","text":""},{"location":"testes/#beneficios","title":"Benef\u00edcios","text":"<p>\u2705 Detectar bugs cedo - Antes de chegar a produ\u00e7\u00e3o \u2705 Refatora\u00e7\u00e3o segura - Alterar c\u00f3digo com confian\u00e7a \u2705 Documenta\u00e7\u00e3o viva - Testes mostram como usar o c\u00f3digo \u2705 Design melhor - C\u00f3digo test\u00e1vel \u00e9 c\u00f3digo bem estruturado \u2705 Menos debugging - Testes automatizam verifica\u00e7\u00f5es \u2705 Regress\u00e3o - Garantir que corre\u00e7\u00f5es n\u00e3o quebram funcionalidades  </p>"},{"location":"testes/#topicos","title":"\ud83d\udcda T\u00f3picos","text":""},{"location":"testes/#1-abap-unit-basico","title":"1\ufe0f\u20e3 ABAP Unit B\u00e1sico","text":"<p>Primeiros passos com ABAP Unit.</p> <ul> <li>Anatomia de uma classe de teste</li> <li>Atributos <code>FOR TESTING</code>, <code>RISK LEVEL</code>, <code>DURATION</code></li> <li>Criar primeiro teste</li> <li>Executar testes (Ctrl+Shift+F10)</li> <li>Interpretar resultados</li> </ul>"},{"location":"testes/#2-test-fixtures","title":"2\ufe0f\u20e3 Test Fixtures","text":"<p>Preparar e limpar ambiente de teste.</p> <ul> <li>M\u00e9todos setup() e teardown()</li> <li>class_setup() e class_teardown()</li> <li>Ciclo de vida dos testes</li> <li>Dados de teste reutiliz\u00e1veis</li> </ul>"},{"location":"testes/#3-assertions","title":"3\ufe0f\u20e3 Assertions","text":"<p>Verifica\u00e7\u00f5es e valida\u00e7\u00f5es em testes.</p> <ul> <li>assert_equals / assert_not_equals</li> <li>assert_initial / assert_not_initial</li> <li>assert_bound / assert_not_bound</li> <li>assert_true / assert_false</li> <li>assert_subrc</li> <li>assert_table_contains</li> <li>Mensagens personalizadas</li> </ul>"},{"location":"testes/#4-test-doubles-e-mocking","title":"4\ufe0f\u20e3 Test Doubles e Mocking","text":"<p>Isolar c\u00f3digo sob teste.</p> <ul> <li>O que s\u00e3o Test Doubles</li> <li>ABAP Test Double Framework</li> <li>Mockar depend\u00eancias</li> <li>Stubs vs Mocks vs Fakes</li> <li>configure_call() e times()</li> </ul>"},{"location":"testes/#5-injecao-de-dependencias","title":"5\ufe0f\u20e3 Inje\u00e7\u00e3o de Depend\u00eancias","text":"<p>Tornar c\u00f3digo test\u00e1vel.</p> <ul> <li>Princ\u00edpio de Invers\u00e3o de Depend\u00eancia</li> <li>Interfaces para desacoplamento</li> <li>Constructor Injection</li> <li>Setter Injection</li> <li>Exemplos pr\u00e1ticos</li> </ul>"},{"location":"testes/#6-cobertura-de-codigo","title":"6\ufe0f\u20e3 Cobertura de C\u00f3digo","text":"<p>Medir qualidade dos testes.</p> <ul> <li>O que \u00e9 Code Coverage</li> <li>Visualizar no Eclipse ADT</li> <li>Coverage Analyzer (SCOV)</li> <li>Metas de cobertura (70-80%)</li> <li>Statement vs Branch coverage</li> </ul>"},{"location":"testes/#7-tdd-test-driven-development","title":"7\ufe0f\u20e3 TDD - Test Driven Development","text":"<p>Desenvolver orientado a testes.</p> <ul> <li>Ciclo Red-Green-Refactor</li> <li>Escrever teste antes do c\u00f3digo</li> <li>Baby steps</li> <li>Vantagens e desvantagens</li> <li>Exemplo completo TDD</li> </ul>"},{"location":"testes/#exemplo-rapido","title":"\ud83d\ude80 Exemplo R\u00e1pido","text":""},{"location":"testes/#classe-a-testar","title":"Classe a Testar","text":"<pre><code>CLASS zcl_calculator DEFINITION PUBLIC.\n  PUBLIC SECTION.\n    METHODS add\n      IMPORTING iv_a TYPE i\n                iv_b TYPE i\n      RETURNING VALUE(rv_result) TYPE i.\nENDCLASS.\n\nCLASS zcl_calculator IMPLEMENTATION.\n  METHOD add.\n    rv_result = iv_a + iv_b.\n  ENDMETHOD.\nENDCLASS.\n</code></pre>"},{"location":"testes/#classe-de-teste","title":"Classe de Teste","text":"<pre><code>CLASS ltc_calculator DEFINITION FOR TESTING\n  RISK LEVEL HARMLESS\n  DURATION SHORT.\n\n  PRIVATE SECTION.\n    DATA: mo_cut TYPE REF TO zcl_calculator.  \" Class Under Test\n\n    METHODS:\n      setup,\n      test_add_positive_numbers FOR TESTING.\nENDCLASS.\n\nCLASS ltc_calculator IMPLEMENTATION.\n  METHOD setup.\n    CREATE OBJECT mo_cut.\n  ENDMETHOD.\n\n  METHOD test_add_positive_numbers.\n    \" Arrange (preparar)\n    DATA(lv_a) = 5.\n    DATA(lv_b) = 3.\n\n    \" Act (executar)\n    DATA(lv_result) = mo_cut-&gt;add( iv_a = lv_a iv_b = lv_b ).\n\n    \" Assert (verificar)\n    cl_abap_unit_assert=&gt;assert_equals(\n      act = lv_result\n      exp = 8\n      msg = 'Soma de 5 + 3 deveria ser 8' ).\n  ENDMETHOD.\nENDCLASS.\n</code></pre> <p>Executar: Ctrl+Shift+F10 (Eclipse) ou F9 (SAP GUI)</p>"},{"location":"testes/#ferramentas","title":"\ud83d\udee0\ufe0f Ferramentas","text":""},{"location":"testes/#eclipse-adt-recomendado","title":"Eclipse ADT (Recomendado)","text":"<ul> <li>Ctrl+Shift+F10: Executar testes</li> <li>Ctrl+Shift+F11: Executar com coverage</li> <li>View de resultados integrada</li> <li>Coverage destacado no c\u00f3digo</li> </ul>"},{"location":"testes/#sap-gui","title":"SAP GUI","text":"<ul> <li>SE80/SE24: Editar classe</li> <li>F9: Executar testes (Unit Test)</li> <li>F8: Coverage Analyzer (SCOV)</li> </ul>"},{"location":"testes/#boas-praticas","title":"\u26a1 Boas Pr\u00e1ticas","text":""},{"location":"testes/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Nomes descritivos\nMETHOD test_add_returns_sum_of_two_numbers.\n\n\" 2. Arrange-Act-Assert pattern\nMETHOD test_something.\n  \" Arrange - preparar dados\n  DATA(lv_input) = 'test'.\n\n  \" Act - executar a\u00e7\u00e3o\n  DATA(lv_result) = mo_cut-&gt;process( lv_input ).\n\n  \" Assert - verificar resultado\n  cl_abap_unit_assert=&gt;assert_equals( act = lv_result exp = 'expected' ).\nENDMETHOD.\n\n\" 3. Um conceito por teste\nMETHOD test_validate_email_valid.\n  \" Testa APENAS emails v\u00e1lidos\nENDMETHOD.\n\nMETHOD test_validate_email_invalid.\n  \" Testa APENAS emails inv\u00e1lidos (teste separado)\nENDMETHOD.\n\n\" 4. Usar setup para c\u00f3digo comum\nMETHOD setup.\n  CREATE OBJECT mo_cut.\n  mo_cut-&gt;set_config( 'test_mode' ).\nENDMETHOD.\n\n\" 5. Mensagens claras\ncl_abap_unit_assert=&gt;assert_equals(\n  act = lv_count\n  exp = 5\n  msg = |Esperado 5 itens, mas encontrou { lv_count }| ).\n</code></pre>"},{"location":"testes/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Testes dependentes\nMETHOD test_step1.\n  mo_cut-&gt;create_order( ).  \" \u274c test_step2 depende deste\nENDMETHOD.\n\nMETHOD test_step2.\n  mo_cut-&gt;process_order( ).  \" \u274c Falha se test_step1 n\u00e3o executou\nENDMETHOD.\n\n\" 2. Testar implementa\u00e7\u00e3o, n\u00e3o comportamento\ncl_abap_unit_assert=&gt;assert_equals(\n  act = mo_cut-&gt;mv_internal_counter  \" \u274c Detalhe de implementa\u00e7\u00e3o\n  exp = 3 ).\n\n\" 3. Testes sem assertions\nMETHOD test_something.\n  mo_cut-&gt;process( ).  \" \u274c N\u00e3o verifica nada!\nENDMETHOD.\n\n\" 4. Muitas responsabilidades num teste\nMETHOD test_everything.\n  \" Testa valida\u00e7\u00e3o, processamento, grava\u00e7\u00e3o...  \u274c\nENDMETHOD.\n\n\" 5. Ignorar testes falhando\n\" \u274c Testes devem SEMPRE passar em produ\u00e7\u00e3o\n</code></pre>"},{"location":"testes/#estatisticas-de-qualidade","title":"\ud83c\udf93 Estat\u00edsticas de Qualidade","text":""},{"location":"testes/#metas-recomendadas","title":"Metas Recomendadas","text":"M\u00e9trica Meta Cr\u00edtico Code Coverage 70-80% &gt;60% Testes passando 100% 100% Tempo execu\u00e7\u00e3o &lt;5 min &lt;10 min Testes por classe 5-15 &gt;3"},{"location":"testes/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ol> <li>Comece com ABAP Unit B\u00e1sico - Primeiro teste</li> <li>Aprenda Assertions - Verifica\u00e7\u00f5es essenciais</li> <li>Pratique Test Fixtures - Setup e teardown</li> <li>Domine Test Doubles - Isolar depend\u00eancias</li> <li>Estude Inje\u00e7\u00e3o de Depend\u00eancias - C\u00f3digo test\u00e1vel</li> <li>Me\u00e7a com Code Coverage - Qualidade dos testes</li> <li>Experimente TDD - Teste antes do c\u00f3digo</li> </ol> <p>Tags: <code>#Testing</code> <code>#ABAP-Unit</code> <code>#TDD</code> <code>#Quality</code> <code>#Best-Practices</code></p>"},{"location":"testes/1_abap_unit_basico/","title":"ABAP Unit B\u00e1sico","text":"","tags":["ABAP","Testing","ABAP Unit","Unit Test"]},{"location":"testes/1_abap_unit_basico/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>ABAP Unit \u00e9 o framework de testes unit\u00e1rios integrado ao SAP NetWeaver, permitindo criar testes automatizados diretamente no c\u00f3digo ABAP.</p>","tags":["ABAP","Testing","ABAP Unit","Unit Test"]},{"location":"testes/1_abap_unit_basico/#o-que-e-um-teste-unitario","title":"\ud83c\udfaf O que \u00e9 um Teste Unit\u00e1rio?","text":"<p>Um teste unit\u00e1rio verifica uma pequena parte do c\u00f3digo (m\u00e9todo, fun\u00e7\u00e3o) de forma isolada, garantindo que funciona conforme esperado.</p> <p>Caracter\u00edsticas: - \u2705 R\u00e1pido (milissegundos) - \u2705 Isolado (n\u00e3o depende de BD, sistema externo) - \u2705 Repet\u00edvel (sempre mesmo resultado) - \u2705 Automatizado (executa sem interven\u00e7\u00e3o)</p>","tags":["ABAP","Testing","ABAP Unit","Unit Test"]},{"location":"testes/1_abap_unit_basico/#anatomia-de-uma-classe-de-teste","title":"\ud83c\udfd7\ufe0f Anatomia de uma Classe de Teste","text":"","tags":["ABAP","Testing","ABAP Unit","Unit Test"]},{"location":"testes/1_abap_unit_basico/#estrutura-basica","title":"Estrutura B\u00e1sica","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Include ou Classe de Teste\n*&amp;---------------------------------------------------------------------*\nCLASS ltc_my_test DEFINITION FOR TESTING\n  RISK LEVEL HARMLESS\n  DURATION SHORT.\n\n  PRIVATE SECTION.\n    DATA: mo_cut TYPE REF TO zcl_my_class.  \" Class Under Test\n\n    METHODS:\n      \" Executado antes de CADA teste\n      setup,\n\n      \" Testes (um m\u00e9todo por cen\u00e1rio)\n      test_scenario_1 FOR TESTING,\n      test_scenario_2 FOR TESTING.\n\nENDCLASS.\n\nCLASS ltc_my_test IMPLEMENTATION.\n\n  METHOD setup.\n    \" Preparar ambiente\n    CREATE OBJECT mo_cut.\n  ENDMETHOD.\n\n  METHOD test_scenario_1.\n    \" Arrange (preparar)\n    DATA(lv_input) = 'value'.\n\n    \" Act (executar)\n    DATA(lv_result) = mo_cut-&gt;process( lv_input ).\n\n    \" Assert (verificar)\n    cl_abap_unit_assert=&gt;assert_equals(\n      act = lv_result\n      exp = 'expected'\n      msg = 'Resultado diferente do esperado' ).\n  ENDMETHOD.\n\n  METHOD test_scenario_2.\n    \" Outro cen\u00e1rio de teste\n  ENDMETHOD.\n\nENDCLASS.\n</code></pre>","tags":["ABAP","Testing","ABAP Unit","Unit Test"]},{"location":"testes/1_abap_unit_basico/#atributos-de-teste","title":"\ud83c\udff7\ufe0f Atributos de Teste","text":"","tags":["ABAP","Testing","ABAP Unit","Unit Test"]},{"location":"testes/1_abap_unit_basico/#for-testing","title":"FOR TESTING","text":"<p>Marca m\u00e9todo como teste:</p> <pre><code>METHODS test_add_numbers FOR TESTING.\n</code></pre>","tags":["ABAP","Testing","ABAP Unit","Unit Test"]},{"location":"testes/1_abap_unit_basico/#risk-level","title":"RISK LEVEL","text":"<p>Indica risco se teste falhar:</p> <pre><code>CLASS ltc_test DEFINITION FOR TESTING\n  RISK LEVEL HARMLESS.    \" Sem risco\n  \" ou\n  RISK LEVEL DANGEROUS.   \" Pode afetar dados\n  \" ou\n  RISK LEVEL CRITICAL.    \" Pode causar danos graves\n</code></pre> Level Uso HARMLESS Testes puros, sem efeitos colaterais DANGEROUS Pode gravar em BD, chamar RFCs CRITICAL Pode alterar customizing, master data","tags":["ABAP","Testing","ABAP Unit","Unit Test"]},{"location":"testes/1_abap_unit_basico/#duration","title":"DURATION","text":"<p>Tempo esperado de execu\u00e7\u00e3o:</p> <pre><code>CLASS ltc_test DEFINITION FOR TESTING\n  DURATION SHORT.      \" &lt; 1 minuto\n  \" ou\n  DURATION MEDIUM.     \" 1-5 minutos\n  \" ou\n  DURATION LONG.       \" &gt; 5 minutos\n</code></pre> <p>Recomenda\u00e7\u00e3o: Mantenha testes SHORT sempre que poss\u00edvel!</p>","tags":["ABAP","Testing","ABAP Unit","Unit Test"]},{"location":"testes/1_abap_unit_basico/#padrao-arrange-act-assert-aaa","title":"\ud83c\udfa8 Padr\u00e3o Arrange-Act-Assert (AAA)","text":"<p>Estrutura padr\u00e3o para organizar testes:</p> <pre><code>METHOD test_calculate_discount.\n\n  \" \u2550\u2550\u2550 ARRANGE (Preparar) \u2550\u2550\u2550\n  \" Definir dados de entrada\n  DATA(lv_price) = 1000.\n  DATA(lv_discount_percent) = 10.\n\n  \" \u2550\u2550\u2550 ACT (Executar) \u2550\u2550\u2550\n  \" Chamar m\u00e9todo sob teste\n  DATA(lv_final_price) = mo_cut-&gt;calculate_discount(\n    iv_price    = lv_price\n    iv_discount = lv_discount_percent ).\n\n  \" \u2550\u2550\u2550 ASSERT (Verificar) \u2550\u2550\u2550\n  \" Validar resultado\n  cl_abap_unit_assert=&gt;assert_equals(\n    act = lv_final_price\n    exp = 900\n    msg = |Desconto de { lv_discount_percent }% em { lv_price } deveria ser 900| ).\n\nENDMETHOD.\n</code></pre>","tags":["ABAP","Testing","ABAP Unit","Unit Test"]},{"location":"testes/1_abap_unit_basico/#exemplo-completo-calculadora","title":"\ud83d\udca1 Exemplo Completo: Calculadora","text":"","tags":["ABAP","Testing","ABAP Unit","Unit Test"]},{"location":"testes/1_abap_unit_basico/#classe-a-testar","title":"Classe a Testar","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Classe: ZCL_CALCULATOR\n*&amp;---------------------------------------------------------------------*\nCLASS zcl_calculator DEFINITION PUBLIC FINAL CREATE PUBLIC.\n\n  PUBLIC SECTION.\n    METHODS:\n      add IMPORTING iv_a TYPE i\n                    iv_b TYPE i\n          RETURNING VALUE(rv_result) TYPE i,\n\n      subtract IMPORTING iv_a TYPE i\n                         iv_b TYPE i\n               RETURNING VALUE(rv_result) TYPE i,\n\n      divide IMPORTING iv_a TYPE i\n                       iv_b TYPE i\n             RETURNING VALUE(rv_result) TYPE f\n             RAISING   cx_sy_zerodivide.\n\nENDCLASS.\n\nCLASS zcl_calculator IMPLEMENTATION.\n\n  METHOD add.\n    rv_result = iv_a + iv_b.\n  ENDMETHOD.\n\n  METHOD subtract.\n    rv_result = iv_a - iv_b.\n  ENDMETHOD.\n\n  METHOD divide.\n    IF iv_b = 0.\n      RAISE EXCEPTION TYPE cx_sy_zerodivide.\n    ENDIF.\n    rv_result = iv_a / iv_b.\n  ENDMETHOD.\n\nENDCLASS.\n</code></pre>","tags":["ABAP","Testing","ABAP Unit","Unit Test"]},{"location":"testes/1_abap_unit_basico/#classe-de-teste","title":"Classe de Teste","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Testes: ZCL_CALCULATOR\n*&amp;---------------------------------------------------------------------*\nCLASS ltc_calculator DEFINITION FOR TESTING\n  RISK LEVEL HARMLESS\n  DURATION SHORT.\n\n  PRIVATE SECTION.\n    DATA: mo_calculator TYPE REF TO zcl_calculator.\n\n    METHODS:\n      setup,\n      test_add_positive_numbers FOR TESTING,\n      test_add_negative_numbers FOR TESTING,\n      test_subtract FOR TESTING,\n      test_divide_normal FOR TESTING,\n      test_divide_by_zero FOR TESTING.\n\nENDCLASS.\n\nCLASS ltc_calculator IMPLEMENTATION.\n\n  METHOD setup.\n    \" Executado antes de CADA teste\n    CREATE OBJECT mo_calculator.\n  ENDMETHOD.\n\n  METHOD test_add_positive_numbers.\n    \" Arrange\n    DATA(lv_a) = 5.\n    DATA(lv_b) = 3.\n\n    \" Act\n    DATA(lv_result) = mo_calculator-&gt;add( iv_a = lv_a iv_b = lv_b ).\n\n    \" Assert\n    cl_abap_unit_assert=&gt;assert_equals(\n      act = lv_result\n      exp = 8\n      msg = '5 + 3 deveria ser 8' ).\n  ENDMETHOD.\n\n  METHOD test_add_negative_numbers.\n    \" Arrange\n    DATA(lv_a) = -5.\n    DATA(lv_b) = 3.\n\n    \" Act\n    DATA(lv_result) = mo_calculator-&gt;add( iv_a = lv_a iv_b = lv_b ).\n\n    \" Assert\n    cl_abap_unit_assert=&gt;assert_equals(\n      act = lv_result\n      exp = -2\n      msg = '-5 + 3 deveria ser -2' ).\n  ENDMETHOD.\n\n  METHOD test_subtract.\n    \" Arrange\n    DATA(lv_a) = 10.\n    DATA(lv_b) = 4.\n\n    \" Act\n    DATA(lv_result) = mo_calculator-&gt;subtract( iv_a = lv_a iv_b = lv_b ).\n\n    \" Assert\n    cl_abap_unit_assert=&gt;assert_equals(\n      act = lv_result\n      exp = 6\n      msg = '10 - 4 deveria ser 6' ).\n  ENDMETHOD.\n\n  METHOD test_divide_normal.\n    \" Arrange\n    DATA(lv_a) = 10.\n    DATA(lv_b) = 2.\n\n    \" Act\n    DATA(lv_result) = mo_calculator-&gt;divide( iv_a = lv_a iv_b = lv_b ).\n\n    \" Assert\n    cl_abap_unit_assert=&gt;assert_equals(\n      act = lv_result\n      exp = '5.0'\n      msg = '10 / 2 deveria ser 5.0' ).\n  ENDMETHOD.\n\n  METHOD test_divide_by_zero.\n    \" Arrange\n    DATA(lv_a) = 10.\n    DATA(lv_b) = 0.\n\n    \" Act &amp; Assert (espera exce\u00e7\u00e3o)\n    TRY.\n        DATA(lv_result) = mo_calculator-&gt;divide( iv_a = lv_a iv_b = lv_b ).\n\n        \" Se chegou aqui, n\u00e3o lan\u00e7ou exce\u00e7\u00e3o (FALHA!)\n        cl_abap_unit_assert=&gt;fail(\n          msg = 'Deveria lan\u00e7ar exce\u00e7\u00e3o ao dividir por zero' ).\n\n      CATCH cx_sy_zerodivide.\n        \" Sucesso! Exce\u00e7\u00e3o foi lan\u00e7ada como esperado\n    ENDTRY.\n  ENDMETHOD.\n\nENDCLASS.\n</code></pre>","tags":["ABAP","Testing","ABAP Unit","Unit Test"]},{"location":"testes/1_abap_unit_basico/#executar-testes","title":"\u25b6\ufe0f Executar Testes","text":"","tags":["ABAP","Testing","ABAP Unit","Unit Test"]},{"location":"testes/1_abap_unit_basico/#eclipse-adt-recomendado","title":"Eclipse ADT (Recomendado)","text":"<ol> <li>Abrir classe no editor</li> <li>Ctrl+Shift+F10 - Executar testes</li> <li>Ver resultados na view \"ABAP Unit\"</li> </ol> <p>Atalhos: - <code>Ctrl+Shift+F10</code> - Run Unit Tests - <code>Ctrl+Shift+F11</code> - Run with Coverage - <code>F5</code> - Re-run Last Test</p>","tags":["ABAP","Testing","ABAP Unit","Unit Test"]},{"location":"testes/1_abap_unit_basico/#sap-gui","title":"SAP GUI","text":"<ol> <li>SE80 ou SE24 - Abrir classe</li> <li>Classe \u2192 Executar \u2192 Testes Unit\u00e1rios (ou <code>F9</code>)</li> <li>Ver resultados na janela popup</li> </ol>","tags":["ABAP","Testing","ABAP Unit","Unit Test"]},{"location":"testes/1_abap_unit_basico/#interpretar-resultados","title":"\ud83d\udcca Interpretar Resultados","text":"","tags":["ABAP","Testing","ABAP Unit","Unit Test"]},{"location":"testes/1_abap_unit_basico/#testes-passando","title":"Testes Passando \u2705","text":"<pre><code>Run: 5 tests\nStatus: OK (Green)\nDuration: 0.023s\n</code></pre>","tags":["ABAP","Testing","ABAP Unit","Unit Test"]},{"location":"testes/1_abap_unit_basico/#testes-falhando","title":"Testes Falhando \u274c","text":"<pre><code>Run: 5 tests\nFailed: 1\nDuration: 0.031s\n\ntest_add_positive_numbers - FAILED\n  Expected: 8\n  Actual: 7\n  Message: 5 + 3 deveria ser 8\n</code></pre>","tags":["ABAP","Testing","ABAP Unit","Unit Test"]},{"location":"testes/1_abap_unit_basico/#onde-colocar-testes","title":"\ud83c\udfaf Onde Colocar Testes?","text":"","tags":["ABAP","Testing","ABAP Unit","Unit Test"]},{"location":"testes/1_abap_unit_basico/#opcao-1-test-include-classes-globais","title":"Op\u00e7\u00e3o 1: Test Include (Classes Globais)","text":"<pre><code>ZCL_MY_CLASS\n\u251c\u2500\u2500 Definitions\n\u251c\u2500\u2500 Implementations\n\u2514\u2500\u2500 Test Classes (Include Autom\u00e1tico)\n</code></pre> <p>Vantagem: Testes junto com c\u00f3digo Uso: Classes globais (SE24)</p>","tags":["ABAP","Testing","ABAP Unit","Unit Test"]},{"location":"testes/1_abap_unit_basico/#opcao-2-include-separado-reports","title":"Op\u00e7\u00e3o 2: Include Separado (Reports)","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Report Z_MY_REPORT\n*&amp;---------------------------------------------------------------------*\nREPORT z_my_report.\n\n\" ... c\u00f3digo do report ...\n\n*&amp;---------------------------------------------------------------------*\n*&amp; Test Include\n*&amp;---------------------------------------------------------------------*\nINCLUDE z_my_report_test IF FOUND.\n</code></pre> <p>Arquivo: Z_MY_REPORT_TEST <pre><code>CLASS ltc_test DEFINITION FOR TESTING ...\n</code></pre></p>","tags":["ABAP","Testing","ABAP Unit","Unit Test"]},{"location":"testes/1_abap_unit_basico/#opcao-3-classe-de-teste-separada","title":"Op\u00e7\u00e3o 3: Classe de Teste Separada","text":"<pre><code>\" Classe principal: ZCL_ORDER_PROCESSOR\n\" Classe de teste: ZCL_ORDER_PROCESSOR_TEST (sufixo _TEST)\n</code></pre> <p>Uso: Testes muito complexos</p>","tags":["ABAP","Testing","ABAP Unit","Unit Test"]},{"location":"testes/1_abap_unit_basico/#boas-praticas","title":"\u26a1 Boas Pr\u00e1ticas","text":"","tags":["ABAP","Testing","ABAP Unit","Unit Test"]},{"location":"testes/1_abap_unit_basico/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Nomes descritivos\nMETHOD test_calculate_discount_returns_reduced_price.\n\n\" 2. Um assert por teste (ideal)\ncl_abap_unit_assert=&gt;assert_equals( act = lv_result exp = 100 ).\n\n\" 3. Sempre limpar em teardown\nMETHOD teardown.\n  CLEAR mo_cut.\n  \" Deletar dados tempor\u00e1rios\nENDMETHOD.\n\n\" 4. Testar casos extremos\nMETHOD test_add_max_integer.\n  \" Testa limite superior\nENDMETHOD.\n\nMETHOD test_add_zero.\n  \" Testa zero\nENDMETHOD.\n\n\" 5. Mensagens informativas\ncl_abap_unit_assert=&gt;assert_equals(\n  act = lv_count\n  exp = 5\n  msg = |Esperava 5 itens mas encontrou { lv_count }| ).\n</code></pre>","tags":["ABAP","Testing","ABAP Unit","Unit Test"]},{"location":"testes/1_abap_unit_basico/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Nomes gen\u00e9ricos\nMETHOD test1.  \" \u274c N\u00e3o diz o que testa\n\n\" 2. Muitas responsabilidades\nMETHOD test_everything.\n  \" Testa 10 coisas diferentes  \u274c\nENDMETHOD.\n\n\" 3. Depend\u00eancias externas\nMETHOD test_read_database.\n  SELECT * FROM kna1...  \" \u274c N\u00e3o \u00e9 teste unit\u00e1rio!\nENDMETHOD.\n\n\" 4. Sem assertions\nMETHOD test_process.\n  mo_cut-&gt;process( ).  \" \u274c N\u00e3o verifica nada\nENDMETHOD.\n\n\" 5. Testes interdependentes\nDATA: gv_shared_state.  \" \u274c Testes compartilhando estado\n</code></pre>","tags":["ABAP","Testing","ABAP Unit","Unit Test"]},{"location":"testes/1_abap_unit_basico/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>Test Fixtures - Setup e teardown avan\u00e7ados</li> <li>Assertions - Todas as verifica\u00e7\u00f5es dispon\u00edveis</li> <li>Test Doubles - Mockar depend\u00eancias</li> </ul> <p>Tags: <code>#ABAP-Unit</code> <code>#Testing</code> <code>#Basics</code> <code>#AAA-Pattern</code></p>","tags":["ABAP","Testing","ABAP Unit","Unit Test"]},{"location":"testes/2_test_fixtures/","title":"Test Fixtures","text":"","tags":["ABAP","Testing","Test Fixtures","Setup"]},{"location":"testes/2_test_fixtures/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Test Fixtures s\u00e3o m\u00e9todos especiais que preparam e limpam o ambiente de teste, garantindo que cada teste execute em condi\u00e7\u00f5es controladas.</p>","tags":["ABAP","Testing","Test Fixtures","Setup"]},{"location":"testes/2_test_fixtures/#ciclo-de-vida-dos-testes","title":"\ud83d\udd04 Ciclo de Vida dos Testes","text":"<pre><code>class_setup()           \u2190 Executado 1x antes de TODOS os testes\n    \u2193\n    setup()             \u2190 Executado antes de CADA teste\n        \u2193\n        test_1()        \u2190 Teste 1\n        \u2193\n    teardown()          \u2190 Executado ap\u00f3s CADA teste\n    \u2193\n    setup()\n        \u2193\n        test_2()        \u2190 Teste 2\n        \u2193\n    teardown()\n    \u2193\nclass_teardown()        \u2190 Executado 1x ap\u00f3s TODOS os testes\n</code></pre>","tags":["ABAP","Testing","Test Fixtures","Setup"]},{"location":"testes/2_test_fixtures/#metodos-de-fixture","title":"\ud83d\udee0\ufe0f M\u00e9todos de Fixture","text":"","tags":["ABAP","Testing","Test Fixtures","Setup"]},{"location":"testes/2_test_fixtures/#setup","title":"setup()","text":"<p>Executado antes de cada teste.</p> <pre><code>CLASS ltc_test DEFINITION FOR TESTING\n  RISK LEVEL HARMLESS\n  DURATION SHORT.\n\n  PRIVATE SECTION.\n    DATA: mo_cut TYPE REF TO zcl_order_processor.\n\n    METHODS:\n      setup,\n      test_process_order FOR TESTING,\n      test_cancel_order FOR TESTING.\n\nENDCLASS.\n\nCLASS ltc_test IMPLEMENTATION.\n\n  METHOD setup.\n    \" Executado antes de test_process_order\n    \" E novamente antes de test_cancel_order\n\n    CREATE OBJECT mo_cut.\n    mo_cut-&gt;set_mode( 'TEST' ).\n  ENDMETHOD.\n\n  METHOD test_process_order.\n    \" mo_cut j\u00e1 est\u00e1 criado e configurado\n    DATA(lv_result) = mo_cut-&gt;process( '12345' ).\n    cl_abap_unit_assert=&gt;assert_equals( act = lv_result exp = 'OK' ).\n  ENDMETHOD.\n\n  METHOD test_cancel_order.\n    \" mo_cut recriado novamente (isolamento!)\n    DATA(lv_result) = mo_cut-&gt;cancel( '12345' ).\n    cl_abap_unit_assert=&gt;assert_equals( act = lv_result exp = 'CANCELLED' ).\n  ENDMETHOD.\n\nENDCLASS.\n</code></pre> <p>Uso: Criar objetos, inicializar dados comuns a todos os testes.</p>","tags":["ABAP","Testing","Test Fixtures","Setup"]},{"location":"testes/2_test_fixtures/#teardown","title":"teardown()","text":"<p>Executado ap\u00f3s cada teste.</p> <pre><code>METHOD teardown.\n  \" Limpar ap\u00f3s cada teste\n  CLEAR mo_cut.\n\n  \" Deletar dados tempor\u00e1rios\n  DELETE FROM ztmp_test WHERE session_id = gv_session_id.\n\n  \" Liberar recursos\n  IF mo_connection IS BOUND.\n    mo_connection-&gt;close( ).\n  ENDIF.\nENDMETHOD.\n</code></pre> <p>Uso: Limpar mem\u00f3ria, deletar dados tempor\u00e1rios, fechar conex\u00f5es.</p>","tags":["ABAP","Testing","Test Fixtures","Setup"]},{"location":"testes/2_test_fixtures/#class_setup","title":"class_setup()","text":"<p>Executado 1 vez antes de todos os testes da classe.</p> <pre><code>CLASS ltc_test DEFINITION FOR TESTING\n  RISK LEVEL HARMLESS\n  DURATION SHORT.\n\n  PRIVATE SECTION.\n    CLASS-DATA: go_shared_config TYPE REF TO zcl_config.\n\n    CLASS-METHODS:\n      class_setup,\n      class_teardown.\n\n    METHODS:\n      test_scenario_1 FOR TESTING,\n      test_scenario_2 FOR TESTING.\n\nENDCLASS.\n\nCLASS ltc_test IMPLEMENTATION.\n\n  METHOD class_setup.\n    \" Executado 1x no in\u00edcio\n    \" Opera\u00e7\u00f5es pesadas/lentas aqui\n\n    CREATE OBJECT go_shared_config.\n    go_shared_config-&gt;load_from_file( '/tmp/test_config.json' ).\n\n    \" Criar dados master de teste\n    INSERT ztmp_test_data FROM TABLE @gt_master_data.\n  ENDMETHOD.\n\n  METHOD class_teardown.\n    \" Executado 1x no final\n    DELETE FROM ztmp_test_data WHERE test_session = 'ABC123'.\n  ENDMETHOD.\n\nENDCLASS.\n</code></pre> <p>Uso: Setup pesado (carregar configs, criar master data), compartilhado entre testes.</p> <p>\u26a0\ufe0f Cuidado: Dados compartilhados podem causar depend\u00eancias entre testes!</p>","tags":["ABAP","Testing","Test Fixtures","Setup"]},{"location":"testes/2_test_fixtures/#class_teardown","title":"class_teardown()","text":"<p>Executado 1 vez ap\u00f3s todos os testes da classe.</p> <pre><code>METHOD class_teardown.\n  \" Limpar dados criados em class_setup\n  DELETE FROM ztmp_test_master WHERE session_id = gv_session_id.\n\n  \" Fechar conex\u00f5es globais\n  CLEAR go_shared_config.\nENDMETHOD.\n</code></pre>","tags":["ABAP","Testing","Test Fixtures","Setup"]},{"location":"testes/2_test_fixtures/#exemplo-completo","title":"\ud83d\udca1 Exemplo Completo","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; Teste com Fixtures Completo\n*&amp;---------------------------------------------------------------------*\nCLASS ltc_order_test DEFINITION FOR TESTING\n  RISK LEVEL HARMLESS\n  DURATION SHORT.\n\n  PRIVATE SECTION.\n    \" Dados de inst\u00e2ncia (recriados em cada teste)\n    DATA: mo_processor TYPE REF TO zcl_order_processor,\n          mv_order_id  TYPE vbeln.\n\n    \" Dados de classe (compartilhados)\n    CLASS-DATA: gt_test_customers TYPE TABLE OF kna1,\n                gv_session_id     TYPE char32.\n\n    CLASS-METHODS:\n      class_setup,\n      class_teardown.\n\n    METHODS:\n      setup,\n      teardown,\n      test_create_order FOR TESTING,\n      test_cancel_order FOR TESTING.\n\nENDCLASS.\n\nCLASS ltc_order_test IMPLEMENTATION.\n\n  \" \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n  \" CLASS FIXTURES (executam 1x para toda classe)\n  \" \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n  METHOD class_setup.\n    \" Gerar ID \u00fanico para sess\u00e3o de teste\n    gv_session_id = cl_system_uuid=&gt;create_uuid_c32_static( ).\n\n    \" Criar clientes de teste\n    gt_test_customers = VALUE #(\n      ( kunnr = '0000100001' name1 = 'Test Customer 1' land1 = 'PT' )\n      ( kunnr = '0000100002' name1 = 'Test Customer 2' land1 = 'BR' )\n    ).\n\n    \" Inserir em tabela tempor\u00e1ria\n    INSERT kna1 FROM TABLE @gt_test_customers.\n\n    WRITE: / |Class Setup - Sess\u00e3o: { gv_session_id }|.\n  ENDMETHOD.\n\n  METHOD class_teardown.\n    \" Deletar clientes de teste\n    DELETE FROM kna1 WHERE kunnr IN ( '0000100001', '0000100002' ).\n\n    WRITE: / 'Class Teardown - Limpeza completa'.\n  ENDMETHOD.\n\n  \" \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n  \" INSTANCE FIXTURES (executam antes/depois de CADA teste)\n  \" \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n  METHOD setup.\n    \" Criar nova inst\u00e2ncia para cada teste (isolamento)\n    CREATE OBJECT mo_processor.\n\n    \" Gerar novo order ID\n    mv_order_id = |TEST{ sy-datum }{ sy-uzeit }|.\n\n    WRITE: / |Setup - Teste iniciando com ordem { mv_order_id }|.\n  ENDMETHOD.\n\n  METHOD teardown.\n    \" Limpar dados da ordem\n    DELETE FROM vbak WHERE vbeln = mv_order_id.\n    DELETE FROM vbap WHERE vbeln = mv_order_id.\n\n    \" Liberar objeto\n    CLEAR mo_processor.\n\n    WRITE: / |Teardown - Ordem { mv_order_id } limpa|.\n  ENDMETHOD.\n\n  \" \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n  \" TESTES\n  \" \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n  METHOD test_create_order.\n    \" Arrange\n    DATA(lv_customer) = gt_test_customers[ 1 ]-kunnr.\n\n    \" Act\n    DATA(lv_result) = mo_processor-&gt;create_order(\n      iv_order_id  = mv_order_id\n      iv_customer  = lv_customer\n      iv_material  = 'MAT001'\n      iv_quantity  = 10 ).\n\n    \" Assert\n    cl_abap_unit_assert=&gt;assert_equals(\n      act = lv_result\n      exp = 'SUCCESS'\n      msg = |Cria\u00e7\u00e3o de ordem { mv_order_id } deveria ter sucesso| ).\n\n    \" Verificar que ordem foi criada no BD\n    SELECT SINGLE @abap_true FROM vbak\n      WHERE vbeln = @mv_order_id\n      INTO @DATA(lv_exists).\n\n    cl_abap_unit_assert=&gt;assert_true(\n      act = lv_exists\n      msg = 'Ordem deveria existir no BD' ).\n  ENDMETHOD.\n\n  METHOD test_cancel_order.\n    \" Arrange - Criar ordem primeiro\n    mo_processor-&gt;create_order(\n      iv_order_id  = mv_order_id\n      iv_customer  = gt_test_customers[ 1 ]-kunnr\n      iv_material  = 'MAT001'\n      iv_quantity  = 5 ).\n\n    \" Act - Cancelar\n    DATA(lv_result) = mo_processor-&gt;cancel_order( mv_order_id ).\n\n    \" Assert\n    cl_abap_unit_assert=&gt;assert_equals(\n      act = lv_result\n      exp = 'CANCELLED'\n      msg = 'Cancelamento deveria ter sucesso' ).\n  ENDMETHOD.\n\nENDCLASS.\n</code></pre>","tags":["ABAP","Testing","Test Fixtures","Setup"]},{"location":"testes/2_test_fixtures/#boas-praticas","title":"\u26a1 Boas Pr\u00e1ticas","text":"","tags":["ABAP","Testing","Test Fixtures","Setup"]},{"location":"testes/2_test_fixtures/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Setup m\u00ednimo necess\u00e1rio\nMETHOD setup.\n  CREATE OBJECT mo_cut.  \" \u2705 Apenas o essencial\nENDMETHOD.\n\n\" 2. Sempre limpar em teardown\nMETHOD teardown.\n  DELETE FROM ztmp_test WHERE session_id = gv_session.  \" \u2705\n  CLEAR mo_cut.\nENDMETHOD.\n\n\" 3. Usar class_setup para opera\u00e7\u00f5es pesadas\nMETHOD class_setup.\n  \" \u2705 Carregar config 1x, n\u00e3o a cada teste\n  go_config-&gt;load_from_file( '/config/test.json' ).\nENDMETHOD.\n\n\" 4. Cada teste deve ser independente\nMETHOD setup.\n  CREATE OBJECT mo_cut.  \" \u2705 Nova inst\u00e2ncia = isolamento\nENDMETHOD.\n\n\" 5. Dados de teste descritivos\ngt_test_customers = VALUE #(\n  ( kunnr = 'TESTCUST01' name1 = 'Valid Customer' )  \" \u2705 Nome claro\n).\n</code></pre>","tags":["ABAP","Testing","Test Fixtures","Setup"]},{"location":"testes/2_test_fixtures/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Setup complexo demais\nMETHOD setup.\n  \" \u274c Muita l\u00f3gica = testes lentos\n  DO 1000 TIMES.\n    \" processar...\n  ENDDO.\nENDMETHOD.\n\n\" 2. Compartilhar estado mut\u00e1vel\nCLASS-DATA: go_shared TYPE REF TO zcl_processor.  \" \u274c Perigoso!\n\nMETHOD test_1.\n  go_shared-&gt;set_value( 'A' ).  \" Afeta test_2!\nENDMETHOD.\n\n\" 3. N\u00e3o limpar ap\u00f3s testes\nMETHOD teardown.\n  \" \u274c Vazio! Dados ficam na BD\nENDMETHOD.\n\n\" 4. Testes dependentes\nMETHOD test_step1.\n  gv_order_id = mo_cut-&gt;create( ).  \" \u274c test_step2 depende\nENDMETHOD.\n\nMETHOD test_step2.\n  mo_cut-&gt;process( gv_order_id ).  \" \u274c Falha se test_step1 n\u00e3o executou\nENDMETHOD.\n</code></pre>","tags":["ABAP","Testing","Test Fixtures","Setup"]},{"location":"testes/2_test_fixtures/#quando-usar-cada-fixture","title":"\ud83c\udfaf Quando Usar Cada Fixture","text":"Fixture Quando Usar Exemplo setup() Sempre! Prepara\u00e7\u00e3o padr\u00e3o Criar objetos, inicializar vari\u00e1veis teardown() Quando grava em BD/arquivo Deletar dados tempor\u00e1rios class_setup() Opera\u00e7\u00f5es pesadas/lentas Carregar configs, criar master data class_teardown() Limpar dados globais Deletar master data de teste","tags":["ABAP","Testing","Test Fixtures","Setup"]},{"location":"testes/2_test_fixtures/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>ABAP Unit B\u00e1sico - Fundamentos</li> <li>Assertions - Verifica\u00e7\u00f5es</li> <li>Test Doubles - Mockar depend\u00eancias</li> </ul> <p>Tags: <code>#Test-Fixtures</code> <code>#Setup</code> <code>#Teardown</code> <code>#Test-Lifecycle</code></p>","tags":["ABAP","Testing","Test Fixtures","Setup"]},{"location":"testes/3_assertions/","title":"Assertions","text":"","tags":["ABAP","Testing","Assertions","Verification"]},{"location":"testes/3_assertions/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Assertions s\u00e3o verifica\u00e7\u00f5es que determinam se um teste passou ou falhou. Classe <code>cl_abap_unit_assert</code> fornece m\u00e9todos est\u00e1ticos para validar resultados.</p>","tags":["ABAP","Testing","Assertions","Verification"]},{"location":"testes/3_assertions/#assertions-principais","title":"\u2705 Assertions Principais","text":"","tags":["ABAP","Testing","Assertions","Verification"]},{"location":"testes/3_assertions/#assert_equals","title":"assert_equals","text":"<p>Verifica se dois valores s\u00e3o iguais.</p> <pre><code>cl_abap_unit_assert=&gt;assert_equals(\n  act = lv_resultado     \" Valor atual\n  exp = lv_esperado      \" Valor esperado\n  msg = 'Mensagem de erro se falhar' ).\n\n\" Exemplo\nDATA(lv_soma) = 5 + 3.\n\ncl_abap_unit_assert=&gt;assert_equals(\n  act = lv_soma\n  exp = 8\n  msg = '5 + 3 deveria ser 8' ).\n</code></pre>","tags":["ABAP","Testing","Assertions","Verification"]},{"location":"testes/3_assertions/#assert_not_equals","title":"assert_not_equals","text":"<p>Verifica se dois valores s\u00e3o diferentes.</p> <pre><code>cl_abap_unit_assert=&gt;assert_not_equals(\n  act = lv_new_id\n  exp = lv_old_id\n  msg = 'Novo ID deveria ser diferente do antigo' ).\n</code></pre>","tags":["ABAP","Testing","Assertions","Verification"]},{"location":"testes/3_assertions/#assert_true-assert_false","title":"assert_true / assert_false","text":"<p>Verifica condi\u00e7\u00e3o booleana.</p> <pre><code>\" assert_true\ncl_abap_unit_assert=&gt;assert_true(\n  act = lv_is_valid\n  msg = 'Valida\u00e7\u00e3o deveria retornar true' ).\n\n\" assert_false\ncl_abap_unit_assert=&gt;assert_false(\n  act = lv_has_errors\n  msg = 'N\u00e3o deveria ter erros' ).\n</code></pre>","tags":["ABAP","Testing","Assertions","Verification"]},{"location":"testes/3_assertions/#assert_initial-assert_not_initial","title":"assert_initial / assert_not_initial","text":"<p>Verifica se vari\u00e1vel est\u00e1 vazia ou preenchida.</p> <pre><code>\" assert_initial (vazio)\ncl_abap_unit_assert=&gt;assert_initial(\n  act = lv_result\n  msg = 'Resultado deveria estar vazio' ).\n\n\" assert_not_initial (preenchido)\ncl_abap_unit_assert=&gt;assert_not_initial(\n  act = lv_customer_id\n  msg = 'Customer ID n\u00e3o deveria estar vazio' ).\n</code></pre>","tags":["ABAP","Testing","Assertions","Verification"]},{"location":"testes/3_assertions/#assert_bound-assert_not_bound","title":"assert_bound / assert_not_bound","text":"<p>Verifica se refer\u00eancia est\u00e1 atribu\u00edda.</p> <pre><code>\" assert_bound (objeto existe)\ncl_abap_unit_assert=&gt;assert_bound(\n  act = mo_processor\n  msg = 'Objeto deveria estar criado' ).\n\n\" assert_not_bound (objeto n\u00e3o existe)\ncl_abap_unit_assert=&gt;assert_not_bound(\n  act = mo_connection\n  msg = 'Conex\u00e3o n\u00e3o deveria estar ativa' ).\n</code></pre>","tags":["ABAP","Testing","Assertions","Verification"]},{"location":"testes/3_assertions/#assert_subrc","title":"assert_subrc","text":"<p>Verifica sy-subrc.</p> <pre><code>SELECT SINGLE * FROM kna1\n  WHERE kunnr = lv_customer\n  INTO @DATA(ls_customer).\n\ncl_abap_unit_assert=&gt;assert_subrc(\n  act = sy-subrc\n  exp = 0\n  msg = |Cliente { lv_customer } deveria existir| ).\n</code></pre>","tags":["ABAP","Testing","Assertions","Verification"]},{"location":"testes/3_assertions/#assert_table_contains","title":"assert_table_contains","text":"<p>Verifica se tabela cont\u00e9m linha espec\u00edfica.</p> <pre><code>cl_abap_unit_assert=&gt;assert_table_contains(\n  line  = VALUE ty_customer( kunnr = '100001' name1 = 'Test' )\n  table = lt_customers\n  msg   = 'Cliente de teste deveria estar na tabela' ).\n</code></pre>","tags":["ABAP","Testing","Assertions","Verification"]},{"location":"testes/3_assertions/#assert_differs","title":"assert_differs","text":"<p>Verifica se valores s\u00e3o fisicamente diferentes (n\u00e3o apenas conte\u00fado).</p> <pre><code>DATA: lv_ref1 TYPE REF TO data,\n      lv_ref2 TYPE REF TO data.\n\nCREATE DATA lv_ref1.\nCREATE DATA lv_ref2.\n\ncl_abap_unit_assert=&gt;assert_differs(\n  act = lv_ref1\n  exp = lv_ref2\n  msg = 'Deveriam ser refer\u00eancias diferentes' ).\n</code></pre>","tags":["ABAP","Testing","Assertions","Verification"]},{"location":"testes/3_assertions/#fail","title":"\ud83d\udea8 fail()","text":"<p>For\u00e7ar falha do teste.</p> <pre><code>IF lv_error_occurred = abap_true.\n  cl_abap_unit_assert=&gt;fail(\n    msg = 'Opera\u00e7\u00e3o n\u00e3o deveria ter falhado' ).\nENDIF.\n\n\" Uso comum: verificar se exce\u00e7\u00e3o foi lan\u00e7ada\nTRY.\n    mo_cut-&gt;dangerous_operation( ).\n\n    \" Se chegou aqui, n\u00e3o lan\u00e7ou exce\u00e7\u00e3o = FALHA\n    cl_abap_unit_assert=&gt;fail(\n      msg = 'Deveria ter lan\u00e7ado exce\u00e7\u00e3o' ).\n\n  CATCH cx_custom_error.\n    \" OK - exce\u00e7\u00e3o foi lan\u00e7ada\nENDTRY.\n</code></pre>","tags":["ABAP","Testing","Assertions","Verification"]},{"location":"testes/3_assertions/#exemplos-praticos","title":"\ud83d\udca1 Exemplos Pr\u00e1ticos","text":"","tags":["ABAP","Testing","Assertions","Verification"]},{"location":"testes/3_assertions/#teste-com-multiplas-assertions","title":"Teste com M\u00faltiplas Assertions","text":"<pre><code>METHOD test_create_order.\n  \" Arrange\n  DATA(lv_customer) = '100001'.\n\n  \" Act\n  DATA(ls_order) = mo_cut-&gt;create_order(\n    iv_customer = lv_customer\n    iv_material = 'MAT001'\n    iv_quantity = 10 ).\n\n  \" Assert - m\u00faltiplas verifica\u00e7\u00f5es\n  cl_abap_unit_assert=&gt;assert_not_initial(\n    act = ls_order-vbeln\n    msg = 'Order ID deveria ser gerado' ).\n\n  cl_abap_unit_assert=&gt;assert_equals(\n    act = ls_order-kunnr\n    exp = lv_customer\n    msg = 'Customer deveria ser o mesmo' ).\n\n  cl_abap_unit_assert=&gt;assert_equals(\n    act = ls_order-status\n    exp = 'NEW'\n    msg = 'Status inicial deveria ser NEW' ).\n\n  cl_abap_unit_assert=&gt;assert_true(\n    act = xsdbool( ls_order-netwr &gt; 0 )\n    msg = 'Valor l\u00edquido deveria ser maior que zero' ).\nENDMETHOD.\n</code></pre>","tags":["ABAP","Testing","Assertions","Verification"]},{"location":"testes/3_assertions/#testar-excecoes","title":"Testar Exce\u00e7\u00f5es","text":"<pre><code>METHOD test_divide_by_zero_raises_exception.\n  \" Arrange\n  DATA(lv_a) = 10.\n  DATA(lv_b) = 0.\n\n  \" Act &amp; Assert\n  TRY.\n      DATA(lv_result) = mo_calculator-&gt;divide( iv_a = lv_a iv_b = lv_b ).\n\n      \" Se chegou aqui = FALHA\n      cl_abap_unit_assert=&gt;fail(\n        msg = 'Deveria lan\u00e7ar cx_sy_zerodivide' ).\n\n    CATCH cx_sy_zerodivide.\n      \" Sucesso! Exce\u00e7\u00e3o esperada foi lan\u00e7ada\n  ENDTRY.\nENDMETHOD.\n</code></pre>","tags":["ABAP","Testing","Assertions","Verification"]},{"location":"testes/3_assertions/#testar-tabelas","title":"Testar Tabelas","text":"<pre><code>METHOD test_filter_returns_correct_items.\n  \" Arrange\n  DATA(lt_input) = VALUE ty_items_tab(\n    ( id = '1' status = 'ACTIVE' )\n    ( id = '2' status = 'INACTIVE' )\n    ( id = '3' status = 'ACTIVE' )\n  ).\n\n  \" Act\n  DATA(lt_result) = mo_cut-&gt;filter_active( lt_input ).\n\n  \" Assert\n  cl_abap_unit_assert=&gt;assert_equals(\n    act = lines( lt_result )\n    exp = 2\n    msg = 'Deveria retornar 2 itens ativos' ).\n\n  \" Verificar conte\u00fado\n  cl_abap_unit_assert=&gt;assert_table_contains(\n    line  = VALUE ty_item( id = '1' status = 'ACTIVE' )\n    table = lt_result\n    msg   = 'Deveria conter item 1' ).\n\n  cl_abap_unit_assert=&gt;assert_table_contains(\n    line  = VALUE ty_item( id = '3' status = 'ACTIVE' )\n    table = lt_result\n    msg   = 'Deveria conter item 3' ).\nENDMETHOD.\n</code></pre>","tags":["ABAP","Testing","Assertions","Verification"]},{"location":"testes/3_assertions/#comparar-estruturas","title":"Comparar Estruturas","text":"<pre><code>METHOD test_calculate_returns_correct_structure.\n  \" Arrange\n  DATA(lv_price) = 1000.\n  DATA(lv_tax_rate) = '0.23'.\n\n  \" Act\n  DATA(ls_result) = mo_cut-&gt;calculate_with_tax(\n    iv_price    = lv_price\n    iv_tax_rate = lv_tax_rate ).\n\n  \" Assert - estrutura esperada\n  DATA(ls_expected) = VALUE ty_result(\n    net_price   = 1000\n    tax_amount  = 230\n    gross_price = 1230\n    currency    = 'EUR' ).\n\n  cl_abap_unit_assert=&gt;assert_equals(\n    act = ls_result\n    exp = ls_expected\n    msg = 'C\u00e1lculo deveria retornar estrutura correta' ).\nENDMETHOD.\n</code></pre>","tags":["ABAP","Testing","Assertions","Verification"]},{"location":"testes/3_assertions/#tabela-de-assertions","title":"\ud83d\udcca Tabela de Assertions","text":"Assertion Uso Exemplo <code>assert_equals</code> Igualdade <code>act = 8, exp = 8</code> <code>assert_not_equals</code> Diferen\u00e7a <code>act = 'A', exp = 'B'</code> <code>assert_true</code> Condi\u00e7\u00e3o verdadeira <code>act = abap_true</code> <code>assert_false</code> Condi\u00e7\u00e3o falsa <code>act = abap_false</code> <code>assert_initial</code> Valor vazio <code>act = ''</code> <code>assert_not_initial</code> Valor preenchido <code>act = 'XYZ'</code> <code>assert_bound</code> Objeto existe <code>act = mo_obj</code> <code>assert_not_bound</code> Objeto n\u00e3o existe <code>act = mo_null</code> <code>assert_subrc</code> sy-subrc <code>act = 0, exp = 0</code> <code>assert_table_contains</code> Linha em tabela <code>line in table</code> <code>assert_differs</code> Refer\u00eancias diferentes <code>ref1 &lt;&gt; ref2</code> <code>fail</code> For\u00e7ar falha Quando condi\u00e7\u00e3o inesperada","tags":["ABAP","Testing","Assertions","Verification"]},{"location":"testes/3_assertions/#boas-praticas","title":"\u26a1 Boas Pr\u00e1ticas","text":"","tags":["ABAP","Testing","Assertions","Verification"]},{"location":"testes/3_assertions/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Mensagens descritivas\ncl_abap_unit_assert=&gt;assert_equals(\n  act = lv_count\n  exp = 5\n  msg = |Esperava 5 itens mas encontrou { lv_count }| ).  \" \u2705\n\n\" 2. Um conceito por teste\nMETHOD test_add_returns_sum.\n  \" \u2705 Testa APENAS soma\n  cl_abap_unit_assert=&gt;assert_equals( act = lv_result exp = 8 ).\nENDMETHOD.\n\n\" 3. Valores esperados expl\u00edcitos\ncl_abap_unit_assert=&gt;assert_equals(\n  act = ls_order-status\n  exp = 'APPROVED' ).  \" \u2705 Literal claro\n\n\" 4. assert_true para condi\u00e7\u00f5es complexas\ncl_abap_unit_assert=&gt;assert_true(\n  act = xsdbool( lv_date BETWEEN '20250101' AND '20251231' )\n  msg = 'Data deveria estar em 2025' ).  \" \u2705\n</code></pre>","tags":["ABAP","Testing","Assertions","Verification"]},{"location":"testes/3_assertions/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Mensagens gen\u00e9ricas\ncl_abap_unit_assert=&gt;assert_equals(\n  act = lv_result\n  exp = 8\n  msg = 'Erro' ).  \" \u274c N\u00e3o ajuda a debugar\n\n\" 2. M\u00faltiplos conceitos num teste\nMETHOD test_everything.\n  cl_abap_unit_assert=&gt;assert_equals( ... ).  \" Testa A\n  cl_abap_unit_assert=&gt;assert_true( ... ).    \" Testa B\n  cl_abap_unit_assert=&gt;assert_bound( ... ).   \" Testa C\n  \" \u274c Dif\u00edcil saber o que falhou\nENDMETHOD.\n\n\" 3. Calcular valor esperado\nDATA(lv_expected) = lv_input * 2 + 5.  \" \u274c Pode ter mesmo bug\ncl_abap_unit_assert=&gt;assert_equals(\n  act = mo_cut-&gt;calculate( lv_input )\n  exp = lv_expected ).\n\n\" 4. Testes sem assertions\nMETHOD test_process.\n  mo_cut-&gt;process( ).  \" \u274c N\u00e3o verifica nada!\nENDMETHOD.\n</code></pre>","tags":["ABAP","Testing","Assertions","Verification"]},{"location":"testes/3_assertions/#assertions-customizadas","title":"\ud83c\udfaf Assertions Customizadas","text":"<p>Criar assertions pr\u00f3prias para reutiliza\u00e7\u00e3o:</p> <pre><code>CLASS lcl_custom_assert DEFINITION.\n  PUBLIC SECTION.\n    CLASS-METHODS:\n      assert_order_valid\n        IMPORTING is_order TYPE ty_order\n        RAISING   cx_static_check.\nENDCLASS.\n\nCLASS lcl_custom_assert IMPLEMENTATION.\n  METHOD assert_order_valid.\n    cl_abap_unit_assert=&gt;assert_not_initial(\n      act = is_order-vbeln\n      msg = 'Order ID \u00e9 obrigat\u00f3rio' ).\n\n    cl_abap_unit_assert=&gt;assert_not_initial(\n      act = is_order-kunnr\n      msg = 'Customer \u00e9 obrigat\u00f3rio' ).\n\n    cl_abap_unit_assert=&gt;assert_true(\n      act = xsdbool( is_order-netwr &gt; 0 )\n      msg = 'Valor deve ser maior que zero' ).\n  ENDMETHOD.\nENDCLASS.\n\n\" Uso\nMETHOD test_create_order.\n  DATA(ls_order) = mo_cut-&gt;create( ... ).\n  lcl_custom_assert=&gt;assert_order_valid( ls_order ).  \" \u2705 Reutiliz\u00e1vel\nENDMETHOD.\n</code></pre>","tags":["ABAP","Testing","Assertions","Verification"]},{"location":"testes/3_assertions/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>ABAP Unit B\u00e1sico - Fundamentos</li> <li>Test Fixtures - Setup e teardown</li> <li>Test Doubles - Mockar depend\u00eancias</li> </ul> <p>Tags: <code>#Assertions</code> <code>#Verification</code> <code>#Testing</code> <code>#ABAP-Unit</code></p>","tags":["ABAP","Testing","Assertions","Verification"]},{"location":"testes/4_test_doubles/","title":"Test Doubles e Mocking","text":"","tags":["ABAP","Testing","Test Doubles","Mocking"]},{"location":"testes/4_test_doubles/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Test Doubles s\u00e3o objetos falsos que substituem depend\u00eancias reais durante testes, permitindo isolar o c\u00f3digo sob teste.</p>","tags":["ABAP","Testing","Test Doubles","Mocking"]},{"location":"testes/4_test_doubles/#tipos-de-test-doubles","title":"\ud83c\udfad Tipos de Test Doubles","text":"","tags":["ABAP","Testing","Test Doubles","Mocking"]},{"location":"testes/4_test_doubles/#1-dummy","title":"1\ufe0f\u20e3 Dummy","text":"<p>Objeto passado mas nunca usado.</p> <pre><code>mo_service-&gt;process(\n  iv_data = 'real_data'\n  io_logger = lo_dummy_logger ).  \" Nunca chamado\n</code></pre>","tags":["ABAP","Testing","Test Doubles","Mocking"]},{"location":"testes/4_test_doubles/#2-stub","title":"2\ufe0f\u20e3 Stub","text":"<p>Retorna respostas pr\u00e9-programadas.</p> <pre><code>\" Stub sempre retorna 'OK'\nlo_stub-&gt;is_valid( ) = abap_true.\n</code></pre>","tags":["ABAP","Testing","Test Doubles","Mocking"]},{"location":"testes/4_test_doubles/#3-mock","title":"3\ufe0f\u20e3 Mock","text":"<p>Verifica que foi chamado corretamente.</p> <pre><code>\" Mock verifica que send_email foi chamado com par\u00e2metros corretos\nVERIFY lo_mock-&gt;send_email( iv_to = 'test@example.com' ).\n</code></pre>","tags":["ABAP","Testing","Test Doubles","Mocking"]},{"location":"testes/4_test_doubles/#4-fake","title":"4\ufe0f\u20e3 Fake","text":"<p>Implementa\u00e7\u00e3o simplificada funcional.</p> <pre><code>\" Fake database usa tabela interna em vez de BD real\nCLASS lcl_fake_db IMPLEMENTATION.\n  METHOD save.\n    APPEND is_data TO mt_memory_storage.\n  ENDMETHOD.\nENDCLASS.\n</code></pre>","tags":["ABAP","Testing","Test Doubles","Mocking"]},{"location":"testes/4_test_doubles/#abap-test-double-framework","title":"\ud83d\udd27 ABAP Test Double Framework","text":"<p>Framework nativo para criar mocks/stubs em ABAP.</p>","tags":["ABAP","Testing","Test Doubles","Mocking"]},{"location":"testes/4_test_doubles/#criar-test-double","title":"Criar Test Double","text":"<pre><code>DATA: lo_double TYPE REF TO if_my_interface.\n\n\" Criar test double de interface\nlo_double = CAST if_my_interface(\n  cl_abap_testdouble=&gt;create( 'IF_MY_INTERFACE' ) ).\n</code></pre>","tags":["ABAP","Testing","Test Doubles","Mocking"]},{"location":"testes/4_test_doubles/#configurar-comportamento-stub","title":"Configurar Comportamento (Stub)","text":"<pre><code>METHOD test_with_stub.\n  \" Criar double\n  DATA(lo_customer_repo) = CAST if_customer_repository(\n    cl_abap_testdouble=&gt;create( 'IF_CUSTOMER_REPOSITORY' ) ).\n\n  \" Configurar: quando get_customer('100001') for chamado, retornar...\n  cl_abap_testdouble=&gt;configure_call( lo_customer_repo )-&gt;returning(\n    VALUE ty_customer( kunnr = '100001' name1 = 'Test Customer' ) ).\n\n  lo_customer_repo-&gt;get_customer( '100001' ).\n\n  \" Injetar double no objeto sob teste\n  mo_cut = NEW zcl_order_processor( io_customer_repo = lo_customer_repo ).\n\n  \" Testar\n  DATA(ls_order) = mo_cut-&gt;create_order(\n    iv_customer = '100001'\n    iv_material = 'MAT001' ).\n\n  \" Verificar que usou dados do stub\n  cl_abap_unit_assert=&gt;assert_equals(\n    act = ls_order-customer_name\n    exp = 'Test Customer' ).\nENDMETHOD.\n</code></pre>","tags":["ABAP","Testing","Test Doubles","Mocking"]},{"location":"testes/4_test_doubles/#verificar-chamadas-mock","title":"Verificar Chamadas (Mock)","text":"<pre><code>METHOD test_sends_notification.\n  \" Criar mock\n  DATA(lo_notification) = CAST if_notification_service(\n    cl_abap_testdouble=&gt;create( 'IF_NOTIFICATION_SERVICE' ) ).\n\n  \" Injetar no objeto\n  mo_cut = NEW zcl_order_processor( io_notifier = lo_notification ).\n\n  \" Executar\n  mo_cut-&gt;process_order( '12345' ).\n\n  \" Verificar que send() foi chamado exatamente 1 vez\n  cl_abap_testdouble=&gt;verify_expectations( lo_notification ).\nENDMETHOD.\n</code></pre>","tags":["ABAP","Testing","Test Doubles","Mocking"]},{"location":"testes/4_test_doubles/#configurar-multiplas-chamadas","title":"Configurar M\u00faltiplas Chamadas","text":"<pre><code>METHOD test_multiple_calls.\n  DATA(lo_db) = CAST if_database(\n    cl_abap_testdouble=&gt;create( 'IF_DATABASE' ) ).\n\n  \" Primeira chamada retorna 'A'\n  cl_abap_testdouble=&gt;configure_call( lo_db )-&gt;returning( 'A' ).\n  lo_db-&gt;read( ).\n\n  \" Segunda chamada retorna 'B'\n  cl_abap_testdouble=&gt;configure_call( lo_db )-&gt;returning( 'B' ).\n  lo_db-&gt;read( ).\n\n  \" Usar\n  mo_cut = NEW zcl_processor( io_db = lo_db ).\n\n  DATA(lv_first) = mo_cut-&gt;get_next( ).   \" Retorna 'A'\n  DATA(lv_second) = mo_cut-&gt;get_next( ).  \" Retorna 'B'\n\n  cl_abap_unit_assert=&gt;assert_equals( act = lv_first exp = 'A' ).\n  cl_abap_unit_assert=&gt;assert_equals( act = lv_second exp = 'B' ).\nENDMETHOD.\n</code></pre>","tags":["ABAP","Testing","Test Doubles","Mocking"]},{"location":"testes/4_test_doubles/#configurar-excecoes","title":"Configurar Exce\u00e7\u00f5es","text":"<pre><code>METHOD test_handles_database_error.\n  DATA(lo_db) = CAST if_database(\n    cl_abap_testdouble=&gt;create( 'IF_DATABASE' ) ).\n\n  \" Configurar para lan\u00e7ar exce\u00e7\u00e3o\n  cl_abap_testdouble=&gt;configure_call( lo_db )-&gt;raise_exception(\n    NEW cx_database_error( ) ).\n\n  lo_db-&gt;save( is_data = ls_data ).\n\n  \" Injetar\n  mo_cut = NEW zcl_processor( io_db = lo_db ).\n\n  \" Testar tratamento de erro\n  TRY.\n      mo_cut-&gt;process( ).\n      cl_abap_unit_assert=&gt;fail( 'Deveria propagar exce\u00e7\u00e3o' ).\n    CATCH cx_database_error.\n      \" OK - tratou corretamente\n  ENDTRY.\nENDMETHOD.\n</code></pre>","tags":["ABAP","Testing","Test Doubles","Mocking"]},{"location":"testes/4_test_doubles/#times-verificar-quantidade-de-chamadas","title":"times() - Verificar Quantidade de Chamadas","text":"<pre><code>METHOD test_caches_data.\n  DATA(lo_db) = CAST if_database(\n    cl_abap_testdouble=&gt;create( 'IF_DATABASE' ) ).\n\n  \" Configurar que read() deve ser chamado exatamente 1 vez\n  cl_abap_testdouble=&gt;configure_call( lo_db )-&gt;times( 1 ).\n  lo_db-&gt;read( iv_id = '123' ).\n\n  mo_cut = NEW zcl_caching_processor( io_db = lo_db ).\n\n  \" Chamar 3 vezes\n  mo_cut-&gt;get_data( '123' ).\n  mo_cut-&gt;get_data( '123' ).  \" Deveria usar cache\n  mo_cut-&gt;get_data( '123' ).  \" Deveria usar cache\n\n  \" Verificar que BD foi consultado apenas 1 vez\n  cl_abap_testdouble=&gt;verify_expectations( lo_db ).\nENDMETHOD.\n</code></pre>","tags":["ABAP","Testing","Test Doubles","Mocking"]},{"location":"testes/4_test_doubles/#exemplo-completo","title":"\ud83d\udca1 Exemplo Completo","text":"","tags":["ABAP","Testing","Test Doubles","Mocking"]},{"location":"testes/4_test_doubles/#interface-de-dependencia","title":"Interface de Depend\u00eancia","text":"<pre><code>INTERFACE if_email_service PUBLIC.\n  METHODS send_email\n    IMPORTING iv_to      TYPE string\n              iv_subject TYPE string\n              iv_body    TYPE string\n    RETURNING VALUE(rv_success) TYPE abap_bool.\nENDINTERFACE.\n</code></pre>","tags":["ABAP","Testing","Test Doubles","Mocking"]},{"location":"testes/4_test_doubles/#classe-a-testar","title":"Classe a Testar","text":"<pre><code>CLASS zcl_order_processor DEFINITION PUBLIC.\n  PUBLIC SECTION.\n    METHODS constructor\n      IMPORTING io_email_service TYPE REF TO if_email_service.\n\n    METHODS process_order\n      IMPORTING iv_order_id TYPE vbeln\n      RETURNING VALUE(rv_success) TYPE abap_bool.\n\n  PRIVATE SECTION.\n    DATA mo_email_service TYPE REF TO if_email_service.\nENDCLASS.\n\nCLASS zcl_order_processor IMPLEMENTATION.\n  METHOD constructor.\n    mo_email_service = io_email_service.\n  ENDMETHOD.\n\n  METHOD process_order.\n    \" Processar ordem...\n    rv_success = abap_true.\n\n    \" Enviar notifica\u00e7\u00e3o\n    mo_email_service-&gt;send_email(\n      iv_to      = 'manager@company.com'\n      iv_subject = |Ordem { iv_order_id } processada|\n      iv_body    = 'Ordem processada com sucesso' ).\n  ENDMETHOD.\nENDCLASS.\n</code></pre>","tags":["ABAP","Testing","Test Doubles","Mocking"]},{"location":"testes/4_test_doubles/#teste-com-mock","title":"Teste com Mock","text":"<pre><code>CLASS ltc_order_processor DEFINITION FOR TESTING\n  RISK LEVEL HARMLESS\n  DURATION SHORT.\n\n  PRIVATE SECTION.\n    DATA: mo_cut           TYPE REF TO zcl_order_processor,\n          mo_email_service TYPE REF TO if_email_service.\n\n    METHODS:\n      setup,\n      test_sends_notification FOR TESTING.\nENDCLASS.\n\nCLASS ltc_order_processor IMPLEMENTATION.\n  METHOD setup.\n    \" Criar mock de email service\n    mo_email_service = CAST if_email_service(\n      cl_abap_testdouble=&gt;create( 'IF_EMAIL_SERVICE' ) ).\n\n    \" Configurar: send_email retorna true\n    cl_abap_testdouble=&gt;configure_call( mo_email_service )-&gt;returning( abap_true ).\n    mo_email_service-&gt;send_email(\n      iv_to      = cl_abap_testdouble=&gt;any_value( )\n      iv_subject = cl_abap_testdouble=&gt;any_value( )\n      iv_body    = cl_abap_testdouble=&gt;any_value( ) ).\n\n    \" Injetar mock\n    mo_cut = NEW zcl_order_processor( mo_email_service ).\n  ENDMETHOD.\n\n  METHOD test_sends_notification.\n    \" Act\n    DATA(lv_success) = mo_cut-&gt;process_order( '12345' ).\n\n    \" Assert - processamento teve sucesso\n    cl_abap_unit_assert=&gt;assert_true(\n      act = lv_success\n      msg = 'Processamento deveria ter sucesso' ).\n\n    \" Verificar que email foi enviado\n    cl_abap_testdouble=&gt;verify_expectations( mo_email_service ).\n  ENDMETHOD.\nENDCLASS.\n</code></pre>","tags":["ABAP","Testing","Test Doubles","Mocking"]},{"location":"testes/4_test_doubles/#fake-manual","title":"\ud83d\udee0\ufe0f Fake Manual","text":"<p>Quando test double framework n\u00e3o \u00e9 suficiente:</p> <pre><code>\" Interface\nINTERFACE if_customer_repository.\n  METHODS get_customer\n    IMPORTING iv_id TYPE kunnr\n    RETURNING VALUE(rs_customer) TYPE kna1.\nENDINTERFACE.\n\n\" Fake (implementa\u00e7\u00e3o simplificada)\nCLASS lcl_fake_customer_repo DEFINITION FOR TESTING.\n  PUBLIC SECTION.\n    INTERFACES if_customer_repository.\n\n    METHODS add_test_customer\n      IMPORTING is_customer TYPE kna1.\n\n  PRIVATE SECTION.\n    DATA mt_customers TYPE TABLE OF kna1.\nENDCLASS.\n\nCLASS lcl_fake_customer_repo IMPLEMENTATION.\n  METHOD if_customer_repository~get_customer.\n    READ TABLE mt_customers INTO rs_customer\n      WITH KEY kunnr = iv_id.\n  ENDMETHOD.\n\n  METHOD add_test_customer.\n    APPEND is_customer TO mt_customers.\n  ENDMETHOD.\nENDCLASS.\n\n\" Uso no teste\nMETHOD test_with_fake.\n  DATA(lo_fake_repo) = NEW lcl_fake_customer_repo( ).\n\n  \" Adicionar clientes de teste\n  lo_fake_repo-&gt;add_test_customer(\n    VALUE #( kunnr = '100001' name1 = 'Test Customer' ) ).\n\n  \" Injetar\n  mo_cut = NEW zcl_order_processor( lo_fake_repo ).\n\n  \" Testar\n  DATA(ls_order) = mo_cut-&gt;create_order( iv_customer = '100001' ).\n\n  cl_abap_unit_assert=&gt;assert_equals(\n    act = ls_order-customer_name\n    exp = 'Test Customer' ).\nENDMETHOD.\n</code></pre>","tags":["ABAP","Testing","Test Doubles","Mocking"]},{"location":"testes/4_test_doubles/#boas-praticas","title":"\u26a1 Boas Pr\u00e1ticas","text":"","tags":["ABAP","Testing","Test Doubles","Mocking"]},{"location":"testes/4_test_doubles/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Usar interfaces para depend\u00eancias\nCLASS zcl_processor DEFINITION.\n  METHODS constructor\n    IMPORTING io_db TYPE REF TO if_database.  \" \u2705 Interface\nENDCLASS.\n\n\" 2. Inje\u00e7\u00e3o de depend\u00eancias\nmo_cut = NEW zcl_processor(\n  io_db     = lo_mock_db\n  io_logger = lo_stub_logger ).  \" \u2705 Injetado\n\n\" 3. Isolar uma depend\u00eancia por vez\nMETHOD test_database_error.\n  \" \u2705 Mock apenas database, resto real\n  mo_cut = NEW zcl_processor( io_db = lo_mock_db ).\nENDMETHOD.\n\n\" 4. Verificar apenas comportamentos importantes\ncl_abap_testdouble=&gt;verify_expectations( lo_notification ).  \" \u2705\n</code></pre>","tags":["ABAP","Testing","Test Doubles","Mocking"]},{"location":"testes/4_test_doubles/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Depend\u00eancias hardcoded\nCLASS zcl_processor IMPLEMENTATION.\n  METHOD constructor.\n    CREATE OBJECT mo_db TYPE zcl_database.  \" \u274c N\u00e3o test\u00e1vel\n  ENDMETHOD.\nENDCLASS.\n\n\" 2. Mockar tudo\nMETHOD test_something.\n  \" \u274c Mocks demais = teste fr\u00e1gil\n  lo_mock1 = ...\n  lo_mock2 = ...\n  lo_mock3 = ...\nENDMETHOD.\n\n\" 3. Testar implementa\u00e7\u00e3o de mocks\nMETHOD test_mock_works.\n  DATA(lv_result) = lo_mock-&gt;get_data( ).\n  cl_abap_unit_assert=&gt;assert_equals( act = lv_result exp = 'mocked' ).\n  \" \u274c Testa o mock, n\u00e3o o c\u00f3digo real!\nENDMETHOD.\n</code></pre>","tags":["ABAP","Testing","Test Doubles","Mocking"]},{"location":"testes/4_test_doubles/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>Inje\u00e7\u00e3o de Depend\u00eancias - Tornar c\u00f3digo test\u00e1vel</li> <li>ABAP Unit B\u00e1sico - Fundamentos</li> <li>TDD - Test-Driven Development</li> </ul> <p>Tags: <code>#Test-Doubles</code> <code>#Mocking</code> <code>#Stubbing</code> <code>#Isolation</code></p>","tags":["ABAP","Testing","Test Doubles","Mocking"]},{"location":"testes/5_injecao_dependencias/","title":"Inje\u00e7\u00e3o de Depend\u00eancias","text":"","tags":["ABAP","Testing","Dependency Injection","Design Patterns"]},{"location":"testes/5_injecao_dependencias/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Inje\u00e7\u00e3o de Depend\u00eancias (Dependency Injection - DI) \u00e9 um padr\u00e3o que torna c\u00f3digo test\u00e1vel ao permitir substituir depend\u00eancias reais por test doubles.</p>","tags":["ABAP","Testing","Dependency Injection","Design Patterns"]},{"location":"testes/5_injecao_dependencias/#problema-codigo-nao-testavel","title":"\ud83c\udfaf Problema: C\u00f3digo N\u00e3o-Test\u00e1vel","text":"","tags":["ABAP","Testing","Dependency Injection","Design Patterns"]},{"location":"testes/5_injecao_dependencias/#ruim-dependencias-hardcoded","title":"\u274c Ruim: Depend\u00eancias Hardcoded","text":"<pre><code>CLASS zcl_order_processor DEFINITION.\n  PRIVATE SECTION.\n    DATA mo_database TYPE REF TO zcl_database.\n    DATA mo_email    TYPE REF TO zcl_email_service.\nENDCLASS.\n\nCLASS zcl_order_processor IMPLEMENTATION.\n  METHOD constructor.\n    \" \u274c Cria depend\u00eancias internamente\n    CREATE OBJECT mo_database.\n    CREATE OBJECT mo_email.\n  ENDMETHOD.\n\n  METHOD process_order.\n    \" Usa mo_database e mo_email...\n  ENDMETHOD.\nENDCLASS.\n</code></pre> <p>Problema: Imposs\u00edvel testar sem BD real e enviar emails reais!</p>","tags":["ABAP","Testing","Dependency Injection","Design Patterns"]},{"location":"testes/5_injecao_dependencias/#solucao-injetar-dependencias","title":"\u2705 Solu\u00e7\u00e3o: Injetar Depend\u00eancias","text":"","tags":["ABAP","Testing","Dependency Injection","Design Patterns"]},{"location":"testes/5_injecao_dependencias/#1-constructor-injection-recomendado","title":"1\ufe0f\u20e3 Constructor Injection (Recomendado)","text":"<pre><code>INTERFACE if_database.\n  METHODS save IMPORTING is_data TYPE any.\nENDINTERFACE.\n\nINTERFACE if_email_service.\n  METHODS send IMPORTING iv_to TYPE string.\nENDINTERFACE.\n\nCLASS zcl_order_processor DEFINITION.\n  PUBLIC SECTION.\n    METHODS constructor\n      IMPORTING io_database      TYPE REF TO if_database\n                io_email_service TYPE REF TO if_email_service.\n\n  PRIVATE SECTION.\n    DATA: mo_database      TYPE REF TO if_database,\n          mo_email_service TYPE REF TO if_email_service.\nENDCLASS.\n\nCLASS zcl_order_processor IMPLEMENTATION.\n  METHOD constructor.\n    \" \u2705 Recebe depend\u00eancias externas\n    mo_database      = io_database.\n    mo_email_service = io_email_service.\n  ENDMETHOD.\n\n  METHOD process_order.\n    mo_database-&gt;save( ls_order ).\n    mo_email_service-&gt;send( iv_to = 'manager@company.com' ).\n  ENDMETHOD.\nENDCLASS.\n</code></pre> <p>Produ\u00e7\u00e3o: <pre><code>DATA(lo_processor) = NEW zcl_order_processor(\n  io_database      = NEW zcl_real_database( )\n  io_email_service = NEW zcl_real_email_service( ) ).\n</code></pre></p> <p>Teste: <pre><code>METHOD test_process_order.\n  \" \u2705 Injeta mocks\n  DATA(lo_processor) = NEW zcl_order_processor(\n    io_database      = lo_mock_database\n    io_email_service = lo_mock_email ).\n\n  lo_processor-&gt;process_order( '12345' ).\n\n  \" Verificar sem tocar BD/email real!\nENDMETHOD.\n</code></pre></p>","tags":["ABAP","Testing","Dependency Injection","Design Patterns"]},{"location":"testes/5_injecao_dependencias/#2-setter-injection","title":"2\ufe0f\u20e3 Setter Injection","text":"<p>Quando constructor tem muitos par\u00e2metros:</p> <pre><code>CLASS zcl_order_processor DEFINITION.\n  PUBLIC SECTION.\n    METHODS:\n      set_database IMPORTING io_db TYPE REF TO if_database,\n      set_email_service IMPORTING io_email TYPE REF TO if_email_service.\n\n  PRIVATE SECTION.\n    DATA: mo_database      TYPE REF TO if_database,\n          mo_email_service TYPE REF TO if_email_service.\nENDCLASS.\n\nCLASS zcl_order_processor IMPLEMENTATION.\n  METHOD set_database.\n    mo_database = io_db.\n  ENDMETHOD.\n\n  METHOD set_email_service.\n    mo_email_service = io_email.\n  ENDMETHOD.\nENDCLASS.\n</code></pre> <p>Uso: <pre><code>\" Produ\u00e7\u00e3o\nDATA(lo_processor) = NEW zcl_order_processor( ).\nlo_processor-&gt;set_database( NEW zcl_real_database( ) ).\nlo_processor-&gt;set_email_service( NEW zcl_real_email( ) ).\n\n\" Teste\nDATA(lo_processor) = NEW zcl_order_processor( ).\nlo_processor-&gt;set_database( lo_mock_database ).\nlo_processor-&gt;set_email_service( lo_mock_email ).\n</code></pre></p>","tags":["ABAP","Testing","Dependency Injection","Design Patterns"]},{"location":"testes/5_injecao_dependencias/#3-interface-injection-raro-em-abap","title":"3\ufe0f\u20e3 Interface Injection (Raro em ABAP)","text":"<pre><code>INTERFACE if_injectable.\n  METHODS inject_dependencies\n    IMPORTING io_db TYPE REF TO if_database.\nENDINTERFACE.\n</code></pre>","tags":["ABAP","Testing","Dependency Injection","Design Patterns"]},{"location":"testes/5_injecao_dependencias/#exemplo-completo","title":"\ud83d\udca1 Exemplo Completo","text":"","tags":["ABAP","Testing","Dependency Injection","Design Patterns"]},{"location":"testes/5_injecao_dependencias/#interfaces","title":"Interfaces","text":"<pre><code>INTERFACE if_customer_repository.\n  METHODS get_customer\n    IMPORTING iv_id TYPE kunnr\n    RETURNING VALUE(rs_customer) TYPE kna1.\nENDINTERFACE.\n\nINTERFACE if_notification_service.\n  METHODS notify\n    IMPORTING iv_customer TYPE kunnr\n              iv_message  TYPE string.\nENDINTERFACE.\n</code></pre>","tags":["ABAP","Testing","Dependency Injection","Design Patterns"]},{"location":"testes/5_injecao_dependencias/#implementacoes-reais","title":"Implementa\u00e7\u00f5es Reais","text":"<pre><code>CLASS zcl_db_customer_repo DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES if_customer_repository.\nENDCLASS.\n\nCLASS zcl_db_customer_repo IMPLEMENTATION.\n  METHOD if_customer_repository~get_customer.\n    SELECT SINGLE * FROM kna1\n      WHERE kunnr = @iv_id\n      INTO @rs_customer.\n  ENDMETHOD.\nENDCLASS.\n\nCLASS zcl_email_notification DEFINITION.\n  PUBLIC SECTION.\n    INTERFACES if_notification_service.\nENDCLASS.\n\nCLASS zcl_email_notification IMPLEMENTATION.\n  METHOD if_notification_service~notify.\n    \" Enviar email real\n    CALL FUNCTION 'SO_NEW_DOCUMENT_ATT_SEND_API1' ...\n  ENDMETHOD.\nENDCLASS.\n</code></pre>","tags":["ABAP","Testing","Dependency Injection","Design Patterns"]},{"location":"testes/5_injecao_dependencias/#classe-testavel","title":"Classe Test\u00e1vel","text":"<pre><code>CLASS zcl_order_service DEFINITION.\n  PUBLIC SECTION.\n    METHODS constructor\n      IMPORTING io_customer_repo TYPE REF TO if_customer_repository\n                io_notifier      TYPE REF TO if_notification_service.\n\n    METHODS create_order\n      IMPORTING iv_customer TYPE kunnr\n                iv_material TYPE matnr\n      RETURNING VALUE(rv_order_id) TYPE vbeln.\n\n  PRIVATE SECTION.\n    DATA: mo_customer_repo TYPE REF TO if_customer_repository,\n          mo_notifier      TYPE REF TO if_notification_service.\nENDCLASS.\n\nCLASS zcl_order_service IMPLEMENTATION.\n  METHOD constructor.\n    mo_customer_repo = io_customer_repo.\n    mo_notifier      = io_notifier.\n  ENDMETHOD.\n\n  METHOD create_order.\n    \" Validar cliente\n    DATA(ls_customer) = mo_customer_repo-&gt;get_customer( iv_customer ).\n\n    IF ls_customer-kunnr IS INITIAL.\n      RAISE EXCEPTION TYPE cx_invalid_customer.\n    ENDIF.\n\n    \" Criar ordem\n    rv_order_id = |ORD{ sy-datum }{ sy-uzeit }|.\n\n    \" Notificar\n    mo_notifier-&gt;notify(\n      iv_customer = iv_customer\n      iv_message  = |Ordem { rv_order_id } criada| ).\n  ENDMETHOD.\nENDCLASS.\n</code></pre>","tags":["ABAP","Testing","Dependency Injection","Design Patterns"]},{"location":"testes/5_injecao_dependencias/#uso-em-producao","title":"Uso em Produ\u00e7\u00e3o","text":"<pre><code>DATA(lo_service) = NEW zcl_order_service(\n  io_customer_repo = NEW zcl_db_customer_repo( )\n  io_notifier      = NEW zcl_email_notification( ) ).\n\nDATA(lv_order_id) = lo_service-&gt;create_order(\n  iv_customer = '100001'\n  iv_material = 'MAT001' ).\n</code></pre>","tags":["ABAP","Testing","Dependency Injection","Design Patterns"]},{"location":"testes/5_injecao_dependencias/#teste","title":"Teste","text":"<pre><code>CLASS ltc_order_service DEFINITION FOR TESTING\n  RISK LEVEL HARMLESS\n  DURATION SHORT.\n\n  PRIVATE SECTION.\n    DATA: mo_cut           TYPE REF TO zcl_order_service,\n          mo_customer_repo TYPE REF TO if_customer_repository,\n          mo_notifier      TYPE REF TO if_notification_service.\n\n    METHODS:\n      setup,\n      test_create_order_success FOR TESTING,\n      test_invalid_customer_raises_error FOR TESTING.\nENDCLASS.\n\nCLASS ltc_order_service IMPLEMENTATION.\n  METHOD setup.\n    \" Criar mocks\n    mo_customer_repo = CAST if_customer_repository(\n      cl_abap_testdouble=&gt;create( 'IF_CUSTOMER_REPOSITORY' ) ).\n\n    mo_notifier = CAST if_notification_service(\n      cl_abap_testdouble=&gt;create( 'IF_NOTIFICATION_SERVICE' ) ).\n\n    \" Injetar mocks\n    mo_cut = NEW zcl_order_service(\n      io_customer_repo = mo_customer_repo\n      io_notifier      = mo_notifier ).\n  ENDMETHOD.\n\n  METHOD test_create_order_success.\n    \" Stub: get_customer retorna cliente v\u00e1lido\n    cl_abap_testdouble=&gt;configure_call( mo_customer_repo )-&gt;returning(\n      VALUE kna1( kunnr = '100001' name1 = 'Test Customer' ) ).\n    mo_customer_repo-&gt;get_customer( '100001' ).\n\n    \" Stub: notify retorna sucesso\n    cl_abap_testdouble=&gt;configure_call( mo_notifier ).\n    mo_notifier-&gt;notify(\n      iv_customer = cl_abap_testdouble=&gt;any_value( )\n      iv_message  = cl_abap_testdouble=&gt;any_value( ) ).\n\n    \" Act\n    DATA(lv_order_id) = mo_cut-&gt;create_order(\n      iv_customer = '100001'\n      iv_material = 'MAT001' ).\n\n    \" Assert\n    cl_abap_unit_assert=&gt;assert_not_initial(\n      act = lv_order_id\n      msg = 'Order ID deveria ser gerado' ).\n\n    \" Verificar que notify foi chamado\n    cl_abap_testdouble=&gt;verify_expectations( mo_notifier ).\n  ENDMETHOD.\n\n  METHOD test_invalid_customer_raises_error.\n    \" Stub: get_customer retorna vazio (cliente inv\u00e1lido)\n    cl_abap_testdouble=&gt;configure_call( mo_customer_repo )-&gt;returning(\n      VALUE kna1( ) ).\n    mo_customer_repo-&gt;get_customer( '999999' ).\n\n    \" Act &amp; Assert\n    TRY.\n        mo_cut-&gt;create_order(\n          iv_customer = '999999'\n          iv_material = 'MAT001' ).\n\n        cl_abap_unit_assert=&gt;fail(\n          msg = 'Deveria lan\u00e7ar cx_invalid_customer' ).\n\n      CATCH cx_invalid_customer.\n        \" Sucesso!\n    ENDTRY.\n  ENDMETHOD.\nENDCLASS.\n</code></pre>","tags":["ABAP","Testing","Dependency Injection","Design Patterns"]},{"location":"testes/5_injecao_dependencias/#padrao-factory-alternativa","title":"\ud83c\udfd7\ufe0f Padr\u00e3o Factory (Alternativa)","text":"<p>Quando DI n\u00e3o \u00e9 vi\u00e1vel:</p> <pre><code>\" Factory retorna interface\nCLASS zcl_database_factory DEFINITION.\n  PUBLIC SECTION.\n    CLASS-METHODS get_instance\n      RETURNING VALUE(ro_db) TYPE REF TO if_database.\nENDCLASS.\n\nCLASS zcl_database_factory IMPLEMENTATION.\n  METHOD get_instance.\n    IF sy-sysid = 'TST'.\n      ro_db = NEW zcl_test_database( ).\n    ELSE.\n      ro_db = NEW zcl_production_database( ).\n    ENDIF.\n  ENDMETHOD.\nENDCLASS.\n\n\" Uso\nDATA(lo_db) = zcl_database_factory=&gt;get_instance( ).\n</code></pre>","tags":["ABAP","Testing","Dependency Injection","Design Patterns"]},{"location":"testes/5_injecao_dependencias/#boas-praticas","title":"\u26a1 Boas Pr\u00e1ticas","text":"","tags":["ABAP","Testing","Dependency Injection","Design Patterns"]},{"location":"testes/5_injecao_dependencias/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Sempre usar interfaces\nMETHODS constructor\n  IMPORTING io_repo TYPE REF TO if_repository.  \" \u2705\n\n\" 2. Constructor injection (prefer\u00edvel)\nmo_cut = NEW zcl_processor(\n  io_db     = lo_mock_db\n  io_logger = lo_stub_logger ).  \" \u2705\n\n\" 3. Depend\u00eancias expl\u00edcitas\n\" F\u00e1cil ver o que a classe precisa\n\n\" 4. Um n\u00edvel de abstra\u00e7\u00e3o\nINTERFACE if_email_service.  \" \u2705 Alto n\u00edvel\n  METHODS send_email.\nENDINTERFACE.\n</code></pre>","tags":["ABAP","Testing","Dependency Injection","Design Patterns"]},{"location":"testes/5_injecao_dependencias/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Criar depend\u00eancias internamente\nCREATE OBJECT mo_db TYPE zcl_database.  \" \u274c\n\n\" 2. Depend\u00eancias concretas\nMETHODS constructor\n  IMPORTING io_db TYPE REF TO zcl_specific_database.  \" \u274c Concreto\n\n\" 3. Muitas depend\u00eancias (&gt;5)\nMETHODS constructor\n  IMPORTING io_dep1 ... io_dep10.  \" \u274c Classe faz demais\n\n\" 4. Depend\u00eancias opcionais sem default\nMETHODS set_logger\n  IMPORTING io_logger TYPE REF TO if_logger.  \" \u26a0\ufe0f E se n\u00e3o chamar?\n</code></pre>","tags":["ABAP","Testing","Dependency Injection","Design Patterns"]},{"location":"testes/5_injecao_dependencias/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>Test Doubles - Mockar depend\u00eancias</li> <li>TDD - Desenvolver com testes</li> <li>Code Coverage - Medir qualidade</li> </ul> <p>Tags: <code>#Dependency-Injection</code> <code>#Design-Patterns</code> <code>#Testability</code></p>","tags":["ABAP","Testing","Dependency Injection","Design Patterns"]},{"location":"testes/6_code_coverage/","title":"Cobertura de C\u00f3digo (Code Coverage)","text":"","tags":["ABAP","Testing","Code Coverage","Quality Metrics"]},{"location":"testes/6_code_coverage/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Code Coverage mede a percentagem de c\u00f3digo executada pelos testes, indicando qualidade da suite de testes.</p>","tags":["ABAP","Testing","Code Coverage","Quality Metrics"]},{"location":"testes/6_code_coverage/#tipos-de-cobertura","title":"\ud83d\udcca Tipos de Cobertura","text":"","tags":["ABAP","Testing","Code Coverage","Quality Metrics"]},{"location":"testes/6_code_coverage/#statement-coverage","title":"Statement Coverage","text":"<p>Percentagem de linhas executadas.</p> <pre><code>METHOD calculate_discount.\n  DATA(lv_discount) = 0.\n\n  IF iv_price &gt; 1000.        \" Linha 1\n    lv_discount = iv_price * '0.1'.  \" Linha 2\n  ELSE.                      \" Linha 3\n    lv_discount = 0.         \" Linha 4\n  ENDIF.\n\n  rv_result = iv_price - lv_discount.  \" Linha 5\nENDMETHOD.\n\n\" Teste: calculate_discount( 1500 ) \n\" Cobre: Linhas 1, 2, 5 = 60% coverage (3/5)\n\" N\u00c3O cobre: Linhas 3, 4 = branch ELSE n\u00e3o testado\n</code></pre>","tags":["ABAP","Testing","Code Coverage","Quality Metrics"]},{"location":"testes/6_code_coverage/#branch-coverage","title":"Branch Coverage","text":"<p>Percentagem de caminhos (branches) executados.</p> <pre><code>\" 2 branches: IF (true) e ELSE (false)\n\" Coverage 100% requer AMBOS os caminhos testados\n\nMETHOD test_high_price.\n  \" Testa branch IF\n  DATA(lv_discount) = mo_cut-&gt;calculate_discount( 1500 ).\nENDMETHOD.\n\nMETHOD test_low_price.\n  \" Testa branch ELSE\n  DATA(lv_discount) = mo_cut-&gt;calculate_discount( 500 ).\nENDMETHOD.\n</code></pre>","tags":["ABAP","Testing","Code Coverage","Quality Metrics"]},{"location":"testes/6_code_coverage/#metas-de-cobertura","title":"\ud83c\udfaf Metas de Cobertura","text":"N\u00edvel Coverage Classifica\u00e7\u00e3o Cr\u00edtico &lt; 40% \u274c Insuficiente Baixo 40-60% \u26a0\ufe0f Melhorar Aceit\u00e1vel 60-70% \ud83d\udfe1 OK Bom 70-80% \u2705 Bom Excelente 80-90% \ud83c\udf1f Excelente Perfeito &gt; 90% \ud83d\udc8e Perfeito <p>Meta Recomendada: 70-80%</p> <p>\u26a0\ufe0f 100% nem sempre \u00e9 necess\u00e1rio! (c\u00f3digo gerado, getters/setters triviais)</p>","tags":["ABAP","Testing","Code Coverage","Quality Metrics"]},{"location":"testes/6_code_coverage/#medir-coverage","title":"\u25b6\ufe0f Medir Coverage","text":"","tags":["ABAP","Testing","Code Coverage","Quality Metrics"]},{"location":"testes/6_code_coverage/#eclipse-adt-recomendado","title":"Eclipse ADT (Recomendado)","text":"<ol> <li>Executar com coverage: <code>Ctrl+Shift+F11</code></li> <li>Ver resultado: View \"Coverage\"</li> <li>C\u00f3digo destacado:</li> <li>\ud83d\udfe2 Verde = executado</li> <li>\ud83d\udd34 Vermelho = N\u00c3O executado</li> </ol>","tags":["ABAP","Testing","Code Coverage","Quality Metrics"]},{"location":"testes/6_code_coverage/#sap-gui","title":"SAP GUI","text":"<ol> <li>SE80/SE24 - Abrir classe</li> <li>F8 ou Coverage Analyzer (SCOV)</li> <li>Executar testes</li> <li>Ver relat\u00f3rio de cobertura</li> </ol>","tags":["ABAP","Testing","Code Coverage","Quality Metrics"]},{"location":"testes/6_code_coverage/#exemplo-pratico","title":"\ud83d\udca1 Exemplo Pr\u00e1tico","text":"","tags":["ABAP","Testing","Code Coverage","Quality Metrics"]},{"location":"testes/6_code_coverage/#codigo-a-testar","title":"C\u00f3digo a Testar","text":"<pre><code>CLASS zcl_price_calculator DEFINITION PUBLIC.\n  PUBLIC SECTION.\n    METHODS calculate_final_price\n      IMPORTING iv_base_price TYPE p\n                iv_customer_type TYPE char1  \" 'P'=Premium, 'R'=Regular\n      RETURNING VALUE(rv_price) TYPE p.\nENDCLASS.\n\nCLASS zcl_price_calculator IMPLEMENTATION.\n  METHOD calculate_final_price.\n    rv_price = iv_base_price.\n\n    \" Branch 1: Desconto Premium\n    IF iv_customer_type = 'P'.\n      rv_price = rv_price * '0.9'.  \" 10% desconto\n\n    \" Branch 2: Desconto Regular  \n    ELSEIF iv_customer_type = 'R'.\n      rv_price = rv_price * '0.95'.  \" 5% desconto\n\n    \" Branch 3: Sem desconto\n    ELSE.\n      \" Sem altera\u00e7\u00e3o\n    ENDIF.\n\n    \" Taxa de servi\u00e7o\n    IF rv_price &gt; 1000.\n      rv_price = rv_price + 50.  \" Taxa fixa\n    ENDIF.\n  ENDMETHOD.\nENDCLASS.\n</code></pre>","tags":["ABAP","Testing","Code Coverage","Quality Metrics"]},{"location":"testes/6_code_coverage/#testes-com-coverage-baixo","title":"Testes com Coverage Baixo \u274c","text":"<pre><code>CLASS ltc_calculator DEFINITION FOR TESTING\n  RISK LEVEL HARMLESS\n  DURATION SHORT.\n\n  PRIVATE SECTION.\n    DATA mo_cut TYPE REF TO zcl_price_calculator.\n\n    METHODS:\n      setup,\n      test_premium_customer FOR TESTING.\nENDCLASS.\n\nCLASS ltc_calculator IMPLEMENTATION.\n  METHOD setup.\n    CREATE OBJECT mo_cut.\n  ENDMETHOD.\n\n  METHOD test_premium_customer.\n    \" Testa APENAS Premium\n    DATA(lv_price) = mo_cut-&gt;calculate_final_price(\n      iv_base_price    = 1000\n      iv_customer_type = 'P' ).\n\n    cl_abap_unit_assert=&gt;assert_equals(\n      act = lv_price\n      exp = 900\n      msg = 'Premium deveria ter 10% desconto' ).\n  ENDMETHOD.\nENDCLASS.\n\n\" Coverage: ~40% \u274c\n\" Branches n\u00e3o cobertos:\n\"   - Customer type 'R'\n\"   - Customer type outro\n\"   - Pre\u00e7o &gt; 1000 (taxa)\n</code></pre>","tags":["ABAP","Testing","Code Coverage","Quality Metrics"]},{"location":"testes/6_code_coverage/#testes-com-coverage-alto","title":"Testes com Coverage Alto \u2705","text":"<pre><code>CLASS ltc_calculator DEFINITION FOR TESTING\n  RISK LEVEL HARMLESS\n  DURATION SHORT.\n\n  PRIVATE SECTION.\n    DATA mo_cut TYPE REF TO zcl_price_calculator.\n\n    METHODS:\n      setup,\n      test_premium_customer FOR TESTING,\n      test_regular_customer FOR TESTING,\n      test_standard_customer FOR TESTING,\n      test_high_price_adds_service_fee FOR TESTING,\n      test_low_price_no_service_fee FOR TESTING.\nENDCLASS.\n\nCLASS ltc_calculator IMPLEMENTATION.\n  METHOD setup.\n    CREATE OBJECT mo_cut.\n  ENDMETHOD.\n\n  METHOD test_premium_customer.\n    \" Branch: customer_type = 'P'\n    DATA(lv_price) = mo_cut-&gt;calculate_final_price(\n      iv_base_price    = 1000\n      iv_customer_type = 'P' ).\n\n    cl_abap_unit_assert=&gt;assert_equals( act = lv_price exp = 900 ).\n  ENDMETHOD.\n\n  METHOD test_regular_customer.\n    \" Branch: customer_type = 'R'\n    DATA(lv_price) = mo_cut-&gt;calculate_final_price(\n      iv_base_price    = 1000\n      iv_customer_type = 'R' ).\n\n    cl_abap_unit_assert=&gt;assert_equals( act = lv_price exp = 950 ).\n  ENDMETHOD.\n\n  METHOD test_standard_customer.\n    \" Branch: customer_type = outro\n    DATA(lv_price) = mo_cut-&gt;calculate_final_price(\n      iv_base_price    = 1000\n      iv_customer_type = 'S' ).\n\n    cl_abap_unit_assert=&gt;assert_equals( act = lv_price exp = 1000 ).\n  ENDMETHOD.\n\n  METHOD test_high_price_adds_service_fee.\n    \" Branch: price &gt; 1000\n    DATA(lv_price) = mo_cut-&gt;calculate_final_price(\n      iv_base_price    = 1200\n      iv_customer_type = 'S' ).\n\n    cl_abap_unit_assert=&gt;assert_equals(\n      act = lv_price\n      exp = 1250  \" 1200 + 50 taxa\n      msg = 'Pre\u00e7o alto deveria incluir taxa de servi\u00e7o' ).\n  ENDMETHOD.\n\n  METHOD test_low_price_no_service_fee.\n    \" Branch: price &lt;= 1000\n    DATA(lv_price) = mo_cut-&gt;calculate_final_price(\n      iv_base_price    = 500\n      iv_customer_type = 'S' ).\n\n    cl_abap_unit_assert=&gt;assert_equals(\n      act = lv_price\n      exp = 500\n      msg = 'Pre\u00e7o baixo n\u00e3o deveria ter taxa' ).\n  ENDMETHOD.\nENDCLASS.\n\n\" Coverage: ~95% \u2705\n\" Todos os branches cobertos!\n</code></pre>","tags":["ABAP","Testing","Code Coverage","Quality Metrics"]},{"location":"testes/6_code_coverage/#melhorar-coverage","title":"\ud83d\udcc8 Melhorar Coverage","text":"","tags":["ABAP","Testing","Code Coverage","Quality Metrics"]},{"location":"testes/6_code_coverage/#1-identificar-gaps","title":"1. Identificar Gaps","text":"<pre><code>Coverage Report:\n\u251c\u2500\u2500 calculate_final_price: 60%\n\u2502   \u251c\u2500\u2500 Line 5-6: \u2705 Covered\n\u2502   \u251c\u2500\u2500 Line 8-9: \u274c Not covered (ELSEIF branch)\n\u2502   \u2514\u2500\u2500 Line 15-16: \u274c Not covered (high price)\n</code></pre>","tags":["ABAP","Testing","Code Coverage","Quality Metrics"]},{"location":"testes/6_code_coverage/#2-criar-testes-para-gaps","title":"2. Criar Testes para Gaps","text":"<pre><code>METHOD test_missing_branch.\n  \" Cobrir linha 8-9\n  DATA(lv_price) = mo_cut-&gt;calculate_final_price(\n    iv_base_price    = 1000\n    iv_customer_type = 'R' ).  \" \u2705 Agora cobre ELSEIF\nENDMETHOD.\n</code></pre>","tags":["ABAP","Testing","Code Coverage","Quality Metrics"]},{"location":"testes/6_code_coverage/#3-re-executar-coverage","title":"3. Re-executar Coverage","text":"<pre><code>Coverage Report:\n\u251c\u2500\u2500 calculate_final_price: 85% \u2705 Melhorado!\n</code></pre>","tags":["ABAP","Testing","Code Coverage","Quality Metrics"]},{"location":"testes/6_code_coverage/#o-que-nao-contar","title":"\ud83c\udfaf O que N\u00c3O Contar","text":"<p>C\u00f3digo que pode ter baixo coverage:</p> <pre><code>\" 1. Getters/Setters triviais\nMETHOD get_value.\n  rv_value = mv_value.  \" OK ter 0% coverage\nENDMETHOD.\n\n\" 2. C\u00f3digo gerado automaticamente\n\" (ex: convers\u00f5es autom\u00e1ticas)\n\n\" 3. Construtores vazios\nMETHOD constructor.\n  \" Vazio\nENDMETHOD.\n\n\" 4. Exception handlers de erros improv\u00e1veis\nCATCH cx_sy_itab_line_not_found.\n  \" Nunca deveria acontecer = OK n\u00e3o testar\n</code></pre>","tags":["ABAP","Testing","Code Coverage","Quality Metrics"]},{"location":"testes/6_code_coverage/#boas-praticas","title":"\u26a1 Boas Pr\u00e1ticas","text":"","tags":["ABAP","Testing","Code Coverage","Quality Metrics"]},{"location":"testes/6_code_coverage/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Testar todos os branches cr\u00edticos\nIF iv_status = 'CRITICAL'.\n  \" \u2705 Deve ter teste\nENDIF.\n\n\" 2. Foco em l\u00f3gica de neg\u00f3cio\nMETHOD calculate_complex_discount.\n  \" \u2705 90%+ coverage aqui\nENDMETHOD.\n\n\" 3. Coverage como m\u00e9trica, n\u00e3o meta\n\" 80% com testes bons &gt; 100% com testes ruins\n\n\" 4. Revisar c\u00f3digo n\u00e3o coberto\n\" Ser\u00e1 que \u00e9 c\u00f3digo morto?\n</code></pre>","tags":["ABAP","Testing","Code Coverage","Quality Metrics"]},{"location":"testes/6_code_coverage/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Testes s\u00f3 para coverage\nMETHOD test_for_coverage.\n  mo_cut-&gt;do_something( ).  \" \u274c Sem assertion!\nENDMETHOD.\n\n\" 2. Obcecar com 100%\n\" \u274c Gastar horas testando getters triviais\n\n\" 3. Ignorar coverage baixo em c\u00f3digo cr\u00edtico\nMETHOD process_payment.\n  \" \u274c 30% coverage aqui \u00e9 GRAVE!\nENDMETHOD.\n</code></pre>","tags":["ABAP","Testing","Code Coverage","Quality Metrics"]},{"location":"testes/6_code_coverage/#relatorios-coverage","title":"\ud83d\udcca Relat\u00f3rios Coverage","text":"","tags":["ABAP","Testing","Code Coverage","Quality Metrics"]},{"location":"testes/6_code_coverage/#ver-em-eclipse-adt","title":"Ver em Eclipse ADT","text":"<pre><code>Window \u2192 Show View \u2192 Other \u2192 ABAP \u2192 Coverage\n</code></pre>","tags":["ABAP","Testing","Code Coverage","Quality Metrics"]},{"location":"testes/6_code_coverage/#exportar-relatorio","title":"Exportar Relat\u00f3rio","text":"<pre><code>Coverage View \u2192 Export \u2192 HTML/CSV\n</code></pre>","tags":["ABAP","Testing","Code Coverage","Quality Metrics"]},{"location":"testes/6_code_coverage/#cicd-integration","title":"CI/CD Integration","text":"<pre><code># Falhar build se coverage &lt; 70%\nabap_unit:\n  min_coverage: 70\n</code></pre>","tags":["ABAP","Testing","Code Coverage","Quality Metrics"]},{"location":"testes/6_code_coverage/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>ABAP Unit B\u00e1sico - Criar testes</li> <li>TDD - Coverage natural com TDD</li> <li>Assertions - Verifica\u00e7\u00f5es eficazes</li> </ul> <p>Tags: <code>#Code-Coverage</code> <code>#Quality-Metrics</code> <code>#Testing</code> <code>#SCOV</code></p>","tags":["ABAP","Testing","Code Coverage","Quality Metrics"]},{"location":"testes/7_tdd/","title":"TDD - Test-Driven Development","text":"","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>TDD (Test-Driven Development) \u00e9 uma pr\u00e1tica onde voc\u00ea escreve o teste ANTES do c\u00f3digo de produ\u00e7\u00e3o, seguindo o ciclo Red-Green-Refactor.</p>","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#ciclo-red-green-refactor","title":"\ud83d\udd04 Ciclo Red-Green-Refactor","text":"<pre><code>1. \ud83d\udd34 RED: Escrever teste que FALHA\n         \u2193\n2. \ud83d\udfe2 GREEN: Escrever c\u00f3digo m\u00ednimo para PASSAR\n         \u2193\n3. \ud83d\udd35 REFACTOR: Melhorar c\u00f3digo SEM alterar comportamento\n         \u2193\n     (Repetir)\n</code></pre>","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#regras-do-tdd","title":"\ud83c\udfaf Regras do TDD","text":"","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#1-nao-escrever-codigo-de-producao-sem-teste-falhando","title":"1. N\u00e3o escrever c\u00f3digo de produ\u00e7\u00e3o sem teste falhando","text":"","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#2-escrever-apenas-teste-suficiente-para-falhar","title":"2. Escrever apenas teste suficiente para falhar","text":"","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#3-escrever-apenas-codigo-suficiente-para-passar-no-teste","title":"3. Escrever apenas c\u00f3digo suficiente para passar no teste","text":"","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#exemplo-completo-calculadora","title":"\ud83d\udca1 Exemplo Completo: Calculadora","text":"","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#passo-1-red-teste-falha","title":"\ud83d\udd34 PASSO 1: Red - Teste Falha","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; TDD Exemplo: Calculadora\n*&amp;---------------------------------------------------------------------*\n\n\" \u2550\u2550\u2550 TESTE (escrever PRIMEIRO) \u2550\u2550\u2550\nCLASS ltc_calculator DEFINITION FOR TESTING\n  RISK LEVEL HARMLESS\n  DURATION SHORT.\n\n  PRIVATE SECTION.\n    DATA mo_cut TYPE REF TO zcl_calculator.\n\n    METHODS:\n      setup,\n      test_add_two_numbers FOR TESTING.\nENDCLASS.\n\nCLASS ltc_calculator IMPLEMENTATION.\n  METHOD setup.\n    CREATE OBJECT mo_cut.\n  ENDMETHOD.\n\n  METHOD test_add_two_numbers.\n    \" Arrange\n    DATA(lv_a) = 5.\n    DATA(lv_b) = 3.\n\n    \" Act\n    DATA(lv_result) = mo_cut-&gt;add( iv_a = lv_a iv_b = lv_b ).\n\n    \" Assert\n    cl_abap_unit_assert=&gt;assert_equals(\n      act = lv_result\n      exp = 8\n      msg = '5 + 3 deveria ser 8' ).\n  ENDMETHOD.\nENDCLASS.\n</code></pre> <p>Executar: \u274c FALHA (m\u00e9todo <code>add</code> n\u00e3o existe ainda!)</p>","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#passo-2-green-codigo-minimo","title":"\ud83d\udfe2 PASSO 2: Green - C\u00f3digo M\u00ednimo","text":"<pre><code>\" \u2550\u2550\u2550 C\u00d3DIGO DE PRODU\u00c7\u00c3O (escrever DEPOIS) \u2550\u2550\u2550\nCLASS zcl_calculator DEFINITION PUBLIC.\n  PUBLIC SECTION.\n    METHODS add\n      IMPORTING iv_a TYPE i\n                iv_b TYPE i\n      RETURNING VALUE(rv_result) TYPE i.\nENDCLASS.\n\nCLASS zcl_calculator IMPLEMENTATION.\n  METHOD add.\n    \" C\u00f3digo M\u00cdNIMO para passar\n    rv_result = iv_a + iv_b.\n  ENDMETHOD.\nENDCLASS.\n</code></pre> <p>Executar: \u2705 PASSA!</p>","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#passo-3-refactor-melhorar","title":"\ud83d\udd35 PASSO 3: Refactor - Melhorar","text":"<pre><code>\" Neste caso simples, j\u00e1 est\u00e1 OK\n\" Refactor seria: renomear vari\u00e1veis, extrair m\u00e9todos, etc.\n</code></pre> <p>Executar novamente: \u2705 AINDA PASSA!</p>","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#repetir-proximo-teste","title":"\ud83d\udd04 REPETIR: Pr\u00f3ximo Teste","text":"<pre><code>\" \u2550\u2550\u2550 ADICIONAR TESTE PARA SUBTRA\u00c7\u00c3O \u2550\u2550\u2550\nMETHOD test_subtract_two_numbers FOR TESTING.\n  \" Arrange\n  DATA(lv_a) = 10.\n  DATA(lv_b) = 4.\n\n  \" Act\n  DATA(lv_result) = mo_cut-&gt;subtract( iv_a = lv_a iv_b = lv_b ).\n\n  \" Assert\n  cl_abap_unit_assert=&gt;assert_equals(\n    act = lv_result\n    exp = 6\n    msg = '10 - 4 deveria ser 6' ).\nENDMETHOD.\n</code></pre> <p>Executar: \u274c FALHA (m\u00e9todo <code>subtract</code> n\u00e3o existe)</p> <pre><code>\" \u2550\u2550\u2550 IMPLEMENTAR subtract \u2550\u2550\u2550\nMETHOD subtract.\n  rv_result = iv_a - iv_b.\nENDMETHOD.\n</code></pre> <p>Executar: \u2705 PASSA!</p>","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#exemplo-avancado-validador-de-email","title":"\ud83c\udfd7\ufe0f Exemplo Avan\u00e7ado: Validador de Email","text":"","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#iteracao-1-email-vazio","title":"Itera\u00e7\u00e3o 1: Email Vazio","text":"","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#red","title":"\ud83d\udd34 Red","text":"<pre><code>METHOD test_empty_email_is_invalid FOR TESTING.\n  \" Act\n  DATA(lv_valid) = mo_validator-&gt;is_valid_email( '' ).\n\n  \" Assert\n  cl_abap_unit_assert=&gt;assert_false(\n    act = lv_valid\n    msg = 'Email vazio deveria ser inv\u00e1lido' ).\nENDMETHOD.\n</code></pre> <p>\u274c Falha: m\u00e9todo n\u00e3o existe</p>","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#green","title":"\ud83d\udfe2 Green","text":"<pre><code>CLASS zcl_email_validator IMPLEMENTATION.\n  METHOD is_valid_email.\n    IF iv_email IS INITIAL.\n      rv_valid = abap_false.\n    ELSE.\n      rv_valid = abap_true.  \" Implementa\u00e7\u00e3o m\u00ednima\n    ENDIF.\n  ENDMETHOD.\nENDCLASS.\n</code></pre> <p>\u2705 Passa!</p>","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#iteracao-2-email-sem","title":"Itera\u00e7\u00e3o 2: Email sem @","text":"","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#red_1","title":"\ud83d\udd34 Red","text":"<pre><code>METHOD test_email_without_at_is_invalid FOR TESTING.\n  \" Act\n  DATA(lv_valid) = mo_validator-&gt;is_valid_email( 'teste.com' ).\n\n  \" Assert\n  cl_abap_unit_assert=&gt;assert_false(\n    act = lv_valid\n    msg = 'Email sem @ deveria ser inv\u00e1lido' ).\nENDMETHOD.\n</code></pre> <p>\u274c Falha: retorna <code>true</code> (implementa\u00e7\u00e3o atual)</p>","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#green_1","title":"\ud83d\udfe2 Green","text":"<pre><code>METHOD is_valid_email.\n  IF iv_email IS INITIAL.\n    rv_valid = abap_false.\n    RETURN.\n  ENDIF.\n\n  \" Verificar @\n  IF NOT iv_email CA '@'.\n    rv_valid = abap_false.\n    RETURN.\n  ENDIF.\n\n  rv_valid = abap_true.\nENDMETHOD.\n</code></pre> <p>\u2705 Passa!</p>","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#iteracao-3-email-valido","title":"Itera\u00e7\u00e3o 3: Email V\u00e1lido","text":"","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#red_2","title":"\ud83d\udd34 Red","text":"<pre><code>METHOD test_valid_email FOR TESTING.\n  \" Act\n  DATA(lv_valid) = mo_validator-&gt;is_valid_email( 'user@example.com' ).\n\n  \" Assert\n  cl_abap_unit_assert=&gt;assert_true(\n    act = lv_valid\n    msg = 'Email v\u00e1lido deveria ser aceite' ).\nENDMETHOD.\n</code></pre> <p>\u2705 J\u00e1 passa! (implementa\u00e7\u00e3o atual aceita)</p>","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#refactor","title":"\ud83d\udd35 Refactor","text":"<pre><code>METHOD is_valid_email.\n  \" Extrair valida\u00e7\u00f5es para m\u00e9todos privados\n  IF iv_email IS INITIAL OR\n     NOT contains_at_sign( iv_email ) OR\n     NOT contains_domain( iv_email ).\n    rv_valid = abap_false.\n  ELSE.\n    rv_valid = abap_true.\n  ENDIF.\nENDMETHOD.\n\nMETHOD contains_at_sign.\n  rv_result = xsdbool( iv_email CA '@' ).\nENDMETHOD.\n\nMETHOD contains_domain.\n  SPLIT iv_email AT '@' INTO DATA(lv_user) DATA(lv_domain).\n  rv_result = xsdbool( lv_domain IS NOT INITIAL ).\nENDMETHOD.\n</code></pre> <p>\u2705 Testes ainda passam!</p>","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#vantagens-do-tdd","title":"\ud83c\udfaf Vantagens do TDD","text":"","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#beneficios","title":"\u2705 Benef\u00edcios","text":"<ol> <li>Design melhor - C\u00f3digo test\u00e1vel = c\u00f3digo desacoplado</li> <li>Menos bugs - Testes desde in\u00edcio</li> <li>Documenta\u00e7\u00e3o - Testes mostram uso esperado</li> <li>Confian\u00e7a - Refatorar sem medo</li> <li>Coverage alto - Naturalmente &gt;80%</li> <li>Foco - Um problema de cada vez</li> </ol>","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#desafios-do-tdd","title":"\u26a0\ufe0f Desafios do TDD","text":"","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#dificuldades","title":"Dificuldades","text":"<ol> <li>Curva aprendizado - Requer pr\u00e1tica</li> <li>Mais tempo inicial - Compensa no longo prazo</li> <li>Dif\u00edcil com c\u00f3digo legado - Sem testes existentes</li> <li>Requer disciplina - N\u00e3o pular Red-Green-Refactor</li> </ol>","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#baby-steps","title":"\ud83d\udca1 Baby Steps","text":"<p>Regra: Passos pequenos e incrementais.</p> <pre><code>\" \u274c RUIM: Implementar tudo de uma vez\nMETHOD validate_order.\n  \" 200 linhas de valida\u00e7\u00e3o complexa sem testes\nENDMETHOD.\n\n\" \u2705 BOM: Um caso de cada vez\nMETHOD test_order_without_customer_is_invalid FOR TESTING.\n  \" Testar APENAS customer vazio\nENDMETHOD.\n\nMETHOD test_order_without_items_is_invalid FOR TESTING.\n  \" Testar APENAS items vazios (PR\u00d3XIMO passo)\nENDMETHOD.\n</code></pre>","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#exemplo-completo-processador-de-pedidos","title":"\ud83c\udf93 Exemplo Completo: Processador de Pedidos","text":"<pre><code>*&amp;---------------------------------------------------------------------*\n*&amp; TDD Completo: Processador de Pedidos\n*&amp;---------------------------------------------------------------------*\n\n\" \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\" CLASSE DE TESTE (escrever PRIMEIRO)\n\" \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\nCLASS ltc_order_processor DEFINITION FOR TESTING\n  RISK LEVEL HARMLESS\n  DURATION SHORT.\n\n  PRIVATE SECTION.\n    DATA mo_cut TYPE REF TO zcl_order_processor.\n\n    METHODS:\n      setup,\n\n      \" Itera\u00e7\u00e3o 1\n      test_order_with_valid_data_is_created FOR TESTING,\n\n      \" Itera\u00e7\u00e3o 2\n      test_order_without_customer_raises_error FOR TESTING,\n\n      \" Itera\u00e7\u00e3o 3\n      test_order_without_items_raises_error FOR TESTING.\n\nENDCLASS.\n\nCLASS ltc_order_processor IMPLEMENTATION.\n  METHOD setup.\n    CREATE OBJECT mo_cut.\n  ENDMETHOD.\n\n  \" \u2550\u2550\u2550 ITERA\u00c7\u00c3O 1: Happy Path \u2550\u2550\u2550\n  METHOD test_order_with_valid_data_is_created.\n    \" Arrange\n    DATA(ls_order) = VALUE ty_order(\n      customer_id = '100001'\n      items       = VALUE #( ( material = 'MAT001' quantity = 10 ) ) ).\n\n    \" Act\n    DATA(lv_order_id) = mo_cut-&gt;create_order( ls_order ).\n\n    \" Assert\n    cl_abap_unit_assert=&gt;assert_not_initial(\n      act = lv_order_id\n      msg = 'Order ID deveria ser gerado' ).\n  ENDMETHOD.\n\n  \" \u2550\u2550\u2550 ITERA\u00c7\u00c3O 2: Valida\u00e7\u00e3o Customer \u2550\u2550\u2550\n  METHOD test_order_without_customer_raises_error.\n    \" Arrange\n    DATA(ls_order) = VALUE ty_order(\n      customer_id = ''  \" Vazio!\n      items       = VALUE #( ( material = 'MAT001' quantity = 10 ) ) ).\n\n    \" Act &amp; Assert\n    TRY.\n        mo_cut-&gt;create_order( ls_order ).\n        cl_abap_unit_assert=&gt;fail( 'Deveria lan\u00e7ar cx_invalid_order' ).\n      CATCH cx_invalid_order.\n        \" OK\n    ENDTRY.\n  ENDMETHOD.\n\n  \" \u2550\u2550\u2550 ITERA\u00c7\u00c3O 3: Valida\u00e7\u00e3o Items \u2550\u2550\u2550\n  METHOD test_order_without_items_raises_error.\n    \" Arrange\n    DATA(ls_order) = VALUE ty_order(\n      customer_id = '100001'\n      items       = VALUE #( ) ).  \" Vazio!\n\n    \" Act &amp; Assert\n    TRY.\n        mo_cut-&gt;create_order( ls_order ).\n        cl_abap_unit_assert=&gt;fail( 'Deveria lan\u00e7ar cx_invalid_order' ).\n      CATCH cx_invalid_order.\n        \" OK\n    ENDTRY.\n  ENDMETHOD.\n\nENDCLASS.\n\n\" \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\" CLASSE DE PRODU\u00c7\u00c3O (escrever DEPOIS, iterativamente)\n\" \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\nCLASS zcl_order_processor DEFINITION PUBLIC.\n  PUBLIC SECTION.\n    METHODS create_order\n      IMPORTING is_order TYPE ty_order\n      RETURNING VALUE(rv_order_id) TYPE vbeln\n      RAISING   cx_invalid_order.\nENDCLASS.\n\nCLASS zcl_order_processor IMPLEMENTATION.\n  METHOD create_order.\n    \" Itera\u00e7\u00e3o 2: Validar customer\n    IF is_order-customer_id IS INITIAL.\n      RAISE EXCEPTION TYPE cx_invalid_order\n        EXPORTING textid = cx_invalid_order=&gt;customer_required.\n    ENDIF.\n\n    \" Itera\u00e7\u00e3o 3: Validar items\n    IF is_order-items IS INITIAL.\n      RAISE EXCEPTION TYPE cx_invalid_order\n        EXPORTING textid = cx_invalid_order=&gt;items_required.\n    ENDIF.\n\n    \" Itera\u00e7\u00e3o 1: Gerar ID\n    rv_order_id = |ORD{ sy-datum }{ sy-uzeit }|.\n\n    \" TODO (pr\u00f3ximas itera\u00e7\u00f5es):\n    \" - Salvar no BD\n    \" - Enviar notifica\u00e7\u00e3o\n    \" - Atualizar estoque\n  ENDMETHOD.\nENDCLASS.\n</code></pre>","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#boas-praticas-tdd","title":"\u26a1 Boas Pr\u00e1ticas TDD","text":"","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#fazer","title":"\u2705 Fazer","text":"<pre><code>\" 1. Red-Green-Refactor sempre\n\" \ud83d\udd34 Teste falha \u2192 \ud83d\udfe2 C\u00f3digo passa \u2192 \ud83d\udd35 Refactor\n\n\" 2. Baby steps\n\" \u2705 Um requisito de cada vez\n\n\" 3. Testar comportamento, n\u00e3o implementa\u00e7\u00e3o\ncl_abap_unit_assert=&gt;assert_equals(\n  act = lo_order-&gt;get_total( )  \" \u2705 Comportamento p\u00fablico\n  exp = 1000 ).\n\n\" 4. Refactor quando testes passam\n\" \ud83d\udfe2 Verde = seguro refatorar\n\n\" 5. Commits frequentes\n\" Commit ap\u00f3s cada ciclo Red-Green-Refactor\n</code></pre>","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#evitar","title":"\u274c Evitar","text":"<pre><code>\" 1. Pular para Green sem Red\n\" \u274c Escrever c\u00f3digo antes do teste\n\n\" 2. Testes complexos demais\nMETHOD test_entire_workflow FOR TESTING.\n  \" \u274c Testar 10 coisas de uma vez\nENDMETHOD.\n\n\" 3. N\u00e3o refatorar\n\" \u274c C\u00f3digo funciona mas fica bagun\u00e7ado\n\n\" 4. Alterar teste para passar\n\" \u274c Teste falha? Corrigir c\u00f3digo, n\u00e3o teste!\n</code></pre>","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"testes/7_tdd/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ul> <li>ABAP Unit B\u00e1sico - Fundamentos de testes</li> <li>Inje\u00e7\u00e3o de Depend\u00eancias - Design test\u00e1vel</li> <li>Code Coverage - TDD = coverage natural</li> </ul> <p>Tags: <code>#TDD</code> <code>#Test-Driven-Development</code> <code>#Red-Green-Refactor</code> <code>#Agile</code></p>","tags":["ABAP","TDD","Test Driven Development","Agile"]},{"location":"utilitarios/","title":"\ud83e\uddf0 Utilit\u00e1rios e Fun\u00e7\u00f5es Comuns","text":"<p>Snippets, utilit\u00e1rios e fun\u00e7\u00f5es auxiliares \u00fateis em desenvolvimento ABAP: datas, JSON, strings, convers\u00f5es e muito mais.</p>"},{"location":"utilitarios/#o-que-vais-encontrar","title":"\ud83d\udcd6 O que vais encontrar","text":"<ul> <li>Manipula\u00e7\u00e3o de datas e horas</li> <li>Convers\u00e3o JSON/XML</li> <li>Opera\u00e7\u00f5es com strings</li> <li>Fun\u00e7\u00f5es de convers\u00e3o</li> <li>Gera\u00e7\u00e3o de GUIDs</li> <li>Trabalhar com ficheiros</li> <li>Envio de emails</li> <li>PopUps e mensagens</li> <li>Utilit\u00e1rios de tabela</li> </ul>"},{"location":"utilitarios/#categorias","title":"\ud83c\udfaf Categorias","text":""},{"location":"utilitarios/#datas-e-horas","title":"\ud83d\udcc5 Datas e Horas","text":"<pre><code>\" Data atual\nDATA(lv_hoje) = sy-datum.\n\n\" Adicionar dias\nDATA(lv_amanha) = lv_hoje + 1.\nDATA(lv_proxima_semana) = lv_hoje + 7.\n\n\" Diferen\u00e7a entre datas\nDATA lv_dias TYPE i.\nCALL FUNCTION 'HR_99S_INTERVAL_BETWEEN_DATES'\n  EXPORTING\n    begda = lv_data_inicio\n    endda = lv_data_fim\n  IMPORTING\n    days  = lv_dias.\n\n\" Primeiro dia do m\u00eas\nDATA(lv_primeiro_dia) = lv_hoje.\nlv_primeiro_dia+6(2) = '01'.\n\n\" \u00daltimo dia do m\u00eas\nCALL FUNCTION 'LAST_DAY_OF_MONTHS'\n  EXPORTING\n    day_in  = lv_hoje\n  IMPORTING\n    last_day_of_month = DATA(lv_ultimo_dia).\n\n\" Formatar data\nWRITE lv_hoje TO DATA(lv_data_formatada) DD/MM/YYYY.\n</code></pre>"},{"location":"utilitarios/#json","title":"\ud83d\udce6 JSON","text":"<pre><code>\" Serializar (ABAP \u2192 JSON)\nDATA: lt_dados TYPE TABLE OF sflight.\nSELECT * FROM sflight INTO TABLE lt_dados UP TO 10 ROWS.\n\nDATA(lv_json) = /ui2/cl_json=&gt;serialize( \n  data = lt_dados \n  compress = abap_false \n  pretty_name = /ui2/cl_json=&gt;pretty_mode-camel_case ).\n\n\" Deserializar (JSON \u2192 ABAP)\n/ui2/cl_json=&gt;deserialize(\n  EXPORTING json = lv_json\n  CHANGING  data = lt_dados ).\n\n\" JSON com formata\u00e7\u00e3o bonita\nDATA(lv_json_pretty) = /ui2/cl_json=&gt;serialize( \n  data = lt_dados \n  compress = abap_false\n  pretty_name = /ui2/cl_json=&gt;pretty_mode-low_case ).\n</code></pre>"},{"location":"utilitarios/#strings","title":"\ud83d\udd24 Strings","text":""},{"location":"utilitarios/#concatenar","title":"Concatenar","text":"<pre><code>DATA(lv_nome_completo) = |{ lv_primeiro_nome } { lv_apelido }|.\n\n\" Ou com CONCATENATE\nCONCATENATE lv_primeiro_nome lv_apelido \n  INTO lv_nome_completo SEPARATED BY space.\n</code></pre>"},{"location":"utilitarios/#dividir","title":"Dividir","text":"<pre><code>SPLIT lv_email AT '@' INTO lv_user lv_domain.\n</code></pre>"},{"location":"utilitarios/#substituir","title":"Substituir","text":"<pre><code>REPLACE ALL OCCURRENCES OF '.' IN lv_texto WITH ','.\n</code></pre>"},{"location":"utilitarios/#maiusculasminusculas","title":"Mai\u00fasculas/Min\u00fasculas","text":"<pre><code>DATA(lv_maiusculas) = to_upper( lv_texto ).\nDATA(lv_minusculas) = to_lower( lv_texto ).\n</code></pre>"},{"location":"utilitarios/#remover-espacos","title":"Remover espa\u00e7os","text":"<pre><code>CONDENSE lv_texto NO-GAPS.  \" Remove todos os espa\u00e7os\nCONDENSE lv_texto.           \" Remove espa\u00e7os extra\n</code></pre>"},{"location":"utilitarios/#conversoes","title":"\ud83d\udd04 Convers\u00f5es","text":""},{"location":"utilitarios/#string-numero","title":"String \u2194 N\u00famero","text":"<pre><code>\" String para n\u00famero\nDATA(lv_numero) = CONV i( '123' ).\n\n\" N\u00famero para string\nDATA(lv_texto) = |{ lv_numero }|.\nDATA(lv_texto2) = CONV string( lv_numero ).\n</code></pre>"},{"location":"utilitarios/#data-string","title":"Data \u2194 String","text":"<pre><code>\" Data para string\nDATA lv_data_str TYPE string.\nWRITE sy-datum TO lv_data_str DD/MM/YYYY.\n\n\" String para data\nCALL FUNCTION 'CONVERT_DATE_TO_INTERNAL'\n  EXPORTING\n    date_external = '31/12/2024'\n    accept_initial_date = abap_true\n  IMPORTING\n    date_internal = DATA(lv_data).\n</code></pre>"},{"location":"utilitarios/#guid-uuid","title":"\ud83c\udd94 GUID / UUID","text":"<pre><code>TRY.\n    DATA(lv_guid) = cl_system_uuid=&gt;create_uuid_x16_static( ).\n    DATA(lv_guid_c32) = cl_system_uuid=&gt;convert_uuid_x16_static( lv_guid ).\n    WRITE: / lv_guid_c32.\n  CATCH cx_uuid_error.\n    MESSAGE 'Erro ao gerar GUID' TYPE 'E'.\nENDTRY.\n</code></pre>"},{"location":"utilitarios/#envio-de-email","title":"\u2709\ufe0f Envio de Email","text":"<pre><code>DATA: lt_receivers TYPE TABLE OF somlreci1,\n      lt_body      TYPE TABLE OF soli.\n\nAPPEND VALUE #( receiver = 'user@empresa.com' rec_type = 'U' ) TO lt_receivers.\nAPPEND 'Ol\u00e1,' TO lt_body.\nAPPEND 'Este \u00e9 um email de teste.' TO lt_body.\n\nCALL FUNCTION 'SO_NEW_DOCUMENT_ATT_SEND_API1'\n  EXPORTING\n    document_data = VALUE sodocchgi1(\n      obj_name  = 'EMAIL'\n      obj_descr = 'Assunto do Email' )\n  TABLES\n    object_content = lt_body\n    receivers      = lt_receivers\n  EXCEPTIONS\n    OTHERS = 99.\n\nIF sy-subrc = 0.\n  COMMIT WORK.\n  MESSAGE 'Email enviado com sucesso' TYPE 'S'.\nENDIF.\n</code></pre>"},{"location":"utilitarios/#ficheiros","title":"\ud83d\udcc1 Ficheiros","text":""},{"location":"utilitarios/#ler-ficheiro-local","title":"Ler ficheiro local","text":"<pre><code>DATA: lt_dados TYPE TABLE OF string.\n\nCALL FUNCTION 'GUI_UPLOAD'\n  EXPORTING\n    filename = 'C:\\temp\\dados.txt'\n  TABLES\n    data_tab = lt_dados.\n</code></pre>"},{"location":"utilitarios/#gravar-ficheiro-local","title":"Gravar ficheiro local","text":"<pre><code>DATA: lt_output TYPE TABLE OF string.\nAPPEND 'Linha 1' TO lt_output.\nAPPEND 'Linha 2' TO lt_output.\n\nCALL FUNCTION 'GUI_DOWNLOAD'\n  EXPORTING\n    filename = 'C:\\temp\\output.txt'\n  TABLES\n    data_tab = lt_output.\n</code></pre>"},{"location":"utilitarios/#popups-e-mensagens","title":"\ud83d\udcac PopUps e Mensagens","text":""},{"location":"utilitarios/#popup-de-confirmacao","title":"Popup de Confirma\u00e7\u00e3o","text":"<pre><code>CALL FUNCTION 'POPUP_TO_CONFIRM'\n  EXPORTING\n    titlebar       = 'Confirmar'\n    text_question  = 'Tem a certeza?'\n    icon_button_1  = 'icon_okay'\n    icon_button_2  = 'icon_cancel'\n  IMPORTING\n    answer         = DATA(lv_resposta).\n\nIF lv_resposta = '1'.  \" Sim\n  WRITE: / 'Confirmado'.\nENDIF.\n</code></pre>"},{"location":"utilitarios/#popup-com-input","title":"Popup com Input","text":"<pre><code>DATA lv_valor TYPE string.\n\nCALL FUNCTION 'POPUP_GET_VALUES'\n  EXPORTING\n    popup_title = 'Introduzir Valor'\n  TABLES\n    fields      = VALUE sval_tab(\n      ( tabname = 'SCARR' fieldname = 'CARRID' value = lv_valor ) ).\n\nWRITE: / 'Valor:', lv_valor.\n</code></pre>"},{"location":"utilitarios/#mensagem-de-progresso","title":"Mensagem de Progresso","text":"<pre><code>CALL FUNCTION 'SAPGUI_PROGRESS_INDICATOR'\n  EXPORTING\n    percentage = 50\n    text       = 'A processar... 50%'.\n</code></pre>"},{"location":"utilitarios/#operacoes-com-tabelas","title":"\ud83d\udd22 Opera\u00e7\u00f5es com Tabelas","text":""},{"location":"utilitarios/#remover-duplicados","title":"Remover Duplicados","text":"<pre><code>SORT lt_dados.\nDELETE ADJACENT DUPLICATES FROM lt_dados.\n</code></pre>"},{"location":"utilitarios/#contar-linhas-com-condicao","title":"Contar Linhas com Condi\u00e7\u00e3o","text":"<pre><code>DATA(lv_count) = REDUCE i( INIT x = 0\n                           FOR wa IN lt_dados WHERE ( price &gt; 1000 )\n                           NEXT x = x + 1 ).\n</code></pre>"},{"location":"utilitarios/#filtrar-tabela","title":"Filtrar Tabela","text":"<pre><code>DATA(lt_filtrada) = FILTER #( lt_dados WHERE carrid = 'LH' ).\n</code></pre>"},{"location":"utilitarios/#mapeartransformar","title":"Mapear/Transformar","text":"<pre><code>DATA(lt_nomes) = VALUE stringtab( FOR wa IN lt_pessoas ( wa-nome ) ).\n</code></pre>"},{"location":"utilitarios/#exercicios-praticos","title":"\ud83d\udcda Exerc\u00edcios Pr\u00e1ticos","text":"<p>Exerc\u00edcios dispon\u00edveis (ser\u00e3o desenvolvidos): - <code>ex01.md</code> \u2192 Manipula\u00e7\u00e3o de datas - <code>ex02.md</code> \u2192 JSON e XML - <code>ex03.md</code> \u2192 Opera\u00e7\u00f5es com strings - <code>ex04.md</code> \u2192 Upload/Download ficheiros - <code>ex05.md</code> \u2192 Envio de emails - <code>ex06-ex10.md</code> \u2192 Casos pr\u00e1ticos diversos</p>"},{"location":"utilitarios/#funcoes-uteis","title":"\ud83e\udde9 Fun\u00e7\u00f5es \u00dateis","text":"Fun\u00e7\u00e3o Descri\u00e7\u00e3o <code>POPUP_TO_CONFIRM</code> Popup de confirma\u00e7\u00e3o <code>POPUP_GET_VALUES</code> Popup com input <code>GUI_UPLOAD</code> Upload ficheiro <code>GUI_DOWNLOAD</code> Download ficheiro <code>SO_NEW_DOCUMENT_ATT_SEND_API1</code> Enviar email <code>CONVERT_DATE_TO_INTERNAL</code> Converter data <code>HR_99S_INTERVAL_BETWEEN_DATES</code> Diferen\u00e7a entre datas <code>LAST_DAY_OF_MONTHS</code> \u00daltimo dia do m\u00eas"},{"location":"utilitarios/#proximos-passos","title":"\ud83d\udd17 Pr\u00f3ximos Passos","text":"<ol> <li>Explore Strings - Manipula\u00e7\u00e3o de texto</li> <li>Domine Datas e Horas - C\u00e1lculos temporais</li> <li>Aprenda Convers\u00f5es - Transformar tipos</li> <li>Pratique File Handling - Upload/Download</li> <li>Use Mensagens - Comunicar com usu\u00e1rio</li> <li>Implemente Number Ranges - Numera\u00e7\u00e3o autom\u00e1tica</li> <li>Gerencie Locks - Enqueue/Dequeue</li> </ol>"},{"location":"utilitarios/1_string_functions/","title":"Fun\u00e7\u00f5es de String","text":"","tags":["ABAP","Utilit\u00e1rios","Strings"]},{"location":"utilitarios/1_string_functions/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Strings s\u00e3o onipresentes em ABAP: nomes, IDs, descri\u00e7\u00f5es, mensagens. Esta p\u00e1gina re\u00fane as fun\u00e7\u00f5es e t\u00e9cnicas mais \u00fateis para manipular texto com seguran\u00e7a e desempenho.</p>","tags":["ABAP","Utilit\u00e1rios","Strings"]},{"location":"utilitarios/1_string_functions/#operacoes-basicas","title":"Opera\u00e7\u00f5es B\u00e1sicas","text":"<ul> <li>CONCATENAR: <code>CONCATENATE</code> ou templates</li> <li>DIVIDIR: <code>SPLIT</code></li> <li>SUBSTRING: <code>+</code>/<code>( )</code> ou <code>CONDENSE</code>/<code>SHIFT</code></li> <li>REPLACE: <code>REPLACE</code> ou <code>REPLACE ALL OCCURRENCES OF</code></li> <li>COMPARAR: <code>=</code> sens\u00edvel, <code>=</code>/<code>NE</code> com <code>TO_LOWER</code></li> </ul>","tags":["ABAP","Utilit\u00e1rios","Strings"]},{"location":"utilitarios/1_string_functions/#exemplos","title":"Exemplos","text":"<pre><code>DATA(lv1) = 'ABAP'.\nDATA(lv2) = 'Rocks'.\n\n\" Template (moderno)\nDATA(lv_concat) = |{ lv1 } { lv2 }|.\n\n\" CONCATENATE (legacy)\nCONCATENATE lv1 lv2 INTO DATA(lv_cat2) SEPARATED BY ' '.\n\n\" SPLIT\nSPLIT lv_concat AT ' ' INTO TABLE DATA(lt_parts).\n</code></pre>","tags":["ABAP","Utilit\u00e1rios","Strings"]},{"location":"utilitarios/1_string_functions/#funcoes-uteis-abap-740","title":"Fun\u00e7\u00f5es \u00dateis (ABAP 7.40+)","text":"<ul> <li><code>CONDENSE</code> remove espa\u00e7os extras</li> <li><code>TRANSLATE</code> para upper/lower</li> <li><code>FIND</code> para procurar substrings</li> <li><code>REPLACE</code> para substituir</li> <li><code>REGEX</code> com <code>FIND REGEX</code> e <code>REPLACE REGEX</code></li> </ul> <pre><code>\" Remover espa\u00e7os\nCONDENSE lv_concat.\n\n\" Procurar\nFIND 'Rocks' IN lv_concat.\nIF sy-subrc = 0.\n  \" achou\nENDIF.\n\n\" Regex\nFIND REGEX 'ABAP\\s+Rocks' IN lv_concat.\n</code></pre>","tags":["ABAP","Utilit\u00e1rios","Strings"]},{"location":"utilitarios/1_string_functions/#strings-e-performance","title":"Strings e Performance","text":"<ul> <li>Evite concatena\u00e7\u00f5es repetidas em loops (use <code>STRING( )</code> tempor\u00e1rio ou <code>cl_abap_string_utils</code> se dispon\u00edvel).</li> <li>Prefira templates (<code>|{ var }|</code>) em vez de <code>CONCATENATE</code> para clareza.</li> </ul>","tags":["ABAP","Utilit\u00e1rios","Strings"]},{"location":"utilitarios/1_string_functions/#internacionalizacao-e-encoding","title":"Internacionaliza\u00e7\u00e3o e Encoding","text":"<ul> <li>Use tipos <code>string</code> para texto Unicode.</li> <li>Para manipular bytes use <code>xstring</code>.</li> <li>Ao trabalhar com arquivos, converta entre <code>string</code> e <code>xstring</code> conforme necess\u00e1rio.</li> </ul>","tags":["ABAP","Utilit\u00e1rios","Strings"]},{"location":"utilitarios/1_string_functions/#boas-praticas","title":"Boas Pr\u00e1ticas","text":"<ul> <li>Valide tamanho antes de gravar em campos de base de dados (ex: <code>CHAR10</code>).</li> <li>Use <code>REPLACE ALL OCCURRENCES OF</code> para substitui\u00e7\u00f5es massivas.</li> <li>Para parsing complexo, prefira <code>FIND REGEX</code> e grupos de captura.</li> </ul>","tags":["ABAP","Utilit\u00e1rios","Strings"]},{"location":"utilitarios/1_string_functions/#proximos-passos","title":"Pr\u00f3ximos passos","text":"<ul> <li><code>2_data_hora.md</code> \u2014 formata\u00e7\u00e3o de datas</li> <li><code>3_conversoes.md</code> \u2014 convers\u00f5es entre tipos</li> </ul> <p>Tags: <code>#strings</code> <code>#text-processing</code> <code>#regex</code></p>","tags":["ABAP","Utilit\u00e1rios","Strings"]},{"location":"utilitarios/2_data_hora/","title":"Data e Hora","text":"","tags":["ABAP","Utilit\u00e1rios","DateTime"]},{"location":"utilitarios/2_data_hora/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Trabalhar com datas e horas em ABAP envolve tipos espec\u00edficos (<code>d</code>, <code>t</code>, <code>timestamp</code>, <code>tz</code>) e utilit\u00e1rios para convers\u00e3o, formata\u00e7\u00e3o e timezone.</p>","tags":["ABAP","Utilit\u00e1rios","DateTime"]},{"location":"utilitarios/2_data_hora/#tipos-comuns","title":"Tipos Comuns","text":"<ul> <li><code>d</code> (DATE) \u2014 formato interno YYYYMMDD</li> <li><code>t</code> (TIME) \u2014 formato HHMMSS</li> <li><code>timestamp</code> \u2014 geralmente <code>p</code> ou <code>string</code> dependendo da vers\u00e3o; use <code>cl_abap_tstmp</code></li> <li><code>tzoffset</code> / timezone handling com classes (ex: <code>cl_abap_tstmp</code>, <code>cl_abap_tstmp_util</code>)</li> </ul>","tags":["ABAP","Utilit\u00e1rios","DateTime"]},{"location":"utilitarios/2_data_hora/#conversoes","title":"Convers\u00f5es","text":"<pre><code>DATA(lv_date) = sy-datum.    \" hoje\nDATA(lv_time) = sy-uzeit.    \" agora\n\n\" String -&gt; Date\nDATA(lv_date_from_str) = |20251105|.\n\n\" Date -&gt; YYYY-MM-DD\nDATA(lv_formatted) = |{ lv_date(4) }-{ lv_date+4(2) }-{ lv_date+6(2) }|.\n</code></pre>","tags":["ABAP","Utilit\u00e1rios","DateTime"]},{"location":"utilitarios/2_data_hora/#timezones","title":"Timezones","text":"<p>Use classes de timestamp para converter:</p> <pre><code>DATA(lv_tstmp) = cl_abap_tstmp=&gt;get_current( ).\n\" Converter para timezone espec\u00edfica\nDATA(lv_utc) = cl_abap_tstmp=&gt;to_utc( iv_tstmp = lv_tstmp ).\n</code></pre>","tags":["ABAP","Utilit\u00e1rios","DateTime"]},{"location":"utilitarios/2_data_hora/#formatacao-amigavel","title":"Formata\u00e7\u00e3o amig\u00e1vel","text":"<ul> <li>Use templates para formatar</li> <li>Use <code>CONVERT TIME STAMP</code> para convers\u00f5es cl\u00e1ssicas em sistemas legados</li> </ul> <pre><code>DATA(lv_t) = sy-uzeit.\nDATA(lv_hh) = lv_t(2).\nDATA(lv_mm) = lv_t+2(2).\nDATA(lv_ss) = lv_t+4(2).\n\nWRITE: / |{ lv_hh }:{ lv_mm }:{ lv_ss }|.\n</code></pre>","tags":["ABAP","Utilit\u00e1rios","DateTime"]},{"location":"utilitarios/2_data_hora/#boas-praticas","title":"Boas Pr\u00e1ticas","text":"<ul> <li>Armazene datas no formato nativo (<code>d</code>) na base de dados.</li> <li>N\u00e3o confie no rel\u00f3gio do cliente para autoriza\u00e7\u00f5es/valida\u00e7\u00f5es cr\u00edticas; use <code>sy-datum</code>/<code>sy-uzeit</code> ou services centrais.</li> <li>Ao exibir, converta para timezone do usu\u00e1rio.</li> </ul>","tags":["ABAP","Utilit\u00e1rios","DateTime"]},{"location":"utilitarios/2_data_hora/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li><code>3_conversoes.md</code> \u2014 convers\u00f5es tipo a tipo</li> </ul> <p>Tags: <code>#date</code> <code>#time</code> <code>#timezone</code></p>","tags":["ABAP","Utilit\u00e1rios","DateTime"]},{"location":"utilitarios/3_conversoes/","title":"Convers\u00f5es de Tipos","text":"","tags":["ABAP","Utilit\u00e1rios","Conversions"]},{"location":"utilitarios/3_conversoes/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Convers\u00f5es entre tipos s\u00e3o comuns: n\u00fameros para texto, texto para n\u00fameros, cast entre refer\u00eancias e estruturas. Aqui est\u00e3o as ferramentas e armadilhas.</p>","tags":["ABAP","Utilit\u00e1rios","Conversions"]},{"location":"utilitarios/3_conversoes/#conv-e-cast","title":"CONV e CAST","text":"<ul> <li><code>CONV</code> para convers\u00f5es expl\u00edcitas de valor</li> <li><code>CAST</code> para refer\u00eancias e objetos</li> </ul> <pre><code>DATA(lv_num_str) = CONV string( 123 ).\nDATA(lv_int) = CONV i( '00123' ).\n\n\" CAST\nDATA(lo_obj) = CAST ref TO zcl_my_class( lv_ref ).\n</code></pre>","tags":["ABAP","Utilit\u00e1rios","Conversions"]},{"location":"utilitarios/3_conversoes/#conversoes-de-numerosdecimais","title":"Convers\u00f5es de n\u00fameros/decimais","text":"<ul> <li>Use <code>DECIMAL_SHIFT</code> e tipos <code>p</code> para c\u00e1lculos financeiros</li> <li>Evite convers\u00f5es impl\u00edcitas que silenciosamente truncam</li> </ul> <pre><code>DATA(lv_amount) = '100,50'.\nREPLACE ALL OCCURRENCES OF ',' IN lv_amount WITH '.'.\nDATA(lv_dec) = CONV p( lv_amount ).\n</code></pre>","tags":["ABAP","Utilit\u00e1rios","Conversions"]},{"location":"utilitarios/3_conversoes/#strings-estruturas","title":"Strings -&gt; Estruturas","text":"<ul> <li>Use <code>SPLIT</code> + <code>MOVE-CORRESPONDING</code> ou <code>cl_abap_structdescr</code></li> <li>Para CSV, prefira <code>cl_abap_structdescr</code> ou parsing dedicado</li> </ul>","tags":["ABAP","Utilit\u00e1rios","Conversions"]},{"location":"utilitarios/3_conversoes/#json-xml","title":"JSON / XML","text":"<ul> <li>JSON: <code>cl_sxml_string_writer</code> / <code>cl_trex_json</code> (dependendo da vers\u00e3o)</li> <li>XML: <code>CALL TRANSFORMATION</code> ou <code>cl_xml_document</code></li> </ul> <p>Exemplo simples JSON \u2192 estrutura:</p> <pre><code>DATA: lv_json TYPE string.\nCALL TRANSFORMATION id\n  SOURCE XML lv_json\n  RESULT my_struct = DATA(ls_struct).\n</code></pre>","tags":["ABAP","Utilit\u00e1rios","Conversions"]},{"location":"utilitarios/3_conversoes/#boas-praticas","title":"Boas Pr\u00e1ticas","text":"<ul> <li>Valide antes de converter (ex: <code>IS NUMERIC</code>)</li> <li>Use <code>CONV</code> explicitamente para mostrar inten\u00e7\u00e3o</li> <li>Evite depender de locais (comma vs dot) sem normalizar</li> </ul>","tags":["ABAP","Utilit\u00e1rios","Conversions"]},{"location":"utilitarios/3_conversoes/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li><code>4_file_handling.md</code> \u2014 ficheiros no app/presentation server</li> </ul> <p>Tags: <code>#conversoes</code> <code>#casting</code> <code>#json</code></p>","tags":["ABAP","Utilit\u00e1rios","Conversions"]},{"location":"utilitarios/4_file_handling/","title":"Manipula\u00e7\u00e3o de Ficheiros","text":"","tags":["ABAP","Utilit\u00e1rios","Files"]},{"location":"utilitarios/4_file_handling/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>ABAP diferencia Presentation Server (PC do usu\u00e1rio) e Application Server (servidor SAP). Principais comandos: <code>OPEN DATASET</code>, <code>TRANSFER</code>, <code>READ DATASET</code>, <code>CLOSE DATASET</code>.</p>","tags":["ABAP","Utilit\u00e1rios","Files"]},{"location":"utilitarios/4_file_handling/#application-server-server","title":"Application Server (SERVER)","text":"<pre><code>DATA: lv_path TYPE string VALUE '/usr/sap/trans/myfile.txt'.\n\nOPEN DATASET lv_path FOR INPUT IN TEXT MODE ENCODING DEFAULT.\nIF sy-subrc &lt;&gt; 0.\n  MESSAGE 'Erro ao abrir ficheiro' TYPE 'E'.\n  RETURN.\nENDIF.\n\nREAD DATASET lv_path INTO DATA(lv_line).\nWHILE sy-subrc = 0.\n  WRITE: / lv_line.\n  READ DATASET lv_path INTO lv_line.\nENDWHILE.\n\nCLOSE DATASET lv_path.\n</code></pre>","tags":["ABAP","Utilit\u00e1rios","Files"]},{"location":"utilitarios/4_file_handling/#presentation-server-pc","title":"Presentation Server (PC)","text":"<ul> <li>Use <code>GUI_UPLOAD</code> / <code>GUI_DOWNLOAD</code> (cl_gui_frontend_services)</li> </ul> <pre><code>DATA: lt_lines TYPE TABLE OF string.\ncl_gui_frontend_services=&gt;gui_upload(\n  EXPORTING\n    filename = 'C:\\temp\\file.txt'\n  CHANGING\n    data_tab = lt_lines ).\n</code></pre>","tags":["ABAP","Utilit\u00e1rios","Files"]},{"location":"utilitarios/4_file_handling/#seguranca-e-permissoes","title":"Seguran\u00e7a e Permiss\u00f5es","text":"<ul> <li>Restrinja paths permitidos (whitelist).</li> <li>Evite permitir upload arbitr\u00e1rio sem valida\u00e7\u00e3o.</li> <li>Evite executar ficheiros carregados.</li> </ul>","tags":["ABAP","Utilit\u00e1rios","Files"]},{"location":"utilitarios/4_file_handling/#boas-praticas","title":"Boas Pr\u00e1ticas","text":"<ul> <li>Use <code>OPEN DATASET</code> com <code>IN TEXT MODE</code> e <code>ENCODING</code> adequado.</li> <li>Sempre <code>CLOSE DATASET</code> em tratamento de exce\u00e7\u00f5es (TRY/CATCH ou CLEANUP).</li> <li>Ao escrever ficheiros sens\u00edveis, controle permiss\u00f5es e rotas de transporte.</li> </ul>","tags":["ABAP","Utilit\u00e1rios","Files"]},{"location":"utilitarios/4_file_handling/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li><code>5_mensagens.md</code> \u2014 mensagens e logging</li> </ul> <p>Tags: <code>#files</code> <code>#open_dataset</code> <code>#gui_upload</code></p>","tags":["ABAP","Utilit\u00e1rios","Files"]},{"location":"utilitarios/5_mensagens/","title":"Mensagens e Logging","text":"","tags":["ABAP","Utilit\u00e1rios","Mensagens"]},{"location":"utilitarios/5_mensagens/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Mensagens em ABAP fornecem feedback ao utilizador (<code>S</code>, <code>I</code>, <code>W</code>, <code>E</code>, <code>A</code>) e h\u00e1 frameworks para log e auditoria (<code>BAL</code>, <code>SLG1</code>).</p>","tags":["ABAP","Utilit\u00e1rios","Mensagens"]},{"location":"utilitarios/5_mensagens/#message","title":"MESSAGE","text":"<ul> <li>Sintaxe b\u00e1sica: <code>MESSAGE 'texto' TYPE 'I'.</code></li> <li>Tipos: <code>S</code> (sucesso), <code>I</code> (info), <code>W</code> (warning), <code>E</code> (erro), <code>A</code> (abend)</li> </ul> <pre><code>IF sy-subrc &lt;&gt; 0.\n  MESSAGE 'Opera\u00e7\u00e3o falhou' TYPE 'E'.\nENDIF.\n</code></pre>","tags":["ABAP","Utilit\u00e1rios","Mensagens"]},{"location":"utilitarios/5_mensagens/#classes-de-mensagem","title":"Classes de Mensagem","text":"<ul> <li>Use mensagems classes (<code>SE91</code>) para textos reutiliz\u00e1veis e tradu\u00e7\u00e3o.</li> </ul> <pre><code>MESSAGE e001(zmy_class) WITH lv_param.\n</code></pre>","tags":["ABAP","Utilit\u00e1rios","Mensagens"]},{"location":"utilitarios/5_mensagens/#logging-e-auditoria","title":"Logging e Auditoria","text":"<ul> <li><code>BAL</code> / Application Log para opera\u00e7\u00f5es cr\u00edticas</li> <li><code>SLG1</code> para visualizar logs</li> </ul> <pre><code>CALL FUNCTION 'BAL_LOG_MSG_ADD'\n  EXPORTING\n    i_s_msg = VALUE #( msgty = 'I' msgv1 = |Processo OK| ).\n</code></pre>","tags":["ABAP","Utilit\u00e1rios","Mensagens"]},{"location":"utilitarios/5_mensagens/#excecoes-vs-mensagens","title":"Exce\u00e7\u00f5es vs Mensagens","text":"<ul> <li>Use exce\u00e7\u00f5es (classes) para flows program\u00e1ticos e <code>MESSAGE</code> para UX.</li> <li>Em APIs internas, preferir exce\u00e7\u00f5es que callers possam tratar.</li> </ul>","tags":["ABAP","Utilit\u00e1rios","Mensagens"]},{"location":"utilitarios/5_mensagens/#boas-praticas","title":"Boas Pr\u00e1ticas","text":"<ul> <li>N\u00e3o expor dados sens\u00edveis em mensagens</li> <li>Use classes de mensagem para i18n</li> <li>Logue opera\u00e7\u00f5es cr\u00edticas em <code>BAL</code> com contexto</li> </ul>","tags":["ABAP","Utilit\u00e1rios","Mensagens"]},{"location":"utilitarios/5_mensagens/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li><code>6_number_ranges.md</code> \u2014 gerar n\u00fameros sequenciais</li> </ul> <p>Tags: <code>#message</code> <code>#logging</code> <code>#bal</code></p>","tags":["ABAP","Utilit\u00e1rios","Mensagens"]},{"location":"utilitarios/6_number_ranges/","title":"Number Ranges","text":"","tags":["ABAP","Utilit\u00e1rios","Number Ranges"]},{"location":"utilitarios/6_number_ranges/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Number ranges (intervalos num\u00e9ricos) s\u00e3o usados para documentos e objetos que precisam de IDs \u00fanicos e sequenciais. Em SAP, h\u00e1 SNRO (Number Range Objects) e FM/Classes para obter o pr\u00f3ximo n\u00famero.</p>","tags":["ABAP","Utilit\u00e1rios","Number Ranges"]},{"location":"utilitarios/6_number_ranges/#usar-snro-number_get_next","title":"Usar SNRO (NUMBER_GET_NEXT)","text":"<pre><code>DATA: lv_number TYPE n LENGTH 10.\n\nCALL FUNCTION 'NUMBER_GET_NEXT'\n  EXPORTING\n    nr_range_nr = '01'\n    object      = 'Z_MY_NUMBER_RANGE'\n  IMPORTING\n    number      = lv_number\n  EXCEPTIONS\n    OTHERS      = 1.\n\nIF sy-subrc &lt;&gt; 0.\n  \" Tratar erro\nENDIF.\n</code></pre> <ul> <li><code>Z_MY_NUMBER_RANGE</code> precisa ser criado via SNRO (transaction SNRO).</li> <li>Transporte e autoriza\u00e7\u00e3o cuidadosos.</li> </ul>","tags":["ABAP","Utilit\u00e1rios","Number Ranges"]},{"location":"utilitarios/6_number_ranges/#boas-praticas","title":"Boas Pr\u00e1ticas","text":"<ul> <li>Use number ranges para documentos que exigem sequ\u00eancia e controle.</li> <li>Proteja concorr\u00eancia (SNRO lida com lock interno).</li> <li>Evite reiniciar ranges sem planeamento.</li> </ul>","tags":["ABAP","Utilit\u00e1rios","Number Ranges"]},{"location":"utilitarios/6_number_ranges/#exemplos","title":"Exemplos","text":"<ul> <li>NF-e, Pedidos (Sales Order), Faturas, IDs internos</li> </ul>","tags":["ABAP","Utilit\u00e1rios","Number Ranges"]},{"location":"utilitarios/6_number_ranges/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li><code>7_locks.md</code> \u2014 mecanismo de lock</li> </ul> <p>Tags: <code>#number-range</code> <code>#snro</code> <code>#unique-id</code></p>","tags":["ABAP","Utilit\u00e1rios","Number Ranges"]},{"location":"utilitarios/7_locks/","title":"Locks (Enqueue / Dequeue)","text":"","tags":["ABAP","Utilit\u00e1rios","Locks"]},{"location":"utilitarios/7_locks/#visao-geral","title":"\ud83d\udccb Vis\u00e3o Geral","text":"<p>Locks previnem atualiza\u00e7\u00f5es concorrentes de dados cr\u00edticos. Em ABAP usamos <code>ENQUEUE_&lt;OBJ&gt;</code> e <code>DEQUEUE_&lt;OBJ&gt;</code> (ou <code>ENQUEUE</code>/<code>DEQUEUE</code>).</p>","tags":["ABAP","Utilit\u00e1rios","Locks"]},{"location":"utilitarios/7_locks/#lock-object","title":"Lock Object","text":"<ul> <li>Definido em <code>SE11</code> \u2192 Lock Objects</li> <li>Campos chave: ex: <code>ZLOCK_OBJ</code> com <code>MANDT</code>, <code>KUNNR</code></li> </ul>","tags":["ABAP","Utilit\u00e1rios","Locks"]},{"location":"utilitarios/7_locks/#exemplo-de-uso","title":"Exemplo de uso","text":"<pre><code>DATA: lv_kunnr TYPE kunnr VALUE '1000'.\n\nCALL FUNCTION 'ENQUEUE_EZLOCK'\n  EXPORTING\n    mode_zlock = 'S'\n    kunnr      = lv_kunnr\n  EXCEPTIONS\n    foreign_lock = 1\n    system_failure = 2\n    OTHERS = 3.\n\nIF sy-subrc &lt;&gt; 0.\n  \" Tratar lock n\u00e3o obtido\nENDIF.\n\n\" Fazer atualiza\u00e7\u00e3o segura\n\nCALL FUNCTION 'DEQUEUE_EZLOCK'\n  EXPORTING\n    kunnr = lv_kunnr.\n</code></pre>","tags":["ABAP","Utilit\u00e1rios","Locks"]},{"location":"utilitarios/7_locks/#enqueuedequeue-moderno","title":"ENQUEUE/DEQUEUE Moderno","text":"<pre><code>ENQUEUE zlock_object ID lv_key.\n\" ...\nDEQUEUE zlock_object ID lv_key.\n</code></pre>","tags":["ABAP","Utilit\u00e1rios","Locks"]},{"location":"utilitarios/7_locks/#tipos-de-lock","title":"Tipos de Lock","text":"<ul> <li>Shared (S) \u2014 leitura coordenada</li> <li>Exclusive (E) \u2014 escrita exclusiva</li> </ul>","tags":["ABAP","Utilit\u00e1rios","Locks"]},{"location":"utilitarios/7_locks/#boas-praticas","title":"Boas Pr\u00e1ticas","text":"<ul> <li>Mantenha o bloco de c\u00f3digo lock o mais curto poss\u00edvel.</li> <li>Sempre liberar locks (<code>DEQUEUE</code>) em todas as rotas de sa\u00edda (TRY/CATCH/FINAL).</li> <li>Use lock objects definidos em SE11, n\u00e3o ad-hoc.</li> </ul>","tags":["ABAP","Utilit\u00e1rios","Locks"]},{"location":"utilitarios/7_locks/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li>Revisar <code>security</code> e <code>testes</code> para integra\u00e7\u00f5es com locks e number ranges.</li> </ul> <p>Tags: <code>#locks</code> <code>#enqueue</code> <code>#concurrency</code></p>","tags":["ABAP","Utilit\u00e1rios","Locks"]}]}